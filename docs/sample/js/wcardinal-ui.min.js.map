{"version":3,"file":"wcardinal-ui.min.js","sources":["../../../node_modules/tslib/tslib.es6.js","wcardinal/ui/d-applications.ts","wcardinal/ui/d-border-mask.ts","wcardinal/ui/util/is-function.ts","wcardinal/ui/d-base-background.ts","wcardinal/ui/util/is-string.ts","wcardinal/ui/d-corner-mask.ts","wcardinal/ui/d-base-border.ts","wcardinal/ui/util/is-number.ts","wcardinal/ui/d-base-interactive.ts","wcardinal/ui/d-base-corner.ts","wcardinal/ui/d-base-outline.ts","wcardinal/ui/d-base-state.ts","wcardinal/ui/d-base-padding.ts","wcardinal/ui/d-base-point.ts","wcardinal/ui/d-base-background-mesh-geometry.ts","wcardinal/ui/d-base-background-mesh.ts","wcardinal/ui/d-base-border-mesh-geometry.ts","wcardinal/ui/d-base-border-mesh.ts","wcardinal/ui/d-base-outline-mesh.ts","wcardinal/ui/d-base-reflowable.ts","wcardinal/ui/d-base-states.ts","wcardinal/ui/d-layout-clear-type.ts","wcardinal/ui/d-scalar-expression.ts","wcardinal/ui/d-base.ts","wcardinal/ui/d-scalar-functions.ts","wcardinal/ui/theme/d-themes.ts","wcardinal/ui/util/util-keyboard-event.ts","wcardinal/ui/util/util-pointer-event.ts","wcardinal/ui/d-align-horizontal.ts","wcardinal/ui/d-align-vertical.ts","wcardinal/ui/d-align-with.ts","wcardinal/ui/d-dynamic-text-measure-result-character.ts","wcardinal/ui/d-dynamic-text-measure-result.ts","wcardinal/ui/util/util-character-iterator.ts","wcardinal/ui/d-dynamic-text-measure.ts","wcardinal/ui/d-dynamic-text-geometry.ts","wcardinal/ui/d-dynamic-text-style.ts","wcardinal/ui/d-dynamic-text.ts","wcardinal/ui/d-base-overflow-mask-simple.ts","wcardinal/ui/d-menu-item-link-menu-item-id.ts","wcardinal/ui/d-text-base.ts","wcardinal/ui/d-image-base.ts","wcardinal/ui/d-image.ts","wcardinal/ui/d-list-item.ts","wcardinal/ui/d-menu-item.ts","wcardinal/ui/d-menu-item-text.ts","wcardinal/ui/d-menu-item-check.ts","wcardinal/ui/d-menu-item-link-state.ts","wcardinal/ui/d-menu-item-link-target.ts","wcardinal/ui/d-menus.ts","wcardinal/ui/util/util-attach.ts","wcardinal/ui/util/util-clipboard.ts","wcardinal/ui/d-menu-item-link.ts","wcardinal/ui/d-layout-direction.ts","wcardinal/ui/d-menu-align.ts","wcardinal/ui/d-menu-item-menu.ts","wcardinal/ui/d-list-item-separator-reflowable.ts","wcardinal/ui/d-list-item-separator.ts","wcardinal/ui/d-menu-item-separator.ts","wcardinal/ui/d-layout-space.ts","wcardinal/ui/d-menu-item-space.ts","wcardinal/ui/load/load-menu-item.ts","wcardinal/ui/d-layout.ts","wcardinal/ui/shape/e-shape-type.ts","wcardinal/ui/d-layout-vertical.ts","wcardinal/ui/d-menu-item-expandable-body.ts","wcardinal/ui/d-menu-item-expandable-header.ts","wcardinal/ui/d-menu-item-expandables.ts","wcardinal/ui/d-menu-item-expandable.ts","wcardinal/ui/d-menu-item-expandable-item-check.ts","wcardinal/ui/d-menu-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-separator.ts","wcardinal/ui/d-menu-item-expandable-item-space.ts","wcardinal/ui/d-menu-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-item-expandable.ts","wcardinal/ui/d-menu-sided-item-check.ts","wcardinal/ui/d-menu-sided-item-link.ts","wcardinal/ui/d-menu-sided-item-menu.ts","wcardinal/ui/d-menu-sided-item-separator.ts","wcardinal/ui/d-menu-sided-item-space.ts","wcardinal/ui/d-menu-sided-item-text.ts","wcardinal/ui/d-menu-sideds.ts","wcardinal/ui/load/load-menu-sided-item.ts","wcardinal/ui/d-menu-sided-item-expandables.ts","wcardinal/ui/d-menu-sided-item-expandable.ts","wcardinal/ui/d-menu-sided-item-expandable-item-check.ts","wcardinal/ui/d-menu-sided-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-separator.ts","wcardinal/ui/d-menu-sided-item-expandable-item-space.ts","wcardinal/ui/d-menu-sided-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-sided-item-expandable.ts","wcardinal/ui/load/load-menu-item-all.ts","wcardinal/ui/shape/e-shape-deserializers.ts","wcardinal/ui/shape/e-shape-uploadeds.ts","wcardinal/ui/shape/e-shape-points-style.ts","wcardinal/ui/shape/e-shape-points-style-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-bar-position.ts","wcardinal/ui/shape/variant/e-shape-bar-points.ts","wcardinal/ui/shape/e-shape.ts","wcardinal/ui/shape/e-shape-runtime.ts","wcardinal/ui/shape/action/e-shape-action.ts","wcardinal/ui/shape/e-shape-corner.ts","wcardinal/ui/shape/e-shape-stroke-side.ts","wcardinal/ui/shape/e-shape-transform.ts","wcardinal/ui/util/to-padded.ts","wcardinal/ui/util/util-rgb.ts","wcardinal/ui/shape/variant/e-shape-gradients.ts","wcardinal/ui/shape/variant/e-shape-base.ts","wcardinal/ui/shape/e-shape-defaults.ts","wcardinal/ui/shape/e-shape-tag-value.ts","wcardinal/ui/shape/e-shape-tag-value-range.ts","wcardinal/ui/shape/variant/e-shape-fill-impl.ts","wcardinal/ui/shape/variant/e-shape-stroke-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-value-range-impl.ts","wcardinal/ui/shape/e-shape-text.ts","wcardinal/ui/shape/e-shape-text-align-horizontal.ts","wcardinal/ui/shape/e-shape-text-align-vertical.ts","wcardinal/ui/shape/e-shape-text-direction.ts","wcardinal/ui/shape/variant/e-shape-tag-value-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-impl.ts","wcardinal/ui/shape/variant/e-shape-text-align-impl.ts","wcardinal/ui/shape/action/e-shape-action-value-blink-type.ts","wcardinal/ui/shape/variant/e-shape-text-offset-impl.ts","wcardinal/ui/shape/variant/e-shape-text-outline-impl.ts","wcardinal/ui/shape/variant/e-shape-text-impl.ts","wcardinal/ui/shape/variant/e-shape-primitive.ts","wcardinal/ui/shape/variant/e-shape-line-base.ts","wcardinal/ui/shape/variant/e-shape-bar.ts","wcardinal/ui/shape/variant/build-color.ts","wcardinal/ui/shape/e-shape-uploaded.ts","wcardinal/ui/shape/variant/e-shape-text-uploadeds.ts","wcardinal/ui/shape/variant/to-length.ts","wcardinal/ui/shape/variant/e-shape-text-uploaded.ts","wcardinal/ui/shape/variant/e-shape-bar-uploaded.ts","wcardinal/ui/shape/variant/e-shape-bar-uploadeds.ts","wcardinal/ui/util/is-array.ts","wcardinal/ui/shape/action/e-shape-action-bases.ts","wcardinal/ui/shape/action/e-shape-action-runtime.ts","wcardinal/ui/shape/action/e-shape-action-runtime-conditional.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-brighten.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-darken.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-opacity.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-visibility.ts","wcardinal/ui/shape/action/e-shape-action-value-base.ts","wcardinal/ui/shape/action/e-shape-action-value-type.ts","wcardinal/ui/shape/action/e-shape-action-value-subtyped.ts","wcardinal/ui/shape/action/e-shape-action-values.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-target.ts","wcardinal/ui/shape/action/e-shape-action-value-blink.ts","wcardinal/ui/util/util-alpha.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-cursor.ts","wcardinal/ui/shape/action/e-shape-action-value-change-cursor.ts","wcardinal/ui/util/format-node/format-node-a-large.ts","wcardinal/ui/util/format-node/format-node-a-small.ts","wcardinal/ui/util/format-node/format-node-d-large.ts","wcardinal/ui/util/format-node/format-node-d-small.ts","wcardinal/ui/util/format-node/format-node-precision.ts","wcardinal/ui/util/format-node/format-node-e.ts","wcardinal/ui/util/format-node/format-node-f.ts","wcardinal/ui/util/format-node/format-node-fsi.ts","wcardinal/ui/util/format-node/format-node-g.ts","wcardinal/ui/util/format-node/format-node-h-large.ts","wcardinal/ui/util/format-node/format-node-h-small.ts","wcardinal/ui/util/format-node/format-node-m-large.ts","wcardinal/ui/util/format-node/format-node-m-small.ts","wcardinal/ui/util/format-node/format-node-mi.ts","wcardinal/ui/util/format-node/format-node-p-large.ts","wcardinal/ui/util/format-node/format-node-p-small.ts","wcardinal/ui/util/format-node/format-node-padding.ts","wcardinal/ui/util/format-node/format-node-parenthesis.ts","wcardinal/ui/util/format-node/format-node-plus.ts","wcardinal/ui/util/format-node/format-node-rp-large.ts","wcardinal/ui/util/format-node/format-node-rp-small.ts","wcardinal/ui/util/format-node/format-node-sdt.ts","wcardinal/ui/util/format-node/format-node-space.ts","wcardinal/ui/util/format-node/format-node-ssi.ts","wcardinal/ui/util/format-node/format-node-string.ts","wcardinal/ui/util/format-node/format-node-y-large.ts","wcardinal/ui/util/format-node/format-node-y-small.ts","wcardinal/ui/util/format-node/format-node-z.ts","wcardinal/ui/util/format-node/format-noder-d.ts","wcardinal/ui/util/format-node/format-nodes.ts","wcardinal/ui/util/number-formatter-impl.ts","wcardinal/ui/util/number-formatters.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-number.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-text.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text.ts","wcardinal/ui/shape/action/e-shape-action-value-misc-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-emit-event.ts","wcardinal/ui/shape/action/e-shape-action-value-emit-event.ts","wcardinal/ui/util/ascii.ts","wcardinal/ui/util/dynamic-font-atlas-chaaracter-origin.ts","wcardinal/ui/util/dynamic-font-atlas-character.ts","wcardinal/ui/util/dynamic-sdf-font-generator.ts","wcardinal/ui/util/dynamic-sdf-font-atlas.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input-data.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input.ts","wcardinal/ui/shape/action/e-shape-action-value-misc.ts","wcardinal/ui/shape/action/e-shape-action-value-open-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-flow.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page-inplace.ts","wcardinal/ui/shape/action/e-shape-action-value-open.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move-type.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-type.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-y.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-forward-or-backward.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-left-or-right.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-y.ts","wcardinal/ui/shape/action/e-shape-action-value-opetyped.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize-type.ts","wcardinal/ui/shape/e-shape-sizes.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate.ts","wcardinal/ui/shape/action/e-shape-action-value-deserializer.ts","wcardinal/ui/shape/e-shape-image-elements.ts","wcardinal/ui/shape/e-shape-resource-manager-deserialization.ts","wcardinal/ui/shape/e-shape-deserializer.ts","wcardinal/ui/shape/variant/e-shape-bars.ts","wcardinal/ui/load/load-shape-bar.ts","wcardinal/ui/shape/variant/build-step.ts","wcardinal/ui/shape/variant/to-step.ts","wcardinal/ui/shape/variant/build-circle.ts","wcardinal/ui/shape/variant/e-shape-circle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-circle-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-circle.ts","wcardinal/ui/shape/variant/e-shape-circles.ts","wcardinal/ui/load/load-shape-circle.ts","wcardinal/ui/shape/variant/e-shape-group-uploaded.ts","wcardinal/ui/shape/variant/e-shape-group-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-group-fill-editor.ts","wcardinal/ui/shape/variant/e-shape-group-points.ts","wcardinal/ui/shape/e-shape-editor.ts","wcardinal/ui/shape/e-shape-transforms.ts","wcardinal/ui/shape/variant/e-shape-group-size-layout.ts","wcardinal/ui/shape/variant/e-shape-group-size-editor.ts","wcardinal/ui/shape/variant/e-shape-group-size-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-editor.ts","wcardinal/ui/shape/variant/e-shape-group.ts","wcardinal/ui/shape/variant/e-shape-groups.ts","wcardinal/ui/load/load-shape-group.ts","wcardinal/ui/shape/variant/e-shape-group-size-shadowed.ts","wcardinal/ui/shape/variant/e-shape-group-shadowed.ts","wcardinal/ui/shape/variant/e-shape-group-shadoweds.ts","wcardinal/ui/load/load-shape-group-shadowed.ts","wcardinal/ui/shape/variant/e-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-image.ts","wcardinal/ui/shape/variant/e-shape-images.ts","wcardinal/ui/shape/variant/build-rectangle.ts","wcardinal/ui/shape/variant/e-shape-rectangle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-uploadeds.ts","wcardinal/ui/load/load-shape-image.ts","wcardinal/ui/shape/variant/e-shape-label-uploaded.ts","wcardinal/ui/shape/variant/e-shape-label-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-label.ts","wcardinal/ui/shape/variant/e-shape-labels.ts","wcardinal/ui/load/load-shape-label.ts","wcardinal/ui/util/to-index-of.ts","wcardinal/ui/shape/variant/e-shape-line-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-line-points.ts","wcardinal/ui/shape/variant/e-shape-line.ts","wcardinal/ui/shape/variant/e-shape-lines.ts","wcardinal/ui/load/load-shape-line.ts","wcardinal/ui/shape/variant/e-shape-line-of-nulls-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-uploadeds.ts","wcardinal/ui/shape/variant/copy-clipping.ts","wcardinal/ui/shape/variant/copy-index.ts","wcardinal/ui/shape/variant/copy-step.ts","wcardinal/ui/shape/variant/copy-uv.ts","wcardinal/ui/shape/variant/copy-vertex.ts","wcardinal/ui/shape/variant/is-static.ts","wcardinal/ui/shape/variant/to-computed.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-fill-impl.ts","wcardinal/ui/util/dynamic-atlas-item.ts","wcardinal/ui/util/dynamic-atlas-item-empty.ts","wcardinal/ui/util/dynamic-atlas-item-font-atlas.ts","wcardinal/ui/util/dynamic-atlas-item-image.ts","wcardinal/ui/util/dynamic-atlas-item-text.ts","wcardinal/ui/util/dynamic-atlas-item-white.ts","wcardinal/ui/util/dynamic-atlas.ts","wcardinal/ui/util/dynamic-font-atlas-font.ts","wcardinal/ui/util/dynamic-font-atlas.ts","wcardinal/ui/util/dynamic-font-atlases.ts","wcardinal/ui/util/dynamic-sdf-font-atlases.ts","wcardinal/ui/util/is-nan.ts","wcardinal/ui/util/lazy.ts","wcardinal/ui/util/to-ceiling-index.ts","wcardinal/ui/util/to-string.ts","wcardinal/ui/util/to-svg-url.ts","wcardinal/ui/resource/svg-resource.ts","wcardinal/ui/util/util-svg-atlas-builder.ts","wcardinal/ui/d-mouse-modifier.ts","wcardinal/ui/util/util-click-outside.ts","wcardinal/ui/util/util-drag-easing-history.ts","wcardinal/ui/d-animation-timings.ts","wcardinal/ui/d-animation-base.ts","wcardinal/ui/util/util-drag-easing.ts","wcardinal/ui/d-mouse-modifiers.ts","wcardinal/ui/util/util-file-opener.ts","wcardinal/ui/util/util-drag.ts","wcardinal/ui/util/util-extractor.ts","wcardinal/ui/util/util-file-downloader.ts","wcardinal/ui/util/util-extract.ts","wcardinal/ui/shape/e-shape-capability.ts","wcardinal/ui/util/util-hsv.ts","wcardinal/ui/util/util-name.ts","wcardinal/ui/util/util-overlay.ts","wcardinal/ui/util/util-promise.ts","wcardinal/ui/util/util-rgba.ts","wcardinal/ui/util/util-texture-plane.ts","wcardinal/ui/util/util-texture.ts","wcardinal/ui/util/util-transition.ts","wcardinal/ui/util/util-wheel-event.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-size-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-stroke-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points.ts","wcardinal/ui/shape/variant/build-line-of-any-color.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-circles-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-circles-uploadeds.ts","wcardinal/ui/shape/variant/to-hit-threshold.ts","wcardinal/ui/shape/variant/e-shape-line-of-circles.ts","wcardinal/ui/shape/variant/e-shape-lines-of-circles.ts","wcardinal/ui/load/load-shape-line-of-circles.ts","wcardinal/ui/shape/e-shape-capabilities.ts","wcardinal/ui/snapper/e-snapper-target-value.ts","wcardinal/ui/shape/variant/build-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangle-roundeds-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangle-roundeds.ts","wcardinal/ui/shape/variant/e-shape-lines-of-rectangle-roundeds.ts","wcardinal/ui/load/load-shape-line-of-rectangle-roundeds.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangles-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangles-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangles.ts","wcardinal/ui/shape/variant/e-shape-lines-of-rectangles.ts","wcardinal/ui/load/load-shape-line-of-rectangles.ts","wcardinal/ui/shape/variant/build-triangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangle-roundeds-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangle-roundeds.ts","wcardinal/ui/shape/variant/e-shape-lines-of-triangle-roundeds.ts","wcardinal/ui/load/load-shape-line-of-triangle-roundeds.ts","wcardinal/ui/shape/variant/build-triangle.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangles-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangles-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangles.ts","wcardinal/ui/shape/variant/e-shape-lines-of-triangles.ts","wcardinal/ui/load/load-shape-line-of-triangles.ts","wcardinal/ui/shape/variant/e-shape-null-uploaded.ts","wcardinal/ui/shape/variant/e-shape-null-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-null.ts","wcardinal/ui/shape/variant/e-shape-nulls.ts","wcardinal/ui/load/load-shape-null.ts","wcardinal/ui/shape/variant/e-shape-rectangles.ts","wcardinal/ui/load/load-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-rectangle-roundeds.ts","wcardinal/ui/load/load-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-triangle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-triangle-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-triangles.ts","wcardinal/ui/load/load-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-triangle-roundeds.ts","wcardinal/ui/load/load-shape-triangle-rounded.ts","wcardinal/ui/load/load-shape-all.ts","wcardinal/ui/load/load-all.ts","wcardinal/ui/shape/variant/e-shape-group-fill-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-viewer.ts","wcardinal/ui/shape/e-shape-buffer-count.ts","wcardinal/ui/shape/e-shape-buffer-unit.ts","wcardinal/ui/shape/e-shape-buffer-unit-builder.ts","wcardinal/ui/shape/e-shape-buffer.ts","wcardinal/ui/shape/e-shape-renderer-iterator-datum.ts","wcardinal/ui/shape/e-shape-renderer-iterator.ts","wcardinal/ui/shape/e-shape-renderer.ts","wcardinal/ui/shape/e-shape-container.ts","wcardinal/ui/shape/e-shape-search.ts","wcardinal/ui/shape/e-shape-deleter.ts","wcardinal/ui/shape/e-shape-resource-manager-serialization.ts","wcardinal/ui/shape/e-shape-runtimes.ts","wcardinal/ui/snapper/e-snapper-grid.ts","wcardinal/ui/snapper/e-snapper-result.ts","wcardinal/ui/snapper/e-snapper.ts","wcardinal/ui/snapper/e-snapper-target.ts","wcardinal/ui/d-command-flag.ts","wcardinal/ui/d-animation-empty.ts","wcardinal/ui/d-animation-fade-in.ts","wcardinal/ui/d-application-padding.ts","wcardinal/ui/d-application-layer-options.ts","wcardinal/ui/d-controller-default-focus.ts","wcardinal/ui/d-command-clear.ts","wcardinal/ui/d-dialog-close-on.ts","wcardinal/ui/d-command-redo.ts","wcardinal/ui/d-command-undo.ts","wcardinal/ui/d-controller-default-command.ts","wcardinal/ui/d-controller-keyboard.ts","wcardinal/ui/d-controllers.ts","wcardinal/ui/d-application-layer.ts","wcardinal/ui/d-application.ts","wcardinal/ui/d-board.ts","wcardinal/ui/d-button-base.ts","wcardinal/ui/d-button.ts","wcardinal/ui/d-button-ambient.ts","wcardinal/ui/d-button-check.ts","wcardinal/ui/d-button-check-right.ts","wcardinal/ui/d-button-primary.ts","wcardinal/ui/d-dialog.ts","wcardinal/ui/d-html-element-when.ts","wcardinal/ui/d-layout-horizontal.ts","wcardinal/ui/d-dialog-command.ts","wcardinal/ui/d-html-element.ts","wcardinal/ui/d-picker-datetime-mask.ts","wcardinal/ui/d-input.ts","wcardinal/ui/d-input-number.ts","wcardinal/ui/d-input-real.ts","wcardinal/ui/d-text.ts","wcardinal/ui/d-input-label.ts","wcardinal/ui/d-input-and-label.ts","wcardinal/ui/d-input-real-and-label.ts","wcardinal/ui/d-input-text.ts","wcardinal/ui/d-input-text-and-label.ts","wcardinal/ui/d-picker-color-and-alpha.ts","wcardinal/ui/d-picker-color-recent.ts","wcardinal/ui/d-picker-color.ts","wcardinal/ui/d-picker-color-gradient-point.ts","wcardinal/ui/d-picker-color-gradient-data.ts","wcardinal/ui/d-picker-color-gradient-data-view.ts","wcardinal/ui/d-picker-color-gradient-recent.ts","wcardinal/ui/d-picker-color-gradient.ts","wcardinal/ui/d-dialog-color-gradient.ts","wcardinal/ui/d-button-color-gradient.ts","wcardinal/ui/d-dialog-color.ts","wcardinal/ui/d-button-color.ts","wcardinal/ui/d-button-danger.ts","wcardinal/ui/d-picker-datetime-button-back.ts","wcardinal/ui/d-picker-datetime-button-date.ts","wcardinal/ui/d-picker-datetime-button-next.ts","wcardinal/ui/d-picker-datetime-label.ts","wcardinal/ui/d-picker-datetime-label-date.ts","wcardinal/ui/d-picker-datetime-space.ts","wcardinal/ui/d-input-integer.ts","wcardinal/ui/d-picker-time-bound.ts","wcardinal/ui/d-drag-mode.ts","wcardinal/ui/d-picker-time-bound-hours.ts","wcardinal/ui/d-picker-time-bound-minutes.ts","wcardinal/ui/d-picker-time-bound-seconds.ts","wcardinal/ui/d-picker-time-bounds.ts","wcardinal/ui/d-picker-time.ts","wcardinal/ui/d-picker-datetime.ts","wcardinal/ui/d-picker-date.ts","wcardinal/ui/d-dialog-date.ts","wcardinal/ui/d-dialog-dates.ts","wcardinal/ui/d-button-date.ts","wcardinal/ui/d-dialog-datetime.ts","wcardinal/ui/d-dialog-datetimes.ts","wcardinal/ui/d-picker-dates.ts","wcardinal/ui/d-picker-times.ts","wcardinal/ui/d-picker-datetimes.ts","wcardinal/ui/d-button-datetime.ts","wcardinal/ui/d-button-file.ts","wcardinal/ui/d-button-group.ts","wcardinal/ui/d-button-radio.ts","wcardinal/ui/d-button-radio-right.ts","wcardinal/ui/d-button-redo.ts","wcardinal/ui/d-button-secondary.ts","wcardinal/ui/d-dialog-time.ts","wcardinal/ui/d-dialog-times.ts","wcardinal/ui/d-button-time.ts","wcardinal/ui/d-button-undo.ts","wcardinal/ui/d-base-overflow-mask.ts","wcardinal/ui/d-view-drag-impl.ts","wcardinal/ui/d-chart-axis-position.ts","wcardinal/ui/d-chart-axis-tick-position.ts","wcardinal/ui/d-view-transform-impl.ts","wcardinal/ui/d-view-impl.ts","wcardinal/ui/d-canvas-container.ts","wcardinal/ui/d-canvas.ts","wcardinal/ui/shape/e-shape-points-styles.ts","wcardinal/ui/d-chart-coordinate.ts","wcardinal/ui/d-chart-axis-base-options-parser.ts","wcardinal/ui/d-chart-axis-base.ts","wcardinal/ui/d-chart-axis-container-impl.ts","wcardinal/ui/d-chart-axis-x.ts","wcardinal/ui/d-chart-axis-x-datetime.ts","wcardinal/ui/d-chart-axis-y.ts","wcardinal/ui/d-chart-color-set.ts","wcardinal/ui/d-chart-coordinate-container-sub-impl.ts","wcardinal/ui/d-chart-plot-area.ts","wcardinal/ui/d-chart-coordinate-container-impl.ts","wcardinal/ui/d-chart-coordinate-linear-tick.ts","wcardinal/ui/d-chart-coordinate-transform-impl.ts","wcardinal/ui/d-chart-region-impl.ts","wcardinal/ui/d-chart-coordinate-linear.ts","wcardinal/ui/d-chart-coordinate-log-tick.ts","wcardinal/ui/d-chart-coordinate-log.ts","wcardinal/ui/d-chart-legend-item.ts","wcardinal/ui/d-chart-legend.ts","wcardinal/ui/d-chart-overview.ts","wcardinal/ui/d-chart-plot-area-container.ts","wcardinal/ui/d-chart-series.ts","wcardinal/ui/d-chart-series-scalar.ts","wcardinal/ui/d-chart-series-fill-impl.ts","wcardinal/ui/d-chart-series-stroke-impl.ts","wcardinal/ui/d-chart-series-container-impl.ts","wcardinal/ui/d-chart-selection.ts","wcardinal/ui/d-chart-region-impl-observable.ts","wcardinal/ui/d-chart-series-base-coordinate-container.ts","wcardinal/ui/d-chart-series-base.ts","wcardinal/ui/d-chart-series-fill-computed-impl.ts","wcardinal/ui/d-chart-series-stroke-computed-impl.ts","wcardinal/ui/d-chart-series-line-of-any.ts","wcardinal/ui/d-chart-series-line-of-circles.ts","wcardinal/ui/d-chart-series-line-of-rectangle-roundeds.ts","wcardinal/ui/d-chart-series-line-of-rectangles.ts","wcardinal/ui/d-chart-series-line-of-triangle-roundeds.ts","wcardinal/ui/d-chart-series-line-of-triangles.ts","wcardinal/ui/d-chart-series-line.ts","wcardinal/ui/d-chart-series-linear-parameters-impl.ts","wcardinal/ui/d-chart-series-linear.ts","wcardinal/ui/d-chart-selection-shape-base.ts","wcardinal/ui/d-chart-selection-gridline-x.ts","wcardinal/ui/d-chart-selection-gridline-y.ts","wcardinal/ui/d-chart-selection-gridline-container-impl.ts","wcardinal/ui/d-chart-selection-marker.ts","wcardinal/ui/d-chart-selection-sub-impl.ts","wcardinal/ui/d-list-selection.ts","wcardinal/ui/d-chart-selection-simple.ts","wcardinal/ui/d-chart.ts","wcardinal/ui/d-command-create.ts","wcardinal/ui/d-command-delete.ts","wcardinal/ui/d-command-save-as.ts","wcardinal/ui/d-command-save.ts","wcardinal/ui/d-content.ts","wcardinal/ui/d-diagram-canvas-mapping-point-impl.ts","wcardinal/ui/d-diagram-canvas-mapping-impl.ts","wcardinal/ui/d-diagram-canvas-tile.ts","wcardinal/ui/d-diagram-layer.ts","wcardinal/ui/d-diagram-layer-container.ts","wcardinal/ui/d-diagram-canvas-base.ts","wcardinal/ui/d-diagram-canvas-editor.ts","wcardinal/ui/d-diagram-serialized.ts","wcardinal/ui/d-diagram-canvas.ts","wcardinal/ui/d-diagrams.ts","wcardinal/ui/d-diagram-base.ts","wcardinal/ui/d-diagram-editor.ts","wcardinal/ui/d-diagram-shape.ts","wcardinal/ui/d-diagram-tag.ts","wcardinal/ui/d-diagram.ts","wcardinal/ui/d-dialog-confirm-message.ts","wcardinal/ui/d-dialog-confirm.ts","wcardinal/ui/d-dialog-confirm-delete.ts","wcardinal/ui/d-dialog-confirm-discard.ts","wcardinal/ui/d-dialog-input-text.ts","wcardinal/ui/d-dialog-message.ts","wcardinal/ui/d-dialog-processing-message.ts","wcardinal/ui/d-dialog-processing.ts","wcardinal/ui/d-dialog-save-as.ts","wcardinal/ui/d-dialog-select-list-item.ts","wcardinal/ui/d-scroll-bar.ts","wcardinal/ui/d-scroll-bar-thumb.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-horizontal.ts","wcardinal/ui/d-scroll-bar-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-vertical.ts","wcardinal/ui/d-scroll-bar-thumb-vertical.ts","wcardinal/ui/d-scroll-bar-vertical.ts","wcardinal/ui/d-pane.ts","wcardinal/ui/d-list.ts","wcardinal/ui/d-dialog-select-list.ts","wcardinal/ui/d-dialog-select-search.ts","wcardinal/ui/d-note.ts","wcardinal/ui/d-dialog-select.ts","wcardinal/ui/d-menu-context.ts","wcardinal/ui/d-menu.ts","wcardinal/ui/d-dropdown.ts","wcardinal/ui/d-menu-sided-selection.ts","wcardinal/ui/d-expandable-header.ts","wcardinal/ui/d-expandable.ts","wcardinal/ui/d-input-integer-and-label.ts","wcardinal/ui/d-map-coordinate-epsg3857.ts","wcardinal/ui/d-map-coordinates.ts","wcardinal/ui/d-map-tile.ts","wcardinal/ui/d-map-tile-plane.ts","wcardinal/ui/d-map-tile-pyramid-impl.ts","wcardinal/ui/d-map-tile-pyramids.ts","wcardinal/ui/d-menu-bar-item.ts","wcardinal/ui/d-menu-bar-blocker.ts","wcardinal/ui/d-menu-bar.ts","wcardinal/ui/d-menu-sided-content.ts","wcardinal/ui/d-table-column.ts","wcardinal/ui/d-menu-sided.ts","wcardinal/ui/d-notification.ts","wcardinal/ui/d-pagination.ts","wcardinal/ui/d-picker-datetime-range.ts","wcardinal/ui/d-picker-time-range.ts","wcardinal/ui/d-select.ts","wcardinal/ui/d-shadow-impl.ts","wcardinal/ui/d-slider-range.ts","wcardinal/ui/d-slider.ts","wcardinal/ui/d-table-body-cell-check.ts","wcardinal/ui/d-table-body-cell-color.ts","wcardinal/ui/d-table-body-cell-index.ts","wcardinal/ui/d-table-body-cell-input-integer.ts","wcardinal/ui/d-table-body-cell-input-real.ts","wcardinal/ui/d-table-body-cell-input-text.ts","wcardinal/ui/d-table-body-cell-select-dialog.ts","wcardinal/ui/d-table-body-cell-select-fetcher.ts","wcardinal/ui/d-table-body-cell-select-menu.ts","wcardinal/ui/d-table-body-cell-text.ts","wcardinal/ui/d-table-body-cell-date.ts","wcardinal/ui/d-table-body-cell-datetime.ts","wcardinal/ui/d-table-body-cell-time.ts","wcardinal/ui/d-table-cell-state.ts","wcardinal/ui/d-table-data-selection.ts","wcardinal/ui/d-table-row-state.ts","wcardinal/ui/d-table-row.ts","wcardinal/ui/d-table-body-row.ts","wcardinal/ui/d-table-data-filter-impl.ts","wcardinal/ui/d-table-data-mapped-list.ts","wcardinal/ui/d-table-data-selection-impl.ts","wcardinal/ui/d-table-data-sorter.ts","wcardinal/ui/d-table-data-sorter-impl.ts","wcardinal/ui/d-table-data-list.ts","wcardinal/ui/d-table-body.ts","wcardinal/ui/d-table-category-cell.ts","wcardinal/ui/d-table-category.ts","wcardinal/ui/d-table-header-cell-state.ts","wcardinal/ui/d-table-header-cell.ts","wcardinal/ui/d-table-header.ts","wcardinal/ui/d-table.ts","wcardinal/ui/d-tree.ts","wcardinal/ui/snapper/e-snapper-result-scale.ts","wcardinal/ui/util/to-svg-texture.ts","wcardinal-ui.browser.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplicationLayerStageLike } from \"./d-application-layer-stage-like\";\nimport { DApplicationLike, DApplicationTarget } from \"./d-application-like\";\n\nexport class DApplications {\n\tprotected static INSTANCES: DApplicationLike[] = [];\n\n\tstatic add( instance: DApplicationLike ): void {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tinstances.push( instance );\n\t}\n\n\tstatic first(): DApplicationLike {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 < instances.length ) {\n\t\t\treturn instances[ 0 ];\n\t\t}\n\t\tthrow new Error( \"No application found.\" );\n\t}\n\n\tstatic last(): DApplicationLike {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 < instances.length ) {\n\t\t\treturn instances[ instances.length - 1 ];\n\t\t}\n\t\tthrow new Error( \"No application found.\" );\n\t}\n\n\tstatic get( index: number ): DApplicationLike | null {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 <= index && index < instances.length ) {\n\t\t\treturn instances[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic indexOf( instance: DApplicationLike ): number {\n\t\treturn DApplications.INSTANCES.indexOf( instance );\n\t}\n\n\tstatic size(): number {\n\t\treturn DApplications.INSTANCES.length;\n\t}\n\n\tprotected static toStage( target: DApplicationTarget ): DApplicationLayerStageLike | null {\n\t\tlet stage: any = target;\n\t\twhile( stage.parent ) {\n\t\t\tstage = stage.parent;\n\t\t}\n\t\tif( (\"application\" in stage) && (\"layer\" in stage) ) {\n\t\t\treturn stage as DApplicationLayerStageLike;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic find( target: DApplicationTarget ): DApplicationLike | null {\n\t\tconst stage = this.toStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayerBase( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.toStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application.getLayerBase();\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayerOverlay( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.toStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application.getLayerOverlay();\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayer( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.toStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic update( target?: DApplicationTarget ): void {\n\t\tif( target ) {\n\t\t\tconst stage = this.toStage( target );\n\t\t\tif( stage ) {\n\t\t\t\tstage.layer.update();\n\t\t\t}\n\t\t} else {\n\t\t\tconst instances = DApplications.INSTANCES;\n\t\t\tfor( let i = 0, imax = instances.length; i < imax; ++i ) {\n\t\t\t\tinstances[ i ].update();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic render( target?: DApplicationTarget ): void {\n\t\tif( target ) {\n\t\t\tconst stage = this.toStage( target );\n\t\t\tif( stage ) {\n\t\t\t\tstage.layer.render();\n\t\t\t}\n\t\t} else {\n\t\t\tconst instances = DApplications.INSTANCES;\n\t\t\tfor( let i = 0, imax = instances.length; i < imax; ++i ) {\n\t\t\t\tinstances[ i ].render();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A border mask.\n * Borders on masked parts are not rendered.\n */\nexport enum DBorderMask {\n\tNONE = 0,\n\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\n\tTOP_RIGHT = TOP | RIGHT,\n\tTOP_BOTTOM = TOP | BOTTOM,\n\tTOP_LEFT = TOP | LEFT,\n\n\tRIGHT_BOTTOM = RIGHT | BOTTOM,\n\tRIGHT_LEFT = RIGHT | LEFT,\n\n\tBOTTOM_LEFT = BOTTOM | LEFT,\n\n\tNOT_TOP = RIGHT | BOTTOM | LEFT,\n\tNOT_RIGHT = TOP | BOTTOM | LEFT,\n\tNOT_BOTTOM = TOP | RIGHT | LEFT,\n\tNOT_LEFT = TOP | RIGHT | BOTTOM,\n\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isFunction = ( target: unknown ): target is Function => {\n\treturn (typeof target) === \"function\";\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\n\ntype Callback = () => void;\n\nexport class DBaseBackground implements DBackgroundStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.background != null ) {\n\t\t\tconst background = options.background;\n\t\t\tthis._color = background.color;\n\t\t\tthis._alpha = background.alpha;\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isString = ( target: unknown ): target is string => {\n\treturn ( typeof target === \"string\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object String]\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DCornerMask {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP_LEFT | TOP_RIGHT | BOTTOM_LEFT | BOTTOM_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBorderStateAware } from \"./d-border\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseBorder implements DBorderStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.border != null ) {\n\t\t\tconst border = options.border;\n\t\t\tthis._color = border.color;\n\t\t\tthis._alpha = border.alpha;\n\t\t\tthis._width = border.width;\n\t\t\tthis._align = border.align;\n\t\t\tthis._mask = ( isString( border.mask ) ? DBorderMask[ border.mask ] : border.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseState ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( isFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseState ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( isFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetMask( state: DBaseState ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( isFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isNumber = ( target: unknown ): target is number => {\n\treturn ( typeof target === \"number\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object Number]\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * DBase interactivity.\n * Mouse / touch events are triggered only on interactive objects.\n */\nexport enum DBaseInteractive {\n\t/**\n\t * Not interactive.\n\t */\n\tNONE = 0,\n\n\t/**\n\t * Interactive.\n\t * However children are not interactive.\n\t */\n\tSELF = 1,\n\n\t/**\n\t * Not interactive.\n\t * However children are interactive.\n\t */\n\tCHILDREN = 2,\n\n\t/**\n\t * Interactive.\n\t * Children are also interactive.\n\t */\n\tBOTH = SELF | CHILDREN\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DCorner } from \"./d-corner\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseCorner implements DCorner {\n\tprotected _theme: DThemeBase;\n\tprotected _radius?: number;\n\tprotected _mask?: DCornerMask;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.corner != null ) {\n\t\t\tconst corner = options.corner;\n\t\t\tif( isNumber( corner ) ) {\n\t\t\t\tthis._radius = corner;\n\t\t\t\tthis._mask = undefined;\n\t\t\t} else {\n\t\t\t\tthis._radius = corner.radius;\n\t\t\t\tthis._mask = ( isString( corner.mask ) ? DCornerMask[ corner.mask ] : corner.mask );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetRadius(): number {\n\t\tconst radius = this._radius;\n\t\treturn ( radius !== undefined ? radius : this._theme.getCornerRadius() );\n\t}\n\n\tget radius(): number | undefined {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number | undefined ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask(): DCornerMask {\n\t\tconst mask = this._mask;\n\t\treturn ( mask !== undefined ? mask : this._theme.getCornerMask() );\n\t}\n\n\tget mask(): DCornerMask | undefined {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DCornerMask | undefined ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( radius?: number, mask?: DCornerMask ): void {\n\t\tlet isChanged = false;\n\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tconst callback = this._callback;\n\t\tif( isChanged && callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DOutline } from \"./d-outline\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseOutline implements DOutline {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _offset?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.outline != null ) {\n\t\t\tconst outline = options.outline;\n\t\t\tthis._color = outline.color;\n\t\t\tthis._alpha = outline.alpha;\n\t\t\tthis._width = outline.width;\n\t\t\tthis._offset = outline.offset;\n\t\t\tthis._align = outline.align;\n\t\t\tthis._mask = ( isString( outline.mask ) ? DBorderMask[ outline.mask ] : outline.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseState ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( isFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset( state: DBaseState ): number {\n\t\tconst offset = this._offset;\n\t\tif( offset !== undefined ) {\n\t\t\tif( isFunction( offset ) ) {\n\t\t\t\tconst result = offset( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn offset;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineOffset( state );\n\t}\n\n\tget offset(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._offset;\n\t}\n\n\tset offset( offset: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._offset !== offset ) {\n\t\t\tthis._offset = offset;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseState ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( isFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask( state: DBaseState ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( isFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DBaseState {\n\tNONE\t\t= 0,\n\tHOVERED\t\t= 1 << 0,\n\tACTIVE\t\t= 1 << 1,\n\tACTIVE_IN\t= 1 << 2,\n\tFOCUSED\t\t= 1 << 3,\n\tFOCUSED_IN\t= 1 << 4,\n\tUNFOCUSABLE\t= 1 << 5,\n\tFOCUS_ROOT\t= 1 << 6,\n\tREAD_ONLY\t= 1 << 7,\n\tDISABLED\t= 1 << 8,\n\tDRAGGING\t= 1 << 9,\n\tPRESSED\t\t= 1 << 10,\n\tINVALID\t\t= 1 << 11,\n\tSUCCEEDED\t= 1 << 12,\n\tFAILED\t\t= 1 << 13,\n\n\tCUSTOM\t\t= 1 << 20\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\nimport { isNumber } from \"./util/is-number\";\n\ntype Callback = () => void;\n\nexport class DBasePadding implements DPadding {\n\tprotected _theme: DThemeBase;\n\tprotected _left?: number;\n\tprotected _top?: number;\n\tprotected _right?: number;\n\tprotected _bottom?: number;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\n\t\tif( options != null && options.padding != null ) {\n\t\t\tconst padding = options.padding;\n\t\t\tif( isNumber( padding ) ) {\n\t\t\t\tthis._left = padding;\n\t\t\t\tthis._top = padding;\n\t\t\t\tthis._right = padding;\n\t\t\t\tthis._bottom = padding;\n\t\t\t} else {\n\t\t\t\tthis._left = padding.left;\n\t\t\t\tthis._top = padding.top;\n\t\t\t\tthis._right = padding.right;\n\t\t\t\tthis._bottom = padding.bottom;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetLeft(): number {\n\t\tconst left = this._left;\n\t\treturn left !== undefined ? left : this._theme.getPaddingLeft();\n\t}\n\n\tget left(): number | undefined {\n\t\treturn this._left;\n\t}\n\n\tset left( left: number | undefined ) {\n\t\tif( this._left !== left ) {\n\t\t\tthis._left = left;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTop(): number {\n\t\tconst top = this._top;\n\t\treturn top !== undefined ? top : this._theme.getPaddingTop();\n\t}\n\n\tget top(): number | undefined {\n\t\treturn this._top;\n\t}\n\n\tset top( top: number | undefined ) {\n\t\tif( this._top !== top ) {\n\t\t\tthis._top = top;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRight(): number {\n\t\tconst right = this._right;\n\t\treturn right !== undefined ? right : this._theme.getPaddingRight();\n\t}\n\n\tget right(): number | undefined {\n\t\treturn this._right;\n\t}\n\n\tset right( right: number | undefined ) {\n\t\tif( this._right !== right ) {\n\t\t\tthis._right = right;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBottom(): number {\n\t\tconst bottom = this._bottom;\n\t\treturn bottom !== undefined ? bottom : this._theme.getPaddingBottom();\n\t}\n\n\tget bottom(): number | undefined {\n\t\treturn this._bottom;\n\t}\n\n\tset bottom( bottom: number | undefined ) {\n\t\tif( this._bottom !== bottom ) {\n\t\t\tthis._bottom = bottom;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ) {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t\tif( this._callback != null ) {\n\t\t\tthis._callback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\n\ntype Callback = () => any;\n\nexport class DBasePoint {\n\tprotected _point: IPoint;\n\tcb: Callback;\n\tscope: any;\n\n\tconstructor( point: IPoint, cb: Callback, scope?: any ) {\n\t\tthis._point = point;\n\t\tthis.cb = cb;\n\t}\n\n\tget x() {\n\t\treturn this._point.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst point = this._point;\n\t\tif( point.x !== x ) {\n\t\t\tpoint.x = x;\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tget y() {\n\t\treturn this._point.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst point = this._point;\n\t\tif( point.y !== y ) {\n\t\t\tpoint.y = y;\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tset( x: number, y: number ) {\n\t\tconst point = this._point;\n\t\tif( point.x !== x || point.y !== y ) {\n\t\t\tpoint.set( x, y );\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tcopyFrom( target: IPoint ): this {\n\t\tconst point = this._point;\n\t\tif( point.x !== target.x || point.y !== target.y ) {\n\t\t\tpoint.copyFrom( target );\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( target: IPoint ): IPoint {\n\t\treturn target.copyFrom( this._point );\n\t}\n\n\tcopy(): this {\n\t\treturn this.copyFrom( arguments[ 0 ] );\n\t}\n\n\tclone( cb?: Function, scope?: any ): IPoint {\n\t\tcb = cb || this.cb;\n\t\tscope = scope || this.scope;\n\t\treturn new DBasePoint( this._point, cb as Callback, scope );\n\t}\n\n\tequals( p: IPoint ): boolean {\n\t\treturn this._point.equals( p );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBackgroundMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor( texture: Texture, width: number, height: number, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper( new Float32Array( 56 ), new Float32Array( 56 ), new Uint16Array( 42 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected getTextureId(): number {\n\t\treturn (this._texture as any)._updateID;\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( c ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs( iv: number, uvs: Float32Array, u0: number, u1: number, v0: number, v1: number ): void {\n\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this.texture as any;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId = this.getTextureId();\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = Math.min( width * 0.5, borderSize );\n\t\t\tconst x2 = Math.max( width * 0.5, width - borderSize );\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = Math.min( height * 0.5, borderSize );\n\t\t\tconst y2 = Math.max( height * 0.5, height - borderSize );\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v0, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle\n\t\t\tthis.fillVertices( iv, vertices, x0, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, u0, u3, v1, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DBaseBackgroundMeshGeometry } from \"./d-base-background-mesh-geometry\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBackgroundMesh extends Mesh {\n\tgeometry!: DBaseBackgroundMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBackgroundMeshGeometry( texture, 100, 100, borderSize, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBorderMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _borderMask: DBorderMask;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor(\n\t\ttexture: Texture, width: number, height: number,\n\t\tborderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask\n\t) {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._borderMask = borderMask;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this._borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tif( this._borderMask !== borderMask ) {\n\t\t\tthis._borderMask = borderMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, b1: boolean, b2: boolean, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( b1 || b2 ) {\n\t\t\tif( c ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t\t} else if( b1 && b2 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t\t} else if( b1 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u1, u2, v0, v1 );\n\t\t\t} else {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v1, v2 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u1, u1, v1, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs(\n\t\tiv: number, uvs: Float32Array, b: boolean,\n\t\tu0: number, u1: number, v0: number, v1: number,\n\t\tuz: number, vz: number\n\t): void {\n\t\tif( b ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, uz, uz, vz, vz );\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this._texture as any;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId = texture._updateID;\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = Math.min( width * 0.5, borderSize );\n\t\t\tconst x2 = Math.max( width * 0.5, width - borderSize );\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = Math.min( height * 0.5, borderSize );\n\t\t\tconst y2 = Math.max( height * 0.5, height - borderSize );\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst borderMask = this._borderMask;\n\t\t\tconst bt = ! (borderMask & DBorderMask.TOP);\n\t\t\tconst bb = ! (borderMask & DBorderMask.BOTTOM);\n\t\t\tconst bl = ! (borderMask & DBorderMask.LEFT);\n\t\t\tconst br = ! (borderMask & DBorderMask.RIGHT);\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, bl, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, bt, u1, u2, v0, v1, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, br, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, bl, u0, u1, v1, v2, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle right\n\t\t\tthis.fillVertices( iv, vertices, x2, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, br, u2, u3, v1, v2, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, bl, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, bb, u1, u2, v2, v3, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, br, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DBaseBorderMeshGeometry } from \"./d-base-border-mesh-geometry\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBorderMesh extends Mesh {\n\tgeometry!: DBaseBorderMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBorderMeshGeometry( texture, 100, 100, borderSize, borderMask, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this.geometry.borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tthis.geometry.borderMask = borderMask;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\n\nexport class DBaseOutlineMesh extends DBaseBorderMesh {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DBaseBackgroundMesh } from \"./d-base-background-mesh\";\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\nimport { DBaseOutlineMesh } from \"./d-base-outline-mesh\";\n\nexport class DBaseReflowable implements DReflowable {\n\tprotected _lastBackgroundCornerRadius: number;\n\tprotected _lastBorderCornerRadius: number;\n\tprotected _lastBorderWidth: number;\n\tprotected _lastOutlineCornerRadius: number;\n\tprotected _lastOutlineWidth: number;\n\tprotected _backgroundPlane: DBaseBackgroundMesh;\n\tprotected _borderPlane: DBaseBorderMesh;\n\tprotected _outlinePlane: DBaseOutlineMesh;\n\n\tconstructor( base: DBase ) {\n\t\tconst theme = base.theme;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = corner.getRadius();\n\t\tconst cornerHeight = cornerRadius + 1;\n\t\tconst cornerMask = corner.getMask();\n\t\tconst backgroundPlane = this._backgroundPlane = new DBaseBackgroundMesh(\n\t\t\ttheme.getBackgroundTexture( cornerRadius ),\n\t\t\tcornerHeight, cornerMask\n\t\t);\n\t\tbase.appendRenderable( backgroundPlane, true );\n\n\t\tconst state = base.state;\n\n\t\tconst border = base.border;\n\t\tconst borderWidth = border.getWidth( state );\n\t\tconst borderMask = border.getMask( state );\n\t\tconst borderPlane = this._borderPlane = new DBaseBorderMesh(\n\t\t\ttheme.getBorderTexture( cornerRadius, borderWidth ),\n\t\t\tcornerHeight,\n\t\t\tborderMask,\n\t\t\tcornerMask\n\t\t);\n\t\tbase.appendRenderable( borderPlane, false );\n\n\t\tconst outline = base.outline;\n\t\tconst outlineWidth = outline.getWidth( state );\n\t\tconst outlineMask = outline.getMask( state );\n\t\tconst outlinePlane = this._outlinePlane = new DBaseOutlineMesh(\n\t\t\ttheme.getBorderTexture( cornerRadius, outlineWidth ),\n\t\t\tcornerHeight,\n\t\t\toutlineMask,\n\t\t\tcornerMask\n\t\t);\n\t\tbase.appendRenderable( outlinePlane, false );\n\n\t\tthis._lastBackgroundCornerRadius = cornerRadius;\n\t\tthis._lastBorderCornerRadius = cornerRadius;\n\t\tthis._lastBorderWidth = borderWidth;\n\t\tthis._lastOutlineCornerRadius = cornerRadius;\n\t\tthis._lastOutlineWidth = outlineWidth;\n\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst theme = base.theme;\n\t\tconst state = base.state;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = corner.getRadius();\n\t\tconst cornerHeight = cornerRadius + 1;\n\t\tconst cornerMask = corner.getMask();\n\n\t\t// Background\n\t\tconst background = base.background;\n\t\tconst backgroundPlane = this._backgroundPlane;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\t\tif( 0 < backgroundAlpha ) {\n\t\t\t\tif( this._lastBackgroundCornerRadius !== cornerRadius ) {\n\t\t\t\t\tthis._lastBackgroundCornerRadius = cornerRadius;\n\t\t\t\t\tbackgroundPlane.texture = theme.getBackgroundTexture( cornerRadius );\n\t\t\t\t\tbackgroundPlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tbackgroundPlane.tint = backgroundColor;\n\t\t\t\tbackgroundPlane.alpha = backgroundAlpha;\n\t\t\t\tbackgroundPlane.width = width;\n\t\t\t\tbackgroundPlane.height = height;\n\t\t\t\tbackgroundPlane.cornerMask = cornerMask;\n\t\t\t\tbackgroundPlane.visible = true;\n\t\t\t} else {\n\t\t\t\tbackgroundPlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\tbackgroundPlane.visible = false;\n\t\t}\n\n\t\t// Border\n\t\tconst border = base.border;\n\t\tconst borderPlane = this._borderPlane;\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tif( 0 < borderAlpha ) {\n\t\t\t\tconst borderWidth = border.getWidth( state );\n\t\t\t\tif( this._lastBorderCornerRadius !== cornerRadius || this._lastBorderWidth !== borderWidth ) {\n\t\t\t\t\tthis._lastBorderCornerRadius = cornerRadius;\n\t\t\t\t\tthis._lastBorderWidth = borderWidth;\n\t\t\t\t\tborderPlane.texture = theme.getBorderTexture( cornerRadius, borderWidth );\n\t\t\t\t\tborderPlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\t\tconst borderMask = border.getMask( state );\n\t\t\t\tborderPlane.tint = borderColor;\n\t\t\t\tborderPlane.alpha = borderAlpha;\n\t\t\t\tconst borderOffset = borderAlign * borderWidth;\n\t\t\t\tborderPlane.x = -borderOffset;\n\t\t\t\tborderPlane.y = -borderOffset;\n\t\t\t\tborderPlane.width = width + borderOffset * 2;\n\t\t\t\tborderPlane.height = height + borderOffset * 2;\n\t\t\t\tborderPlane.borderMask = borderMask;\n\t\t\t\tborderPlane.cornerMask = cornerMask;\n\t\t\t\tborderPlane.visible = true;\n\t\t\t} else {\n\t\t\t\tborderPlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\tborderPlane.visible = false;\n\t\t}\n\n\t\t// Outline\n\t\tconst outline = base.outline;\n\t\tconst outlinePlane = this._outlinePlane;\n\t\tconst outlineColor = outline.getColor( state );\n\t\tif( outlineColor != null ) {\n\t\t\tconst outlineAlpha = outline.getAlpha( state );\n\t\t\tif( 0 < outlineAlpha ) {\n\t\t\t\tconst outlineWidth = outline.getWidth( state );\n\t\t\t\tif( this._lastOutlineCornerRadius !== cornerRadius || this._lastOutlineWidth !== outlineWidth ) {\n\t\t\t\t\tthis._lastOutlineCornerRadius = cornerRadius;\n\t\t\t\t\tthis._lastOutlineWidth = outlineWidth;\n\t\t\t\t\toutlinePlane.texture = theme.getBorderTexture( cornerRadius, outlineWidth );\n\t\t\t\t\toutlinePlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tconst outlineMask = outline.getMask( state );\n\t\t\t\tconst outlineOffset = outline.getOffset( state );\n\t\t\t\tconst outlineAlign = outline.getAlign( state );\n\t\t\t\toutlinePlane.tint = outlineColor;\n\t\t\t\toutlinePlane.alpha = outlineAlpha;\n\t\t\t\tconst outlineOffsetAccumulative = outlineOffset + outlineAlign * outlineWidth;\n\t\t\t\toutlinePlane.x = -outlineOffsetAccumulative;\n\t\t\t\toutlinePlane.y = -outlineOffsetAccumulative;\n\t\t\t\toutlinePlane.width = width + outlineOffsetAccumulative * 2;\n\t\t\t\toutlinePlane.height = height + outlineOffsetAccumulative * 2;\n\t\t\t\toutlinePlane.borderMask = outlineMask;\n\t\t\t\toutlinePlane.cornerMask = cornerMask;\n\t\t\t\toutlinePlane.visible = true;\n\t\t\t} else {\n\t\t\t\toutlinePlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\toutlinePlane.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport class DBaseStates {\n\tstatic is( target: DBaseState, state: DBaseState ): boolean {\n\t\treturn !! ( target & state );\n\t}\n\n\tstatic isHovered( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.HOVERED );\n\t}\n\n\tstatic isDragging( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.DRAGGING );\n\t}\n\n\tstatic isFocused( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.FOCUSED );\n\t}\n\n\tstatic isFocusedIn( target: DBaseState ) {\n\t\treturn !! ( target & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) );\n\t}\n\n\tstatic isActive( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.ACTIVE );\n\t}\n\n\tstatic isActiveIn( target: DBaseState ) {\n\t\treturn !! ( target & (DBaseState.ACTIVE | DBaseState.ACTIVE_IN) );\n\t}\n\n\tstatic isNotActive( state: DBaseState ): boolean {\n\t\treturn (!! ( state & DBaseState.DISABLED )) || (! ( state & DBaseState.ACTIVE ));\n\t}\n\n\tstatic isPressed( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.PRESSED );\n\t}\n\n\tstatic isDisabled( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.DISABLED );\n\t}\n\n\tstatic isReadOnly( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.READ_ONLY );\n\t}\n\n\tstatic isActionable( target: DBaseState ) {\n\t\treturn ! ( target & (DBaseState.DISABLED | DBaseState.READ_ONLY) );\n\t}\n\n\tstatic isInvalid( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.INVALID );\n\t}\n\n\tstatic isSucceeded( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.SUCCEEDED );\n\t}\n\n\tstatic isFailed( target: DBaseState ) {\n\t\treturn !! ( target & DBaseState.FAILED );\n\t}\n\n\tstatic bind(\n\t\tdestination: DBase<any, any>, destinationState: DBaseState,\n\t\tsource: DBase<any, any>, when: ( sourceState: DBaseState ) => boolean\n\t) {\n\t\tdestination.setState( destinationState, when( source.state ) );\n\t\tsource.on( \"statechange\", ( newSourceState: DBaseState ) => {\n\t\t\tdestination.setState( destinationState, when( newSourceState ) );\n\t\t});\n\t}\n\n\tstatic disable(\n\t\tdestination: DBase<any, any>, source: DBase<any, any>,\n\t\twhen: ( sourceState: DBaseState ) => boolean = DBaseStates.isNotActive\n\t) {\n\t\tDBaseStates.bind( destination, DBaseState.DISABLED, source, when );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLayoutClearType {\n\tNONE = 0,\n\tBEFORE = 1,\n\tAFTER = 2,\n\tBOTH = BEFORE | AFTER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScalar } from \"./d-scalar\";\nimport { isNumber } from \"./util/is-number\";\n\nconst enum NodeType {\n\t// Parensesis\n\tOPEN,\n\tCLOSE,\n\tPARENSESIS,\n\n\t// Operations\n\tADD_OR_PLUS,\n\tSUB_OR_MINUS,\n\n\tPLUS,\n\tMINUS,\n\n\tADD,\n\tSUB,\n\tMUL,\n\tDIV,\n\n\t// Functions\n\tMIN,\n\tMAX,\n\tCOMMA,\n\n\t// Literals\n\tPARENT,\n\tSELF,\n\tPADDING,\n\tCURRENT,\n\tNUMBER\n}\n\ntype NodeTypeOperator = NodeType.SUB_OR_MINUS | NodeType.ADD_OR_PLUS |\n\tNodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV |\n\tNodeType.OPEN | NodeType.CLOSE |\n\tNodeType.MIN | NodeType.MAX | NodeType.COMMA;\ntype NodeTypeLiteral = NodeType.NUMBER | NodeType.PARENT | NodeType.SELF | NodeType.PADDING | NodeType.CURRENT;\ntype Token = NodeTypeOperator | [ NodeTypeLiteral, number ];\n\ninterface NodeOrTokenParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: NodeOrToken[];\n}\n\ninterface NodeOrTokenUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: NodeOrToken;\n}\n\ntype NodeArithmeticOperator = NodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV;\n\ninterface NodeOrTokenArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: NodeOrToken;\n\t[ 2 ]: NodeOrToken;\n}\n\ninterface NodeOrTokenFunction {\n\t[ 0 ]: NodeType.MIN | NodeType.MAX;\n\t[ 1 ]: NodeOrToken[];\n}\n\ntype NodeOrToken = Token | NodeOrTokenParensesis | NodeOrTokenUnary | NodeOrTokenArithmetic | NodeOrTokenFunction;\n\ninterface NodeLiteral {\n\t[ 0 ]: NodeTypeLiteral;\n\t[ 1 ]: number;\n}\n\ninterface NodeParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: Node[];\n}\n\ninterface NodeUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: Node;\n}\n\ninterface NodeArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: Node;\n\t[ 2 ]: Node;\n}\n\ninterface NodeFunction {\n\t[ 0 ]: NodeType.MIN | NodeType.MAX;\n\t[ 1 ]: Node[];\n}\n\ntype Node = NodeParensesis | NodeUnary | NodeArithmetic | NodeFunction | NodeLiteral;\n\nconst TOKEN_MAPPING_OPERATOR: { [ token: string ]: NodeTypeOperator | undefined } = {\n\t\"+\": NodeType.ADD_OR_PLUS,\n\t\"-\": NodeType.SUB_OR_MINUS,\n\t\"*\": NodeType.MUL,\n\t\"/\": NodeType.DIV,\n\t\"(\": NodeType.OPEN,\n\t\")\": NodeType.CLOSE,\n\t\",\": NodeType.COMMA,\n\t\"min\": NodeType.MIN,\n\t\"max\": NodeType.MAX\n};\n\nconst TOKEN_MAPPING_LITERAL: { [ token: string ]: NodeTypeLiteral | undefined } = {\n\t\"%\": NodeType.PARENT,\n\t\"s\": NodeType.SELF,\n\t\"p\": NodeType.PADDING,\n\t\"c\": NodeType.CURRENT\n};\n\n/**\n * Parser and evaluator of the scalar expressions like `100% - 50s`.\n *\n * Literals\n *\n * * x%: 0.01 * x * parent value\n * * xs: 0.01 * x * self value\n * * xp: 0.01 * x * padding value\n * * xc: 0.01 * x * current value\n *\n * Operators\n *\n * * `+`\n * * `-`\n * * `*`\n * * `/`\n * * `(` and `)`\n *\n * Functions\n *\n * * min( a, b, ... )\n * * max( a, b, ... )\n *\n * Examples\n *\n * * `90%`: 0.9 * parent value\n * * `50s`: 0.5 * self value\n * * `90% - 50s`: 0.9 * parent value - 0.5 * self value\n * * `90% - (50s + 100) * 2`: 0.9 * parent value - ( 0.5 * self value + 100 ) * 2\n */\nexport class DScalarExpression implements DScalar {\n\tprotected static TOKEN_REGEX = /(?:\\+|-|\\*|\\/|\\(|\\)|min|max|,|(?:\\d+(?:\\.\\d*)?[%psc]?))/g;\n\tprotected _node: Node;\n\n\tconstructor( expression: string ) {\n\t\tconst nodes: NodeOrToken[] = this.toToken( expression );\n\t\tlet i = 0;\n\t\tdo {\n\t\t\ti = this.toParensesis( nodes, i );\n\t\t} while( i < nodes.length );\n\t\tthis.toUnary( nodes );\n\t\tthis.toArithmetic( nodes, NodeType.MUL, NodeType.DIV );\n\t\tthis.toArithmetic( nodes, NodeType.ADD, NodeType.SUB );\n\t\tif( nodes.length === 1 ) {\n\t\t\tconst node = nodes[ 0 ];\n\t\t\tif( ! isNumber( node ) ) {\n\t\t\t\tthis._node = node as any;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthrow new Error( `Failed to parse '${expression}'` );\n\t}\n\n\ttoParensesis( nodes: NodeOrToken[], ifrom: number ): number {\n\t\tlet ito = nodes.length;\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst inode = nodes[ i ];\n\t\t\tif( inode === NodeType.OPEN ) {\n\t\t\t\tlet istart = i;\n\t\t\t\tlet nodeType = NodeType.PARENSESIS;\n\t\t\t\tif( 0 < i ) {\n\t\t\t\t\tconst nodeTypePrev = nodes[ i - 1 ];\n\t\t\t\t\tif( nodeTypePrev === NodeType.MIN || nodeTypePrev === NodeType.MAX ) {\n\t\t\t\t\t\tistart -= 1;\n\t\t\t\t\t\tnodeType = nodeTypePrev;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor( let j = i + 1; j < ito; ++j ) {\n\t\t\t\t\tconst jnode = nodes[ j ];\n\t\t\t\t\tif( jnode === NodeType.CLOSE ) {\n\t\t\t\t\t\tnodes[ istart ] = [ nodeType, this.toComma( nodes, i + 1, j ) ];\n\t\t\t\t\t\tnodes.splice( istart + 1, j - istart );\n\t\t\t\t\t\treturn istart + 1;\n\t\t\t\t\t} else if( jnode === NodeType.OPEN ) {\n\t\t\t\t\t\tj = this.toParensesis( nodes, j ) - 1;\n\t\t\t\t\t\tito = nodes.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( `Malformed parensesis` );\n\t\t\t}\n\t\t}\n\t\treturn ito;\n\t}\n\n\ttoCommaOf( nodes: NodeOrToken[], ifrom: number, ito: number ): NodeOrToken {\n\t\tconst l = ito - ifrom;\n\t\tif( l <= 0 ) {\n\t\t\treturn [ NodeType.NUMBER, 0 ];\n\t\t} else if( l <= 1 ) {\n\t\t\treturn nodes[ ifrom ];\n\t\t} else {\n\t\t\tconst operand: NodeOrToken[] = [];\n\t\t\tfor( let j = ifrom; j < ito; ++j ) {\n\t\t\t\toperand.push( nodes[ j ] );\n\t\t\t}\n\t\t\treturn [ NodeType.PARENSESIS, operand ];\n\t\t}\n\t}\n\n\ttoComma( nodes: NodeOrToken[], ifrom: number, ito: number ): NodeOrToken[] {\n\t\tlet result: NodeOrToken[] | null = null;\n\t\tlet iprev = ifrom;\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === NodeType.COMMA ) {\n\t\t\t\tresult = result || [];\n\t\t\t\tresult.push( this.toCommaOf( nodes, iprev, i ) );\n\t\t\t\tiprev = i + 1;\n\t\t\t}\n\t\t}\n\t\tif( iprev < ito ) {\n\t\t\tif( result == null ) {\n\t\t\t\tconst operand: NodeOrToken[] = [];\n\t\t\t\tfor( let i = iprev; i < ito; ++i ) {\n\t\t\t\t\toperand.push( nodes[ i ] );\n\t\t\t\t}\n\t\t\t\treturn operand;\n\t\t\t} else {\n\t\t\t\tresult.push( this.toCommaOf( nodes, iprev, ito ) );\n\t\t\t}\n\t\t}\n\t\treturn result || [];\n\t}\n\n\ttoUnaryNode( node: NodeOrToken ): void {\n\t\tif( ! isNumber( node ) ) {\n\t\t\tif( node[ 0 ] === NodeType.PARENSESIS ||\n\t\t\t\tnode[ 0 ] === NodeType.MIN ||\n\t\t\t\tnode[ 0 ] === NodeType.MAX ) {\n\t\t\t\tthis.toUnary( node[ 1 ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoUnary( nodes: NodeOrToken[] ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === NodeType.ADD_OR_PLUS || node === NodeType.SUB_OR_MINUS ) {\n\t\t\t\tif( i <= 0 || isNumber( nodes[ i - 1 ] ) ) {\n\t\t\t\t\tif( i + 1 < imax && ! isNumber( nodes[ i + 1 ] ) ) {\n\t\t\t\t\t\tconst operand = nodes.splice( i + 1, 1 )[ 0 ];\n\t\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.PLUS : NodeType.MINUS );\n\t\t\t\t\t\tnodes[ i ] = [ type, operand ];\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toUnaryNode( operand );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error( \"Malformed unary operator\" );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.ADD : NodeType.SUB );\n\t\t\t\t\tnodes[ i ] = type;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toUnaryNode( node );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmeticNode( node: NodeOrToken, operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tif( ! isNumber( node ) ) {\n\t\t\tif( node[ 0 ] === NodeType.PARENSESIS || node[ 0 ] === NodeType.MIN || node[ 0 ] === NodeType.MAX ) {\n\t\t\t\tthis.toArithmetic( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.PLUS || node[ 0 ] === NodeType.MINUS ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.ADD || node[ 0 ] === NodeType.SUB ||\n\t\t\t\tnode[ 0 ] === NodeType.MUL || node[ 0 ] === NodeType.DIV ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t\tthis.toArithmeticNode( node[ 2 ], operatorA, operatorB );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmetic( nodes: NodeOrToken[], operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === operatorA || node === operatorB ) {\n\t\t\t\tif( 0 < i && i + 1 < imax ) {\n\t\t\t\t\tconst left = nodes[ i - 1 ];\n\t\t\t\t\tconst right = nodes[ i + 1 ];\n\t\t\t\t\tif( ! isNumber( left ) && ! isNumber( right ) ) {\n\t\t\t\t\t\tnodes.splice( i, 2 );\n\t\t\t\t\t\tnodes[ i - 1 ] = [ node, left, right ];\n\t\t\t\t\t\ti -= 1;\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toArithmeticNode( left, operatorA, operatorB );\n\t\t\t\t\t\tthis.toArithmeticNode( right, operatorA, operatorB );\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( `Malformed operands for the operator ${node}` );\n\t\t\t} else {\n\t\t\t\tthis.toArithmeticNode( node, operatorA, operatorB );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoToken( expression: string ): Token[] {\n\t\tconst tokens: Token[] = [];\n\t\twhile( true ) {\n\t\t\tconst matched = DScalarExpression.TOKEN_REGEX.exec( expression );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst token = matched[ 0 ];\n\t\t\t\tconst tokenTypeOperator = TOKEN_MAPPING_OPERATOR[ token ];\n\t\t\t\tif( tokenTypeOperator != null ) {\n\t\t\t\t\ttokens.push( tokenTypeOperator );\n\t\t\t\t} else {\n\t\t\t\t\tconst parsedToken = parseFloat( token );\n\t\t\t\t\tif( parsedToken !== parsedToken ) {\n\t\t\t\t\t\tthrow new Error( `Unexpected token '${token}' at ${matched.index} in '${expression}'` );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tokenTypeLiteral = TOKEN_MAPPING_LITERAL[ token[ token.length - 1 ] ];\n\t\t\t\t\tif( tokenTypeLiteral != null ) {\n\t\t\t\t\t\ttokens.push([ tokenTypeLiteral, parsedToken * 0.01 ]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttokens.push([ NodeType.NUMBER, parsedToken ]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n\n\tprotected evaluate( node: Node, parent: number, self: number, padding: number, current: number ): number {\n\t\tswitch( node[ 0 ] ) {\n\t\tcase NodeType.PARENSESIS:\n\t\t\tconst nodes = node[ 1 ];\n\t\t\treturn this.evaluate( nodes[ nodes.length - 1 ], parent, self, padding, current );\n\n\t\t// Unary operators\n\t\tcase NodeType.PLUS:\n\t\t\treturn + this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\tcase NodeType.MINUS:\n\t\t\treturn - this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\t// Four arithmetic operators\n\t\tcase NodeType.ADD:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) +\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.SUB:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) -\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.MUL:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) *\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.DIV:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) /\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\n\t\t// Functions\n\t\tcase NodeType.MIN:\n\t\t\tif( 0 < node[ 1 ].length ) {\n\t\t\t\tconst args = node[ 1 ];\n\t\t\t\tlet result = this.evaluate( args[ 0 ], parent, self, padding, current );\n\t\t\t\tfor( let i = 1, imax = args.length; i < imax; ++i ) {\n\t\t\t\t\tresult = Math.min( result, this.evaluate( args[ i ], parent, self, padding, current ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\tcase NodeType.MAX:\n\t\t\tif( 0 < node[ 1 ].length ) {\n\t\t\t\tconst args = node[ 1 ];\n\t\t\t\tlet result = this.evaluate( args[ 0 ], parent, self, padding, current );\n\t\t\t\tfor( let i = 1, imax = args.length; i < imax; ++i ) {\n\t\t\t\t\tresult = Math.max( result, this.evaluate( args[ i ], parent, self, padding, current ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\n\t\t// Literals\n\t\tcase NodeType.PARENT:\n\t\t\treturn node[ 1 ] * parent;\n\t\tcase NodeType.SELF:\n\t\t\treturn node[ 1 ] * self;\n\t\tcase NodeType.PADDING:\n\t\t\treturn node[ 1 ] * padding;\n\t\tcase NodeType.CURRENT:\n\t\t\treturn node[ 1 ] * current;\n\t\tcase NodeType.NUMBER:\n\t\t\treturn node[ 1 ];\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcalculate( parent: number, self: number, padding: number, current: number ): number {\n\t\treturn this.evaluate( this._node, parent, self, padding, current );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject, interaction, Point, Rectangle, Renderer, Texture, Transform } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseBackground } from \"./d-base-background\";\nimport { DBaseBorder } from \"./d-base-border\";\nimport { DBaseCorner } from \"./d-base-corner\";\nimport { DBaseInteractive } from \"./d-base-interactive\";\nimport { DBaseOutline } from \"./d-base-outline\";\nimport { DBasePadding } from \"./d-base-padding\";\nimport { DBasePoint } from \"./d-base-point\";\nimport { DBaseReflowable } from \"./d-base-reflowable\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DBorderStateAware } from \"./d-border\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCoordinatePosition, DCoordinateSize } from \"./d-coordinate\";\nimport { DCorner } from \"./d-corner\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { DThemeFont } from \"./d-font\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DOutline } from \"./d-outline\";\nimport { DPadding } from \"./d-padding\";\nimport { DScalarFunctions } from \"./d-scalar-functions\";\nimport { DScalarSet } from \"./d-scalar-set\";\nimport { DShadow } from \"./d-shadow\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isFunction } from \"./util/is-function\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\nimport { UtilKeyboardEvent, UtilKeyboardEventShortcut } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\n/**\n * {@link DBase} padding options.\n */\nexport interface DBasePaddingOptions {\n\t/** A top padding */\n\ttop?: number;\n\n\t/** A right padding */\n\tright?: number;\n\n\t/** A bottom padding */\n\tbottom?: number;\n\n\t/** A left padding */\n\tleft?: number;\n}\n\n/**\n * {@link DBase} corner options.\n */\nexport interface DBaseCornerOptions {\n\t/** A radius */\n\tradius?: number;\n\n\t/** Masked corners get unrounded. */\n\tmask?: (keyof typeof DCornerMask) | DCornerMask;\n}\n\n/**\n * Mappings of event names and event handlers.\n */\nexport interface DBaseOnOptions {\n\t[name: string]: Function;\n}\n\n/**\n * {@link DBase} background options.\n */\nexport interface DBaseBackgroundOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to an background alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n}\n\n/**\n * {@link DBase} border options.\n */\nexport interface DBaseBorderOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to a border alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * A width or a function returning a width.\n\t * If a computed value is undefined, falls back to a border width of a theme.\n\t */\n\twidth?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An align or a function returning an align.\n\t * If a computed value is undefined, falls back to a border align of a theme.\n\t * If an align is 0, a border is rendered completely inside of a {@link DBase}.\n\t * If an align is 1, a border is rendered completely outside of a {@link DBase}.\n\t */\n\talign?: DStateAwareOrValueMightBe<number>;\n\n\t/** Masked borders get removed. */\n\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n}\n\n/**\n * {@link DBase} outline optons.\n */\nexport interface DBaseOutlineOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to an outline alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * A width or a function returning a width.\n\t * If a computed value is undefined, falls back to an outline width of a theme.\n\t */\n\twidth?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An offset or a function returning an offset.\n\t * If a computed value is undefined, falls back to an outline align of a theme.\n\t * A outline moves to outside when an offset gets larger.\n\t */\n\toffset?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An align or a function returning an align.\n\t * If a computed value is undefined, falls back to an outline align of a theme.\n\t * If an align is 0, an outline is rendered completely inside.\n\t * If an align is 1, an outline is rendered completely outside.\n\t */\n\talign?: DStateAwareOrValueMightBe<number>;\n\n\t/** Masked outlines get removed. */\n\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n}\n\n/**\n * {@link DBase} options.\n */\nexport interface DBaseOptions<THEME extends DThemeBase = DThemeBase> {\n\t/**\n\t * A parent.\n\t *\n\t * In the case of UI classes which pop up (e.g., {@link DDialog} and {@link DMenu}),\n\t * if multiple application instances are there, better to set\n\t * this to an `application.stage` so that they pick a right application.\n\t * By default, they assume the last created application is\n\t * the one they belong to at the time when they are created.\n\t */\n\tparent?: Container;\n\n\t/** Children. */\n\tchildren?: Array<DisplayObject | null>;\n\n\t/** A name. */\n\tname?: string;\n\n\t/**\n\t * One of the followings:\n\t * * A X position\n\t * * A position keyword\n\t * * A position expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a X position ({@link DScalarFunction})\n\t * * An object returning a X position ({@link DScalar})\n\t */\n\tx?: DCoordinatePosition;\n\n\t/**\n\t * One of the followings:\n\t * * A Y position\n\t * * A position keyword\n\t * * A position expresion (Parsed by {@link DScalarExpression})\n\t * * A function returning a Y position ({@link DScalarFunction})\n\t * * An object returning a Y position ({@link DScalar})\n\t */\n\ty?: DCoordinatePosition;\n\n\t/**\n\t * One of the followings:\n\t * * A width\n\t * * A size keyword\n\t * * A size expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a width ({@link DScalarFunction})\n\t * * An object returning a width ({@link DScalar})\n\t */\n\twidth?: DCoordinateSize;\n\n\t/**\n\t * One of the followings:\n\t * * A height\n\t * * A size keyword\n\t * * A size expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a hight ({@link DScalarFunction})\n\t * * An object returning a hight ({@link DScalar})\n\t */\n\theight?: DCoordinateSize;\n\n\t/**\n\t * A visibility.\n\t * Set to true to make {@link DBase} visible.\n\t * Set to false to make {@link DBase} invisible.\n\t * The default values is true.\n\t */\n\tvisible?: boolean;\n\n\t/** A default state. */\n\tstate?: (keyof typeof DBaseState) | Array<keyof typeof DBaseState> | DBaseState;\n\n\t/** An interactivity option. */\n\tinteractive?: (keyof typeof DBaseInteractive) | DBaseInteractive;\n\n\t/** A padding options. */\n\tpadding?: number | DBasePaddingOptions;\n\n\t/** A corner options. */\n\tcorner?: number | DBaseCornerOptions;\n\n\t/** A theme or a theme name. */\n\ttheme?: THEME | string;\n\n\t/**\n\t * Mappings of event names and event handlers.\n\t */\n\ton?: DBaseOnOptions;\n\n\t/**\n\t * A weight used by {@link DLayoutVertical} and {@link DLayoutHorizontal}.\n\t */\n\tweight?: number;\n\n\t/** A tooltip text. */\n\ttitle?: string;\n\n\t/** A shortcut option. */\n\tshortcut?: string | UtilKeyboardEventShortcut;\n\n\t/** A shortcut options. */\n\tshortcuts?: Array<string | UtilKeyboardEventShortcut>;\n\n\t/** A background options. */\n\tbackground?: DBaseBackgroundOptions;\n\n\t/** A border options. */\n\tborder?: DBaseBorderOptions;\n\n\t/** An outline options. */\n\toutline?: DBaseOutlineOptions;\n\n\t/** A shadow. */\n\tshadow?: DShadow;\n\n\t/** A clear type used by {@link DLayoutVertical} and {@link DLayoutHorizontal}. */\n\tclear?: (keyof typeof DLayoutClearType) | DLayoutClearType;\n\n\t/** A cursor shape. */\n\tcursor?: string;\n}\n\n/**\n * DBase theme\n */\nexport interface DThemeBase extends DThemeFont {\n\t/**\n\t * Returns a X coordinate.\n\t */\n\tgetX(): DCoordinatePosition;\n\n\t/**\n\t * Returns a Y coordinate.\n\t */\n\tgetY(): DCoordinatePosition;\n\n\t/**\n\t * Returns a height.\n\t */\n\tgetHeight(): DCoordinateSize;\n\n\t/**\n\t * Returns a width.\n\t */\n\tgetWidth(): DCoordinateSize;\n\n\t/**\n\t * Returns a background color.\n\t * If the color is null, backgrounds are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetBackgroundColor( state: DBaseState ): number | null;\n\n\t/**\n\t * Returns a background alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetBackgroundAlpha( state: DBaseState ): number;\n\n\t/**\n\t * Returns a background texture of the given radius.\n\t *\n\t * @param radius a corner radius\n\t */\n\tgetBackgroundTexture( radius: number ): Texture;\n\n\t/**\n\t * Returns a border color.\n\t * If the color is null, borders are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderColor( state: DBaseState ): number | null;\n\n\t/**\n\t * Returns a border alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderAlpha( state: DBaseState ): number;\n\n\t/**\n\t * Returns a border width.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderWidth( state: DBaseState ): number;\n\n\t/**\n\t * Returns a border align.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderAlign( state: DBaseState ): number;\n\n\t/**\n\t * Returns a border mask.\n\t *\n\t * @param state a mask\n\t */\n\tgetBorderMask( state: DBaseState ): DBorderMask;\n\n\t/**\n\t * Returns a border texture of the given radius and width.\n\t *\n\t * @param radius a corner radius\n\t * @param width a border width\n\t */\n\tgetBorderTexture( radius: number, width: number ): Texture;\n\n\t/**\n\t * Returns a left padding.\n\t */\n\tgetPaddingLeft(): number;\n\n\t/**\n\t * Returns a right padding.\n\t */\n\tgetPaddingRight(): number;\n\n\t/**\n\t * Returns a top padding.\n\t */\n\tgetPaddingTop(): number;\n\n\t/**\n\t * Returns a bottom padding.\n\t */\n\tgetPaddingBottom(): number;\n\n\t/**\n\t * Returns a corner radius.\n\t */\n\tgetCornerRadius(): number;\n\n\t/**\n\t * Returns a corner mask.\n\t */\n\tgetCornerMask(): DCornerMask;\n\n\t/**\n\t * Returns an outline color.\n\t * If the color is null, outlines are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineColor( state: DBaseState ): number | null;\n\n\t/**\n\t * Returns an outline alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineAlpha( state: DBaseState ): number;\n\n\t/**\n\t * Returns an outline width.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineWidth( state: DBaseState ): number;\n\n\t/**\n\t * Returns an outline offset.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineOffset( state: DBaseState ): number;\n\n\t/**\n\t * Returns an outline align.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineAlign( state: DBaseState ): number;\n\n\t/**\n\t * Returns an outline mask.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineMask( state: DBaseState ): DBorderMask;\n\n\t/**\n\t * Returns a shadow.\n\t * If a shadow is null, no shadow is rendered.\n\t */\n\tgetShadow(): DShadow | null;\n\n\t/**\n\t * Returns an interactivity.\n\t */\n\tgetInteractive(): DBaseInteractive;\n\n\t/**\n\t * Returns a tooltip text.\n\t */\n\tgetTitle(): string;\n\n\t/**\n\t * Returns a clear type.\n\t * A clear type is for layout classes including {@link DLayoutVertical}.\n\t */\n\tgetClearType(): DLayoutClearType;\n\n\t/**\n\t * Returns a weight.\n\t * Weights are for layout classes including {@link DLayoutVertical}.\n\t * If a weight is less than or equals to zero, layout classes are supposed not to change a width / height.\n\t */\n\tgetWeight(): number;\n\n\t/**\n\t * Creates a new shadow.\n\t */\n\tnewShadow(): DShadow | null;\n\n\t/**\n\t * Creates a new weak shadow.\n\t */\n\tnewShadowWeak(): DShadow | null;\n\n\t/**\n\t * Returns a cursor.\n\t */\n\tgetCursor(): string | null;\n}\n\nconst toTheme = <THEME extends DThemeBase>( options?: DBaseOptions<THEME> ): THEME | null => {\n\tif( options != null && options.theme != null ) {\n\t\tconst theme = options.theme;\n\t\tif( isString( theme ) ) {\n\t\t\treturn DThemes.getInstance().get( theme );\n\t\t} else {\n\t\t\treturn theme;\n\t\t}\n\t}\n\treturn null;\n};\n\nexport interface DRefitable {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nconst toShortcuts = <THEME extends DThemeBase>(\n\toptions?: DBaseOptions<THEME>\n): UtilKeyboardEventShortcut[] | undefined => {\n\tif( options != null && ( options.shortcuts != null || options.shortcut != null ) ) {\n\t\tconst result: UtilKeyboardEventShortcut[] = [];\n\t\tif( options.shortcut != null ) {\n\t\t\tresult.push( UtilKeyboardEvent.toShortcut( options.shortcut ) );\n\t\t}\n\n\t\tif( options.shortcuts != null ) {\n\t\t\tconst shortcuts = options.shortcuts;\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.toShortcut( shortcuts[ i ] );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\treturn undefined;\n};\n\nexport interface DRenderable {\n\trender( renderer: Renderer ): void;\n\tupdateTransform(): void;\n}\n\nexport interface DReflowable {\n\tonReflow( base: DBase, width: number, height: number ): void;\n}\n\nconst enum AutoFlag {\n\tNONE = 0,\n\tWIDTH = 1,\n\tHEIGHT = 2\n}\n\nexport class DBase<\n\tTHEME extends DThemeBase = DThemeBase,\n\tOPTIONS extends DBaseOptions<THEME> = DBaseOptions<THEME>\n> extends Container {\n\tprotected static WORK_CONTAINS_POINT: Point = new Point();\n\n\tprivate _name: string;\n\tprivate _state: DBaseState;\n\tprivate _stateLocal: DBaseState;\n\tprivate _theme: THEME;\n\tprotected _options: OPTIONS | undefined;\n\tprivate _width: number;\n\tprivate _height: number;\n\tprotected _padding: DPadding;\n\tprotected _corner: DCorner;\n\tprivate _scalarSet: DScalarSet;\n\tprotected _autoFlags: AutoFlag;\n\tprivate _isDirty: boolean;\n\tprivate _hasDirty: boolean;\n\tprotected _isChildrenDirty: boolean;\n\tprivate _shadow: DShadow | null;\n\tprivate _onShadowUpdateBound: () => void;\n\tprivate _weight: number;\n\tprivate _position: DBasePoint;\n\tprivate _scale: DBasePoint;\n\tprivate _skew: DBasePoint;\n\tprotected _title: string;\n\tprotected _background: DBackgroundStateAware;\n\tprotected _border: DBorderStateAware;\n\tprotected _outline: DOutline;\n\tprotected _clearType: DLayoutClearType;\n\tprotected _shortcuts?: UtilKeyboardEventShortcut[];\n\tprotected _befores: DRenderable[];\n\tprotected _afters: DRenderable[];\n\tprotected _reflowables: DReflowable[];\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper();\n\n\t\t// Transform\n\t\tconst transform: Transform = this.transform;\n\t\tthis._position = new DBasePoint( transform.position, (): void => {\n\t\t\tthis.onPositionChanged();\n\t\t});\n\t\tthis._scale = new DBasePoint( transform.scale, (): void => {\n\t\t\tthis.onScaleChanged();\n\t\t});\n\t\tthis._skew = new DBasePoint( transform.skew, (): void => {\n\t\t\tthis.onSkewChanged();\n\t\t});\n\n\t\t//\n\t\tthis._options = options;\n\t\tconst scalarSet: DScalarSet = this._scalarSet = {};\n\t\tthis._autoFlags = AutoFlag.NONE;\n\t\tthis._isDirty = true;\n\t\tthis._hasDirty = false;\n\t\tthis._isChildrenDirty = false;\n\t\tthis._shadow = null;\n\t\tthis._name = ( options && options.name ) || \"\";\n\t\tconst theme = this._theme = toTheme( options ) || this.getThemeDefault();\n\t\tthis._befores = [];\n\t\tthis._afters = [];\n\t\tthis._reflowables = [];\n\t\tthis._clearType = ( options && options.clear != null ?\n\t\t\t( isString( options.clear ) ? DLayoutClearType[ options.clear ] : options.clear ) :\n\t\t\ttheme.getClearType()\n\t\t);\n\t\tthis._padding = new DBasePadding( theme, options, (): void => {\n\t\t\tthis.layout();\n\t\t\tthis.toChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tconst toDirtyAndUpdate = (): void => {\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t};\n\t\tthis._background = new DBaseBackground( theme, options, toDirtyAndUpdate );\n\t\tthis._border = new DBaseBorder( theme, options, toDirtyAndUpdate );\n\t\tthis._outline = new DBaseOutline( theme, options, toDirtyAndUpdate );\n\t\tthis._corner = new DBaseCorner( theme, options, toDirtyAndUpdate );\n\t\tthis.initReflowable();\n\n\t\t// X\n\t\tconst position = transform.position;\n\t\tconst x = ( options && options.x != null ? options.x : theme.getX() );\n\t\tif( isNumber( x ) ) {\n\t\t\tposition.x = x;\n\t\t} else {\n\t\t\tposition.x = 0;\n\t\t\tscalarSet.x = DScalarFunctions.position( x );\n\t\t}\n\n\t\t// Y\n\t\tconst y = ( options && options.y != null ? options.y : theme.getY() );\n\t\tif( isNumber( y ) ) {\n\t\t\tposition.y = y;\n\t\t} else {\n\t\t\tposition.y = 0;\n\t\t\tscalarSet.y = DScalarFunctions.position( y );\n\t\t}\n\n\t\t// Width\n\t\tconst width = ( options && options.width != null ? options.width : theme.getWidth() );\n\t\tif( isNumber( width ) ) {\n\t\t\tthis._width = width;\n\t\t} else if( width === \"auto\" || width === \"AUTO\" ) {\n\t\t\tthis._width = 100;\n\t\t\tthis.toWidthAuto();\n\t\t} else {\n\t\t\tthis._width = 100;\n\t\t\tscalarSet.width = DScalarFunctions.size( width );\n\t\t}\n\n\t\t// Height\n\t\tconst height = ( options && options.height != null ? options.height : theme.getHeight() );\n\t\tif( isNumber( height ) ) {\n\t\t\tthis._height = height;\n\t\t} else if( height === \"auto\" || height === \"AUTO\" ) {\n\t\t\tthis._height = 100;\n\t\t\tthis.toHeightAuto();\n\t\t} else {\n\t\t\tthis._height = 100;\n\t\t\tscalarSet.height = DScalarFunctions.size( height );\n\t\t}\n\n\t\t// Visibility\n\t\tif( options && options.visible != null ) {\n\t\t\tthis.visible = options.visible;\n\t\t}\n\n\t\t// State\n\t\tthis._state = DBaseState.NONE;\n\t\tthis._stateLocal = DBaseState.NONE;\n\n\t\t// Interactive\n\t\tconst interactive = ( options && options.interactive != null ?\n\t\t\t( isString( options.interactive ) ? DBaseInteractive[ options.interactive ] : options.interactive ) :\n\t\t\ttheme.getInteractive()\n\t\t);\n\t\tthis.interactive = ( ( interactive & DBaseInteractive.SELF ) !== 0 );\n\t\tthis.interactiveChildren = ( ( interactive & DBaseInteractive.CHILDREN ) !== 0 );\n\n\t\t// Events\n\t\tif( options ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Title\n\t\tthis._title = ( options && options.title != null ? options.title : theme.getTitle() );\n\n\t\t// Weight\n\t\tthis._weight = ( options && options.weight != null ? options.weight : theme.getWeight() );\n\n\t\t// Shadow\n\t\tthis._onShadowUpdateBound = (): void => {\n\t\t\tDApplications.update( this );\n\t\t};\n\t\tconst shadow = (options && options.shadow) || theme.getShadow();\n\t\tif( shadow ) {\n\t\t\tthis.shadow = shadow;\n\t\t}\n\n\t\t// Event handlers\n\t\tthis.on( UtilPointerEvent.over, ( e: InteractionEvent ): void => {\n\t\t\tthis.onOver( e );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.out, ( e: InteractionEvent ): void => {\n\t\t\tthis.onOut( e );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t});\n\n\t\t// Children change detection\n\t\tthis.on( \"added\", (): void => {\n\t\t\tthis.layout();\n\t\t\tif( this.isDirty() || this.hasDirty() ) {\n\t\t\t\tthis.toParentHasDirty();\n\t\t\t}\n\t\t\tif( this._isChildrenDirty ) {\n\t\t\t\tthis.toParentChildrenDirty();\n\t\t\t}\n\t\t\tthis.updateState();\n\t\t\tDApplications.update( this );\n\t\t});\n\n\t\tthis.on( \"removed\", (): void => {\n\t\t\tthis.blur( true );\n\t\t\tthis.updateState();\n\t\t\tDApplications.update( this );\n\t\t});\n\n\t\t// Shortcut\n\t\tconst shortcuts = this._shortcuts = toShortcuts( options );\n\t\tif( shortcuts != null ) {\n\t\t\tconst onShortcutBound = ( e: KeyboardEvent ): void => {\n\t\t\t\tthis.onShortcut( e );\n\t\t\t};\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcuts[ i ], onShortcutBound );\n\t\t\t}\n\t\t}\n\n\t\t// Cursor\n\t\tlet cursor: string | null | undefined = options && options.cursor;\n\t\tif( cursor == null ) {\n\t\t\tcursor = theme.getCursor();\n\t\t}\n\t\tif( cursor != null ) {\n\t\t\tthis.cursor = cursor;\n\t\t}\n\n\t\t// Other initialization\n\t\tthis.init( options );\n\n\t\t// State Override\n\t\tif( options && options.state != null ) {\n\t\t\tif( isString( options.state ) ) {\n\t\t\t\tthis.setState( DBaseState[ options.state ], true );\n\t\t\t} else if( isNumber( options.state ) ) {\n\t\t\t\tthis.setState( options.state, true );\n\t\t\t} else {\n\t\t\t\tconst states = options.state;\n\t\t\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\t\t\tthis.setState( DBaseState[ states[ i ] ], true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Parent\n\t\tif( options && options.parent != null ) {\n\t\t\toptions.parent.addChild( this );\n\t\t}\n\n\t\t// Children\n\t\tif( options && options.children != null ) {\n\t\t\tconst children = options.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child != null ) {\n\t\t\t\t\tthis.addChild( child );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tprependRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = this;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tlist.unshift( renderable );\n\t}\n\n\tappendRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = this;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tlist.push( renderable );\n\t}\n\n\tremoveRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = null;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tconst index = list.indexOf( renderable );\n\t\tif( 0 <= index ) {\n\t\t\tlist.splice( index, 1 );\n\t\t}\n\t}\n\n\taddReflowable( reflowable: DReflowable ): void {\n\t\tthis._reflowables.push( reflowable );\n\t}\n\n\tremoveReflowable( reflowable: DReflowable ): void {\n\t\tconst reflowables = this._reflowables;\n\t\tconst index = reflowables.indexOf( reflowable );\n\t\tif( 0 <= index ) {\n\t\t\treflowables.splice( index, 1 );\n\t\t}\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DBaseReflowable( this );\n\t}\n\n\tprotected onChildrenChange(): void {\n\t\tthis.toChildrenDirty();\n\t\tsuper.onChildrenChange();\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\t// OTHER INITIALIZATIONS BEFORE `parent.addChild( this )`\n\t}\n\n\tget weight(): number {\n\t\treturn this._weight;\n\t}\n\n\tprotected onPositionChanged(): void {\n\t\tthis.moveChildren();\n\t\tDApplications.update( this );\n\t\tthis.emit( \"move\", this );\n\t}\n\n\tresize( width: number, height: number ): boolean {\n\t\tconst oldWidth = this._width;\n\t\tconst oldHeight = this._height;\n\t\tconst widthResized = oldWidth !== width;\n\t\tconst heightResized = oldHeight !== height;\n\n\t\tif( widthResized ) {\n\t\t\tthis._width = width;\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tthis._height = height;\n\t\t}\n\n\t\tconst resized = widthResized || heightResized;\n\t\tif( resized ) {\n\t\t\tthis.onResize( width, height, oldWidth, oldHeight );\n\t\t}\n\n\t\tif( widthResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.x = scalarSet.x( parent.width, width, parent.padding.getLeft(), position.x );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.y = scalarSet.y( parent.height, height, parent.padding.getTop(), position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resized;\n\t}\n\n\tgetClearType(): DLayoutClearType {\n\t\treturn this._clearType;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tthis.toDirty();\n\t\tthis.toChildrenDirty();\n\t\tthis.resizeChildren();\n\t\tDApplications.update( this );\n\t\tthis.emit( \"resize\", newWidth, newHeight, oldWidth, oldHeight, this );\n\t}\n\n\tprotected onScaleChanged(): void {\n\t\tDApplications.update( this );\n\t\tthis.emit( \"scale\", this );\n\t}\n\n\tprotected onSkewChanged(): void {\n\t\tDApplications.update( this );\n\t\tthis.emit( \"skew\", this );\n\t}\n\n\tget type(): string {\n\t\treturn this.getType();\n\t}\n\n\tget name(): string {\n\t\treturn this._name;\n\t}\n\n\tset name( name: string ) {\n\t\tthis._name = name;\n\t}\n\n\tget x(): number {\n\t\treturn this._position.x;\n\t}\n\n\tset x( x: number ) {\n\t\tthis._position.x = x;\n\t}\n\n\tgetX(): DCoordinatePosition {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.x != null ) {\n\t\t\treturn scalarSet.x;\n\t\t} else {\n\t\t\treturn this.x;\n\t\t}\n\t}\n\n\tsetX( x: DCoordinatePosition ) {\n\t\tif( isNumber( x ) ) {\n\t\t\tthis.x = x;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( x );\n\t\t\tif( scalarSet.x !== scalar ) {\n\t\t\t\tscalarSet.x = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._position.y;\n\t}\n\n\tset y( y: number ) {\n\t\tthis._position.y = y;\n\t}\n\n\tgetY(): DCoordinatePosition {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.y != null ) {\n\t\t\treturn scalarSet.y;\n\t\t} else {\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tsetY( y: DCoordinatePosition ) {\n\t\tif( isNumber( y ) ) {\n\t\t\tthis.y = y;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( y );\n\t\t\tif( scalarSet.y !== scalar ) {\n\t\t\t\tscalarSet.y = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tconst oldWidth = this._width;\n\t\tif( oldWidth !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst height = this._height;\n\t\t\tthis.onResize( width, height, oldWidth, height );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.x = scalarSet.x( parent.width, width, parent.padding.getLeft(), position.x );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toWidthAuto() {\n\t\tthis._autoFlags |= AutoFlag.WIDTH;\n\t}\n\n\tprotected isWidthAuto(): boolean {\n\t\treturn ( this._autoFlags & AutoFlag.WIDTH ) !== 0;\n\t}\n\n\tgetWidth(): DCoordinateSize {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( this.isWidthAuto() ) {\n\t\t\treturn \"auto\";\n\t\t} else if( scalarSet.width != null ) {\n\t\t\treturn scalarSet.width;\n\t\t} else {\n\t\t\treturn this.width;\n\t\t}\n\t}\n\n\tsetWidth( width: DCoordinateSize ) {\n\t\tif( isNumber( width ) ) {\n\t\t\tthis.width = width;\n\t\t} else if( width === \"auto\" || width === \"AUTO\" ) {\n\t\t\tif( ! this.isWidthAuto() ) {\n\t\t\t\tthis.toWidthAuto();\n\t\t\t\tthis.toChildrenDirty();\n\t\t\t\tDApplications.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.size( width );\n\t\t\tif( scalarSet.width !== scalar ) {\n\t\t\t\tscalarSet.width = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tconst oldHeight = this._height;\n\t\tif( oldHeight !== height ) {\n\t\t\tthis._height = height;\n\t\t\tconst width = this._width;\n\t\t\tthis.onResize( width, height, width, oldHeight );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.y = scalarSet.y( parent.height, height, parent.padding.getTop(), position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toHeightAuto() {\n\t\tthis._autoFlags |= AutoFlag.HEIGHT;\n\t}\n\n\tprotected isHeightAuto(): boolean {\n\t\treturn ( this._autoFlags & AutoFlag.HEIGHT ) !== 0;\n\t}\n\n\tgetHeight(): DCoordinateSize {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( this.isHeightAuto() ) {\n\t\t\treturn \"auto\";\n\t\t} else if( scalarSet.height != null ) {\n\t\t\treturn scalarSet.height;\n\t\t} else {\n\t\t\treturn this.height;\n\t\t}\n\t}\n\n\tsetHeight( height: DCoordinateSize ) {\n\t\tif( isNumber( height ) ) {\n\t\t\tthis.height = height;\n\t\t} else if( height === \"auto\" || height === \"AUTO\" ) {\n\t\t\tif( ! this.isHeightAuto() ) {\n\t\t\t\tthis.toHeightAuto();\n\t\t\t\tthis.toChildrenDirty();\n\t\t\t\tDApplications.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.size( height );\n\t\t\tif( scalarSet.height !== scalar ) {\n\t\t\t\tscalarSet.height = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\tget position(): DBasePoint {\n\t\treturn this._position;\n\t}\n\n\tget scale(): DBasePoint {\n\t\treturn this._scale;\n\t}\n\n\tget skew(): DBasePoint {\n\t\treturn this._skew;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\tget corner(): DCorner {\n\t\treturn this._corner;\n\t}\n\n\tget background(): DBackgroundStateAware {\n\t\treturn this._background;\n\t}\n\n\tget border(): DBorderStateAware {\n\t\treturn this._border;\n\t}\n\n\tget outline(): DOutline {\n\t\treturn this._outline;\n\t}\n\n\tget unsafe(): Transform {\n\t\treturn this.transform;\n\t}\n\n\tget title(): string {\n\t\treturn this._title;\n\t}\n\n\tset title( title: string ) {\n\t\tif( this._title !== title ) {\n\t\t\tthis._title = title;\n\t\t\tif( this.isHovered() ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.view.title = this._title;\n\t\t}\n\t}\n\n\tshow(): this {\n\t\tif( ! this.visible ) {\n\t\t\tthis.visible = true;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisShown(): boolean {\n\t\treturn this.visible;\n\t}\n\n\thide(): this {\n\t\tif( this.visible ) {\n\t\t\tthis.visible = false;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisHidden(): boolean {\n\t\treturn ! this.visible;\n\t}\n\n\ttoDirty(): boolean {\n\t\tif( ! this._isDirty ) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoHasDirty(): boolean {\n\t\tif( ! this._hasDirty ) {\n\t\t\tthis._hasDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentHasDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toHasDirty();\n\t\t}\n\t}\n\n\ttoChildrenDirty(): boolean {\n\t\tif( ! this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = true;\n\t\t\tthis.onChildrenDirty();\n\t\t\tthis.toParentChildrenDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentChildrenDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toChildrenDirty();\n\t\t}\n\t}\n\n\tisChildrenDirty(): boolean {\n\t\treturn this._isChildrenDirty;\n\t}\n\n\tprotected onChildrenDirty() {\n\t\t// DO NOTHING\n\t}\n\n\tisDirty() {\n\t\treturn this._isDirty;\n\t}\n\n\thasDirty() {\n\t\treturn this._hasDirty;\n\t}\n\n\tsetHovered( isHovered: boolean ) {\n\t\treturn this.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tsetActive( isActive: boolean ) {\n\t\treturn this.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tsetPressed( isPressed: boolean ) {\n\t\treturn this.setState( DBaseState.PRESSED, isPressed );\n\t}\n\n\tsetReadOnly( isReadOnly: boolean ) {\n\t\treturn this.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tsetDisabled( isDisabled: boolean ) {\n\t\treturn this.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tsetDragging( isDragging: boolean ) {\n\t\treturn this.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tsetInvalid( isInvalid: boolean ) {\n\t\treturn this.setState( DBaseState.INVALID, isInvalid );\n\t}\n\n\tsetSucceeded( isSucceeded: boolean ) {\n\t\treturn this.setState( DBaseState.SUCCEEDED, isSucceeded );\n\t}\n\n\tsetFailed( isFailed: boolean ) {\n\t\treturn this.setState( DBaseState.FAILED, isFailed );\n\t}\n\n\tsetFocused( isFocused: boolean ) {\n\t\tif( this.isFocused() !== isFocused ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().setFocused( this, isFocused, false );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tfocus(): this {\n\t\treturn this.setFocused( true );\n\t}\n\n\tblur( recursively?: boolean ): this {\n\t\tif( recursively ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tconst focused = focusController.getFocused();\n\t\t\t\tif( focused instanceof DBase ) {\n\t\t\t\t\tlet current: Container = focused;\n\t\t\t\t\twhile( current ) {\n\t\t\t\t\t\tif( current === this ) {\n\t\t\t\t\t\t\tfocused.setFocused( false );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setFocused( false );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisHovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tisActive(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tisActiveIn(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE | DBaseState.ACTIVE_IN );\n\t}\n\n\tisPressed(): boolean {\n\t\treturn this.hasState( DBaseState.PRESSED );\n\t}\n\n\tisReadOnly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tisDisabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tisActionable(): boolean {\n\t\treturn ! this.hasState( DBaseState.DISABLED | DBaseState.READ_ONLY );\n\t}\n\n\tisDragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tisFocused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tisFocusedIn(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED | DBaseState.FOCUSED_IN );\n\t}\n\n\tisUnfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tisInvalid(): boolean {\n\t\treturn this.hasState( DBaseState.INVALID );\n\t}\n\n\tisSucceeded(): boolean {\n\t\treturn this.hasState( DBaseState.SUCCEEDED );\n\t}\n\n\tisFailed(): boolean {\n\t\treturn this.hasState( DBaseState.FAILED );\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ) {\n\t\tconst oldStateLocal = this._stateLocal;\n\t\tconst newStateLocal = ( isOn ? (oldStateLocal | state) : (oldStateLocal & ~state) );\n\t\tif( oldStateLocal !== newStateLocal ) {\n\t\t\tthis._stateLocal = newStateLocal;\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\tsetStates( statesOn: DBaseState, statesOff: DBaseState ) {\n\t\tconst oldStateLocal = this._stateLocal;\n\t\tconst newStateLocal = ( (oldStateLocal | statesOn) & ~statesOff );\n\t\tif( oldStateLocal !== newStateLocal ) {\n\t\t\tthis._stateLocal = newStateLocal;\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected updateState(): void {\n\t\tconst parent = this.parent;\n\t\tconst stateLocal = this._stateLocal;\n\t\tconst newState = ( parent instanceof DBase ?\n\t\t\tthis.mergeState( stateLocal, parent.state ) :\n\t\t\tstateLocal\n\t\t);\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn stateLocal | ( stateParent & DBaseState.DISABLED ) |\n\t\t\t( stateParent & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) ? DBaseState.FOCUSED_IN : DBaseState.NONE ) |\n\t\t\t( stateParent & (DBaseState.ACTIVE | DBaseState.ACTIVE_IN) ? DBaseState.ACTIVE_IN : DBaseState.NONE );\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tthis.toDirty();\n\t\tDApplications.update( this );\n\t\tthis.emit( \"statechange\", newState, oldState, this );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentStateChange( newState, oldState );\n\t\t\t}\n\t\t}\n\n\t\tif( DBaseStates.isFocused( newState ) ) {\n\t\t\tif( ! DBaseStates.isFocused( oldState ) ) {\n\t\t\t\tthis.onFocused();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isFocused( oldState ) ) {\n\t\t\t\tthis.onBlured();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onChildFocused( focused: DBase ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocused( focused );\n\t\t}\n\t}\n\n\tprotected onFocused(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocused( this );\n\t\t}\n\t}\n\n\tprotected onBlured(): void {\n\t\t//\n\t}\n\n\tprotected onParentStateChange( newStateParent: number, oldStateParent: number ) {\n\t\tconst newState = this.mergeState( this._stateLocal, newStateParent );\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tget state(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\tgetState(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\treturn !! ( this._state & state );\n\t}\n\n\tget theme(): THEME {\n\t\treturn this._theme;\n\t}\n\n\tset theme( theme: THEME ) {\n\t\tconst result = this._theme;\n\t\tif( result !== theme ) {\n\t\t\tthis._theme = theme;\n\t\t\tthis._padding.setTheme( theme );\n\t\t\tthis._background.setTheme( theme );\n\t\t\tthis._border.setTheme( theme );\n\t\t\tthis._outline.setTheme( theme );\n\t\t\tthis._corner.setTheme( theme );\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\trefit(): void {\n\t\tif( this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = false;\n\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onRefit();\n\t\t}\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst isWidthAuto = this.isWidthAuto();\n\t\tconst isHeightAuto = this.isHeightAuto();\n\t\tif( isWidthAuto && isHeightAuto ) {\n\t\t\tlet width = 0;\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible ) {\n\t\t\t\t\tif( this.hasRefitableWidth( child ) ) {\n\t\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t\t}\n\t\t\t\t\tif( this.hasRefitableHeight( child ) ) {\n\t\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.resize( width + padding.getRight(), height + padding.getBottom() );\n\t\t} else if( isWidthAuto ) {\n\t\t\tlet width = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableWidth( child ) ) {\n\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.width = width + padding.getRight();\n\t\t} else if( isHeightAuto ) {\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableHeight( child ) ) {\n\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.height = height + padding.getBottom();\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn target instanceof DBase;\n\t}\n\n\tprotected hasRefitableHeight( target: any ): target is DRefitable {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && isFunction( target.getHeight() ) );\n\t}\n\n\tprotected hasRefitableWidth( target: any ): target is DBase<any, any> {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && isFunction( target.getWidth() ) );\n\t}\n\n\treflow(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis.onReflow();\n\t\t\tthis._isDirty = false;\n\t\t}\n\n\t\tif( this._hasDirty ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._hasDirty = false;\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\t\tconst reflowables = this._reflowables;\n\t\tfor( let i = 0, imax = reflowables.length; i < imax; ++i ) {\n\t\t\treflowables[ i ].onReflow( this, width, height );\n\t\t}\n\t}\n\n\tget shadow(): DShadow | null {\n\t\treturn this._shadow;\n\t}\n\n\tset shadow( shadow: DShadow | null ) {\n\t\tconst previous = this._shadow;\n\t\tif( previous !== shadow ) {\n\t\t\tif( previous != null ) {\n\t\t\t\tprevious.off( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.removeReflowable( previous );\n\t\t\t\tthis.removeRenderable( previous, true );\n\t\t\t}\n\n\t\t\tthis._shadow = shadow;\n\t\t\tif( shadow != null ) {\n\t\t\t\tshadow.on( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.addReflowable( shadow );\n\t\t\t\tthis.prependRenderable( shadow, true );\n\t\t\t}\n\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tlayout(): void {\n\t\tconst parent = this.getParentOfSize();\n\t\tif( parent ) {\n\t\t\tthis.onParentResize( parent.width, parent.height, parent.padding );\n\t\t}\n\t}\n\n\tprotected getParentOfSize(): { width: number, height: number, padding: DPadding } | null {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\treturn parent;\n\t\t} else {\n\t\t\treturn DApplications.getLayer( this );\n\t\t}\n\t}\n\n\t/**\n\t * Called when a parent resized.\n\t *\n\t * @param parentWidth a parent's local width\n\t * @param parentHeight a parent's local height\n\t */\n\tonParentResize( parentWidth: number, parentHeight: number, parentPadding: DPadding ): void {\n\t\tconst scalarSet = this._scalarSet;\n\t\tconst position = this.transform.position;\n\t\tconst x = position.x;\n\t\tconst y = position.y;\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\n\t\t// Width & height\n\t\tconst paddingWidth = parentPadding.getLeft() + parentPadding.getRight();\n\t\tconst paddingHeight = parentPadding.getTop() + parentPadding.getBottom();\n\t\tconst newWidth = ( scalarSet.width != null ?\n\t\t\tscalarSet.width( parentWidth, width, paddingWidth, width ) : width );\n\t\tconst newHeight = ( scalarSet.height != null ?\n\t\t\tscalarSet.height( parentHeight, height, paddingHeight, height ) : height );\n\t\tthis.resize( newWidth, newHeight );\n\n\t\t// X & Y\n\t\tconst newX = ( scalarSet.x != null ? scalarSet.x( parentWidth, this._width, parentPadding.getLeft(), x ) : x );\n\t\tconst newY = ( scalarSet.y != null ? scalarSet.y( parentHeight, this._height, parentPadding.getTop(), y ) : y );\n\t\tthis.position.set( newX, newY );\n\t}\n\n\tresizeChildren(): void {\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\t\tconst padding = this._padding;\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( width, height, padding );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Called when a parent moved.\n\t *\n\t * @param x a parent's local x position\n\t * @param y a parent's local y position\n\t */\n\tonParentMove( x: number, y: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected moveChildren() {\n\t\tconst x = this.x;\n\t\tconst y = this.y;\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentMove( x, y );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Wheel\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tthis.emit( \"wheel\", e, deltas, global, this );\n\t\treturn false;\n\t}\n\n\t// Keydown\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keydown\", e, this );\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keyup\", e, this );\n\t\treturn false;\n\t}\n\n\t// Down\n\tprotected onDown( e: InteractionEvent ): void {\n\t\tconst target = e.target;\n\t\tif( target === this ) {\n\t\t\tthis.onDownThis( e );\n\t\t} else if( !( target instanceof DBase ) ) {\n\t\t\tlet parent = target.parent;\n\t\t\twhile( parent != null && ! ( parent instanceof DBase ) ) {\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\tif( parent === this ) {\n\t\t\t\tthis.onDownThis( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onDownThis( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tfocusController.setFocused( focusController.findFocusableParent( this ), true, true );\n\t\t}\n\t}\n\n\t// Over\n\tprotected onOver( e: InteractionEvent ): void {\n\t\t// Hover\n\t\tthis.setHovered( true );\n\n\t\t// Title\n\t\tif( e.target === this ) {\n\t\t\tthis.applyTitle();\n\t\t}\n\t}\n\n\t// Out\n\tprotected onOut( e: InteractionEvent ): void {\n\t\tthis.setHovered( false );\n\t}\n\n\t// Double click\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tthis.emit( \"dblclick\", e, interactionManager, this );\n\t\treturn false;\n\t}\n\n\t//\n\trender( renderer: Renderer ): void {\n\t\tif( this.visible && 0 < this.worldAlpha && this.renderable ) {\n\t\t\tthis.renderBefore( renderer );\n\t\t\tsuper.render( renderer );\n\t\t\tthis.renderAfter( renderer );\n\t\t}\n\t}\n\n\tprotected renderBefore( renderer: Renderer ): void {\n\t\tconst befores = this._befores;\n\t\tfor( let i = 0, imax = befores.length; i < imax; ++i ) {\n\t\t\tconst before = befores[ i ];\n\t\t\tbefore.updateTransform();\n\t\t\tbefore.render( renderer );\n\t\t}\n\t}\n\n\tprotected renderAfter( renderer: Renderer ): void {\n\t\tconst afters = this._afters;\n\t\tfor( let i = 0, imax = afters.length; i < imax; ++i ) {\n\t\t\tconst after = afters[ i ];\n\t\t\tafter.updateTransform();\n\t\t\tafter.render( renderer );\n\t\t}\n\t}\n\n\t//\n\tprotected getThemeDefault(): THEME {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBase\";\n\t}\n\n\t//\n\tprotected _calculateBounds(): void {\n\t\tconst worldTransform = this.transform.worldTransform;\n\t\tconst bounds = this._bounds;\n\n\t\tconst work = DBase.WORK_CONTAINS_POINT;\n\t\twork.set( 0, 0 );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\twork.set( this._width, this._height );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\tsuper._calculateBounds();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn this.containsGlobalPoint( point ) || this.containsLocalPoint(\n\t\t\tthis.worldTransform.applyInverse( point, DBase.WORK_CONTAINS_POINT )\n\t\t);\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tprotected containsLocalPoint( point: Point ): boolean {\n\t\treturn (\n\t\t\t0 <= point.x && point.x <= this._width &&\n\t\t\t0 <= point.y && point.y <= this._height\n\t\t);\n\t}\n\n\t/**\n\t * Returns a clipping rect.\n\t *\n\t * @param result a clipping rect\n\t */\n\tgetClippingRect( target: DBase, result: Rectangle ): void {\n\t\tresult.x = 0;\n\t\tresult.y = 0;\n\t\tresult.width = this._width;\n\t\tresult.height = this._height;\n\t}\n\n\tdestroy(): void {\n\t\t// Layout\n\t\tconst scalarSet = this._scalarSet;\n\t\tscalarSet.x = null;\n\t\tscalarSet.y = null;\n\t\tscalarSet.width = null;\n\t\tscalarSet.height = null;\n\n\t\t// Shadow\n\t\tconst shadow = this._shadow;\n\t\tif( shadow ) {\n\t\t\tthis._shadow = null;\n\t\t\tshadow.destroy();\n\t\t}\n\n\t\t// Children\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinatePosition, DCoordinateSizeNoAuto } from \"./d-coordinate\";\nimport { DScalarExpression } from \"./d-scalar-expression\";\nimport { DScalarFunction } from \"./d-scalar-function\";\nimport { isFunction } from \"./util/is-function\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nconst POSITION_CENTER = ( p: number, s: number ) => ( p - s ) * 0.5;\nconst POSITION_PADDING = ( p: number, s: number, d: number ) => d;\nconst SIZE_MAXIMIZED = ( p: number ) => p;\nconst SIZE_PADDING = ( p: number, s: number, d: number ) => p - d;\n\nexport class DScalarFunctions {\n\tstatic position( coordinate: DCoordinatePosition | undefined ): DScalarFunction | null {\n\t\tif( coordinate == null || isNumber( coordinate ) ) {\n\t\t\treturn null;\n\t\t} else if( isString( coordinate ) ) {\n\t\t\tswitch( coordinate ) {\n\t\t\tcase \"center\":\n\t\t\tcase \"CENTER\":\n\t\t\t\treturn POSITION_CENTER;\n\t\t\tcase \"padding\":\n\t\t\tcase \"PADDING\":\n\t\t\t\treturn POSITION_PADDING;\n\t\t\t}\n\n\t\t\tconst scalarExpression = new DScalarExpression( coordinate );\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalarExpression.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t} else if( isFunction( coordinate ) ) {\n\t\t\treturn coordinate;\n\t\t} else {\n\t\t\tconst scalar = coordinate;\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalar.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic size( coordinate: DCoordinateSizeNoAuto | undefined ): DScalarFunction | null {\n\t\tif( coordinate == null || isNumber( coordinate ) ) {\n\t\t\treturn null;\n\t\t} else if( isString( coordinate ) ) {\n\t\t\tswitch( coordinate ) {\n\t\t\tcase \"100%\":\n\t\t\tcase \"maximized\":\n\t\t\tcase \"MAXIMIZED\":\n\t\t\t\treturn SIZE_MAXIMIZED;\n\t\t\tcase \"padding\":\n\t\t\tcase \"PADDING\":\n\t\t\t\treturn SIZE_PADDING;\n\t\t\t}\n\n\t\t\tconst scalarExpression = new DScalarExpression( coordinate );\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalarExpression.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t} else if( isFunction( coordinate ) ) {\n\t\t\treturn coordinate;\n\t\t} else {\n\t\t\tconst scalar = coordinate;\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalar.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTheme } from \"./d-theme\";\n\nexport class DThemes {\n\tprivate static DEFAULT_THEME_CLASS: (new () => DTheme) | null = null;\n\tprivate static INSTANCE: DTheme | null = null;\n\n\tpublic static setDefaultThemeClass( theme: new () => DTheme ): void {\n\t\tthis.DEFAULT_THEME_CLASS = theme;\n\t}\n\n\tpublic static getDefaultThemeClass(): (new () => DTheme) | null {\n\t\treturn this.DEFAULT_THEME_CLASS;\n\t}\n\n\tpublic static getInstance(): DTheme {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tconst defaultThemeClass = this.getDefaultThemeClass();\n\t\t\tif( defaultThemeClass == null ) {\n\t\t\t\tthrow new Error( \"No default theme class found\" );\n\t\t\t}\n\t\t\tthis.INSTANCE = new defaultThemeClass();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n\n\tpublic static setInstance( instance: DTheme ): DTheme | null {\n\t\tconst result = this.INSTANCE;\n\t\tthis.INSTANCE = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\nimport { isString } from \"./is-string\";\n\nexport interface UtilKeyboardEventShortcut {\n\talt: boolean;\n\tctrl: boolean;\n\tshift: boolean;\n\tkey: string;\n\twhich: number;\n\tevent?: string;\n}\n\nconst setShortcutKeyAndWhich = ( shortcut: UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut => {\n\tconst key = shortcut.key;\n\tif( key.length <= 1 ) {\n\t\tif( shortcut.shift ) {\n\t\t\tshortcut.key = key.toUpperCase();\n\t\t}\n\t\tconst code = key.charCodeAt( 0 );\n\t\tif( 97 <= code && code <= 122 ) {\n\t\t\t// a ... z\n\t\t\tshortcut.which = code - 32;\n\t\t} else {\n\t\t\tshortcut.which = code;\n\t\t}\n\t} else {\n\t\tswitch( key ) {\n\t\tcase \"Enter\":\n\t\t\tshortcut.which = 13;\n\t\t\tbreak;\n\t\tcase \"Space\":\n\t\t\tshortcut.key = \" \";\n\t\t\tshortcut.which = 32;\n\t\t\tbreak;\n\t\tcase \"Escape\":\n\t\t\tshortcut.which = 27;\n\t\t\tbreak;\n\t\tcase \"F1\":\n\t\t\tshortcut.which = 112;\n\t\t\tbreak;\n\t\tcase \"F2\":\n\t\t\tshortcut.which = 113;\n\t\t\tbreak;\n\t\tcase \"F3\":\n\t\t\tshortcut.which = 114;\n\t\t\tbreak;\n\t\tcase \"F4\":\n\t\t\tshortcut.which = 115;\n\t\t\tbreak;\n\t\tcase \"F5\":\n\t\t\tshortcut.which = 116;\n\t\t\tbreak;\n\t\tcase \"F6\":\n\t\t\tshortcut.which = 117;\n\t\t\tbreak;\n\t\tcase \"F7\":\n\t\t\tshortcut.which = 118;\n\t\t\tbreak;\n\t\tcase \"F8\":\n\t\t\tshortcut.which = 119;\n\t\t\tbreak;\n\t\tcase \"F9\":\n\t\t\tshortcut.which = 120;\n\t\t\tbreak;\n\t\tcase \"F10\":\n\t\t\tshortcut.which = 121;\n\t\t\tbreak;\n\t\tcase \"F11\":\n\t\t\tshortcut.which = 122;\n\t\t\tbreak;\n\t\tcase \"F12\":\n\t\t\tshortcut.which = 123;\n\t\t\tbreak;\n\t\tcase \"CapsLock\":\n\t\t\tif( shortcut.shift ) {\n\t\t\t\tshortcut.which = 20;\n\t\t\t} else {\n\t\t\t\tshortcut.which = 240;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"ArrowUp\":\n\t\t\tshortcut.which = 38;\n\t\t\tbreak;\n\t\tcase \"ArrowDown\":\n\t\t\tshortcut.which = 40;\n\t\t\tbreak;\n\t\tcase \"ArrowLeft\":\n\t\t\tshortcut.which = 37;\n\t\t\tbreak;\n\t\tcase \"ArrowRight\":\n\t\t\tshortcut.which = 39;\n\t\t\tbreak;\n\t\tcase \"Insert\":\n\t\t\tshortcut.which = 45;\n\t\t\tbreak;\n\t\tcase \"Delete\":\n\t\t\tshortcut.which = 46;\n\t\t\tbreak;\n\t\tcase \"PageUp\":\n\t\t\tshortcut.which = 33;\n\t\t\tbreak;\n\t\tcase \"PageDown\":\n\t\t\tshortcut.which = 34;\n\t\t\tbreak;\n\t\tcase \"Backspace\":\n\t\t\tshortcut.which = 8;\n\t\t\tbreak;\n\t\tcase \";\":\n\t\t\tshortcut.which = 187;\n\t\t\tbreak;\n\t\tcase \"Pause\":\n\t\t\tshortcut.which = 19;\n\t\t\tbreak;\n\t\tcase \"ScrollLock\":\n\t\t\tshortcut.which = 145;\n\t\t\tbreak;\n\t\tcase \"Tab\":\n\t\t\tshortcut.which = 9;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn shortcut;\n};\n\nexport class UtilKeyboardEvent {\n\tstatic isActivateKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Space\" || e.key === \"Enter\" || e.which === 32 || e.which === 13 );\n\t}\n\n\tstatic isArrowUpKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowUp\" || e.which === 38 );\n\t}\n\n\tstatic isArrowDownKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowDown\" || e.which === 40 );\n\t}\n\n\tstatic isArrowLeftKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowLeft\" || e.which === 37 );\n\t}\n\n\tstatic isArrowRightKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowRight\" || e.which === 39 );\n\t}\n\n\tstatic isCancelKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Esc\" || e.which === 27 );\n\t}\n\n\tstatic isFocusKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Tab\" || e.which === 9 );\n\t}\n\n\tstatic isUndoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"z\" || e.which === 90 ) );\n\t}\n\n\tstatic isRedoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"y\" || e.which === 89 ) );\n\t}\n\n\tstatic isSaveKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"s\" || e.which === 83 ) );\n\t}\n\n\tstatic isSaveAsKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && e.shiftKey && ( e.key === \"S\" || e.which === 83 ) );\n\t}\n\n\tstatic isDeleteKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Delete\" || e.which === 46 );\n\t}\n\n\tstatic isSelectAllKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"a\" || e.which === 65 ) );\n\t}\n\n\tstatic isOkKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Enter\" || e.which === 13 );\n\t}\n\n\tstatic getFocusDirection( e: KeyboardEvent ): boolean {\n\t\treturn ( e.shiftKey !== true );\n\t}\n\n\tstatic toShortcut( expressionOrShortcut: string | UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut {\n\t\tif( ! isString( expressionOrShortcut ) ) {\n\t\t\treturn expressionOrShortcut;\n\t\t} else {\n\t\t\tconst expression = expressionOrShortcut;\n\t\t\tconst arrowIndex = expression.indexOf(\"->\");\n\t\t\tlet keyExpression: string;\n\t\t\tlet event: string | undefined;\n\t\t\tif( 0 <= arrowIndex ) {\n\t\t\t\tkeyExpression = expression.substring( 0, arrowIndex ).trim();\n\t\t\t\tevent = expression.substring( arrowIndex + 2 ).trim();\n\t\t\t} else {\n\t\t\t\tkeyExpression = expression.trim();\n\t\t\t}\n\t\t\tconst keys = keyExpression.toLowerCase().split( \"+\" );\n\t\t\tconst alt: boolean = 0 <= keys.indexOf( \"alt\" );\n\t\t\tconst ctrl: boolean = 0 <= keys.indexOf( \"ctrl\" );\n\t\t\tconst shift: boolean = 0 <= keys.indexOf( \"shift\" );\n\t\t\tconst key: string = keys[ keys.length - 1 ];\n\t\t\treturn setShortcutKeyAndWhich({\n\t\t\t\talt,\n\t\t\t\tctrl,\n\t\t\t\tshift,\n\t\t\t\tkey,\n\t\t\t\twhich: 0,\n\t\t\t\tevent\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic toString( shortcut: UtilKeyboardEventShortcut ): string {\n\t\tconst parts = [];\n\t\tif( shortcut.ctrl ) {\n\t\t\tparts.push( \"Ctrl\" );\n\t\t}\n\t\tif( shortcut.shift ) {\n\t\t\tparts.push( \"Shift\" );\n\t\t}\n\t\tif( shortcut.alt ) {\n\t\t\tparts.push( \"Alt\" );\n\t\t}\n\t\tparts.push( shortcut.key.toUpperCase() );\n\t\treturn parts.join( \"+\" );\n\t}\n\n\tstatic on(\n\t\ttarget: DBase<any, any>,\n\t\texpressionOrShortcut: string | UtilKeyboardEventShortcut,\n\t\thandler?: ( e: KeyboardEvent ) => void\n\t): void {\n\t\tconst shortcut = this.toShortcut( expressionOrShortcut );\n\t\tdocument.body.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tif(\n\t\t\t\te.altKey === shortcut.alt && e.ctrlKey === shortcut.ctrl &&\n\t\t\t\te.shiftKey === shortcut.shift &&\n\t\t\t\t( e.key === shortcut.key || e.which === shortcut.which )\n\t\t\t) {\n\t\t\t\tif( target.isActionable() ) {\n\t\t\t\t\tif( shortcut.event != null ) {\n\t\t\t\t\t\ttarget.emit( shortcut.event );\n\t\t\t\t\t} else if( handler != null ) {\n\t\t\t\t\t\thandler( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction, IPoint } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplicationTarget } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\n\nexport type UtilPointerEventClickHandler = ( e: InteractionEvent ) => void;\n\nexport interface UtilPointerEventClickTarget extends DApplicationTarget {\n\ton( name: string, handler: UtilPointerEventClickHandler ): void;\n}\n\nexport class UtilPointerEvent {\n\tstatic CLICK_DISTANCE_THRESHOLD: number = 10;\n\tstatic DBLCLICK_INTERVAL_THRESHOLD: number = 333;\n\tstatic LONG_CLICK_THRESHOLD: number = 750;\n\n\tstatic get touchable(): boolean {\n\t\treturn ( \"ontouchstart\" in document );\n\t}\n\n\tstatic get tap(): string {\n\t\treturn \"pointertap\";\n\t}\n\n\tstatic get down(): string {\n\t\treturn \"pointerdown\";\n\t}\n\n\tstatic get enter(): string {\n\t\treturn \"pointerenter\";\n\t}\n\n\tstatic get leave(): string {\n\t\treturn \"pointerleave\";\n\t}\n\n\tstatic get move(): string {\n\t\treturn \"pointermove\";\n\t}\n\n\tstatic get out(): string {\n\t\treturn \"pointerout\";\n\t}\n\n\tstatic get over(): string {\n\t\treturn \"pointerover\";\n\t}\n\n\tstatic get up(): string {\n\t\treturn \"pointerup\";\n\t}\n\n\tstatic get cancel(): string {\n\t\treturn \"pointercancel\";\n\t}\n\n\tstatic toGlobal(\n\t\te: MouseEvent | TouchEvent,\n\t\tinteractionManager: interaction.InteractionManager,\n\t\tresult: IPoint\n\t): IPoint {\n\t\tif( \"touches\" in e ) {\n\t\t\tconst touches = e.changedTouches;\n\t\t\tconst touch = touches[ touches.length - 1 ];\n\t\t\tif( touch != null ) {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, touch.clientX, touch.clientY );\n\t\t\t} else {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, 0, 0 );\n\t\t\t}\n\t\t} else {\n\t\t\tinteractionManager.mapPositionToPoint( result, e.clientX, e.clientY );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic onClick( target: UtilPointerEventClickTarget, handler: UtilPointerEventClickHandler ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", handler );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet interactionManagerBound: interaction.InteractionManager | null = null;\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst isValidDistance = ( e: InteractionEvent ): boolean => {\n\t\t\t\tconst global = e.data.global;\n\t\t\t\tconst dx = Math.abs( downX - global.x );\n\t\t\t\tconst dy = Math.abs( downY - global.y );\n\t\t\t\tconst threshold = this.CLICK_DISTANCE_THRESHOLD;\n\t\t\t\treturn ( dx <= threshold && dy <= threshold );\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\thandler( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( isValidDistance( e ) ) {\n\t\t\t\t\t\t\thandler( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t} else {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t\t}\n\t\t\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\t\t\tif( layer ) {\n\t\t\t\t\t\tinteractionManagerBound = layer.renderer.plugins.interaction;\n\t\t\t\t\t\tinteractionManagerBound.once( up, onUp );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onLongClick(\n\t\ttarget: UtilPointerEventClickTarget,\n\t\tonClick: UtilPointerEventClickHandler,\n\t\tonLongClick: UtilPointerEventClickHandler\n\t): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", onClick );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet timeoutId: number | null = null;\n\t\t\tlet interactionManagerBound: interaction.InteractionManager | null = null;\n\t\t\tconst cleanupTimeout = (): void => {\n\t\t\t\tif( timeoutId != null ) {\n\t\t\t\t\tclearTimeout( timeoutId );\n\t\t\t\t\ttimeoutId = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\tinteractionManagerBound.off( move, onMove );\n\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t}\n\t\t\t\tcleanupTimeout();\n\t\t\t};\n\t\t\tconst isValidDistance = ( e: InteractionEvent ): boolean => {\n\t\t\t\tconst global = e.data.global;\n\t\t\t\tconst dx = Math.abs( downX - global.x );\n\t\t\t\tconst dy = Math.abs( downY - global.y );\n\t\t\t\tconst threshold = this.CLICK_DISTANCE_THRESHOLD;\n\t\t\t\treturn ( dx < threshold && dy < threshold );\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\tonClick( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst move = this.move;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( isValidDistance( e ) ) {\n\t\t\t\t\t\t\tonClick( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onMove = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( ! isValidDistance( e ) ) {\n\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( ! isDowned ) {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tcleanupTimeout();\n\t\t\t\t\tconst oe = e.data.originalEvent;\n\t\t\t\t\tif( \"touches\" in oe ) {\n\t\t\t\t\t\ttimeoutId = window.setTimeout((): void => {\n\t\t\t\t\t\t\tif( isDowned ) {\n\t\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\t\tonLongClick( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this.LONG_CLICK_THRESHOLD );\n\t\t\t\t\t}\n\t\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound.off( move, onMove );\n\t\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t\t}\n\t\t\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\t\t\tif( layer ) {\n\t\t\t\t\t\tinteractionManagerBound = layer.renderer.plugins.interaction;\n\t\t\t\t\t\tinteractionManagerBound.once( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound.on( move, onMove );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onDblClick( target: HTMLElement, handler: ( e: MouseEvent | TouchEvent ) => void ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\t\t} else {\n\t\t\tlet isDowned = 0;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet clickTime = 0;\n\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\n\t\t\ttarget.addEventListener( \"touchend\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 1 || isDowned === 3 ) {\n\t\t\t\t\tconst touches = e.changedTouches;\n\t\t\t\t\tconst touch: Touch | null = touches[ touches.length - 1 ];\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tconst dx = downX - touch.clientX;\n\t\t\t\t\t\tconst dy = downY - touch.clientY;\n\t\t\t\t\t\tif( Math.abs( dx ) + Math.abs( dy ) < this.CLICK_DISTANCE_THRESHOLD ) {\n\t\t\t\t\t\t\tisDowned += 1;\n\t\t\t\t\t\t\tif( isDowned === 4 ) {\n\t\t\t\t\t\t\t\tisDowned = 0;\n\t\t\t\t\t\t\t\tconst elapsedTime = e.timeStamp - clickTime;\n\t\t\t\t\t\t\t\tif( elapsedTime < this.DBLCLICK_INTERVAL_THRESHOLD ) {\n\t\t\t\t\t\t\t\t\thandler( e );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t\t\tisDowned = 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\n\t\t\ttarget.addEventListener( \"touchstart\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 0 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 1;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if( isDowned === 2 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 3;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic contains( target: unknown, targetOrChild: DisplayObject | null ): boolean {\n\t\tlet current = targetOrChild;\n\t\twhile( current != null && current !== target ) {\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn current === target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignWith {\n\tTEXT,\n\tPADDING,\n\tBORDER\n}\n","import { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextMeasureResultCharacter {\n\tx: number;\n\ty: number;\n\tcharacter: DynamicFontAtlasCharacter;\n\n\tconstructor( x: number, y: number, character: DynamicFontAtlasCharacter ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.character = character;\n\t}\n\n\tset( x: number, y: number, character: DynamicFontAtlasCharacter ): void {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.character = character;\n\t}\n}\n","import { DDynamicTextMeasureResultCharacter } from \"./d-dynamic-text-measure-result-character\";\nimport { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextMeasureResult {\n\tcount: number;\n\twidth: number;\n\theight: number;\n\tcharacters: DDynamicTextMeasureResultCharacter[];\n\tclipped: boolean;\n\n\tx: number;\n\ty: number;\n\n\tconstructor() {\n\t\tthis.count = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.characters = [];\n\t\tthis.clipped = false;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tstart(): void {\n\t\tthis.count = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.clipped = false;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tpush( character: DynamicFontAtlasCharacter ): void {\n\t\tconst x = this.x;\n\t\tthis.x += character.advance;\n\t\tconst y = this.y;\n\t\tconst count = this.count;\n\t\tconst characters = this.characters;\n\t\tif( count < characters.length ) {\n\t\t\tcharacters[ count ].set( x, y, character );\n\t\t} else {\n\t\t\tcharacters.push( new DDynamicTextMeasureResultCharacter( x, y, character ) );\n\t\t}\n\t\tthis.count += 1;\n\t}\n\n\tnewLine( lineHeight: number ): void {\n\t\tthis.width = Math.max( this.width, this.x );\n\t\tthis.x = 0;\n\t\tthis.y += lineHeight;\n\t}\n\n\tpop(): boolean {\n\t\tif( 0 < this.x ) {\n\t\t\tconst count = this.count;\n\t\t\tconst characters = this.characters;\n\t\t\tif( 0 < count ) {\n\t\t\t\tconst character = characters[ count - 1 ];\n\t\t\t\tthis.x -= character.character.advance;\n\t\t\t\tthis.count -= 1;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tend( lineHeight: number ): void {\n\t\tthis.newLine( lineHeight );\n\t\tthis.height = this.y;\n\t}\n}\n","\nexport class UtilCharacterIterator {\n\tprotected static _instance: UtilCharacterIterator | null = null;\n\tprotected _target: string;\n\tprotected _position: number;\n\n\tconstructor() {\n\t\tthis._target = \"\";\n\t\tthis._position = 0;\n\t}\n\n\tget position(): number {\n\t\treturn this._position;\n\t}\n\n\tset position( position: number ) {\n\t\tthis._position = position;\n\t}\n\n\tinit( target: string ): void {\n\t\tthis._target = target;\n\t\tthis._position = 0;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._position < this._target.length;\n\t}\n\n\tprotected findNextBreak( target: string, istart: number ): number {\n\t\tconst iend = target.length;\n\t\tfor( let i = istart; i < iend; ++i ) {\n\t\t\tconst code = target.charCodeAt( i );\n\t\t\tif( ! this.isLowSurrogate( code ) && ! this.isVariationSelector( code ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn iend;\n\t}\n\n\tprotected isHighSurrogate( code: number ): boolean {\n\t\treturn ( 0xd800 <= code && code <= 0xdbff );\n\t}\n\n\tprotected isLowSurrogate( code: number ): boolean {\n\t\treturn ( 0xdc00 <= code && code <= 0xdfff );\n\t}\n\n\tprotected isVariationSelector( code: number ): boolean {\n\t\treturn ( 0xfe00 <= code && code <= 0xfe0f );\n\t}\n\n\tnext(): string {\n\t\tconst target = this._target;\n\t\tconst position = this._position;\n\t\tconst nextBreak = this.findNextBreak( target, position + 1 );\n\t\tconst result = target.substring( position, nextBreak );\n\t\tthis._position = nextBreak;\n\t\treturn result;\n\t}\n\n\t/**\n\t * Advances the position if the next character is not equal to\n\t * the given `except`.\n\t *\n\t * @param except\n\t * @return true if the position is advanced\n\t */\n\tadvance( except?: string ): boolean {\n\t\tconst target = this._target;\n\t\tconst position = this._position;\n\t\tconst nextBreak = this.findNextBreak( target, position + 1 );\n\t\tif( target.substring( position, nextBreak ) !== except ) {\n\t\t\tthis._position = nextBreak;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic from( target: string ): UtilCharacterIterator {\n\t\tif( UtilCharacterIterator._instance == null ) {\n\t\t\tUtilCharacterIterator._instance = new UtilCharacterIterator();\n\t\t}\n\t\tconst instance = UtilCharacterIterator._instance;\n\t\tinstance.init( target );\n\t\treturn instance;\n\t}\n}\n","import { DDynamicTextMeasureResult } from \"./d-dynamic-text-measure-result\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { UtilCharacterIterator } from \"./util/util-character-iterator\";\n\nexport class DDynamicTextMeasure {\n\tprotected static RESULT: DDynamicTextMeasureResult | null = null;\n\n\tstatic measure(\n\t\ttext: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined\n\t): DDynamicTextMeasureResult {\n\t\tconst result = DDynamicTextMeasure.RESULT = DDynamicTextMeasure.RESULT || new DDynamicTextMeasureResult();\n\t\tresult.start();\n\t\tif( atlas != null ) {\n\t\t\tconst iterator = UtilCharacterIterator.from( text );\n\t\t\tconst lineHeight = atlas.font.height;\n\t\t\tconst newLine = \"\\n\";\n\t\t\twhile( iterator.hasNext() ) {\n\t\t\t\tconst character = iterator.next();\n\t\t\t\tif( character === newLine ) {\n\t\t\t\t\tresult.newLine( lineHeight );\n\t\t\t\t} else {\n\t\t\t\t\tconst a = atlas.get( character );\n\t\t\t\t\tif( a != null ) {\n\t\t\t\t\t\tconst x = result.x;\n\t\t\t\t\t\tif( clippingWidth != null && clippingWidth < x + a.advance ) {\n\t\t\t\t\t\t\tresult.clipped = true;\n\t\t\t\t\t\t\tconst dots = atlas.get( \"...\" );\n\t\t\t\t\t\t\tif( dots != null ) {\n\t\t\t\t\t\t\t\tif( clippingWidth < x + dots.advance ) {\n\t\t\t\t\t\t\t\t\tif( result.pop() ) {\n\t\t\t\t\t\t\t\t\t\tresult.push( dots );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tresult.push( dots );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile( iterator.hasNext() ) {\n\t\t\t\t\t\t\t\tif( iterator.next() === newLine ) {\n\t\t\t\t\t\t\t\t\tresult.newLine( lineHeight );\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.push( a );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tresult.end( lineHeight );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MeshGeometry } from \"pixi.js\";\nimport { DDynamicTextMeasure } from \"./d-dynamic-text-measure\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextGeometry extends MeshGeometry {\n\twidth: number;\n\theight: number;\n\tclipped: boolean;\n\n\tconstructor() {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.clipped = false;\n\t}\n\n\tupdate( text: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined ): void {\n\t\tconst vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tconst uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tconst indexBuffer = this.getIndex();\n\n\t\tconst result = DDynamicTextMeasure.measure( text, atlas, clippingWidth );\n\t\tconst requiredTextSize = Math.ceil( result.count / 8 ) << 3;\n\t\tconst requiredVertexSize = requiredTextSize << 3;\n\t\tif( (vertexBuffer.data as Float32Array).length < requiredVertexSize ) {\n\t\t\tvertexBuffer.data = new Float32Array( requiredVertexSize );\n\t\t\tuvBuffer.data = new Float32Array( requiredVertexSize );\n\t\t}\n\t\tconst requiredIndexSize = requiredTextSize * 6;\n\t\tif( (indexBuffer.data as Uint16Array).length < requiredIndexSize ) {\n\t\t\tindexBuffer.data = new Uint16Array( requiredIndexSize );\n\t\t}\n\n\t\tconst vertices = vertexBuffer.data as Float32Array;\n\t\tconst uvs = uvBuffer.data as Float32Array;\n\t\tconst indices = indexBuffer.data as Uint16Array;\n\n\t\tif( atlas != null ) {\n\t\t\tconst count = result.count;\n\t\t\tconst characters = result.characters;\n\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\tconst character = characters[ i ];\n\t\t\t\tthis.writeCharacter(\n\t\t\t\t\tvertices, uvs, indices,\n\t\t\t\t\ti, character.x, character.y,\n\t\t\t\t\tcharacter.character, atlas.width, atlas.height\n\t\t\t\t);\n\t\t\t}\n\t\t\tfor( let i = count, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = result.width;\n\t\t\tthis.height = result.height;\n\t\t\tthis.clipped = result.clipped;\n\t\t} else {\n\t\t\tfor( let i = 0, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = 0;\n\t\t\tthis.height = 0;\n\t\t\tthis.clipped = false;\n\t\t}\n\n\t\tvertexBuffer.update();\n\t\tuvBuffer.update();\n\t\tindexBuffer.update();\n\t}\n\n\tprotected writeCharacter(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number, x: number, y: number,\n\t\tcharacter: DynamicFontAtlasCharacter,\n\t\twidth: number, height: number\n\t): void {\n\t\tconst offsetX = character.x - character.origin.x;\n\t\tconst offsetY = 0;\n\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = x + offsetX;\n\t\tvertices[ iv + 1 ] = y + offsetY;\n\t\tvertices[ iv + 2 ] = x + offsetX + character.width;\n\t\tvertices[ iv + 3 ] = y + offsetY;\n\t\tvertices[ iv + 4 ] = x + offsetX + character.width;\n\t\tvertices[ iv + 5 ] = y + offsetY + character.height;\n\t\tvertices[ iv + 6 ] = x + offsetX;\n\t\tvertices[ iv + 7 ] = y + offsetY + character.height;\n\n\t\tconst x0 = character.x / width;\n\t\tconst y0 = character.y / height;\n\t\tconst x1 = ( character.x + character.width ) / width;\n\t\tconst y1 = ( character.y + character.height ) / height;\n\t\tuvs[ iv + 0 ] = x0;\n\t\tuvs[ iv + 1 ] = y0;\n\t\tuvs[ iv + 2 ] = x1;\n\t\tuvs[ iv + 3 ] = y0;\n\t\tuvs[ iv + 4 ] = x1;\n\t\tuvs[ iv + 5 ] = y1;\n\t\tuvs[ iv + 6 ] = x0;\n\t\tuvs[ iv + 7 ] = y1;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n\n\tprotected writeCharacterEmpty(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number\n\t): void {\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = 0;\n\t\tvertices[ iv + 1 ] = 0;\n\t\tvertices[ iv + 2 ] = 0;\n\t\tvertices[ iv + 3 ] = 0;\n\t\tvertices[ iv + 4 ] = 0;\n\t\tvertices[ iv + 5 ] = 0;\n\t\tvertices[ iv + 6 ] = 0;\n\t\tvertices[ iv + 7 ] = 0;\n\n\t\tuvs[ iv + 0 ] = 0;\n\t\tuvs[ iv + 1 ] = 0;\n\t\tuvs[ iv + 2 ] = 0;\n\t\tuvs[ iv + 3 ] = 0;\n\t\tuvs[ iv + 4 ] = 0;\n\t\tuvs[ iv + 5 ] = 0;\n\t\tuvs[ iv + 6 ] = 0;\n\t\tuvs[ iv + 7 ] = 0;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DFontStyle, DFontVariant, DFontWeight, DThemeFont } from \"./d-font\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport type DDynamicTextAlign = \"left\" | \"center\" | \"right\";\n\nexport interface DDynamicTextStyleOptions {\n\talign?: DDynamicTextAlign;\n\tfontFamily?: string;\n\tfontSize?: number;\n\tfontStyle?: DFontStyle;\n\tfontVariant?: DFontVariant;\n\tfontWeight?: DFontWeight;\n\tfill?: number;\n\tclipping?: boolean;\n}\n\nexport class DDynamicTextStyle {\n\tprotected static FONT: DThemeFont | null = null;\n\n\tprotected _id: number;\n\tprotected _idApproved: number;\n\tprotected _fontIdId: number;\n\tprotected _fontId: string;\n\tprotected _fontIdApproved: string;\n\tprotected _align: DDynamicTextAlign;\n\tprotected _fontFamily: string;\n\tprotected _fontSize: number;\n\tprotected _fontStyle: DFontStyle;\n\tprotected _fontVariant: DFontVariant;\n\tprotected _fontWeight: DFontWeight;\n\tprotected _fill: number;\n\tprotected _fillApproved: number;\n\tprotected _clipping: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DDynamicTextStyleOptions | undefined, onChange: () => void ) {\n\t\tthis._id = 0;\n\t\tthis._idApproved = -1;\n\n\t\tconst font = DDynamicTextStyle.FONT = (\n\t\t\tDDynamicTextStyle.FONT || DThemes.getInstance().get( \"DBase\" ) as DThemeFont\n\t\t);\n\t\tthis._align = (options && options.align) || \"left\";\n\t\tthis._fontFamily = (options && options.fontFamily) || font.getFontFamilly();\n\t\tthis._fontSize = (options && options.fontSize) || font.getFontSize();\n\t\tthis._fontStyle = (options && options.fontStyle) || \"normal\";\n\t\tthis._fontVariant = (options && options.fontVariant) || \"normal\";\n\t\tthis._fontWeight = (options && options.fontWeight) || \"normal\";\n\n\t\tthis._fontIdId = -1;\n\t\tthis._fontId = \"\";\n\t\tthis._fontIdApproved = \"\";\n\n\t\tthis._fill = (options && options.fill) || font.getColor( 0 );\n\t\tthis._fillApproved = 0x000000;\n\n\t\tthis._clipping = ((options && options.clipping != null) ? options.clipping : true);\n\n\t\tthis._onChange = onChange;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget idApproved(): number {\n\t\treturn this._idApproved;\n\t}\n\n\tget fontId(): string {\n\t\tthis.update();\n\t\treturn this._fontId;\n\t}\n\n\tget fontIdApproved(): string {\n\t\treturn this._fontIdApproved;\n\t}\n\n\tget fill(): number {\n\t\treturn this._fill;\n\t}\n\n\tset fill( fill: number ) {\n\t\tif( this._fill !== fill ) {\n\t\t\tthis._fill = fill;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._id += 1;\n\t\tthis._onChange();\n\t}\n\n\tget fillApproved(): number {\n\t\treturn this._fillApproved;\n\t}\n\n\tapprove(): void {\n\t\tthis.update();\n\t\tthis._idApproved = this._id;\n\t\tthis._fontIdApproved = this._fontId;\n\t\tthis._fillApproved = this._fill;\n\t}\n\n\tget fontFamily(): string {\n\t\treturn this._fontFamily;\n\t}\n\n\tset fontFamily( fontFamily: string ) {\n\t\tif( this._fontFamily !== fontFamily ) {\n\t\t\tthis._fontFamily = fontFamily;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontSize(): number {\n\t\treturn this._fontSize;\n\t}\n\n\tset fontSize( fontSize: number ) {\n\t\tif( this._fontSize !== fontSize ) {\n\t\t\tthis._fontSize = fontSize;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontStyle(): DFontStyle {\n\t\treturn this._fontStyle;\n\t}\n\n\tset fontStyle( fontStyle: DFontStyle ) {\n\t\tif( this._fontStyle !== fontStyle ) {\n\t\t\tthis._fontStyle = fontStyle;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontVariant(): DFontVariant {\n\t\treturn this._fontVariant;\n\t}\n\n\tset fontVariant( fontVariant: DFontVariant ) {\n\t\tif( this._fontVariant !== fontVariant ) {\n\t\t\tthis._fontVariant = fontVariant;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontWeight(): DFontWeight {\n\t\treturn this._fontWeight;\n\t}\n\n\tset fontWeight( fontWeight: DFontWeight ) {\n\t\tif( this._fontWeight !== fontWeight ) {\n\t\t\tthis._fontWeight = fontWeight;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tif( this._fontIdId !== this._id ) {\n\t\t\tthis._fontIdId = this._id;\n\t\t\tthis._fontId = this.newFontId();\n\t\t}\n\t}\n\n\tprotected newFontId(): string {\n\t\treturn `${this._fontStyle} ${this._fontVariant} ${this._fontWeight} ${this._fontSize}px ${this._fontFamily}`;\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DDynamicTextGeometry } from \"./d-dynamic-text-geometry\";\nimport { DDynamicTextStyle, DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\n\nexport class DDynamicText extends Mesh {\n\tprotected _style: DDynamicTextStyle;\n\tprotected _text: string;\n\tprotected _textApproved: string;\n\tprotected _isDirty: boolean;\n\tprotected _isGeometryDirty: boolean;\n\tprotected _atlas: DynamicFontAtlas | null;\n\tprotected _atlasRevisionUpdated: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _clippingWidth: number | undefined;\n\tprotected _clippingWidthDelta: number;\n\n\treadonly geometry!: DDynamicTextGeometry;\n\n\tconstructor( text: string, options?: DDynamicTextStyleOptions ) {\n\t\tsuper( new DDynamicTextGeometry(), new MeshMaterial( Texture.EMPTY ) );\n\n\t\tthis._style = new DDynamicTextStyle( options, (): void => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis._atlas = null;\n\t\t\tthis.update_();\n\t\t});\n\t\tthis._text = text;\n\t\tthis._textApproved = \"\";\n\t\tthis._isDirty = true;\n\t\tthis._isGeometryDirty = true;\n\t\tthis._atlas = null;\n\t\tthis._atlasRevisionUpdated = 0;\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\t\tthis._clippingWidthDelta = 0;\n\t\tthis.update_();\n\t}\n\n\tprotected update_(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst style = this._style;\n\t\t\tif( this._isDirty ) {\n\t\t\t\tthis._isDirty = false;\n\n\t\t\t\tconst text = this._text;\n\t\t\t\tconst textApproved = this._textApproved;\n\t\t\t\tthis._textApproved = text;\n\t\t\t\tconst fontId = style.fontId;\n\t\t\t\tconst fontIdApproved = style.fontIdApproved;\n\t\t\t\tconst fontSize = style.fontSize;\n\t\t\t\tconst fill = style.fill;\n\t\t\t\tconst fillApproved = style.fillApproved;\n\t\t\t\tstyle.approve();\n\n\t\t\t\tconst atlases = layer.getDynamicFontAtlases();\n\t\t\t\tif( text !== textApproved || fontId !== fontIdApproved || fill !== fillApproved ) {\n\t\t\t\t\tatlases.add( fontId, fontSize, fill, text );\n\t\t\t\t\tatlases.remove( fontIdApproved, fillApproved, textApproved );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget text(): string {\n\t\treturn this._text;\n\t}\n\n\tset text( text: string ) {\n\t\tif( this._text !== text ) {\n\t\t\tthis._text = text;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis.update_();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.x ) * this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.update();\n\t\tconst geometryWidth = this.geometry.width;\n\t\tif( +1e-4 < geometryWidth ) {\n\t\t\tconst newScale = width / geometryWidth;\n\t\t\tthis.scale.x = ( 0 <= this.scale.x ? +newScale : -newScale );\n\t\t}\n\t}\n\n\tget height(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.y ) * this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.update();\n\t\tconst geometryHeight = this.geometry.height;\n\t\tif( +1e-4 < geometryHeight ) {\n\t\t\tconst newScale = height / geometryHeight;\n\t\t\tthis.scale.y = ( 0 <= this.scale.y ? +newScale : -newScale );\n\t\t}\n\t}\n\n\tget clipped(): boolean {\n\t\treturn this.geometry.clipped;\n\t}\n\n\tget style(): DDynamicTextStyle {\n\t\treturn this._style;\n\t}\n\n\tupdate(): void {\n\t\tthis.update_();\n\n\t\tlet atlas = this._atlas;\n\t\tif( atlas == null ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst style = this._style;\n\t\t\t\tatlas = layer.getDynamicFontAtlases().get( style.fontId, style.fill );\n\t\t\t\tif( atlas != null ) {\n\t\t\t\t\tthis._atlasRevisionUpdated = atlas.getRevisionUpdate();\n\t\t\t\t\tthis._atlas = atlas;\n\t\t\t\t\tthis.texture = atlas.texture;\n\t\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst revisionUpdate = atlas.getRevisionUpdate();\n\t\t\tif( revisionUpdate !== this._atlasRevisionUpdated ) {\n\t\t\t\tthis._atlasRevisionUpdated = revisionUpdate;\n\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t}\n\t\t}\n\n\t\tconst clippingWidth = this._clippingWidth;\n\t\tconst newClippingWidth = this.getClippingWidth();\n\t\tif( clippingWidth !== newClippingWidth ) {\n\t\t\tthis._clippingWidth = newClippingWidth;\n\t\t\tthis._isGeometryDirty = true;\n\t\t}\n\n\t\tif( this._isGeometryDirty ) {\n\t\t\tthis._isGeometryDirty = false;\n\t\t\tthis.geometry.update( this._text, atlas, newClippingWidth );\n\t\t}\n\t}\n\n\tprotected getClippingWidth(): number | undefined {\n\t\tif( this._style.clipping ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent instanceof DBase ) {\n\t\t\t\treturn parent.width - parent.padding.getLeft() - parent.padding.getRight() - this._clippingWidthDelta;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tsetClippingWidthDelta( width: number ): void {\n\t\tthis._clippingWidthDelta = width;\n\t}\n\n\t_calculateBounds(): void {\n\t\tthis.update();\n\t\tsuper._calculateBounds();\n\t}\n\n\t_render( renderer?: Renderer ): void {\n\t\tthis.update();\n\t\t(super._render as any)( renderer );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DBaseOverflowMaskSimple extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.drawRect( 0, 0, width, height );\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DMenuItemLinkMenuItemId {\n\tOPEN_LINK_IN_NEW_WINDOW,\n\tCOPY_LINK_ADDRESS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Text } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DRefitable, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMaskSimple } from \"./d-base-overflow-mask-simple\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DTextBaseTextAlignOptions {\n\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical;\n\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n}\n\nexport interface DTextBaseTextOptions<VALUE = unknown> {\n\tvalue?: DStateAwareOrValueMightBe<VALUE>;\n\tcolor?: DStateAwareOrValueMightBe<number>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n\tstyle?: DDynamicTextStyleOptions;\n\talign?: DTextBaseTextAlignOptions;\n\tformatter?: ( value: VALUE, caller: any ) => string;\n\tdynamic?: boolean;\n}\n\nexport interface DTextBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase = DThemeTextBase\n> extends DBaseOptions<THEME> {\n\ttext?: DTextBaseTextOptions<VALUE>;\n\tmask?: boolean;\n}\n\nexport interface DThemeTextBase extends DThemeBase {\n\tgetTextFormatter(): ( value: any, caller: any ) => string;\n\tnewTextValue(): any;\n\tgetTextValue( state: DBaseState ): any;\n\tgetTextAlignVertical(): DAlignVertical;\n\tgetTextAlignHorizontal(): DAlignHorizontal;\n\tgetTextStyleClipping(): boolean;\n\tisOverflowMaskEnabled(): boolean;\n\tisTextDynamic(): boolean;\n}\n\n// Option parser\nconst isOverflowMaskEnabled = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n) => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nconst toTextValue = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase,\n\toptions: DTextBaseOptions<VALUE, THEME> | undefined\n): DStateAwareOrValueMightBe<VALUE> => {\n\tif( options && options.text && options.text.value !== undefined ) {\n\t\treturn options.text.value;\n\t}\n\treturn theme.newTextValue();\n};\n\nconst toTextStyle = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options: DTextBaseOptions<VALUE, THEME> | undefined, state: DBaseState\n): DDynamicTextStyleOptions => {\n\tif( options && options.text && options.text.style != null ) {\n\t\tconst style = options.text.style;\n\t\tconst fill = style.fill != null ? style.fill : theme.getColor( state );\n\t\tconst fontSize = style.fontSize != null ? style.fontSize : theme.getFontSize();\n\t\tconst fontFamily = style.fontFamily != null ? style.fontFamily : theme.getFontFamilly();\n\t\tconst fontWeight = style.fontWeight != null ? style.fontWeight : theme.getFontWeight();\n\t\tconst fontStyle = style.fontStyle != null ? style.fontStyle : theme.getFontStyle();\n\t\tconst fontVariant = style.fontVariant != null ? style.fontVariant : theme.getFontVariant();\n\t\tconst clipping = style.clipping != null ? style.clipping : theme.getTextStyleClipping();\n\t\treturn {\n\t\t\tfill,\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\tfontVariant,\n\t\t\tclipping\n\t\t};\n\t}\n\n\treturn {\n\t\tfill: theme.getColor( state ),\n\t\tfontSize: theme.getFontSize(),\n\t\tfontFamily: theme.getFontFamilly(),\n\t\tfontWeight: theme.getFontWeight(),\n\t\tfontStyle: theme.getFontStyle(),\n\t\tfontVariant: theme.getFontVariant(),\n\t\tclipping: theme.getTextStyleClipping()\n\t};\n};\n\nconst toTextAlign = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n): { vertical: DAlignVertical, horizontal: DAlignHorizontal } => {\n\tif( options && options.text && options.text.align ) {\n\t\tconst align = options.text.align;\n\t\tconst vertical = ( align.vertical != null ?\n\t\t\t( isString( align.vertical ) ? DAlignVertical[ align.vertical ] : align.vertical ) :\n\t\t\ttheme.getTextAlignVertical()\n\t\t);\n\t\tconst horizontal = ( align.horizontal != null ?\n\t\t\t( isString( align.horizontal ) ? DAlignHorizontal[ align.horizontal ] : align.horizontal ) :\n\t\t\ttheme.getTextAlignHorizontal()\n\t\t);\n\t\treturn {\n\t\t\tvertical,\n\t\t\thorizontal\n\t\t};\n\t}\n\treturn {\n\t\tvertical: theme.getTextAlignVertical(),\n\t\thorizontal: theme.getTextAlignHorizontal()\n\t};\n};\n\nconst toTextFormatter = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase,\n\toptions: DTextBaseOptions<VALUE, THEME> | undefined\n): ( value: VALUE, caller: any ) => string => {\n\tif( options && options.text && options.text.formatter ) {\n\t\treturn options.text.formatter;\n\t}\n\treturn theme.getTextFormatter();\n};\n\nconst toTextDynamic = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n): boolean => {\n\tif( options && options.text && options.text.dynamic != null ) {\n\t\treturn options.text.dynamic;\n\t}\n\treturn theme.isTextDynamic();\n};\n\nexport class DTextBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase = DThemeTextBase,\n\tOPTIONS extends DTextBaseOptions<VALUE, THEME> = DTextBaseOptions<VALUE, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _text!: DDynamicText | Text | null;\n\tprotected _textValue!: DStateAwareOrValueMightBe<VALUE>;\n\tprotected _textValueComputed!: VALUE;\n\tprotected _textColor!: DStateAwareOrValueMightBe<number>;\n\tprotected _textAlpha!: DStateAwareOrValueMightBe<number>;\n\tprotected _textStyle!: DDynamicTextStyleOptions;\n\tprotected _textAlign!: {\n\t\tvertical: DAlignVertical,\n\t\thorizontal: DAlignHorizontal\n\t};\n\tprotected _textFormatter!: ( value: VALUE, caller: any ) => string;\n\tprotected _isOverflowMaskEnabled!: boolean;\n\tprotected _overflowMask!: DBaseOverflowMaskSimple | null;\n\tprotected _textDynamic!: boolean;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis._text = null;\n\t\tconst theme = this.theme;\n\t\tthis._textValue = toTextValue( theme, options );\n\t\tthis._textValueComputed = this.computeTextValue();\n\t\tthis._textColor = ( options && options.text && options.text.color );\n\t\tthis._textAlpha = ( options && options.text && options.text.alpha );\n\t\tthis._textStyle = toTextStyle( theme, options, this.state );\n\t\tthis._textAlign = toTextAlign( theme, options );\n\t\tthis._textFormatter = toTextFormatter( theme, options );\n\t\tthis._textDynamic = toTextDynamic( theme, options );\n\t\tthis._isOverflowMaskEnabled = isOverflowMaskEnabled( theme, options );\n\t\tthis._overflowMask = null;\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tset text( text: DStateAwareOrValueMightBe<VALUE> ) {\n\t\tif( this._textValue !== text ) {\n\t\t\tthis._textValue = text;\n\t\t\tthis.updateTextValue();\n\t\t}\n\t}\n\n\tget text(): DStateAwareOrValueMightBe<VALUE> {\n\t\treturn this._textValue;\n\t}\n\n\tprotected onTextChange() {\n\t\t// DO NOTHING\n\t}\n\n\tprotected computeTextValue(): VALUE {\n\t\tconst textValue = this._textValue;\n\t\tif( textValue !== undefined ) {\n\t\t\tif( isFunction( textValue ) ) {\n\t\t\t\tconst result = textValue( this.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn textValue;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getTextValue( this.state ) as VALUE;\n\t}\n\n\tprotected createOrUpdateText(): void {\n\t\tconst formatted = this._textFormatter( this._textValueComputed, this );\n\t\tif( this._text == null ) {\n\t\t\tif( 0 < formatted.length ) {\n\t\t\t\tconst text = this.createText( formatted );\n\t\t\t\tthis._text = text;\n\t\t\t\tthis.addChild( text );\n\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\ttext.mask = this.getOrCreateOverflowMask();\n\t\t\t\t}\n\t\t\t\tthis.toDirty();\n\t\t\t\tDApplications.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._text.text = formatted;\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected createText( formatted: string ): Text | DDynamicText {\n\t\treturn ( this._textDynamic ?\n\t\t\tnew DDynamicText( formatted, this._textStyle ) :\n\t\t\tnew Text( formatted, this._textStyle )\n\t\t);\n\t}\n\n\tprotected getOrCreateOverflowMask(): Graphics {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMaskSimple( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tprotected updateTextPosition( text: DDynamicText | Text ): void {\n\t\tconst align = this._textAlign;\n\t\tconst padding = this._padding;\n\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\ttext.x = this.toRounded( ( this.width - text.width ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() );\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\ttext.y = this.toRounded( ( this.height - text.height ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected toRounded( value: number ): number {\n\t\treturn Math.round( value );\n\t}\n\n\tprotected getTextColor( theme: THEME, state: DBaseState ): number {\n\t\tconst color = this._textColor;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn theme.getColor( state );\n\t}\n\n\tprotected getTextAlpha( theme: THEME, state: DBaseState ): number {\n\t\tconst alpha = this._textAlpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn theme.getAlpha( state );\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tconst theme = this.theme;\n\t\tconst state = this.state;\n\t\ttext.style.fill = this.getTextColor( theme, state );\n\t\ttext.alpha = this.getTextAlpha( theme, state );\n\t}\n\n\tprotected updateTextValue(): void {\n\t\tconst newTextValueComputed = this.computeTextValue();\n\t\tif( this._textValueComputed !== newTextValueComputed ) {\n\t\t\tthis._textValueComputed = newTextValueComputed;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis.updateTextValue();\n\t\t\tthis.updateTextPosition( text );\n\t\t\tthis.updateTextColor( text );\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tsuper.onReflow();\n\t\tthis.updateText();\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn super.isRefitable( target ) ||\n\t\t\t(target != null && target === this._text);\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst text = this._text;\n\t\tif( this._title.length <= 0 && text && (\"clipped\" in text) && text.clipped ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = text.text;\n\t\t\t}\n\t\t} else {\n\t\t\tsuper.applyTitle();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTextBase\";\n\t}\n\n\tdestroy(): void {\n\t\t// Text\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis._text = null;\n\t\t\ttext.destroy();\n\t\t}\n\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Point, Rectangle, Sprite, Text, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DRefitable } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DImageBaseTintOptions {\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n}\n\nexport interface DImageBaseAlignOptions {\n\twith?: (keyof typeof DAlignWith) | DAlignWith;\n\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical;\n\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n}\n\nexport interface DImageBaseMarginOptions {\n\tvertical?: number;\n\thorizontal?: number;\n}\n\nexport interface DImageBaseImageOptions {\n\tsource?: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\ttint?: DImageBaseTintOptions;\n\talign?: DImageBaseAlignOptions;\n\tmargin?: DImageBaseMarginOptions;\n}\n\nexport interface DImageBaseOptions<\n\tVALUE,\n\tTHEME extends DThemeImageBase = DThemeImageBase\n> extends DTextBaseOptions<VALUE, THEME> {\n\timage?: DImageBaseImageOptions;\n}\n\nexport interface DThemeImageBase extends DThemeTextBase {\n\tgetImageAlignHorizontal(): DAlignHorizontal;\n\tgetImageAlignVertical(): DAlignVertical;\n\tgetImageAlignWith(): DAlignWith;\n\tgetImageMarginHorizontal(): number;\n\tgetImageMarginVertial(): number;\n\tgetImageTintColor( state: DBaseState ): number | null;\n\tgetImageTintAlpha( state: DBaseState ): number;\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null;\n}\n\n// Option parser\nconst toImageAlign = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n) => {\n\tif( options != null && options.image != null && options.image.align != null ) {\n\t\tconst align = options.image.align;\n\t\tconst alignWith: DAlignWith = ( align.with != null ?\n\t\t\t( isString( align.with ) ? DAlignWith[ align.with ] : align.with ) :\n\t\t\ttheme.getImageAlignWith()\n\t\t);\n\t\tconst alignVertical: DAlignVertical = ( align.vertical != null ?\n\t\t\t( isString( align.vertical ) ? DAlignVertical[ align.vertical ] : align.vertical ) :\n\t\t\ttheme.getImageAlignVertical()\n\t\t);\n\t\tconst alignHorizontal: DAlignHorizontal = ( align.horizontal != null ?\n\t\t\t( isString( align.horizontal ) ? DAlignHorizontal[ align.horizontal ] : align.horizontal ) :\n\t\t\ttheme.getImageAlignHorizontal()\n\t\t);\n\t\treturn {\n\t\t\twith: alignWith,\n\t\t\tvertical: alignVertical,\n\t\t\thorizontal: alignHorizontal\n\t\t};\n\t}\n\treturn {\n\t\twith: theme.getImageAlignWith(),\n\t\tvertical: theme.getImageAlignVertical(),\n\t\thorizontal: theme.getImageAlignHorizontal()\n\t};\n};\n\nconst toImageMargin = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n) => {\n\tif( options != null && options.image != null && options.image.margin != null ) {\n\t\tconst margin = options.image.margin;\n\t\tconst vertical = ( margin.vertical != null ? margin.vertical : theme.getImageMarginVertial() );\n\t\tconst horizontal = ( margin.horizontal != null ? margin.horizontal : theme.getImageMarginHorizontal() );\n\t\treturn {\n\t\t\tvertical,\n\t\t\thorizontal\n\t\t};\n\t}\n\treturn {\n\t\tvertical: theme.getImageMarginVertial(),\n\t\thorizontal: theme.getImageMarginHorizontal()\n\t};\n};\n\nconst toImageTint = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n): DImageBaseTintOptions | undefined => {\n\tif( options != null && options.image != null && options.image.tint != null ) {\n\t\treturn options.image.tint;\n\t}\n\treturn undefined;\n};\n\nexport class DImageBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeImageBase = DThemeImageBase,\n\tOPTIONS extends DImageBaseOptions<VALUE, THEME> = DImageBaseOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected _image!: DisplayObject | null;\n\tprotected _imageSourceComputed!: Texture | DisplayObject | null;\n\tprotected _imageSource!: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\tprotected _imageAlign!: {\n\t\twith: DAlignWith,\n\t\tvertical: DAlignVertical,\n\t\thorizontal: DAlignHorizontal\n\t};\n\tprotected _imageMargin!: {\n\t\tvertical: number,\n\t\thorizontal: number\n\t};\n\tprotected _imageTint!: DImageBaseTintOptions | undefined;\n\tprotected _imageBound!: Rectangle;\n\tprotected _imageBoundPoint!: Point;\n\tprotected _onImageChangeBound!: () => void;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._image = null;\n\t\tconst theme = this.theme;\n\t\tthis._imageAlign = toImageAlign( theme, options );\n\t\tthis._imageMargin = toImageMargin( theme, options );\n\t\tthis._imageTint = toImageTint( theme, options );\n\t\tthis._imageBound = new Rectangle();\n\t\tthis._imageBoundPoint = new Point();\n\t\tthis._imageSource = ( options && options.image && options.image.source );\n\t\tthis._imageSourceComputed = null;\n\t\tthis._onImageChangeBound = () => {\n\t\t\tthis.onImageChange();\n\t\t};\n\t}\n\n\tget image(): DStateAwareOrValueMightBe<Texture | DisplayObject | null> {\n\t\treturn this._imageSource;\n\t}\n\n\tset image( imageSource: DStateAwareOrValueMightBe<Texture | DisplayObject | null> ) {\n\t\tif( this._imageSource !== imageSource ) {\n\t\t\tthis._imageSource = imageSource;\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected computeImageSource(): Texture | DisplayObject | null {\n\t\tconst imageSource = this._imageSource;\n\t\tif( imageSource !== undefined ) {\n\t\t\tif( isFunction( imageSource ) ) {\n\t\t\t\tconst result = imageSource( this.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn imageSource;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getImageSource( this.state );\n\t}\n\n\tprotected onImageChange(): void {\n\t\tthis.toDirty();\n\t\tDApplications.update( this );\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tconst image = this._image;\n\t\tif( image != null ) {\n\t\t\tthis.updateImageTint( image );\n\t\t}\n\t}\n\n\tprotected getImageRect( image: DisplayObject ): Rectangle {\n\t\timage.updateTransform();\n\t\tconst bounds = image.getLocalBounds( this._imageBound );\n\t\tconst point = this._imageBoundPoint;\n\t\tpoint.set( bounds.left, bounds.top );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x0 = point.x;\n\t\tconst y0 = point.y;\n\t\tpoint.set( bounds.right, bounds.top );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x1 = point.x;\n\t\tconst y1 = point.y;\n\t\tpoint.set( bounds.right, bounds.bottom );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x2 = point.x;\n\t\tconst y2 = point.y;\n\t\tpoint.set( bounds.left, bounds.bottom );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x3 = point.x;\n\t\tconst y3 = point.y;\n\t\tbounds.x = Math.min( x0, x1, x2, x3 );\n\t\tbounds.y = Math.min( y0, y1, y2, y3 );\n\t\tbounds.width = Math.max( x0, x1, x2, x3 ) - bounds.x;\n\t\tbounds.height = Math.max( y0, y1, y2, y3 ) - bounds.y;\n\t\treturn bounds;\n\t}\n\n\tprotected updateTextAndImagePosition( text: DDynamicText | Text, image: DisplayObject ): void {\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst textAlign = this._textAlign;\n\t\tconst imageAlign = this._imageAlign;\n\t\tconst margin = this._imageMargin;\n\t\tconst padding = this._padding;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst imageWaMH = imageWidth + marginHorizontal;\n\t\tswitch( imageAlign.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( ( this.width - text.width - imageWaMH ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( this.width - text.width - padding.getRight() - imageWaMH );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ttext.x = this.toRounded( image.x + imageWaMH );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t}\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\ttext.x = this.toRounded( ( this.width - text.width ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.x = this.toRounded( text.x + ( text.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( ( this.width - text.width - imageWaMH ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() - imageWaMH );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.x = this.toRounded( text.x + text.width + marginHorizontal );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tconst imageHaMV = imageWidth + marginHorizontal;\n\t\tswitch( imageAlign.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\timage.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\timage.y = this.toRounded( ( this.height - text.height - imageHaMV ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\timage.y = this.toRounded( this.height - text.height - padding.getBottom() - imageHaMV );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ttext.y = this.toRounded( image.y + imageHaMV );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\ttext.y = this.toRounded( ( this.height - text.height ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.y = this.toRounded( text.y + ( text.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\ttext.y = this.toRounded( ( this.height - text.height - imageHaMV ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() - imageHaMV );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.y = this.toRounded( text.y + text.height + marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected updateImagePositionText( image: DisplayObject ): void {\n\t\tconst bounds = this.getImageRect( image );\n\t\timage.x = this.toRounded( ( this.width - bounds.width ) * 0.5 );\n\t\timage.y = this.toRounded( ( this.height - bounds.height ) * 0.5 );\n\t}\n\n\tprotected updateImagePositionPadding( image: DisplayObject ): void {\n\t\tconst margin = this._imageMargin;\n\t\tconst align = this._imageAlign;\n\t\tconst padding = this._padding;\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\timage.x = this.toRounded( padding.getLeft() + marginHorizontal );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\timage.x = this.toRounded( ( this.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\timage.x = this.toRounded( this.width - padding.getRight() - marginHorizontal - imageWidth );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\timage.y = this.toRounded( padding.getTop() + marginVertical );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\timage.y = this.toRounded( ( this.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\timage.y = this.toRounded( this.height - padding.getBottom() - marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected updateImagePositionBorder( image: DisplayObject ): void {\n\t\tconst margin = this._imageMargin;\n\t\tconst align = this._imageAlign;\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\timage.x = this.toRounded( marginHorizontal );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\timage.x = this.toRounded( ( this.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\timage.x = this.toRounded( this.width - marginHorizontal - imageWidth );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\timage.y = this.toRounded( marginVertical );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\timage.y = this.toRounded( ( this.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\timage.y = this.toRounded( this.height - marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected getImageTintColor( theme: THEME, state: DBaseState ): number | null {\n\t\tconst imageTint = this._imageTint;\n\t\tif( imageTint != null ) {\n\t\t\tconst color = imageTint.color;\n\t\t\tif( color !== undefined ) {\n\t\t\t\tif( isFunction( color ) ) {\n\t\t\t\t\tconst result = color( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintColor( state );\n\t}\n\n\tprotected getImageTintAlpha( theme: THEME, state: DBaseState ): number {\n\t\tconst imageTint = this._imageTint;\n\t\tif( imageTint != null ) {\n\t\t\tconst alpha = imageTint.alpha;\n\t\t\tif( alpha !== undefined ) {\n\t\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\t\tconst result = alpha( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn alpha;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintAlpha( state );\n\t}\n\n\tprotected updateImageTint( image: DisplayObject ): void {\n\t\tif( this.isTintAware( image ) ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst state = this.state;\n\t\t\tconst color = this.getImageTintColor( theme, state );\n\t\t\tif( color != null ) {\n\t\t\t\tif( image.tint !== color ) {\n\t\t\t\t\timage.tint = color;\n\t\t\t\t}\n\t\t\t\tconst alpha = this.getImageTintAlpha( theme, state );\n\t\t\t\tif( image.alpha !== alpha ) {\n\t\t\t\t\timage.alpha = alpha;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected isTintAware( target: DisplayObject | null ): target is DisplayObject & { tint: number } {\n\t\treturn ( target != null && \"tint\" in target );\n\t}\n\n\tprotected updateImageSource(): void {\n\t\tconst newImageSourceComputed = this.computeImageSource();\n\t\tconst oldImageSourceComputed = this._imageSourceComputed;\n\t\tif( newImageSourceComputed !== oldImageSourceComputed ) {\n\t\t\tthis._imageSourceComputed = newImageSourceComputed;\n\n\t\t\tconst oldImage = this._image;\n\t\t\tif( newImageSourceComputed instanceof Texture ) {\n\t\t\t\tif( oldImageSourceComputed instanceof Texture ) {\n\t\t\t\t\toldImageSourceComputed.off( \"update\", this._onImageChangeBound );\n\t\t\t\t\tif( oldImage instanceof Sprite ) {\n\t\t\t\t\t\toldImage.texture = newImageSourceComputed;\n\t\t\t\t\t\tnewImageSourceComputed.on( \"update\", this._onImageChangeBound );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newImage = new Sprite( newImageSourceComputed );\n\t\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\t\tnewImage.mask = this.getOrCreateOverflowMask();\n\t\t\t\t\t}\n\t\t\t\t\tnewImageSourceComputed.on( \"update\", this._onImageChangeBound );\n\t\t\t\t\tthis.addChild( newImage );\n\t\t\t\t\tthis._image = newImage;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( oldImageSourceComputed instanceof Texture ) {\n\t\t\t\t\toldImageSourceComputed.off( \"update\", this._onImageChangeBound );\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t\t\toldImage.destroy();\n\t\t\t\t\t}\n\t\t\t\t} else if( oldImage != null ) {\n\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t}\n\n\t\t\t\tif( newImageSourceComputed != null ) {\n\t\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\t\tnewImageSourceComputed.mask = this.getOrCreateOverflowMask();\n\t\t\t\t\t}\n\t\t\t\t\tthis.addChild( newImageSourceComputed );\n\t\t\t\t}\n\t\t\t\tthis._image = newImageSourceComputed;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tthis.updateTextValue();\n\t\tthis.updateImageSource();\n\n\t\tconst text = this._text;\n\t\tconst image = this._image;\n\t\tif( text != null ) {\n\t\t\tif( image != null ) {\n\t\t\t\tconst align = this._imageAlign;\n\t\t\t\tswitch( align.with ) {\n\t\t\t\tcase DAlignWith.TEXT:\n\t\t\t\t\tthis.updateTextAndImagePosition( text, image );\n\t\t\t\t\tbreak;\n\t\t\t\tcase DAlignWith.PADDING:\n\t\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\t\tthis.updateImagePositionPadding( image );\n\t\t\t\t\tbreak;\n\t\t\t\tcase DAlignWith.BORDER:\n\t\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\t\tthis.updateImagePositionBorder( image );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.updateTextColor( text );\n\t\t\t\tthis.updateImageTint( image );\n\t\t\t} else {\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\tthis.updateTextColor( text );\n\t\t\t}\n\t\t} else if( image != null ) {\n\t\t\tconst align = this._imageAlign;\n\t\t\tswitch( align.with ) {\n\t\t\tcase DAlignWith.TEXT:\n\t\t\t\tthis.updateImagePositionText( image );\n\t\t\t\tbreak;\n\t\t\tcase DAlignWith.PADDING:\n\t\t\t\tthis.updateImagePositionPadding( image );\n\t\t\t\tbreak;\n\t\t\tcase DAlignWith.BORDER:\n\t\t\t\tthis.updateImagePositionBorder( image );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.updateImageTint( image );\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn super.isRefitable( target ) ||\n\t\t\t(target != null && target === this._image);\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DImageBase\";\n\t}\n\n\tdestroy(): void {\n\t\t// Image\n\t\tconst image = this._image;\n\t\tif( image != null ) {\n\t\t\tthis._image = null;\n\t\t\tconst imageSourceComputed = this._imageSourceComputed;\n\t\t\tif( imageSourceComputed instanceof Texture ) {\n\t\t\t\timageSourceComputed.off( \"update\", this._onImageChangeBound, this );\n\t\t\t\timage.destroy();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\n\nexport interface DImageOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage = DThemeImage\n> extends DImageBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeImage extends DThemeImageBase {\n\n}\n\nexport class DImage<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage = DThemeImage,\n\tOPTIONS extends DImageOptions<VALUE, THEME> = DImageOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DImage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem\n> extends DImageOptions<string, THEME> {\n\tvalue?: VALUE;\n}\n\nexport interface DThemeListItem extends DThemeImage {\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\n// Option parser\nconst toValue = <VALUE, THEME extends DThemeListItem>( options?: DListItemOptions<VALUE, THEME> ): VALUE | null => {\n\treturn ( options != null && options.value != null ?\n\t\toptions.value : null );\n};\n\nexport interface DListItemSelection {\n\tadd( item: DBase ): void;\n}\n\nexport class DListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem,\n\tOPTIONS extends DListItemOptions<VALUE, THEME> = DListItemOptions<VALUE, THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tprotected _value!: VALUE | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.buttonMode = true;\n\t\tthis._value = toValue( options );\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis._value = value;\n\t}\n\n\tprotected hasSelection( target: any ): target is { selection: DListItemSelection } {\n\t\treturn ( target && target.selection && target.selection.add );\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( this.hasSelection( parent ) ) {\n\t\t\t\treturn parent.selection;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tconst selection = this.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( this );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( this.isActionable() && this.isFocused() && UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onSelect( e );\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tsuper.onStateChange( newState, oldState );\n\t\tthis.buttonMode = DBaseStates.isActionable( newState );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\n\nexport interface DMenuItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItem extends DThemeListItem {\n\n}\n\nexport class DMenuItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem,\n\tOPTIONS extends DMenuItemOptions<VALUE, THEME> = DMenuItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tgetContext(): DMenuContext | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getContext ) {\n\t\t\t\treturn parent.getContext();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getCloseable ) {\n\t\t\t\treturn parent.getCloseable();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Text } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText\n> extends DMenuItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemText extends DThemeMenuItem {\n\tgetShortcutTextMargin(): number;\n}\n\nexport class DMenuItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _shortcutText!: Text | DDynamicText | null;\n\tprotected _shortcutMargin!: number;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.initOnClick( options );\n\t\tthis.initOnOver( options );\n\t\tthis.initShortcuts( options );\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initOnOver( options?: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tconst context = this.getContext();\n\t\t\tif( context != null ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent instanceof DBase ) {\n\t\t\t\t\tcontext.trim( this.getCloseable() );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initShortcuts( options?: OPTIONS ): void {\n\t\tconst shortcuts = this._shortcuts;\n\t\tthis._shortcutMargin = this.theme.getShortcutTextMargin();\n\t\tif( shortcuts != null && 0 < shortcuts.length ) {\n\t\t\tconst shortcut = shortcuts[ 0 ];\n\t\t\tconst shortcutTextValue = UtilKeyboardEvent.toString( shortcut );\n\t\t\tthis._shortcutText = ( this._textDynamic ?\n\t\t\t\tnew DDynamicText( shortcutTextValue, this._textStyle ) :\n\t\t\t\tnew Text( shortcutTextValue, this._textStyle )\n\t\t\t);\n\t\t\tthis.appendRenderable( this._shortcutText, true );\n\t\t} else {\n\t\t\tthis._shortcutText = null;\n\t\t}\n\t}\n\n\tprotected updateShortcutText(): void {\n\t\tconst text = this._shortcutText;\n\t\tif( text != null ) {\n\t\t\ttext.position.set(\n\t\t\t\tthis.toRounded( this.width - this._shortcutMargin - text.width ),\n\t\t\t\tthis.toRounded( ( this.height - text.height ) * 0.5 )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tsuper.updateTextColor( text );\n\n\t\tconst shortcutText = this._shortcutText;\n\t\tif( shortcutText != null ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst state = this.state;\n\t\t\tshortcutText.style.fill = theme.getColor( state );\n\t\t\tshortcutText.alpha = theme.getAlpha( state );\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tsuper.updateText();\n\t\tthis.updateShortcutText();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemText\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tconst closeable = this.getCloseable();\n\t\tif( closeable != null ) {\n\t\t\tcloseable.emit( \"select\", this.value, this, closeable );\n\t\t}\n\n\t\tsuper.onSelect( e );\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport interface DMenuItemCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\tcheck: boolean;\n}\n\nexport interface DThemeMenuItemCheck extends DThemeMenuItemText {\n\n}\n\nexport class DMenuItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tif( options && options.check ) {\n\t\t\tthis.setActive( true );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemCheck\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.setActive( ! this.isActive() );\n\t\tsuper.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemCheckOptions<VALUE> {\n\t\treturn \"check\" in options;\n\t}\n}\n","import { DBaseState } from \"./d-base-state\";\n\nexport const DMenuItemLinkState = {\n\tNEW_WINDOW: DBaseState.CUSTOM\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DMenuItemLinkTarget {\n\tAUTO,\n\tTHIS_WINDOW,\n\tNEW_WINDOW\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport type DMenuItemCreator = ( options: DMenuItemOptionsUnion<any>, sticky: boolean ) => DisplayObject | null;\n\nexport type DMenuMenuCreator = ( options?: DMenuOptions ) => DMenu<any>;\n\nexport class DMenus {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\tprotected static MENU_CREATOR?: DMenuMenuCreator;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic setMenuCreator( creator: DMenuMenuCreator ): void {\n\t\tthis.MENU_CREATOR = creator;\n\t}\n\n\tstatic newItemOf<VALUE>(\n\t\tcreators: DMenuItemCreator[],\n\t\tcreatorDefault: DMenuItemCreator | null,\n\t\toptions: DMenuItemOptionsUnion<VALUE>,\n\t\tsticky: boolean\n\t): DisplayObject | null {\n\t\tfor( let i = 0, imax = creators.length; i < imax; ++i ) {\n\t\t\tconst created = creators[ i ]( options, sticky );\n\t\t\tif( created != null ) {\n\t\t\t\treturn created;\n\t\t\t}\n\t\t}\n\t\tif( creatorDefault ) {\n\t\t\treturn creatorDefault( options, sticky );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn this.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky );\n\t}\n\n\tstatic newItemsOf<VALUE>(\n\t\tcreator: { newItem( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null },\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DisplayObject ) {\n\t\t\t\tparent.addChild( item );\n\t\t\t} else {\n\t\t\t\tconst created = creator.newItem( item, sticky );\n\t\t\t\tif( created != null ) {\n\t\t\t\t\tparent.addChild( created );\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error( `No matching menu item creator found: ${JSON.stringify( item )}` );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tthis.newItemsOf( this, parent, items, sticky );\n\t}\n\n\tstatic newMenu<VALUE>( options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\tif( this.MENU_CREATOR != null ) {\n\t\t\treturn this.MENU_CREATOR( options );\n\t\t} else {\n\t\t\tthrow new Error( \"Missing DMenu creator.\" );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Rectangle } from \"pixi.js\";\n\nexport interface UtilAttachTarget {\n\treadonly width: number;\n\treadonly height: number;\n\treadonly position: IPoint;\n}\n\nexport enum UtilAttachAlign {\n\tTOP,\n\tLEFT,\n\tRIGHT,\n\tBOTTOM\n}\n\nexport class UtilAttach {\n\tstatic attach(\n\t\ttarget: UtilAttachTarget,\n\t\tbounds: Rectangle,\n\t\toffsetX: number, offsetY: number,\n\t\tclippingWidth: number, clippingHeight: number,\n\t\talign: UtilAttachAlign\n\t): void {\n\t\tconst width = target.width;\n\t\tconst height = target.height;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\t\tswitch( align ) {\n\t\tcase UtilAttachAlign.LEFT:\n\t\t\tx = bounds.left - width - offsetX;\n\t\t\tif( x < 0 ) {\n\t\t\t\tx = bounds.right + offsetX;\n\t\t\t\tif( clippingWidth < x + width ) {\n\t\t\t\t\tx = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\ty = this.adjust( bounds.top, height, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP:\n\t\t\tx = this.adjust( bounds.left, width, clippingWidth );\n\t\t\ty = bounds.top - height - offsetY;\n\t\t\tif( y < 0 ) {\n\t\t\t\ty = bounds.bottom + offsetY;\n\t\t\t\tif( clippingHeight < y + height ) {\n\t\t\t\t\ty = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.RIGHT:\n\t\t\tx = bounds.right + offsetX;\n\t\t\tif( clippingWidth < x + width ) {\n\t\t\t\tx = bounds.left - width - offsetX;\n\t\t\t\tif( x < 0 ) {\n\t\t\t\t\tx = clippingWidth - width;\n\t\t\t\t}\n\t\t\t}\n\t\t\ty = this.adjust( bounds.top, height, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.BOTTOM:\n\t\t\tx = this.adjust( bounds.left, width, clippingWidth );\n\t\t\ty = bounds.bottom + offsetY;\n\t\t\tif( clippingHeight < y + height ) {\n\t\t\t\ty = bounds.top - height - offsetY;\n\t\t\t\tif( y < 0 ) {\n\t\t\t\t\ty = clippingHeight - height;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\ttarget.position.set( x, y );\n\t}\n\n\tstatic adjust( position: number, size: number, clippingSize: number ): number {\n\t\tif( position < 0 ) {\n\t\t\tif( clippingSize < position + size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} else if( clippingSize < position + size ) {\n\t\t\tif( clippingSize < size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn clippingSize - size;\n\t\t\t}\n\t\t}\n\t\treturn position;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\nconst getSelection = ( element: Element ): Selection | null => {\n\tconst selection = document.getSelection();\n\tif( selection ) {\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents( element );\n\t\tselection.removeAllRanges();\n\t\tselection.addRange( range );\n\t}\n\treturn selection;\n};\n\nconst toClipboardData = ( e: ClipboardEvent ): DataTransfer => {\n\treturn e.clipboardData || (window as any).clipboardData;\n};\n\nconst copyUsingDiv = ( text: string ): boolean => {\n\tconst div = document.createElement( \"div\" );\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\n\tdiv.textContent = \"Dummy\";\n\tdocument.body.appendChild( div );\n\tconst selection = getSelection( div );\n\tlet result = false;\n\tif( selection ) {\n\t\tconst handler = ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === div ) {\n\t\t\t\tconst clipboardData = toClipboardData( e );\n\t\t\t\tclipboardData.setData( \"text/plain\", text );\n\t\t\t\tresult = ( clipboardData.getData( \"text/plain\" ) === text );\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener( \"copy\", handler );\n\t\ttry {\n\t\t\tdocument.execCommand( \"copy\" );\n\t\t} finally {\n\t\t\tdocument.removeEventListener( \"copy\", handler );\n\t\t}\n\t\tselection.removeAllRanges();\n\t}\n\tdocument.body.removeChild( div );\n\treturn result;\n};\n\nconst copyUsingSpan = ( text: string ): boolean => {\n\tconst div = document.createElement( \"div\" );\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\n\tconst span = document.createElement( \"span\" );\n\tspan.innerText = text;\n\tconst root: Node = ( div.attachShadow ? div.attachShadow({ mode: \"open\" }) : div );\n\troot.appendChild( span );\n\tdocument.body.appendChild( div );\n\tlet result = false;\n\tconst selection = getSelection( div );\n\tif( selection ) {\n\t\tresult = document.execCommand( \"copy\" );\n\t\tselection.removeAllRanges();\n\t}\n\tdocument.body.removeChild( div );\n\treturn result;\n};\n\nconst copyUsingWindow = ( window: Window, text: string ): boolean => {\n\tif( typeof ClipboardEvent === \"undefined\" ) {\n\t\tconst clipboardData = (window as any).clipboardData;\n\t\tif( typeof clipboardData !== \"undefined\" && typeof clipboardData.setData !== \"undefined\" ) {\n\t\t\tclipboardData.setData( \"Text\", text );\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nexport class UtilClipboard extends utils.EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\n\t\tconst element = document.body;\n\t\telement.addEventListener( \"copy\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"copy\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"cut\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"cut\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"paste\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"paste\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic copy( text: string ): void {\n\t\tconst clipboard = navigator.clipboard;\n\t\tif( clipboard && clipboard.writeText ) {\n\t\t\tclipboard.writeText( text );\n\t\t} else {\n\t\t\tif( ! copyUsingWindow( window, text ) ) {\n\t\t\t\tif( ! copyUsingDiv( text ) ) {\n\t\t\t\t\tif( navigator.userAgent.indexOf( \"Edge\" ) < 0 ) {\n\t\t\t\t\t\tcopyUsingSpan( text );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemLinkMenuItemId } from \"./d-menu-item-link-menu-item-id\";\nimport { DMenuItemLinkState } from \"./d-menu-item-link-state\";\nimport { DMenuItemLinkTarget } from \"./d-menu-item-link-target\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\nimport { DMenus } from \"./d-menus\";\nimport { isString } from \"./util/is-string\";\nimport { UtilClipboard } from \"./util/util-clipboard\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport type DMenuItemLinkLinkMaker = ( item: DMenuItemLink ) => string | null | Promise<string | null>;\nexport type DMenuItemLinkChecker = ( item: DMenuItemLink ) => boolean | Promise<boolean>;\n\nexport interface DMenuItemLinkOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\tlink: string | DMenuItemLinkLinkMaker;\n\ttarget?: DMenuItemLinkTarget;\n\tchecker?: DMenuItemLinkChecker;\n\tmenu?: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>;\n}\n\nexport interface DThemeMenuItemLink extends DThemeMenuItemText {\n\tgetMenuOptions(): DMenuOptions<DMenuItemLinkMenuItemId>;\n}\n\nexport class DMenuItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected _link: string | DMenuItemLinkLinkMaker;\n\tprotected _target?: DMenuItemLinkTarget;\n\tprotected _checker?: DMenuItemLinkChecker;\n\tprotected _menu?: DMenu<DMenuItemLinkMenuItemId>;\n\tprotected _menuOptions?: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._link = options.link;\n\t\tthis._target = options.target;\n\t\tthis._checker = options.checker;\n\t\tthis._menuOptions = options.menu;\n\t}\n\n\tprotected init( options: OPTIONS ): void {\n\t\tif( options.target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\toptions.state = ( options.state || DBaseState.NONE ) || DMenuItemLinkState.NEW_WINDOW;\n\t\t}\n\t\tsuper.init( options );\n\t}\n\n\tget link(): string | null | Promise<string | null> {\n\t\tconst link = this._link;\n\t\tif( isString( link ) || link == null ) {\n\t\t\treturn link;\n\t\t} else {\n\t\t\treturn link( this );\n\t\t}\n\t}\n\n\tget menu(): DMenu<DMenuItemLinkMenuItemId> {\n\t\tlet menu = this._menu;\n\t\tif( menu == null ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst options = this._menuOptions || theme.getMenuOptions();\n\t\t\tmenu = this.toMenu( options );\n\t\t\tthis._menu = menu;\n\t\t\tmenu.on( \"select\", (\n\t\t\t\tvalue: DMenuItemLinkMenuItemId,\n\t\t\t\titem: DMenuItem<DMenuItemLinkMenuItemId>,\n\t\t\t\tcloseable: Closeable\n\t\t\t): void => {\n\t\t\t\tthis.onMenuSelect( value, item, closeable );\n\t\t\t});\n\t\t}\n\t\treturn menu;\n\t}\n\n\tprotected toMenu(\n\t\toptions: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>\n\t): DMenu<DMenuItemLinkMenuItemId> {\n\t\tif( options instanceof DisplayObject ) {\n\t\t\treturn options;\n\t\t}\n\t\treturn this.newMenu( options );\n\t}\n\n\tprotected newMenu( options: DMenuOptions<DMenuItemLinkMenuItemId> ): DMenu<DMenuItemLinkMenuItemId> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tprotected onMenuSelect(\n\t\tvalue: DMenuItemLinkMenuItemId,\n\t\titem: DMenuItem<DMenuItemLinkMenuItemId>,\n\t\tcloseable: Closeable\n\t): void {\n\t\tswitch( value ) {\n\t\tcase DMenuItemLinkMenuItemId.OPEN_LINK_IN_NEW_WINDOW:\n\t\t\tthis.open( true );\n\t\t\tbreak;\n\t\tcase DMenuItemLinkMenuItemId.COPY_LINK_ADDRESS:\n\t\t\tconst link = this.link;\n\t\t\tif( link != null ) {\n\t\t\t\tif( isString( link ) ) {\n\t\t\t\t\tthis.copy( link );\n\t\t\t\t} else {\n\t\t\t\t\tlink.then(( resolved: string | null ): void => {\n\t\t\t\t\t\tif( resolved != null ) {\n\t\t\t\t\t\t\tthis.copy( resolved );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected copy( link: string ): void {\n\t\tconst a = document.createElement( \"a\" );\n\t\ta.href = link;\n\t\tUtilClipboard.copy( a.href );\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tconst onClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t};\n\t\tconst onLongClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tconst menu = this.menu;\n\t\t\t\tif( menu.isHidden() ) {\n\t\t\t\t\tmenu.open( this );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst target = options && options.target;\n\t\tif( target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\tUtilPointerEvent.onClick( this, onClick );\n\t\t} else {\n\t\t\tUtilPointerEvent.onLongClick( this, onClick, onLongClick );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemLink\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tsuper.onSelect( e );\n\t\tthis.open( this.inNewWindow( e ) );\n\t}\n\n\topen( inNewWindow: boolean ): void {\n\t\tconst link = this.link;\n\t\tif( link != null ) {\n\t\t\tif( isString( link )  ) {\n\t\t\t\tthis.check( link, inNewWindow );\n\t\t\t} else {\n\t\t\t\tlink.then(( resolved: string | null ): void => {\n\t\t\t\t\tif( resolved ) {\n\t\t\t\t\t\tthis.check( resolved, inNewWindow );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected check( link: string, inNewWindow: boolean ): void {\n\t\tconst checker = this._checker;\n\t\tif( checker ) {\n\t\t\tconst checked = checker( this );\n\t\t\tif( checked === true ) {\n\t\t\t\tthis.exec( link, inNewWindow );\n\t\t\t} else if( checked === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tchecked.then(( resolved: boolean ): void => {\n\t\t\t\t\tif( resolved ) {\n\t\t\t\t\t\tthis.exec( link, inNewWindow );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tthis.exec( link, inNewWindow );\n\t\t}\n\t}\n\n\tprotected exec( link: string, inNewWindow: boolean ): void {\n\t\tif( inNewWindow ) {\n\t\t\tconst a = document.createElement( \"a\" );\n\t\t\ta.href = link;\n\t\t\ta.target = \"_blank\";\n\t\t\ta.style.display = \"none\";\n\t\t\ta.rel = \"noopener noreferrer\";\n\t\t\tdocument.body.appendChild( a );\n\t\t\ta.click();\n\t\t\tsetTimeout((): void => {\n\t\t\t\tdocument.body.removeChild( a );\n\t\t\t}, 100);\n\t\t} else {\n\t\t\twindow.location.href = link;\n\t\t}\n\t}\n\n\tprotected inNewWindow( e: KeyboardEvent | interaction.InteractionEvent ): boolean {\n\t\tif( this._target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconst oe = ( e instanceof interaction.InteractionEvent ? e.data.originalEvent : e );\n\t\t\treturn (\n\t\t\t\t( oe.ctrlKey || oe.shiftKey || oe.altKey || oe.metaKey ) ||\n\t\t\t\t( \"button\" in oe && oe.button !== 0 )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemLinkOptions<VALUE> {\n\t\treturn \"link\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLayoutDirection {\n\tVERTICAL,\n\tHORIZONTAL\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAttachAlign } from \"./util/util-attach\";\n\nexport import DMenuAlign = UtilAttachAlign;\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu\n> extends DMenuItemOptions<VALUE, THEME> {\n\tmenu: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuItemMenu extends DThemeMenuItem {\n\n}\n\nexport class DMenuItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tUtilPointerEvent.onClick( this, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.toggle();\n\t\t\t}\n\t\t});\n\n\t\tthis.initHover( options );\n\n\t\tconst menu = this.toMenu( options );\n\t\tthis._menu = menu;\n\t\tmenu.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void => {\n\t\t\tthis.onMenuSelect( value, item, closeable );\n\t\t});\n\t}\n\n\tprotected initHover( options: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected toMenu( options: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options.menu;\n\t\tif( menu instanceof DisplayObject ) {\n\t\t\treturn menu;\n\t\t}\n\t\treturn this.newMenu( menu );\n\t}\n\n\tprotected newMenu( options: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\treturn this._menu;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemMenu\";\n\t}\n\n\topen(): void {\n\t\tconst menu = this._menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\tmenu.open( this, this.getCloseable(), context );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n\n\ttoggle(): void {\n\t\tconst menu = this._menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t} else {\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.open();\n\t\tsuper.onSelect( e );\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void {\n\t\tconst next = this.getCloseable();\n\t\tif( next != null ) {\n\t\t\tnext.emit( \"select\", value, item, closeable );\n\t\t}\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemMenuOptions<VALUE> {\n\t\treturn \"menu\" in options;\n\t}\n\n\tstatic toSubMenuOptions<VALUE>( options: DMenuItemMenuOptions<VALUE>, sticky: boolean ): DMenuItemMenuOptions<VALUE> {\n\t\tconst menu = options.menu;\n\t\tif( ! (menu instanceof DisplayObject) ) {\n\t\t\tif( menu.sticky == null ) {\n\t\t\t\tmenu.sticky = sticky;\n\t\t\t}\n\t\t\tif( menu.align == null ) {\n\t\t\t\tmenu.align = DMenuAlign.RIGHT;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DListItemSeparatorReflowable extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\t\tconst border = base.border;\n\t\tconst borderWidth = border.getWidth( state );\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\tconst padding = base.padding;\n\t\t\tconst middle = height * 0.5;\n\t\t\tthis.clear();\n\t\t\tthis.lineStyle( borderWidth, borderColor, borderAlpha, borderAlign );\n\t\t\tthis.moveTo( padding.getLeft(), middle );\n\t\t\tthis.lineTo( width - padding.getRight(), middle );\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.clear();\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { DListItemSeparatorReflowable } from \"./d-list-item-separator-reflowable\";\n\nexport interface DListItemSeparatorOptions<VALUE, THEME extends DThemeListItemSeparator>\n\textends DListItemOptions<VALUE, THEME> {\n\tseparator?: true;\n}\n\nexport interface DThemeListItemSeparator extends DThemeListItem {\n\n}\n\nexport class DListItemSeparator<\n\tVALUE,\n\tTHEME extends DThemeListItemSeparator = DThemeListItemSeparator,\n\tOPTIONS extends DListItemSeparatorOptions<VALUE, THEME> = DListItemSeparatorOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.interactive = false;\n\t\tthis.buttonMode = false;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DListItemSeparatorReflowable( this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSeparator, DListItemSeparatorOptions, DThemeListItemSeparator } from \"./d-list-item-separator\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSeparatorOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator\n> extends DListItemSeparatorOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemSeparator extends DThemeListItemSeparator {\n\n}\n\nexport class DMenuItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DListItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSeparator\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSeparatorOptions<VALUE> {\n\t\treturn \"separator\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DLayoutSpaceOptions<THEME extends DThemeLayoutSpace = DThemeLayoutSpace> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutSpace extends DThemeBase {\n\n}\n\nexport class DLayoutSpace<\n\tTHEME extends DThemeLayoutSpace = DThemeLayoutSpace,\n\tOPTIONS extends DLayoutSpaceOptions<THEME> = DLayoutSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.visible = false;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayoutSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutSpace, DLayoutSpaceOptions, DThemeLayoutSpace } from \"./d-layout-space\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSpaceOptions<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace\n> extends DLayoutSpaceOptions<THEME> {\n\tspace: true;\n}\n\nexport interface DThemeMenuItemSpace extends DThemeLayoutSpace {\n\n}\n\nexport class DMenuItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DLayoutSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSpace\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSpaceOptions {\n\t\treturn \"space\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuItemText } from \"../d-menu-item-text\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItem = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DLayoutDirection } from \"./d-layout-direction\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DLayoutMargin {\n\thorizontal: number;\n\tvertical: number;\n}\n\nexport interface DLayoutOptions<THEME extends DThemeLayout> extends DBaseOptions<THEME> {\n\tmargin?: number | { horizontal?: number, vertical?: number };\n\tcorner?: number | {\n\t\tradius?: number;\n\t\tmask?: DCornerMask;\n\t\tadjust?: boolean\n\t};\n\trow?: number;\n\tcolumn?: number;\n\tdirection?: (keyof typeof DLayoutDirection) | DLayoutDirection;\n\treverse?: boolean;\n}\n\nexport interface DThemeLayout extends DThemeBase {\n\tgetMargin(): number;\n\tgetDirection(): DLayoutDirection;\n\tgetCornerAdjust(): boolean;\n\tgetMultiplicity(): number;\n\tgetReverse(): boolean;\n}\n\nconst isVisible = ( child: DisplayObject ): child is DBase => {\n\treturn child instanceof DBase && (child.visible || child instanceof DLayoutSpace);\n};\n\nconst toMultiplicity = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): number => {\n\tif( options ) {\n\t\tif( options.row != null ) {\n\t\t\treturn options.row;\n\t\t}\n\t\tif( options.column != null ) {\n\t\t\treturn options.column;\n\t\t}\n\t}\n\treturn theme.getMultiplicity();\n};\n\nconst toMargin = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): DLayoutMargin => {\n\tif( options && options.margin != null ) {\n\t\tconst margin = options.margin;\n\t\tif( isNumber( margin ) ) {\n\t\t\treturn {\n\t\t\t\thorizontal: margin,\n\t\t\t\tvertical: margin\n\t\t\t};\n\t\t} else {\n\t\t\tconst themeMargin = theme.getMargin();\n\t\t\treturn {\n\t\t\t\thorizontal: ( margin.horizontal != null ? margin.horizontal : themeMargin ),\n\t\t\t\tvertical: ( margin.vertical != null ? margin.vertical : themeMargin )\n\t\t\t};\n\t\t}\n\t} else {\n\t\tconst themeMargin = theme.getMargin();\n\t\treturn {\n\t\t\thorizontal: themeMargin,\n\t\t\tvertical: themeMargin\n\t\t};\n\t}\n};\n\nconst toDirection = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): DLayoutDirection => {\n\tif( options && options.direction != null ) {\n\t\tconst direction = options.direction;\n\t\tif( isString( direction ) ) {\n\t\t\treturn DLayoutDirection[ direction ];\n\t\t} else {\n\t\t\treturn direction;\n\t\t}\n\t}\n\treturn theme.getDirection();\n};\n\nconst toCornerAdjust = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): boolean => {\n\tif( options && options.corner != null && ! isNumber( options.corner ) && options.corner.adjust != null ) {\n\t\treturn options.corner.adjust;\n\t}\n\treturn theme.getCornerAdjust();\n};\n\nconst toReverse = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): boolean => {\n\tif( options && options.reverse != null ) {\n\t\treturn options.reverse;\n\t}\n\treturn theme.getReverse();\n};\n\nexport abstract class DLayout<\n\tTHEME extends DThemeLayout,\n\tOPTIONS extends DLayoutOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tstatic CORNER_ADJUST_WORK: Float32Array | null = null;\n\n\tprotected _margin!: DLayoutMargin;\n\tprotected _cornerAdjust!: boolean;\n\tprotected _multiplicity!: number;\n\tprotected _direction!: DLayoutDirection;\n\tprotected _reverse!: boolean;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t\tconst theme = this.theme;\n\t\tthis._margin = toMargin( theme, options );\n\t\tthis._direction = toDirection( theme, options );\n\t\tthis._cornerAdjust = toCornerAdjust( theme, options );\n\t\tthis._multiplicity = toMultiplicity( theme, options );\n\t\tthis._reverse = toReverse( theme, options );\n\t}\n\n\tprotected getWeightTotal() {\n\t\tconst children = this.children;\n\t\tlet result = 0;\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\tlet weight = -1;\n\t\t\tlet j = 0;\n\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\tif( clearType && DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tj -= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\ti += j;\n\t\t\tif( 0 <= weight ) {\n\t\t\t\tresult += weight;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getSpaceLeft( baseSize: number, margin: number ) {\n\t\tconst children = this.children;\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet height = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\theight = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= height;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t} else {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet width = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidth = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= width;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t}\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst children = this.children;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst margin = this._margin;\n\t\tconst marginVertical = margin.vertical;\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst weightTotal = this.getWeightTotal();\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\n\t\tlet cornerAdjustWork = null;\n\t\tif( this._cornerAdjust ) {\n\t\t\tconst requiredSize = 4 + ( children.length << 1 );\n\t\t\tif( DLayout.CORNER_ADJUST_WORK == null || DLayout.CORNER_ADJUST_WORK.length < requiredSize ) {\n\t\t\t\tDLayout.CORNER_ADJUST_WORK = new Float32Array( requiredSize );\n\t\t\t}\n\t\t\tcornerAdjustWork = DLayout.CORNER_ADJUST_WORK;\n\t\t\tcornerAdjustWork[ 0 ] = -2;\n\t\t\tcornerAdjustWork[ 1 ] = -2;\n\t\t\tcornerAdjustWork[ requiredSize - 2 ] = -3;\n\t\t\tcornerAdjustWork[ requiredSize - 1 ] = -3;\n\t\t}\n\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet irow = 0;\n\t\t\tlet y = paddingTop - marginVertical;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst baseSize = this.height - paddingTop - paddingBottom;\n\t\t\t\tconst spaceLeft = this.getSpaceLeft( baseSize, marginVertical );\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet icolumn = 0;\n\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst baseSize = this.width - paddingLeft - paddingRight;\n\t\t\t\tconst spaceLeft = this.getSpaceLeft( baseSize, marginHorizontal );\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.onRefit();\n\t}\n\n\tprotected hasClearTypeBefore( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.BEFORE );\n\t}\n\n\tprotected hasClearTypeAfter( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.AFTER );\n\t}\n\n\tprotected hasClearType( children: DisplayObject[], index: number, clearType: DLayoutClearType ): boolean {\n\t\tif( 2 <= index ) {\n\t\t\tconst i = (index - 2) >> 1;\n\t\t\tif( 0 <= i && i < children.length ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\treturn !!( child.getClearType() & clearType );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected findColumnIndexPrevious( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i ] !== icolumn ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findColumnIndexNext( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j ] !== icolumn2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countRow( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 1 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexPrevious( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i + 1 ] !== irow ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexNext( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j + 1 ] !== irow2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countColumn( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 0 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected toCornerMaskColumn( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\tprotected toCornerMaskRow( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\taddSpace( options?: DLayoutSpaceOptions ) {\n\t\treturn this.addChild( new DLayoutSpace( options ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayout\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeType {\n\tCIRCLE,\n\tRECTANGLE,\n\tRECTANGLE_ROUNDED,\n\tTRIANGLE,\n\tTRIANGLE_ROUNDED,\n\tLINE,\n\tIMAGE,\n\tGROUP,\n\tBAR,\n\tLABEL,\n\tNULL,\n\tGROUP_SHADOWED,\n\tLINE_OF_CIRCLES,\n\tLINE_OF_RECTANGLES,\n\tLINE_OF_RECTANGLE_ROUNDEDS,\n\tLINE_OF_TRIANGLES,\n\tLINE_OF_TRIANGLE_ROUNDEDS,\n\tEXTENSION = 1000\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutVerticalOptions<THEME extends DThemeLayout> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutVertical extends DThemeLayout {\n\n}\n\nexport class DLayoutVertical<\n\tTHEME extends DThemeLayoutVertical = DThemeLayoutVertical,\n\tOPTIONS extends DLayoutVerticalOptions<THEME> = DLayoutVerticalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutVertical\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuItemExpandableBodyOptions<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableBody extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandableBody<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody,\n\tOPTIONS extends DMenuItemExpandableBodyOptions<THEME> = DMenuItemExpandableBodyOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableBody\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DListItem, DListItemOptions, DListItemSelection, DThemeListItem } from \"./d-list-item\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableHeader extends DThemeListItem {\n\n}\n\nexport class DMenuItemExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader,\n\tOPTIONS extends DMenuItemExpandableHeaderOptions<VALUE, THEME> = DMenuItemExpandableHeaderOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableHeader\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ) {\n\t\tthis.emit( \"select\", this );\n\t\tsuper.onSelect( e );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuItemExpandableBody, DMenuItemExpandableBodyOptions } from \"./d-menu-item-expandable-body\";\nimport { DMenuItemExpandableHeader, DMenuItemExpandableHeaderOptions } from \"./d-menu-item-expandable-header\";\nimport { DMenuItemExpandables } from \"./d-menu-item-expandables\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemExpandableOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n> extends DLayoutVerticalOptions<THEME> {\n\theader: DisplayObject | DMenuItemExpandableHeaderOptions<VALUE>;\n\tbody?: Container | DMenuItemExpandableBodyOptions;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n}\n\nexport interface DThemeMenuItemExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: DisplayObject;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\tthis.newItems( body, sticky, theme, options );\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.isActive() ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DMenuItemExpandableHeaderOptions<VALUE> ): DisplayObject {\n\t\treturn new DMenuItemExpandableHeader<VALUE>( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options?: OPTIONS ): Container {\n\t\tif( options && options.body ) {\n\t\t\tif( options.body instanceof DisplayObject ) {\n\t\t\t\treturn options.body;\n\t\t\t} else {\n\t\t\t\treturn this.newBody( theme, options.body );\n\t\t\t}\n\t\t}\n\t\treturn this.newBody( theme );\n\t}\n\n\tprotected newBody( theme: THEME, options?: DMenuItemExpandableBodyOptions ): Container {\n\t\treturn new DMenuItemExpandableBody( options );\n\t}\n\n\topen(): void {\n\t\tthis.setActive( true );\n\t}\n\n\tclose(): void {\n\t\tthis.setActive( false );\n\t}\n\n\ttoggle(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( DBaseStates.isActive( newState ) ) {\n\t\t\tif( ! DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandable\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemExpandableOptions<VALUE> {\n\t\treturn \"header\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemExpandableItemCheck } from \"../d-menu-item-expandable-item-check\";\nimport { DMenuItemExpandableItemLink } from \"../d-menu-item-expandable-item-link\";\nimport { DMenuItemExpandableItemSeparator } from \"../d-menu-item-expandable-item-separator\";\nimport { DMenuItemExpandableItemSpace } from \"../d-menu-item-expandable-item-space\";\nimport { DMenuItemExpandableItemText } from \"../d-menu-item-expandable-item-text\";\nimport { DMenuItemExpandables } from \"../d-menu-item-expandables\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItemExpandable = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuSidedItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSelection } from \"./d-list-item\";\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenu } from \"./d-menu\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected initHover( options: OPTIONS ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void {\n\t\tsuper.onMenuSelect( value, item, closeable );\n\t\tconst selection = this.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( item );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSideds {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemCheck } from \"../d-menu-sided-item-check\";\nimport { DMenuSidedItemLink } from \"../d-menu-sided-item-link\";\nimport { DMenuSidedItemMenu } from \"../d-menu-sided-item-menu\";\nimport { DMenuSidedItemSeparator } from \"../d-menu-sided-item-separator\";\nimport { DMenuSidedItemSpace } from \"../d-menu-sided-item-space\";\nimport { DMenuSidedItemText } from \"../d-menu-sided-item-text\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItem = () => {\n\tDMenuSideds.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemText( options );\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSidedItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenuSideds.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DMenuItemExpandable, DMenuItemExpandableOptions, DThemeMenuItemExpandable } from \"./d-menu-item-expandable\";\nimport { DMenuSidedItemExpandables } from \"./d-menu-sided-item-expandables\";\n\nexport class DMenuSidedItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DMenuItemExpandable<VALUE, THEME, OPTIONS> {\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuSidedItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\nimport { DMenuItemExpandableItemCheck } from \"./d-menu-item-expandable-item-check\";\n\nexport class DMenuSidedItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItemExpandableItemMenu } from \"./d-menu-item-expandable-item-menu\";\nimport { DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSeparator } from \"./d-menu-item-expandable-item-separator\";\nimport { DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSpace } from \"./d-menu-item-expandable-item-space\";\nimport { DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemExpandableItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemText } from \"./d-menu-item-expandable-item-text\";\nimport { DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemExpandable } from \"../d-menu-sided-item-expandable\";\nimport { DMenuSidedItemExpandableItemCheck } from \"../d-menu-sided-item-expandable-item-check\";\nimport { DMenuSidedItemExpandableItemLink } from \"../d-menu-sided-item-expandable-item-link\";\nimport { DMenuSidedItemExpandableItemMenu } from \"../d-menu-sided-item-expandable-item-menu\";\nimport { DMenuSidedItemExpandableItemSeparator } from \"../d-menu-sided-item-expandable-item-separator\";\nimport { DMenuSidedItemExpandableItemSpace } from \"../d-menu-sided-item-expandable-item-space\";\nimport { DMenuSidedItemExpandableItemText } from \"../d-menu-sided-item-expandable-item-text\";\nimport { DMenuSidedItemExpandables } from \"../d-menu-sided-item-expandables\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItemExpandable = () => {\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator((\n\t\toptions: DMenuItemOptionsUnion<any>, sticky: boolean\n\t): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadMenuItem } from \"./load-menu-item\";\nimport { loadMenuItemExpandable } from \"./load-menu-item-expandable\";\nimport { loadMenuSidedItem } from \"./load-menu-sided-item\";\nimport { loadMenuSidedItemExpandable } from \"./load-menu-sided-item-expandable\";\n\nexport const loadMenuItemAll = () => {\n\tloadMenuItem();\n\tloadMenuItemExpandable();\n\tloadMenuSidedItem();\n\tloadMenuSidedItemExpandable();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\n\ntype Deserializer = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n) => Promise<EShape> | EShape | null;\n\nexport const EShapeDeserializers: { [ type: number ]: Deserializer | undefined } = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport type EShapeUploadedCreator = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n) => EShapeUploaded | null;\n\nexport const EShapeUploadeds: {\n\t[ type: number ]: EShapeUploadedCreator | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapePointsStyle {\n\tNONE = 0,\n\tCLOSED = 1,\n\tNON_EXPANDING_WIDTH = 2,\n\tNON_SHRINKING_WIDTH = 4,\n\tNON_SCALING_DOT_AND_DASH = 8,\n\tDOTTED = 16,\n\tDOTTED_DENSELY = 32,\n\tDOTTED_LOOSELY = 64,\n\tDASHED = 128,\n\tDASHED_DENSELY = 256,\n\tDASHED_LOOSELY = 512,\n\tDOTTED_MASK = DOTTED | DOTTED_DENSELY | DOTTED_LOOSELY,\n\tDASHED_MASK = DASHED | DASHED_DENSELY | DASHED_LOOSELY,\n\tNON_SOLID_MASK = DOTTED_MASK | DASHED_MASK\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapePointsStyle } from \"./e-shape-points-style\";\n\nexport class EShapePointsStyleUploadeds {\n\tstatic toScaleInvariant( style: EShapePointsStyle ): number {\n\t\tconst nonExpandingWidth = ( style & EShapePointsStyle.NON_EXPANDING_WIDTH ? 1 : 0 );\n\t\tconst nonShrinkingWidth = ( style & EShapePointsStyle.NON_SHRINKING_WIDTH ? 2 : 0 );\n\t\tconst nonScalingDotAndDash = ( style & EShapePointsStyle.NON_SCALING_DOT_AND_DASH ? 4 : 0 );\n\t\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\t\treturn nonExpandingWidth | nonShrinkingWidth | nonScalingDotAndDash;\n\t\t} else {\n\t\t\treturn nonExpandingWidth | nonShrinkingWidth;\n\t\t}\n\t}\n\n\tstatic toDash(\n\t\tlength: number, strokeWidth: number, style: EShapePointsStyle, result: IPoint\n\t): IPoint {\n\t\tresult.set( 2 * length, 0 );\n\t\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\t\tif( style & EShapePointsStyle.DOTTED ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth );\n\t\t\t} else if( style & EShapePointsStyle.DOTTED_DENSELY ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth * 0.5 );\n\t\t\t} else if( style & EShapePointsStyle.DOTTED_LOOSELY ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth * 2 );\n\t\t\t} else if( style & EShapePointsStyle.DASHED ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth );\n\t\t\t} else if( style & EShapePointsStyle.DASHED_DENSELY ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth * 0.5 );\n\t\t\t} else if( style & EShapePointsStyle.DASHED_LOOSELY ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth * 2 );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeBarPosition {\n\tTOP,\n\tLEFT,\n\tRIGHT,\n\tBOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\nimport {\n\tEShapeLineBasePoints, EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange\n} from \"./e-shape-line-base-points\";\n\nexport class EShapeBarPoints implements EShapeLineBasePoints {\n\tprotected _parent: EShapePointsParent;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\tprotected _values: [ number, number, number, number ];\n\tprotected _segments: number[];\n\tprotected _size: number;\n\tprotected _position: EShapeBarPosition;\n\n\tprotected _updatedSize: number;\n\tprotected _updatedParentSizeX: number;\n\tprotected _updatedParentSizeY: number;\n\tprotected _updatedPosition: EShapeBarPosition;\n\n\tconstructor( parent: EShapePointsParent, position: EShapeBarPosition, size: number, style: EShapePointsStyle ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._values = [ 0, 0, 0, 0 ];\n\t\tthis._segments = [];\n\t\tthis._style = style;\n\t\tthis._size = size;\n\t\tthis._position = position;\n\n\t\tthis._updatedSize = NaN;\n\t\tthis._updatedParentSizeX = NaN;\n\t\tthis._updatedParentSizeY = NaN;\n\t\tthis._updatedPosition = NaN;\n\t}\n\n\tprotected getComputedSize( size: number, position: EShapeBarPosition, sizeX: number, sizeY: number ): number {\n\t\tif( 0 <= size ) {\n\t\t\treturn size;\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\treturn Math.abs( sizeY );\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\treturn Math.abs( sizeX );\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tconst parentSize = this._parent.size;\n\t\tconst parentSizeX = parentSize.x;\n\t\tconst parentSizeY = parentSize.y;\n\t\tconst position = this._position;\n\t\tconst size = this._size;\n\t\tif( this._updatedSize !== size || this._updatedParentSizeX !== parentSizeX ||\n\t\t\tthis._updatedParentSizeY !== parentSizeY || this._updatedPosition !== position ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._updatedSize = size;\n\t\t\tthis._updatedParentSizeX = parentSizeX;\n\t\t\tthis._updatedParentSizeY = parentSizeY;\n\t\t\tthis._updatedPosition = position;\n\t\t\tconst psxh = parentSizeX * 0.5;\n\t\t\tconst psyh = parentSizeY * 0.5;\n\t\t\tconst computedSize = this.getComputedSize( size, position, parentSizeX, parentSizeY );\n\t\t\tconst values = this._values;\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = -psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = -psyh + computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\t\tvalues[ 0 ] = psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = psxh - computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = psyh - computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\tvalues[ 0 ] = -psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = -psxh + computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget length(): number {\n\t\treturn 2;\n\t}\n\n\tget id(): number {\n\t\tthis.update();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.update();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\tset segments( segments: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tthis.moveTo( undefined, size, undefined );\n\t}\n\n\tget position(): EShapeBarPosition {\n\t\treturn this._position;\n\t}\n\n\tset position( position: EShapeBarPosition ) {\n\t\tthis.moveTo( position, undefined, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.moveTo( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tif( source instanceof EShapeBarPoints ) {\n\t\t\treturn this.moveTo( source.position, source.size, source.style );\n\t\t} else {\n\t\t\treturn this.moveTo( undefined, undefined, source.style );\n\t\t}\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet newPosition: EShapeBarPosition | undefined;\n\t\tlet newSize: number | undefined;\n\t\tif( newValues != null ) {\n\t\t\tconst x0 = newValues[ 0 ];\n\t\t\tif( x0 === 0 ) {\n\t\t\t\tconst y0 = newValues[ 1 ];\n\t\t\t\tnewPosition = ( y0 <= 0 ? EShapeBarPosition.TOP : EShapeBarPosition.BOTTOM );\n\t\t\t\tnewSize = Math.abs( newValues[ 3 ] - y0 );\n\t\t\t} else {\n\t\t\t\tnewPosition = ( x0 <= 0 ? EShapeBarPosition.LEFT : EShapeBarPosition.RIGHT );\n\t\t\t\tnewSize = Math.abs( newValues[ 2 ] - x0 );\n\t\t\t}\n\t\t}\n\t\treturn this.moveTo( newPosition, newSize, newStyle );\n\t}\n\n\tprotected moveTo( position?: EShapeBarPosition, size?: number, style?: EShapePointsStyle ): this {\n\t\tlet isChanged = false;\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( position != null && this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeBarPoints {\n\t\treturn new EShapeBarPoints( parent, this._position, this._size, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._position},${this._size},${this._style}]` );\n\t}\n\n\tdeserialize( resourceId: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= resourceId && resourceId < manager.resources.length ) {\n\t\t\tconst resource = manager.resources[ resourceId ];\n\t\t\tconst parsed = JSON.parse( resource ) as [ number, number, number ];\n\t\t\tthis.moveTo( parsed[ 0 ], parsed[ 1 ], parsed[ 2 ] );\n\t\t}\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst length = this.length;\n\t\tif( 2 <= length ) {\n\t\t\tconst values = this._values;\n\t\t\tconst v0x = values[ 0 ];\n\t\t\tconst v0y = values[ 1 ];\n\t\t\tconst v1x = values[ 2 ];\n\t\t\tconst v1y = values[ 3 ];\n\t\t\tif( tester( x, y, v0x, v0y, v1x, v1y, 0, threshold, result ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Rectangle, Texture, utils } from \"pixi.js\";\nimport { DBaseState } from \"../d-base-state\";\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShapeAction } from \"./action/e-shape-action\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeFill } from \"./e-shape-fill\";\nimport { EShapeGradientLike } from \"./e-shape-gradient\";\nimport { EShapeLayout } from \"./e-shape-layout\";\nimport { EShapePoints } from \"./e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\nimport { EShapeStroke } from \"./e-shape-stroke\";\nimport { EShapeTag } from \"./e-shape-tag\";\nimport { EShapeText } from \"./e-shape-text\";\nimport { EShapeTransform } from \"./e-shape-transform\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport enum EShapeCopyPart {\n\tNONE = 0,\n\tTRANSFORM = 1,\n\tSIZE = 2,\n\tSTYLE = 4,\n\tACTION = 8,\n\tPOINTS = 16,\n\tSTATE = 32,\n\tALL = TRANSFORM | SIZE | STYLE | ACTION | POINTS | STATE\n}\n\nexport interface EShape extends utils.EventEmitter {\n\tid: string;\n\treadonly type: EShapeType;\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tradius: number;\n\tcorner: EShapeCorner;\n\treadonly points?: EShapePoints;\n\timage?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tcursor: string;\n\tvisible: boolean;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\troot: EShape;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number;\t\t// A work space for sorting.\n\tselected: boolean;\n\treference: number;\t// Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\t//\n\thovered: boolean;\n\tactive: boolean;\n\treadonly: boolean;\n\treadonly enabled: boolean;\n\tdisabled: boolean;\n\tdragging: boolean;\n\tfocused: boolean;\n\treadonly focusedin: boolean;\n\tunfocusable: boolean;\n\treadonly clicked: boolean;\n\treadonly pressed: boolean;\n\treadonly down: boolean;\n\treadonly up: boolean;\n\treadonly shadowed: boolean;\n\n\t//\n\ttoDirty(): void;\n\tattach( parent: EShapeContainer | EShape, at?: number ): this;\n\tdetach(): this;\n\tcopy( source: EShape ): this;\n\tcopy( source: EShape, part: EShapeCopyPart ): this;\n\tclone(): EShape;\n\tdestroy(): void;\n\n\t//\n\tgetState(): DBaseState;\n\tsetState( state: DBaseState, isOn: boolean ): this;\n\thasState( state: DBaseState ): boolean;\n\tfocus(): this;\n\tblur(): this;\n\n\t//\n\tonDblClick( e: MouseEvent ): void;\n\tonShortcut( e: KeyboardEvent ): void;\n\tonSizeChange(): void;\n\n\t// Action\n\tupdate( time: number ): void;\n\n\t// Transform\n\tupdateTransform(): void;\n\tdisallowOnTransformChange(): void;\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void;\n\tonTransformChange(): void;\n\tonChildTransformChange(): void;\n\n\t// Uploaded\n\tdisallowUploadedUpdate(): void;\n\tallowUploadedUpdate(): void;\n\tupdateUploaded(): void;\n\tupdateUploadedRecursively(): void;\n\n\t// Serialization\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem;\n\n\t// Hit test\n\tcontains( point: Point ): EShape | null;\n\tcontainsBBox( point: Point ): boolean;\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean;\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean;\n\n\t// Coordinate\n\ttoGlobal( position: IPoint, point: Point, skipUpdate?: boolean ): Point;\n\ttoLocal<T extends IPoint>(\n\t\tposition: IPoint,\n\t\tfrom?: DisplayObject,\n\t\tpoint?: T,\n\t\tskipUpdate?: boolean\n\t): T;\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBaseState } from \"../d-base-state\";\nimport { DControllers } from \"../d-controllers\";\nimport { UtilKeyboardEvent } from \"../util/util-keyboard-event\";\nimport { EShapeActionRuntime } from \"./action/e-shape-action-runtime\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeFillLike } from \"./e-shape-fill\";\nimport { EShapeStrokeLike } from \"./e-shape-stroke\";\nimport { EShapeTextLike } from \"./e-shape-text\";\n\nexport enum EShapeRuntimeReset {\n\tNONE = 0,\n\tPOSITION_X = 1,\n\tPOSITION_Y = 2,\n\tPOSITION = POSITION_X | POSITION_Y,\n\tROTATION = 4,\n\tCOLOR_FILL = 8,\n\tCOLOR_STROKE = 16,\n\tCOLOR_FILL_AND_STROKE = COLOR_FILL | COLOR_STROKE,\n\tCOLOR_TEXT = 32,\n\tCOLOR_TEXT_OUTLINE = 64,\n\tCOLOR = COLOR_FILL | COLOR_STROKE | COLOR_TEXT | COLOR_TEXT_OUTLINE,\n\tVISIBILITY = 128,\n\tHEIGHT = 256,\n\tWIDTH = 512,\n\tSIZE = HEIGHT | WIDTH,\n\tTEXT = 1024,\n\tCURSOR = 2048\n}\n\nexport enum EShapeRuntimeState {\n\tNONE = 0,\n\tCHANGED = 1,\n\tCLICKED = 2,\n\tDOWN = 4,\n\tUP = 8,\n\tPRESSED = 16,\n\tPERSISTENT = PRESSED\n}\n\nexport class EShapeRuntime {\n\tx: number;\n\ty: number;\n\tsize: Point;\n\trotation: number;\n\tactions: EShapeActionRuntime[];\n\tfill: EShapeFillLike;\n\tstroke: EShapeStrokeLike;\n\ttext: EShapeTextLike;\n\tcursor: string;\n\n\treset: EShapeRuntimeReset;\n\twritten: EShapeRuntimeReset;\n\n\teffect: number;\n\n\tstate: EShapeRuntimeState;\n\n\tinteractive: boolean;\n\n\tconstructor( shape: EShape ) {\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tthis.x = position.x;\n\t\tthis.y = position.y;\n\t\tthis.size = new Point( shape.size.x, shape.size.y );\n\t\tthis.rotation = transform.rotation;\n\t\tthis.actions = [];\n\t\tthis.fill = shape.fill.toObject();\n\t\tthis.stroke = shape.stroke.toObject();\n\t\tthis.text = shape.text.toObject();\n\t\tthis.cursor = shape.cursor;\n\t\tthis.reset = EShapeRuntimeReset.NONE;\n\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\tthis.effect = NaN;\n\t\tthis.state = EShapeRuntimeState.NONE;\n\t\tthis.interactive = false;\n\t}\n\n\tonPointerClick( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tif( ! shape.disabled ) {\n\t\t\tif( ! (this.state & EShapeRuntimeState.CLICKED) ) {\n\t\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.CLICKED;\n\t\t\t\tDApplications.update( shape );\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerDblClick( shape: EShape, e?: MouseEvent | TouchEvent ): boolean {\n\t\treturn false;\n\t}\n\n\tonPointerOver( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tshape.hovered = true;\n\t}\n\n\tonPointerOut( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tshape.hovered = false;\n\t}\n\n\tonPointerDown( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( shape );\n\t\tif( ! (this.state & EShapeRuntimeState.DOWN) ) {\n\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.DOWN | EShapeRuntimeState.PRESSED;\n\t\t\tif( layer ) {\n\t\t\t\tlayer.update();\n\t\t\t}\n\t\t}\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tfocusController.setFocused( focusController.findFocusableParent( shape ), true, true );\n\t\t}\n\t}\n\n\tonPointerUp( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tif( ! (this.state & EShapeRuntimeState.UP) ) {\n\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.UP;\n\t\t\tthis.state &= ~EShapeRuntimeState.PRESSED;\n\t\t\tDApplications.update( shape );\n\t\t}\n\t}\n\n\tonPointerMove( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\t//\n\t}\n\n\tonKeyDown( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onPointerDown( shape );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onPointerUp( shape );\n\t\t\tthis.onPointerClick( shape );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonStateChange( shape: EShape, newState: DBaseState, oldState: DBaseState ): void {\n\t\tthis.state |= EShapeRuntimeState.CHANGED;\n\t\tDApplications.update( shape );\n\t}\n\n\tupdate( shape: EShape, time: number ): void {\n\t\tconst tag = shape.tag;\n\t\tconst isEffectTimeUp = ( this.effect <= time );\n\t\tif( tag.isChanged || (this.state & EShapeRuntimeState.CHANGED) || isEffectTimeUp ) {\n\t\t\tif( isEffectTimeUp ) {\n\t\t\t\tthis.effect = NaN;\n\t\t\t}\n\t\t\tshape.disallowUploadedUpdate();\n\t\t\tthis.onUpdate( shape, time );\n\t\t\tshape.allowUploadedUpdate();\n\t\t\tthis.state &= EShapeRuntimeState.PERSISTENT;\n\t\t\ttag.isChanged = false;\n\t\t}\n\t}\n\n\tprotected onUpdate( shape: EShape, time: number ): void {\n\t\tif( 0 < this.actions.length ) {\n\t\t\tthis.executeActions( shape, time );\n\t\t\tthis.resetUnwrittenProperties( shape );\n\t\t}\n\t}\n\n\tprotected executeActions( shape: EShape, time: number ): void {\n\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].execute( shape, this, time );\n\t\t}\n\t}\n\n\tprotected resetUnwrittenProperties( shape: EShape ): void {\n\t\tconst target = (~this.written) & this.reset;\n\t\tif( target !== EShapeRuntimeReset.NONE ) {\n\t\t\tif( target & EShapeRuntimeReset.POSITION_X ) {\n\t\t\t\tshape.transform.position.x = this.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.POSITION_Y ) {\n\t\t\t\tshape.transform.position.y = this.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.VISIBILITY ) {\n\t\t\t\tshape.visible = true;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\tconst fill = this.fill;\n\t\t\t\tshape.fill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tfill.color,\n\t\t\t\t\tfill.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tshape.stroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tstroke.color,\n\t\t\t\t\tstroke.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\tconst text = this.text;\n\t\t\t\tshape.text.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttext.color,\n\t\t\t\t\ttext.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\tconst outline = this.text.outline;\n\t\t\t\tshape.text.outline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\toutline.color,\n\t\t\t\t\toutline.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.HEIGHT ) {\n\t\t\t\tshape.size.y = this.size.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.WIDTH ) {\n\t\t\t\tshape.size.x = this.size.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.ROTATION ) {\n\t\t\t\tshape.transform.rotation = this.rotation;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.TEXT ) {\n\t\t\t\tshape.text.value = this.text.value;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.CURSOR ) {\n\t\t\t\tshape.cursor = this.cursor;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nexport class EShapeAction {\n\tvalues: EShapeActionValue[];\n\n\tconstructor() {\n\t\tthis.values = [];\n\t}\n\n\tadd( value: EShapeActionValue, index?: number ): void {\n\t\tconst values = this.values;\n\t\tif( index != null ) {\n\t\t\tvalues.splice( index, 0, value );\n\t\t} else {\n\t\t\tvalues.push( value );\n\t\t}\n\t}\n\n\taddAll( values: EShapeActionValue[] ): void {\n\t\tconst sources = values;\n\t\tconst destinations = this.values;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i) {\n\t\t\tdestinations.push( sources[i] );\n\t\t}\n\t}\n\n\tindexOf( target: EShapeActionValue ): number {\n\t\tconst values = this.values;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value.isEquals( target ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeActionValue | null {\n\t\tconst result = this.values[ index ];\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, value: EShapeActionValue ): void {\n\t\tthis.values[ index ] = value;\n\t}\n\n\tremove( index: number ): void {\n\t\tthis.values.splice( index, 1 );\n\t}\n\n\tclear(): void {\n\t\tthis.values.length = 0;\n\t}\n\n\tsize(): number {\n\t\treturn this.values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this.values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number[] {\n\t\tconst result: number[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tresult.push( values[ i ].serialize( manager ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCorner {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP | BOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeStrokeSide {\n\tNONE = 0,\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\tTOP_OR_LEFT = TOP | LEFT,\n\tTOP_OR_RIGHT = TOP | RIGHT,\n\tBOTTOM_OR_LEFT = BOTTOM | LEFT,\n\tBOTTOM_OR_RIGHT = BOTTOM | RIGHT,\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Matrix, Transform } from \"pixi.js\";\nimport { EShapeTransformParent } from \"./e-shape-transform-parent\";\n\nexport interface EShapeTransform extends Transform {\n\tinternalTransform: Matrix;\n\n\tposition: IPoint;\n\tpivot: IPoint;\n\trotation: number;\n\tskew: IPoint;\n\tscale: IPoint;\n\n\tgetLocalIdCurrent(): number;\n\tgetLocalId(): number;\n\tgetParentId(): number;\n\tgetWorldId(): number;\n}\n\nexport class EShapeTransformImpl extends Transform implements EShapeTransform {\n\tprotected _parent: EShapeTransformParent;\n\tinternalTransform: Matrix;\n\n\tconstructor( parent: EShapeTransformParent ) {\n\t\tsuper();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis._parent = parent;\n\t}\n\n\tprotected onChange(): void {\n\t\t(Transform.prototype as any).onChange.call( this );\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tprotected updateSkew(): void {\n\t\t(Transform.prototype as any).updateSkew.call( this );\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tgetLocalIdCurrent(): number {\n\t\treturn (this as any)._currentLocalID;\n\t}\n\n\tgetLocalId(): number {\n\t\treturn (this as any)._localID;\n\t}\n\n\tgetParentId(): number {\n\t\treturn (this as any)._parentID;\n\t}\n\n\tgetWorldId(): number {\n\t\treturn (this as any)._worldID;\n\t}\n\n\tupdateTransform( parentTransform: Transform ): void {\n\t\tconst oldLocalId = (this as any)._currentLocalID;\n\t\tconst oldWorldId = (this as any)._worldID;\n\t\tsuper.updateTransform( parentTransform );\n\t\tconst newLocalId = (this as any)._currentLocalID;\n\t\tconst newWorldId = (this as any)._worldID;\n\t\tif( oldLocalId !== newLocalId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tlocalTransform.copyTo( internalTransform );\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tinternalTransform.prepend( parentTransform.internalTransform );\n\t\t\t}\n\t\t} else if( oldWorldId !== newWorldId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tlocalTransform.copyTo( internalTransform ).prepend( parentTransform.internalTransform );\n\t\t\t\t(this as any)._currentLocalID += 1;\n\t\t\t\t(this as any)._localID = (this as any)._currentLocalID;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toPadded = ( str: string, length: number, c: string ): string => {\n\tconst strLength = str.length;\n\tif( length < strLength ) {\n\t\treturn str;\n\t}\n\tlet padding = \"\";\n\tfor( let i = 0, imax = length - strLength; i < imax; ++i ) {\n\t\tpadding += c;\n\t}\n\treturn padding + str;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"./to-padded\";\n\nexport class UtilRgb {\n\tstatic toCode( color: number ): string {\n\t\treturn toPadded( color.toString( 16 ).toUpperCase(), 6, \"0\" );\n\t}\n\n\tstatic fromCode( code: string ): number | null {\n\t\tconst trimmed = code.trim().toLowerCase();\n\t\tif( trimmed.length === 6 ) {\n\t\t\tconst color = Number( `0x${trimmed}` );\n\t\t\tif( color === color ) {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic fromRgb( r: number, g: number, b: number ): number {\n\t\treturn ((r * 0xff) << 16) + ((g * 0xff) << 8) + ((b * 0xff) | 0);\n\t}\n\n\tstatic blend( colorA: number, colorB: number, t: number ): number {\n\t\tconst ar = ((colorA >> 16) & 0xff);\n\t\tconst ag = ((colorA >> 8) & 0xff);\n\t\tconst ab = ((colorA | 0) & 0xff);\n\n\t\tconst br = ((colorB >> 16) & 0xff);\n\t\tconst bg = ((colorB >> 8) & 0xff);\n\t\tconst bb = ((colorB | 0) & 0xff);\n\n\t\tconst w1 = Math.max( 0, Math.min( 1, t ) );\n\t\tconst w0 = 1 - w1;\n\t\tconst cr = Math.max( 0, Math.min( 0xff, ar * w0 + br * w1 ) );\n\t\tconst cg = Math.max( 0, Math.min( 0xff, ag * w0 + bg * w1 ) );\n\t\tconst cb = Math.max( 0, Math.min( 0xff, ab * w0 + bb * w1 ) );\n\n\t\treturn (cr << 16) + (cg << 8) + (cb | 0);\n\t}\n\n\tstatic brighten( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0xffffff, amount );\n\t}\n\n\tstatic darken( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0x000000, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShapeGradientLike, EShapeGradientPointLike } from \"../e-shape-gradient\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGradients {\n\tstatic serializeGradient( gradient: EShapeGradientLike ): string {\n\t\tconst points = gradient.points;\n\t\tlet result = `[${gradient.direction}`;\n\t\tfor( let i = 0, imax = points.length, j = 1; i < imax; i += 1, j += 3 ) {\n\t\t\tconst point = points[ i ];\n\t\t\tresult += `,${point.color},${point.alpha},${point.position}`;\n\t\t}\n\t\tresult += \"]\";\n\t\treturn result;\n\t}\n\n\tstatic parseGradient( target: string ): number[] | null {\n\t\ttry {\n\t\t\treturn JSON.parse( target ) as number[];\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserializeGradient( target: string ): EShapeGradientLike | undefined {\n\t\tconst parsed = this.parseGradient( target );\n\t\tif( parsed == null || parsed.length < 7 ) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tconst direction = parsed[ 0 ];\n\t\t\tconst points: EShapeGradientPointLike[] = [];\n\t\t\tfor( let i = 1, imax = parsed.length; i < imax; i += 3 ) {\n\t\t\t\tpoints.push({\n\t\t\t\t\tcolor: parsed[ i + 0 ],\n\t\t\t\t\talpha: parsed[ i + 1 ],\n\t\t\t\t\tposition: parsed[ i + 2 ]\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tpoints,\n\t\t\t\tdirection\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic toGradientId( gradient: EShapeGradientLike | undefined, manager: EShapeResourceManagerSerialization ): number {\n\t\tif( gradient != null ) {\n\t\t\tif( gradient.serialized == null ) {\n\t\t\t\tgradient.serialized = this.serializeGradient( gradient );\n\t\t\t}\n\t\t\treturn manager.add( gradient.serialized );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic toGradientImageUrl( gradient: EShapeGradientLike ): string {\n\t\tconst direction = gradient.direction;\n\t\tconst points = gradient.points;\n\n\t\tlet stops = \"\";\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tconst color = UtilRgb.toCode( point.color );\n\t\t\tconst alpha = point.alpha;\n\t\t\tconst offset = point.position * 100;\n\t\t\tstops += `<stop offset=\"${offset}%\" stop-color=\"#${color}\" stop-opacity=\"${alpha}\" />`;\n\t\t}\n\n\t\tconst radian = direction * Math.PI / 180;\n\t\tconst dx = 0.5 * Math.cos( radian );\n\t\tconst dy = -0.5 * Math.sin( radian );\n\n\t\tconst url = \"data:image/svg+xml;base64,\" + btoa(\n\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">` +\n\t\t\t\t`<defs>` +\n\t\t\t\t\t`<linearGradient id=\"o2glkm3aeu2oio\" x1=\"${0.5 - dx}\" x2=\"${0.5 + dx}\" y1=\"${0.5 - dy}\" y2=\"${0.5 + dy}\">` +\n\t\t\t\t\t\tstops +\n\t\t\t\t\t`</linearGradient>` +\n\t\t\t\t`</defs>` +\n\t\t\t\t`<rect x=\"0\" y=\"0\" width=\"32\" height=\"32\" stroke=\"none\" fill=\"url(#o2glkm3aeu2oio)\" />` +\n\t\t\t`</svg>`\n\t\t);\n\n\t\treturn url;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, Texture, Transform, utils } from \"pixi.js\";\nimport { DApplications } from \"../../d-applications\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeAction } from \"../action/e-shape-action\";\nimport { EShape, EShapeCopyPart } from \"../e-shape\";\nimport { EShapeContainer } from \"../e-shape-container\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeEditor } from \"../e-shape-editor\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeRuntime, EShapeRuntimeState } from \"../e-shape-runtime\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeTransform, EShapeTransformImpl } from \"../e-shape-transform\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploaded } from \"../e-shape-uploaded\";\nimport { EShapeGradients } from \"./e-shape-gradients\";\n\nexport abstract class EShapeBase extends utils.EventEmitter implements EShape {\n\tprotected static WORK_RECT = new Rectangle();\n\tid: string;\n\treadonly type: EShapeType;\n\tabstract readonly size: IPoint;\n\tabstract readonly fill: EShapeFill;\n\tabstract readonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tabstract radius: number;\n\tabstract corner: EShapeCorner;\n\tpoints?: EShapePoints;\n\timage?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tabstract gradient?: EShapeGradientLike;\n\tabstract readonly text: EShapeText;\n\tabstract readonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tabstract cursor: string;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\tprotected _visible: boolean;\n\tprotected _onTransformChangeLock: number;\n\tprotected _isOnTransformChanged: boolean;\n\tprotected _uploadedUpdateLock: number;\n\tprotected _isUploadedUpdated: boolean;\n\tprotected _isUploadedUpdatedRecursively: boolean;\n\n\tprotected _bounds?: Rectangle;\n\tprotected _boundsTransformId: number;\n\tprotected _boundsInternal?: Rectangle;\n\tprotected _boundsInternalTransformId: number;\n\tprotected _boundsLocal?: Rectangle;\n\tprotected _boundsLocalTransformId: number;\n\n\tprotected _state: DBaseState;\n\tprotected _stateLocal: DBaseState;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number; // A work space for sorting.\n\tselected: boolean;\n\treference: number; // Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper();\n\t\tthis.id = \"\";\n\t\tthis.type = type;\n\t\tthis.transform = this.newTransform();\n\t\tthis._onTransformChangeLock = 0;\n\t\tthis._isOnTransformChanged = false;\n\t\tthis.action = new EShapeAction();\n\t\tthis._visible = true;\n\t\tthis._uploadedUpdateLock = 0;\n\t\tthis._isUploadedUpdated = false;\n\t\tthis._isUploadedUpdatedRecursively = false;\n\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis._state = this._stateLocal = DBaseState.UNFOCUSABLE;\n\t\tthis.interactive = false;\n\n\t\t//\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\t//\n\t\tthis.selected = false;\n\t\tthis.index = 0;\n\t\tthis.reference = 0;\n\t}\n\n\tprotected newTransform(): EShapeTransform {\n\t\treturn new EShapeTransformImpl( this );\n\t}\n\n\tonSizeChange(): void {\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploaded();\n\t}\n\n\tonTransformChange(): void {\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploadedRecursively();\n\t}\n\n\tprotected onTransformChange_(): void {\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isOnTransformChanged = true;\n\t\t}\n\t}\n\n\tdisallowOnTransformChange(): void {\n\t\tthis._onTransformChangeLock += 1;\n\t\tif( this._onTransformChangeLock === 1 ) {\n\t\t\tthis._isOnTransformChanged = false;\n\t\t}\n\t}\n\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void {\n\t\tthis._onTransformChangeLock -= 1;\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tif( this._isOnTransformChanged ) {\n\t\t\t\tthis._isOnTransformChanged = false;\n\t\t\t\tif( invokeOnTransformChange ) {\n\t\t\t\t\tthis.onTransformChange();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\t//\n\t}\n\n\tdisallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock += 1;\n\t\tif( this._uploadedUpdateLock === 1 ) {\n\t\t\tthis._isUploadedUpdated = false;\n\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t}\n\t}\n\n\tallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock -= 1;\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tif( this._isUploadedUpdatedRecursively ) {\n\t\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploadedRecursively();\n\t\t\t} else if( this._isUploadedUpdated ) {\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploaded();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateUploadedRecursively(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tthis.updateUploaded();\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tchildren[ i ].updateUploadedRecursively();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdatedRecursively = true;\n\t\t}\n\t}\n\n\tupdateUploaded(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tconst uploaded = this.uploaded;\n\t\t\tif( uploaded != null ) {\n\t\t\t\tuploaded.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdated = true;\n\t\t}\n\t}\n\n\t//\n\tget root(): EShape {\n\t\tlet root: EShape = this;\n\t\twhile( root.parent instanceof EShapeBase ) {\n\t\t\troot = root.parent;\n\t\t}\n\t\treturn root;\n\t}\n\n\t//\n\tget visible(): boolean {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof EShapeBase ) {\n\t\t\treturn parent.visible && this._visible;\n\t\t} else {\n\t\t\treturn this._visible;\n\t\t}\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._visible !== visible ) {\n\t\t\tthis._visible = visible;\n\t\t\tthis.updateUploadedRecursively();\n\t\t}\n\t}\n\n\t//\n\tabstract clone(): EShape;\n\n\t//\n\ttoDirty() {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tparent.toDirty();\n\t\t}\n\t}\n\n\t// Hierarchy\n\tattach( parent: EShapeContainer | EShape, at?: number ): this {\n\t\tthis.detach();\n\t\tthis.parent = parent;\n\t\tconst children = parent.children;\n\t\tif( at != null && 0 <= at && at < children.length ) {\n\t\t\tchildren.splice( at, 0, this );\n\t\t} else {\n\t\t\tchildren.push( this );\n\t\t}\n\t\tthis.uploaded = undefined;\n\t\tparent.onChildTransformChange();\n\t\tparent.toDirty();\n\t\treturn this;\n\t}\n\n\tdetach(): this {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tthis.parent = null;\n\t\t\tthis.uploaded = undefined;\n\t\t\tconst children = parent.children;\n\t\t\tconst index = children.indexOf( this );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tchildren.splice( index, 1 );\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t// Transform\n\tupdateTransform() {\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tif( parent.parent ) {\n\t\t\t\tparent.updateTransform();\n\t\t\t}\n\t\t\tthis.transform.updateTransform(parent.transform);\n\t\t} else {\n\t\t\tthis.transform.updateTransform((Transform as any).IDENTITY);\n\t\t}\n\t}\n\n\t// Serialization\n\tserializeChildren( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem[] {\n\t\tconst children = this.children;\n\t\tconst childrenSerialized = [];\n\t\tfor (let i = 0, imax = children.length; i < imax; ++i) {\n\t\t\tconst child = children[i];\n\t\t\tchildrenSerialized.push(child.serialize(manager));\n\t\t}\n\t\treturn childrenSerialized;\n\t}\n\n\tserializeImage( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst image = this.image;\n\t\treturn (image != null ? manager.add( image.src ) : -1);\n\t}\n\n\tserializeGradient( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn EShapeGradients.toGradientId( this.gradient, manager );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst transform = this.transform;\n\t\tconst position = transform.position;\n\t\tconst pivot = transform.pivot;\n\t\tconst size = this.size;\n\t\tconst shortcut = this.shortcut;\n\t\tconst shortcutId = ( shortcut != null ? manager.add( shortcut ) : -1 );\n\t\tconst title = this.title;\n\t\tconst titleId = ( title != null ? manager.add( title ) : -1 );\n\t\treturn [\n\t\t\tthis.type,\n\t\t\tmanager.add(this.id),\n\t\t\tposition.x,\n\t\t\tposition.y,\n\t\t\tsize.x,\n\t\t\tsize.y,\n\t\t\ttransform.rotation,\n\t\t\ttransform.skew.x,\n\t\t\tthis.fill.serialize( manager ),\n\t\t\tthis.stroke.serialize( manager ),\n\t\t\tmanager.add( this.cursor.trim() ),\n\t\t\tthis.text.serialize( manager ),\n\t\t\tthis.tag.serialize( manager ),\n\t\t\tthis.radius,\n\t\t\tthis.corner,\n\t\t\t-1,\n\t\t\t-1,\n\t\t\tthis.action.serialize( manager ),\n\t\t\tthis.serializeImage( manager ),\n\t\t\tthis.serializeGradient( manager ),\n\t\t\tthis.serializeChildren( manager ),\n\t\t\tpivot.x,\n\t\t\tpivot.y,\n\t\t\t( this.interactive ? 1 : 0 ) | ( this.unfocusable ? 2 : 0 ),\n\t\t\tshortcutId,\n\t\t\ttitleId\n\t\t];\n\t}\n\n\t// Hit test\n\ttoLocalRect( point: IPoint, result: Rectangle ): Rectangle {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this.size;\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\t\tconst pivot = this.transform.pivot;\n\t\tconst dx = x - pivot.x;\n\t\tconst dy = y - pivot.y;\n\t\tconst stroke = this.stroke;\n\t\tconst s = stroke.width * stroke.align;\n\t\tif( 0 <= sx ) {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tresult.x = +dx;\n\t\t\t\tresult.y = +dy;\n\t\t\t\tresult.width = +sx + s;\n\t\t\t\tresult.height = +sy + s;\n\t\t\t} else {\n\t\t\t\tresult.x = +dx;\n\t\t\t\tresult.y = -dy;\n\t\t\t\tresult.width = +sx + s;\n\t\t\t\tresult.height = -sy + s;\n\t\t\t}\n\t\t} else {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tresult.x = -dx;\n\t\t\t\tresult.y = +dy;\n\t\t\t\tresult.width = -sx + s;\n\t\t\t\tresult.height = +sy + s;\n\t\t\t} else {\n\t\t\t\tresult.x = -dx;\n\t\t\t\tresult.y = -dy;\n\t\t\t\tresult.width = -sx + s;\n\t\t\t\tresult.height = -sy + s;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcontains( point: IPoint ): EShape | null {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tif( this.containsAbs( rect.x, rect.y, rect.width, rect.height ) ) {\n\t\t\treturn this;\n\t\t}\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\treturn this.containsText( x, y, point ) || this.containsChildren( x, y, point );\n\t}\n\n\tprotected containsText( x: number, y: number, work: IPoint ): EShape | null {\n\t\tconst text = this.text;\n\t\tconst textAtlas = text.atlas;\n\t\tif( textAtlas != null ) {\n\t\t\tconst textWorld = text.world;\n\t\t\tif( textWorld != null ) {\n\t\t\t\twork.set( x, y );\n\t\t\t\tthis.transform.internalTransform.apply( work, work );\n\t\t\t\tconst tx = work.x - textWorld[ 0 ];\n\t\t\t\tconst ty = work.y - textWorld[ 1 ];\n\t\t\t\tconst th = textWorld[ 2 ] * tx + textWorld[ 3 ] * ty;\n\t\t\t\tconst tv = textWorld[ 4 ] * tx + textWorld[ 5 ] * ty;\n\t\t\t\tif( 0 <= th && th <= textWorld[ 6 ] && 0 <= tv && tv <= textWorld[ 7 ] ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected containsChildren( x: number, y: number, work: IPoint ): EShape | null {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\twork.set( x, y );\n\t\t\tchild.updateTransform();\n\t\t\tchild.transform.localTransform.applyInverse( work, work );\n\t\t\tconst childResult = child.contains( work );\n\t\t\tif( childResult != null ) {\n\t\t\t\tif( this.shadowed ) {\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\treturn childResult;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontainsBBox( point: IPoint ): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\treturn this.containsAbsBBox( rect.x, rect.y, rect.width, rect.height );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn this.containsAbsBBox( x, y, ax, ay );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn (-ax <= x && x <= +ax && -ay <= y && y <= +ay);\n\t}\n\n\tselect( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\t//\n\ttoGlobal( position: IPoint, point: Point, skipUpdate?: boolean ): Point {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tpoint.copyFrom( position );\n\t\tthis.transform.worldTransform.apply( point, point );\n\t\treturn point;\n\t}\n\n\ttoLocal<T extends IPoint>(\n\t\tposition: IPoint,\n\t\tfrom?: DisplayObject,\n\t\tpoint?: T,\n\t\tskipUpdate?: boolean\n\t): T {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tif( point === undefined ) {\n\t\t\tpoint = new Point() as any as T;\n\t\t}\n\t\tpoint.copyFrom( position );\n\t\tthis.transform.worldTransform.applyInverse( point as any, point as any );\n\t\treturn point;\n\t}\n\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst bounds = this._bounds = ( this._bounds || new Rectangle() );\n\t\tconst worldId = this.transform.getWorldId();\n\t\tif( worldId !== this._boundsTransformId ) {\n\t\t\tthis._boundsTransformId = worldId;\n\t\t\tthis.getBounds_( this.transform.worldTransform, work, bounds );\n\t\t}\n\t\tresult.copyFrom( bounds );\n\t\treturn result;\n\t}\n\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsInternal = this._boundsInternal = ( this._boundsInternal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsInternalTransformId ) {\n\t\t\tthis._boundsInternalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.internalTransform, work, boundsInternal );\n\t\t}\n\t\tresult.copyFrom( boundsInternal );\n\t\treturn result;\n\t}\n\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsLocal = this._boundsLocal = ( this._boundsLocal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsLocalTransformId ) {\n\t\t\tthis._boundsLocalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.localTransform, work, boundsLocal );\n\t\t}\n\t\tresult.copyFrom( boundsLocal );\n\t\treturn result;\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\treturn this.size;\n\t}\n\n\tprotected getBounds_( transform: Matrix, work: Point, result: Rectangle ): Rectangle {\n\t\tconst pivot = this.transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\tconst size = this.getBoundsSize();\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\n\t\tconst a = transform.a;\n\t\tconst b = transform.b;\n\t\tconst c = transform.c;\n\t\tconst d = transform.d;\n\n\t\tlet x = -sx + px;\n\t\tlet y = -sy + py;\n\t\tconst x0 = a * x + c * y;\n\t\tconst y0 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = -sy + py;\n\t\tconst x1 = a * x + c * y;\n\t\tconst y1 = b * x + d * y;\n\n\t\tx = -sx + px;\n\t\ty = +sy + py;\n\t\tconst x2 = a * x + c * y;\n\t\tconst y2 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = +sy + py;\n\t\tconst x3 = a * x + c * y;\n\t\tconst y3 = b * x + d * y;\n\n\t\tconst xmin = Math.min( x0, x1, x2, x3 );\n\t\tconst ymin = Math.min( y0, y1, y2, y3 );\n\t\tconst xmax = Math.max( x0, x1, x2, x3 );\n\t\tconst ymax = Math.max( y0, y1, y2, y3 );\n\t\tresult.x = xmin + transform.tx;\n\t\tresult.y = ymin + transform.ty;\n\t\tresult.width = xmax - xmin;\n\t\tresult.height = ymax - ymin;\n\t\treturn result;\n\t}\n\n\t//\n\tdestroy(): void {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\t}\n\n\t//\n\tprotected updateState(): void {\n\t\tconst parent = this.parent;\n\t\tconst stateLocal = this._stateLocal;\n\t\tconst newState = ( parent instanceof EShapeBase ?\n\t\t\tthis.mergeState( stateLocal, parent.getState() ) :\n\t\t\tstateLocal\n\t\t);\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn stateLocal | (stateParent & DBaseState.DISABLED) |\n\t\t\t(stateParent & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) ? DBaseState.FOCUSED_IN : DBaseState.NONE);\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\truntime.onStateChange( this, newState, oldState );\n\t\t}\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof EShapeBase ) {\n\t\t\t\tchild.onParentStateChange( newState, oldState );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onParentStateChange( newStateParent: number, oldStateParent: number ) {\n\t\tconst newState = this.mergeState( this._stateLocal, newStateParent );\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tgetState(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ): this {\n\t\tif( (!! ( this._stateLocal & state )) !== isOn ) {\n\t\t\tif( isOn ) {\n\t\t\t\tthis._stateLocal |= state;\n\t\t\t} else {\n\t\t\t\tthis._stateLocal &= ~state;\n\t\t\t}\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\treturn !! ( this._state & state );\n\t}\n\n\tfocus(): this {\n\t\tthis.focused = true;\n\t\treturn this;\n\t}\n\n\tblur(): this {\n\t\tthis.focused = false;\n\t\treturn this;\n\t}\n\n\tget hovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tset hovered( isHovered: boolean ) {\n\t\tthis.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tget active(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tset active( isActive: boolean ) {\n\t\tthis.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tget readonly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tset readonly( isReadOnly: boolean ) {\n\t\tthis.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tget enabled(): boolean {\n\t\treturn ! this.hasState( DBaseState.DISABLED );\n\t}\n\n\tget disabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tset disabled( isDisabled: boolean ) {\n\t\tthis.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tget dragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tset dragging( isDragging: boolean ) {\n\t\tthis.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tget focused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tset focused( focused: boolean ) {\n\t\tif( this.focused !== focused ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().setFocused( this, focused, false );\n\t\t\t}\n\t\t}\n\t}\n\n\tget focusedin(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED | DBaseState.FOCUSED_IN );\n\t}\n\n\tget unfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tset unfocusable( unforcusable: boolean ) {\n\t\tthis.setState( DBaseState.UNFOCUSABLE, unforcusable );\n\t}\n\n\tget clicked(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.CLICKED) );\n\t}\n\n\tget pressed(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.PRESSED) );\n\t}\n\n\tget down(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.DOWN) );\n\t}\n\n\tget up(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.UP) );\n\t}\n\n\tget shadowed(): boolean {\n\t\treturn false;\n\t}\n\n\tonDblClick( e: MouseEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onPointerDblClick( this );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShortcut( e: KeyboardEvent ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onPointerClick( this );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onKeyDown( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onKeyUp( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\t//\n\tupdate( time: number ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\truntime.update( this, time );\n\t\t}\n\t}\n\n\tupdateRecursively( time: number ): void {\n\t\tthis.update( time );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].update( time );\n\t\t}\n\t}\n\n\tcopy( source: EShape, part: EShapeCopyPart = EShapeCopyPart.ALL ): this {\n\t\tthis.id = source.id;\n\t\tif( (part & EShapeCopyPart.TRANSFORM) !== 0 ) {\n\t\t\tconst transform = this.transform;\n\t\t\tconst sourceTransform = source.transform;\n\t\t\ttransform.position.copyFrom( sourceTransform.position );\n\t\t\ttransform.rotation = sourceTransform.rotation;\n\t\t\ttransform.skew.copyFrom( sourceTransform.skew );\n\t\t\ttransform.pivot.copyFrom( sourceTransform.pivot );\n\t\t\ttransform.scale.copyFrom( sourceTransform.scale );\n\t\t}\n\t\tif( (part & EShapeCopyPart.SIZE) !== 0 ) {\n\t\t\tthis.size.copyFrom( source.size );\n\t\t}\n\t\tif( (part & EShapeCopyPart.STYLE) !== 0 ) {\n\t\t\tthis.fill.copy( source.fill );\n\t\t\tthis.stroke.copy( source.stroke );\n\t\t\tthis.tag.copy( source.tag );\n\t\t\tthis.text.copy( source.text );\n\t\t\tthis.radius = source.radius;\n\t\t\tthis.corner = source.corner;\n\t\t\tif (this.image == null) {\n\t\t\t\tthis.image = source.image;\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.ACTION) !== 0 ) {\n\t\t\tthis.action.addAll( source.action.values );\n\t\t\tthis.interactive = source.interactive;\n\t\t\tthis.cursor = source.cursor;\n\t\t\tthis.shortcut = source.shortcut;\n\t\t}\n\t\tif( (part & EShapeCopyPart.POINTS) !== 0 ) {\n\t\t\tconst sourcePoints = source.points;\n\t\t\tif( sourcePoints != null ) {\n\t\t\t\tconst points = this.points;\n\t\t\t\tif( points != null ) {\n\t\t\t\t\tpoints.copy( sourcePoints );\n\t\t\t\t} else {\n\t\t\t\t\tthis.points = sourcePoints.clone( this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.STATE) !== 0 ) {\n\t\t\tthis.setState( source.getState(), true );\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStrokeSide } from \"./e-shape-stroke-side\";\n\nexport class EShapeDefaults {\n\tstatic IS_EDIT_MODE: boolean = false;\n\n\tstatic FILL_COLOR: number = 0xffffff;\n\tstatic FILL_ALPHA: number = 0.5;\n\tstatic STROKE_COLOR: number = 0x4f4f4f;\n\tstatic STROKE_COLOR_DARK: number = 0x4f4f4f;\n\tstatic STROKE_COLOR_LIGHT: number = 0xd0d0d0;\n\tstatic STROKE_ALPHA: number = 1;\n\tstatic STROKE_WIDTH: number = 2;\n\tstatic STROKE_ALIGN: number = 0;\n\tstatic STROKE_SIDE: number = EShapeStrokeSide.ALL;\n\tstatic TEXT_VALUE: string = \"\";\n\tstatic TEXT_FAMILY: string = \"auto\";\n\tstatic TEXT_SIZE: number = 14;\n\tstatic CURSOR: string = \"\";\n\tstatic RADIUS: number = 0.25;\n\tstatic SIZE_X: number = 100;\n\tstatic SIZE_Y: number = 100;\n\tstatic HIGHLIGHT_COLOR: number = 0x1e87f0;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTagValueRange, EShapeTagValueRangeLike } from \"./e-shape-tag-value-range\";\n\nexport enum EShapeTagValueOrder {\n\tASCENDING,\n\tDESCENDING\n}\n\nexport interface EShapeTagValueLike {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRangeLike;\n\tcapacity: number;\n\torder: EShapeTagValueOrder;\n}\n\nexport interface EShapeTagValueParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValue extends EShapeTagValueLike {\n\tvalue: unknown;\n\treadonly nvalue: number;\n\ttime: number;\n\n\tvalues: unknown[];\n\ttimes: number[];\n\n\trange: EShapeTagValueRange;\n\tparent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tclear(): void;\n\tremove( index: number ): void;\n\tremoveAll( indices: number[] ): void;\n\tcopy( target: EShapeTagValue ): void;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\n\nexport enum EShapeTagValueRangeType {\n\tNONE = 0,\n\tFROM = 1,\n\tTO = 2,\n\tFROM_TO = 3\n}\n\nexport interface EShapeTagValueRangeLike {\n\ttype: EShapeTagValueRangeType;\n\tfrom: number;\n\tto: number;\n}\n\nexport interface EShapeTagValueRangeParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValueRange extends EShapeTagValueRangeLike {\n\tparent?: EShapeTagValueRangeParent;\n\n\tset( from?: number | null, to?: number | null ): boolean;\n\tnormalize( value: number ): number;\n\tisEquals( target: EShapeTagValueRangeLike ): boolean;\n\tcopy( target: EShapeTagValueRangeLike ): void;\n\ttoObject(): EShapeTagValueRangeLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeFillImplParent } from \"./e-shape-fill-impl-parent\";\n\nexport class EShapeFillImpl implements EShapeFill {\n\tprotected _parent: EShapeFillImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\n\tconstructor( parent: EShapeFillImplParent, enable: boolean, color: number, alpha: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeFill {\n\t\treturn new EShapeFillImpl( this._parent, this._enable, this._color, this._alpha );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst stringified = `[${this._enable ? 1 : 0},${this._color},${this._alpha}]`;\n\t\treturn manager.add( stringified );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.fills.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.fills.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeStrokeImplParent } from \"./e-shape-stroke-impl-parent\";\n\nexport class EShapeStrokeImpl implements EShapeStroke {\n\tprotected _parent: EShapeStrokeImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\tprotected _align: number;\n\tprotected _side: EShapeStrokeSide;\n\n\tconstructor(\n\t\tparent: EShapeStrokeImplParent,\n\t\tenable: boolean, color: number, alpha: number,\n\t\twidth: number, align: number, side: EShapeStrokeSide\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t\tthis._align = align;\n\t\tthis._side = side;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget align(): number {\n\t\treturn this._align;\n\t}\n\n\tset align( align: number ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn this._side;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tif( this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width, target.align, target.side );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, align?: number, side?: EShapeStrokeSide ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( align !== undefined && this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( side !== undefined && this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis._parent,\n\t\t\tthis._enable, this._color, this._alpha,\n\t\t\tthis._width, this._align, this._side\n\t\t);\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width,\n\t\t\talign: this._align,\n\t\t\tside: this._side\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst enable = this._enable ? 1 : 0;\n\t\tconst serialized = `[${enable},${this._color},${this._alpha},${this._width},${this._align},${this._side}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.strokes.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ],\n\t\t\t\t\tparsed[ 4 ],\n\t\t\t\t\tparsed[ 5 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.strokes.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ],\n\t\t\t\t\tdeserialized[ 4 ],\n\t\t\t\t\tdeserialized[ 5 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport {\n\tEShapeTagValueRange, EShapeTagValueRangeLike, EShapeTagValueRangeParent, EShapeTagValueRangeType\n} from \"../e-shape-tag-value-range\";\n\nexport class EShapeTagValueRangeImpl implements EShapeTagValueRange {\n\tprotected _type: EShapeTagValueRangeType;\n\tprotected _from: number;\n\tprotected _to: number;\n\tparent?: EShapeTagValueRangeParent;\n\n\tconstructor() {\n\t\tthis._type = EShapeTagValueRangeType.NONE;\n\t\tthis._from = 0;\n\t\tthis._to = 1;\n\t}\n\n\tget type(): EShapeTagValueRangeType {\n\t\treturn this._type;\n\t}\n\n\tset type( type: EShapeTagValueRangeType ) {\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tset( from?: number | null, to?: number | null ): boolean {\n\t\tlet result = false;\n\t\tif( from !== undefined && to !== undefined ) {\n\t\t\tif( from !== null && to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._from !== from || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( from !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.TO) & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~(EShapeTagValueRangeType.TO | EShapeTagValueRangeType.FROM));\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( from !== undefined ) {\n\t\t\tif( from !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.FROM;\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( to !== undefined ) {\n\t\t\tif( to !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( result ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tnormalize( value: number ): number {\n\t\tconst type = this._type;\n\t\tconst from = this._from;\n\t\tconst to = this._to;\n\t\tswitch( type ) {\n\t\tcase EShapeTagValueRangeType.FROM_TO:\n\t\t\treturn (value - from) / (to - from);\n\t\tcase EShapeTagValueRangeType.FROM:\n\t\t\treturn value - from;\n\t\tcase EShapeTagValueRangeType.TO:\n\t\t\treturn to - value;\n\t\tcase EShapeTagValueRangeType.NONE:\n\t\tdefault:\n\t\t\treturn value;\n\t\t}\n\t}\n\n\tisEquals( target: EShapeTagValueRangeLike ): boolean {\n\t\treturn (\n\t\t\tthis._type === target.type &&\n\t\t\tthis._from === target.from &&\n\t\t\tthis._to === target.to\n\t\t);\n\t}\n\n\tcopy( target: EShapeTagValueRangeLike ): this {\n\t\treturn this.copy_( target.type, target.from, target.to );\n\t}\n\n\tprotected copy_( type: EShapeTagValueRangeType, from: number, to: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTagValueRangeLike {\n\t\treturn {\n\t\t\ttype: this.type,\n\t\t\tfrom: this.from,\n\t\t\tto: this.to\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._type},${this._from},${this._to}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.ranges.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.copy_(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.ranges.set( target, deserialized );\n\t\t\t\tthis.copy_(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DeepPartial } from \"../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"./e-shape-text-align\";\nimport { EShapeTextDirection } from \"./e-shape-text-direction\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"./e-shape-text-offset\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"./e-shape-text-outline\";\n\nexport enum EShapeTextWeight {\n\tNORMAL,\n\tBOLD\n}\n\nexport enum EShapeTextStyle {\n\tNORMAL,\n\tITALIC\n}\n\nexport interface EShapeTextLike {\n\tvalue: string;\n\tcolor: number;\n\talpha: number;\n\tfamily: string;\n\tsize: number;\n\tweight: EShapeTextWeight;\n\talign: EShapeTextAlignLike;\n\toffset: EShapeTextOffsetLike;\n\tstyle: EShapeTextStyle;\n\toutline: EShapeTextOutlineLike;\n\tspacing: EShapeTextOffsetLike;\n\tdirection: EShapeTextDirection;\n\tpadding: EShapeTextOffsetLike;\n\tclipping: boolean;\n}\n\nexport interface EShapeTextAtlasCharacter {\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: {\n\t\tx: number,\n\t\ty: number\n\t};\n}\n\nexport interface EShapeTextAtlasCharacters {\n\t[ character: string ]: EShapeTextAtlasCharacter;\n}\n\nexport interface EShapeTextAtlas {\n\twidth: number;\n\theight: number;\n\tfont: {\n\t\tsize: number;\n\t};\n\tcharacters: EShapeTextAtlasCharacters;\n}\n\nexport interface EShapeText extends EShapeTextLike {\n\tenable: boolean;\n\n\talign: EShapeTextAlign;\n\toffset: EShapeTextOffset;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeTextOffset;\n\tpadding: EShapeTextOffset;\n\n\ttexture?: Texture;\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: Float32Array;\t\t// Updated when rendered\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this;\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this;\n\ttoObject(): EShapeTextLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT,\n\tOUTSIDE_LEFT,\n\tOUTSIDE_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM,\n\tOUTSIDE_TOP,\n\tOUTSIDE_BOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextDirection {\n\tLEFT_TO_RIGHT,\n\tTOP_TO_BOTTOM,\n\tBOTTOM_TO_TOP\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedTagValue } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTagValue, EShapeTagValueOrder, EShapeTagValueParent } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nconst INDEX_COMPARATOR = ( a: number, b: number ): number => {\n\treturn a - b;\n};\n\nexport class EShapeTagValueImpl implements EShapeTagValue {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRange;\n\tprotected _value: unknown;\n\tprotected _time: number;\n\n\tprotected _values: unknown[] | undefined;\n\tprotected _times: number[] | undefined;\n\tprotected _capacity: number;\n\tprotected _order: EShapeTagValueOrder;\n\n\tprotected _parent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tconstructor() {\n\t\tthis.id = \"\";\n\t\tthis.initial = \"\";\n\t\tthis.format = \"\";\n\t\tthis.range = new EShapeTagValueRangeImpl();\n\t\tthis._value = 0;\n\t\tthis._time = 0;\n\t\tthis._capacity = 0;\n\t\tthis._order = EShapeTagValueOrder.ASCENDING;\n\t}\n\n\tget parent(): EShapeTagValueParent | undefined {\n\t\treturn this._parent;\n\t}\n\n\tset parent( parent: EShapeTagValueParent | undefined ) {\n\t\tif( this._parent !== parent ) {\n\t\t\tthis._parent = parent;\n\t\t\tthis.range.parent = parent;\n\t\t}\n\t}\n\n\tget value(): unknown {\n\t\treturn this._value;\n\t}\n\n\tset value( newValue: unknown ) {\n\t\tconst formatter = this.formatter;\n\t\tif( formatter != null ) {\n\t\t\tnewValue = formatter( newValue );\n\t\t}\n\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._value !== newValue ) {\n\t\t\t\tthis._value = newValue;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet values = this._values;\n\t\t\tif( values == null ) {\n\t\t\t\tvalues = [];\n\t\t\t\tthis._values = values;\n\t\t\t}\n\n\t\t\t// Update the value\n\t\t\tthis._value = newValue;\n\n\t\t\t// Update the values\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\tvalues.push( newValue );\n\t\t\t} else {\n\t\t\t\tvalues.unshift( newValue );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary values\n\t\t\tconst count = values.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\treturn this.range.normalize( this._value as number );\n\t}\n\n\tget values(): unknown[] {\n\t\tlet result = this._values;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._values = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tif( 0 < newValues.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tlet newValue = newValues[ newValues.length - 1 ];\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\tnewValue = formatter( newValue );\n\t\t\t\t}\n\t\t\t\tif( this._value !== newValue ) {\n\t\t\t\t\tthis._value = newValue;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet values = this._values;\n\t\t\t\tif( values == null ) {\n\t\t\t\t\tvalues = [];\n\t\t\t\t\tthis._values = values;\n\t\t\t\t}\n\n\t\t\t\tconst order = this._order;\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = formatter( newValues[ newValues.length - 1 ] );\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = newValues[ newValues.length - 1 ];\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remove the unnecessary values\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget time(): number {\n\t\treturn this._time;\n\t}\n\n\tset time( newTime: number ) {\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._time !== newTime ) {\n\t\t\t\tthis._time = newTime;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Update the times\n\t\t\tlet times = this._times;\n\t\t\tif( times == null ) {\n\t\t\t\ttimes = [];\n\t\t\t\tthis._times = times;\n\t\t\t}\n\n\t\t\t// Update the time\n\t\t\tthis._time = newTime;\n\n\t\t\t// Update the times\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\ttimes.push( newTime );\n\t\t\t} else {\n\t\t\t\ttimes.unshift( newTime );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary times\n\t\t\tconst count = times.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tlet result = this._times;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._times = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tif( 0 < newTimes.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tconst newTime = newTimes[ newTimes.length - 1 ];\n\t\t\t\tif( this._time !== newTime ) {\n\t\t\t\t\tthis._time = newTime;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Update the times\n\t\t\t\tlet times = this._times;\n\t\t\t\tif( times == null ) {\n\t\t\t\t\ttimes = [];\n\t\t\t\t\tthis._times = times;\n\t\t\t\t}\n\n\t\t\t\t// Update the value\n\t\t\t\tthis._time = newTimes[ newTimes.length - 1 ];\n\n\t\t\t\t//\n\t\t\t\tconst order = this._order;\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.push( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.unshift( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tif( this._capacity < capacity ) {\n\t\t\tthis._capacity = capacity;\n\t\t} else if( capacity < this._capacity ) {\n\t\t\tthis._capacity = capacity;\n\n\t\t\tlet isChanged = false;\n\n\t\t\t// Values\n\t\t\tconst order = this._order;\n\t\t\tconst values = this._values;\n\t\t\tif( values != null ) {\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Times\n\t\t\tconst times = this._times;\n\t\t\tif( times != null ) {\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( isChanged ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget order(): EShapeTagValueOrder {\n\t\treturn this._order;\n\t}\n\n\tset order( order: EShapeTagValueOrder ) {\n\t\tthis._order = order;\n\t}\n\n\tremove( index: number ): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAll( indices: number[] ): void {\n\t\tlet isChanged = false;\n\n\t\tconst values = this._values;\n\t\tconst times = this._times;\n\t\tconst sorted = indices.slice(0).sort( INDEX_COMPARATOR );\n\t\tif( values != null ) {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t\tif( index < values.length ) {\n\t\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( index < times.length ) {\n\t\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tvalues.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\ttimes.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Change flag\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * This method does not copy the `#values` and `#times` for the performance.\n\t *\n\t * @param target a copy target\n\t */\n\tcopy( target: EShapeTagValue ): this {\n\t\tthis.id = target.id;\n\t\tthis.initial = target.initial;\n\t\tthis.format = target.format;\n\t\tthis.formatter = target.formatter;\n\t\tthis.range.copy( target.range );\n\t\tthis._value = target.value;\n\t\tthis._time = target.time;\n\t\tthis._capacity = target.capacity;\n\t\treturn this;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst idSerialized = manager.add( this.id );\n\t\tconst initialSerialized = manager.add( this.initial );\n\t\tconst formatSerialized = manager.add( this.format.trim() );\n\t\tconst rangeSerialized = this.range.serialize( manager );\n\t\treturn manager.add(\n\t\t\t`[${idSerialized},${initialSerialized},${formatSerialized},${rangeSerialized},${this._capacity},${this._order}]`\n\t\t);\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): this {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.tagValues.get( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedTagValue;\n\t\t\t\tmanager.tagValues.set( target, parsed );\n\t\t\t}\n\t\t\tthis.id = resources[ parsed[ 0 ] ] || \"\";\n\t\t\tthis.initial = resources[ parsed[ 1 ] ] || \"\";\n\t\t\tthis.format = resources[ parsed[ 2 ] ] || \"\";\n\t\t\tthis.range.deserialize( parsed[ 3 ], manager );\n\t\t\tthis._capacity = parsed[ 4 ];\n\t\t\tthis._order = parsed[ 5 ];\n\t\t}\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeTagValue } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueImpl } from \"./e-shape-tag-value-impl\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nexport class EShapeTagImpl implements EShapeTag {\n\tstatic RANGE_DUMMY = new EShapeTagValueRangeImpl();\n\tstatic EMPTY_ARRAY = [];\n\n\tprotected _values: EShapeTagValue[];\n\tisChanged: boolean;\n\tinherited?: EShapeTagValue;\n\n\tconstructor() {\n\t\tthis._values = [];\n\t\tthis.isChanged = true;\n\t}\n\n\tget id(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].id;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.id;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget initial(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].initial;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.initial;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget format(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].format;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.format;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget range(): EShapeTagValueRange {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].range;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.range;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.RANGE_DUMMY;\n\t}\n\n\tget value(): unknown {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.value;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset value( value: unknown ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].value = value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.value = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].nvalue;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.nvalue;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget time(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.time;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset time( time: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].time = time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.time = time;\n\t\t\t}\n\t\t}\n\t}\n\n\tget values(): unknown[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].values;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.values;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].values = newValues;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.values = newValues;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].times;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.times;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].times = newTimes;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.times = newTimes;\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.capacity;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].capacity = capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.capacity = capacity;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( value: EShapeTagValue, index?: number ): void {\n\t\tconst values = this._values;\n\t\tvalue.parent = this;\n\t\tif( index === undefined ) {\n\t\t\tvalues.push( value );\n\t\t} else {\n\t\t\tvalues.splice( index, 0, value );\n\t\t}\n\t}\n\n\tset( index: number, value: EShapeTagValue ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalue.parent = this;\n\t\t\tvalues[ index ] = value;\n\t\t\tresult.parent = undefined;\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 )[ 0 ].parent = undefined;\n\t\t}\n\t}\n\n\tindexOf( target: EShapeTagValue ): number {\n\t\tconst values = this._values;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif(\n\t\t\t\tvalue.id === target.id &&\n\t\t\t\tvalue.initial === target.initial &&\n\t\t\t\tvalue.formatter === target.formatter &&\n\t\t\t\tvalue.range.isEquals( target.range )\n\t\t\t) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// ID-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value.id === target.id ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\treturn values[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this._values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tcopy( target: EShapeTag ): this {\n\t\tconst values = this._values;\n\t\tvalues.length = 0;\n\n\t\tfor( let i = 0, imax = target.size(); i < imax; ++i ) {\n\t\t\tconst value = target.get( i );\n\t\t\tif( value != null ) {\n\t\t\t\tconst newValue = new EShapeTagValueImpl().copy( value );\n\t\t\t\tnewValue.parent = this;\n\t\t\t\tvalues.push( newValue );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst values = this._values;\n\t\tif( values.length <= 0 ) {\n\t\t\treturn manager.add( \"[]\" );\n\t\t} else {\n\t\t\tlet serialized = `[${values[ 0 ].serialize( manager )}`;\n\t\t\tfor( let i = 1, imax = values.length; i < imax; ++i ) {\n\t\t\t\tserialized += `,${values[ i ].serialize( manager )}`;\n\t\t\t}\n\t\t\tserialized += \"]\";\n\t\t\treturn manager.add( serialized );\n\t\t}\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= target && target < manager.resources.length ) {\n\t\t\tlet deserialized: number[] | undefined = manager.tags.get( target );\n\t\t\tif( deserialized == null ) {\n\t\t\t\tdeserialized = JSON.parse( manager.resources[ target ] ) as number[];\n\t\t\t\tmanager.tags.set( target, deserialized );\n\t\t\t}\n\n\t\t\tconst values = this._values;\n\t\t\tvalues.length = 0;\n\t\t\tfor( let i = 0, imax = deserialized.length; i < imax; ++i ) {\n\t\t\t\tconst index = deserialized[ i ];\n\t\t\t\tconst value = new EShapeTagValueImpl();\n\t\t\t\tvalue.parent = this;\n\t\t\t\tvalue.deserialize( index, manager );\n\t\t\t\tvalues.push( value );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextAlignImplParent } from \"./e-shape-text-align-impl-parent\";\n\nexport class EShapeTextAlignImpl implements EShapeTextAlign {\n\tprotected _parent: EShapeTextAlignImplParent;\n\tprotected _horizontal: EShapeTextAlignHorizontal;\n\tprotected _vertical: EShapeTextAlignVertical;\n\n\tconstructor(\n\t\tparent: EShapeTextAlignImplParent,\n\t\thorizontal: EShapeTextAlignHorizontal, vertical: EShapeTextAlignVertical\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.aligns.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.aligns.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueBlinkType {\n\tVISIBILITY,\n\tBRIGHTEN,\n\tDARKEN,\n\tOPACITY,\n\tCOLOR_FILL,\n\tCOLOR_STROKE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeTextOffsetImplParent } from \"./e-shape-text-offset-impl-parent\";\n\nexport class EShapeTextOffsetImpl implements EShapeTextOffset {\n\tprotected _parent: EShapeTextOffsetImplParent;\n\tprotected _horizontal: number;\n\tprotected _vertical: number;\n\n\tconstructor( parent: EShapeTextOffsetImplParent, horizontal: number, vertical: number ) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): number {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.margins.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.margins.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeTextOutlineImplParent } from \"./e-shape-text-outline-impl-parent\";\n\nexport class EShapeTextOutlineImpl implements EShapeTextOutline {\n\tprotected _parent: EShapeTextOutlineImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\n\tconstructor( parent: EShapeTextOutlineImplParent, enable: boolean, color: number, alpha: number, width: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeTextOutline {\n\t\treturn new EShapeTextOutlineImpl( this._parent, this._enable, this._color, this._alpha, this._width );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._enable ? 1 : 0},${this._color},${this._alpha},${this._width}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.textOutlines.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.textOutlines.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DDiagramSerializedText } from \"../../d-diagram-serialized\";\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextAtlas, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlign } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOffset } from \"../e-shape-text-offset\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeTextAlignImpl } from \"./e-shape-text-align-impl\";\nimport { EShapeTextImplParent } from \"./e-shape-text-impl-parent\";\nimport { EShapeTextOffsetImpl } from \"./e-shape-text-offset-impl\";\nimport { EShapeTextOutlineImpl } from \"./e-shape-text-outline-impl\";\n\nexport class EShapeTextImpl implements EShapeText {\n\tprotected _parent: EShapeTextImplParent;\n\tprotected _enable: boolean;\n\tprotected _value: string;\n\tprotected _family: string;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _size: number;\n\tprotected _weight: EShapeTextWeight;\n\treadonly align: EShapeTextAlign;\n\treadonly offset: EShapeTextOffset;\n\tprotected _style: EShapeTextStyle;\n\treadonly outline: EShapeTextOutline;\n\treadonly spacing: EShapeTextOffset;\n\tprotected _direction: EShapeTextDirection;\n\treadonly padding: EShapeTextOffset;\n\tprotected _clipping: boolean;\n\n\ttexture?: Texture;\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: Float32Array;\t\t// Updated when rendered\n\n\tconstructor(\n\t\tparent: EShapeTextImplParent,\n\t\tvalue: string, color: number, alpha: number, family: string, size: number\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = true;\n\t\tthis._value = value;\n\t\tthis._color = color!;\n\t\tthis._alpha = alpha!;\n\t\tthis._family = family!;\n\t\tthis._size = size!;\n\t\tthis._weight = EShapeTextWeight.NORMAL;\n\t\tthis.align = new EShapeTextAlignImpl( parent, EShapeTextAlignHorizontal.CENTER, EShapeTextAlignVertical.MIDDLE );\n\t\tthis.offset = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis._style = EShapeTextStyle.NORMAL;\n\t\tthis.spacing = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis.outline = new EShapeTextOutlineImpl( parent, false, 0xffffff, 1.0, 0.5 );\n\t\tthis._direction = EShapeTextDirection.LEFT_TO_RIGHT;\n\t\tthis.padding = new EShapeTextOffsetImpl( parent, 10, 10 );\n\t\tthis._clipping = false;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value( value: string ) {\n\t\tif( this._value !== value ) {\n\t\t\tthis._value = value;\n\n\t\t\t// Compatibility check\n\t\t\tconst parent = this._parent;\n\t\t\tconst uploaded = parent.uploaded;\n\t\t\tif( uploaded == null || ! uploaded.isCompatible( parent ) ) {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Character code check\n\t\t\tconst atlas = this.atlas;\n\t\t\tconst characters = atlas && atlas.characters;\n\t\t\tif( characters != null ) {\n\t\t\t\tfor( let i = 0, imax = value.length; i < imax; ++i ) {\n\t\t\t\t\tconst char = value[ i ];\n\t\t\t\t\tif( ! (char in characters) ) {\n\t\t\t\t\t\tthis.atlas = undefined;\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Update uploaded\n\t\t\tparent.updateUploaded();\n\t\t}\n\t}\n\n\tget family(): string {\n\t\treturn this._family;\n\t}\n\n\tset family( family: string ) {\n\t\tif( this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tthis._parent.toDirty();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn this._weight;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tif( this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tif( this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget direction(): EShapeTextDirection {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: EShapeTextDirection ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tif( target ) {\n\t\t\tthis.set(\n\t\t\t\ttarget.value,\n\t\t\t\ttarget.color,\n\t\t\t\ttarget.alpha,\n\t\t\t\ttarget.family,\n\t\t\t\ttarget.size,\n\t\t\t\ttarget.weight,\n\t\t\t\ttarget.style,\n\t\t\t\ttarget.direction,\n\t\t\t\ttarget.clipping\n\t\t\t);\n\t\t\tthis.align.copy( target.align );\n\t\t\tthis.offset.copy( target.offset );\n\t\t\tthis.outline.copy( target.outline );\n\t\t\tthis.spacing.copy( target.spacing );\n\t\t\tthis.padding.copy( target.padding );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\tlet isChangedDirty = false;\n\t\tlet isChangedUploaded = false;\n\n\t\tif( value != null && this._value !== value ) {\n\t\t\tthis._value = value;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( color != null && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( alpha != null && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( family != null && this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( weight != null && this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( direction != null && this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( clipping != null && this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( isChangedDirty ) {\n\t\t\tthis._parent.toDirty();\n\t\t} else if( isChangedUploaded ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: this._value,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tfamily: this._family,\n\t\t\tsize: this._size,\n\t\t\tweight: this._weight,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: this._style,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tdirection: this._direction,\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: this._clipping\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst alignSerialized = this.align.serialize( manager );\n\t\tconst offsetSerialized = this.offset.serialize( manager );\n\t\tconst outlineSerialized = this.outline.serialize( manager );\n\t\tconst spacingSerialized = this.spacing.serialize( manager );\n\t\tconst paddingSerialized = this.padding.serialize( manager );\n\t\tconst serialized = `[${manager.add( this._value )},${this._color},${this._alpha},` +\n\t\t\t`${manager.add( this._family )},${this._size},${this._weight},${alignSerialized},` +\n\t\t\t`${offsetSerialized},${this._style},${outlineSerialized},${spacingSerialized},` +\n\t\t\t`${this._direction},${paddingSerialized},${this._clipping ? 1 : 0 }]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.texts.get( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedText;\n\t\t\t\tmanager.texts.set( target, parsed );\n\t\t\t}\n\t\t\tthis.set(\n\t\t\t\tresources[ parsed[ 0 ] ] || \"\",\n\t\t\t\tparsed[ 1 ],\n\t\t\t\tparsed[ 2 ],\n\t\t\t\tresources[ parsed[ 3 ] ] || \"auto\",\n\t\t\t\tparsed[ 4 ],\n\t\t\t\tparsed[ 5 ],\n\t\t\t\tparsed[ 8 ],\n\t\t\t\tparsed[ 11 ],\n\t\t\t\t( parsed[ 13 ] !== 0 )\n\t\t\t);\n\t\t\tthis.align.deserialize( parsed[ 6 ], manager );\n\t\t\tthis.offset.deserialize( parsed[ 7 ], manager );\n\t\t\tthis.outline.deserialize( parsed[ 9 ], manager );\n\t\t\tthis.spacing.deserialize( parsed[ 10 ], manager );\n\t\t\tthis.padding.deserialize( parsed[ 12 ], manager );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, ObservablePoint } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeFillImpl } from \"./e-shape-fill-impl\";\nimport { EShapeStrokeImpl } from \"./e-shape-stroke-impl\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\nimport { EShapeTextImpl } from \"./e-shape-text-impl\";\n\nexport abstract class EShapePrimitive extends EShapeBase {\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\tprotected _radius: number;\n\tprotected _corner: EShapeCorner;\n\tpoints?: EShapePoints;\n\tprotected _image?: HTMLImageElement;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\tcursor: string;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper( type );\n\t\tthis.size = this.newSize();\n\t\tthis.fill = this.newFill();\n\t\tthis.stroke = this.newStroke();\n\t\tthis._radius = EShapeDefaults.RADIUS;\n\t\tthis._corner = EShapeCorner.ALL;\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.text = this.newText();\n\t\tthis.cursor = EShapeDefaults.CURSOR;\n\t}\n\n\tprotected newSize(): IPoint {\n\t\treturn new ObservablePoint(\n\t\t\t() => { this.onSizeChange(); },\n\t\t\tundefined,\n\t\t\tEShapeDefaults.SIZE_X,\n\t\t\tEShapeDefaults.SIZE_Y\n\t\t);\n\t}\n\n\tprotected newFill(): EShapeFill {\n\t\treturn new EShapeFillImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.FILL_COLOR,\n\t\t\tEShapeDefaults.FILL_ALPHA\n\t\t);\n\t}\n\n\tprotected newStroke(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\tEShapeDefaults.STROKE_ALIGN,\n\t\t\tEShapeDefaults.STROKE_SIDE\n\t\t);\n\t}\n\n\tprotected newText(): EShapeText {\n\t\treturn new EShapeTextImpl(\n\t\t\tthis,\n\t\t\tEShapeDefaults.TEXT_VALUE,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.TEXT_FAMILY,\n\t\t\tEShapeDefaults.TEXT_SIZE\n\t\t);\n\t}\n\n\tabstract clone(): EShape;\n\n\tget corner(): number {\n\t\treturn this._corner;\n\t}\n\n\tset corner( corner: number ) {\n\t\tif( this._corner !== corner ) {\n\t\t\tthis._corner = corner;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\treturn this._image;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tif( this._image !== image ) {\n\t\t\tif( image != null ) {\n\t\t\t\tthis._image = image;\n\t\t\t\tthis.imageSrc = image.src;\n\t\t\t} else {\n\t\t\t\tthis._image = undefined;\n\t\t\t\tthis.imageSrc = undefined;\n\t\t\t}\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport {\n\tEShapeLineBasePoints, EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange,\n\tEShapeLineBasePointsToHitThreshold\n} from \"./e-shape-line-base-points\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport abstract class EShapeLineBase extends EShapePrimitive {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\tabstract points: EShapeLineBasePoints;\n\tabstract clone(): EShapeLineBase;\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst result = super.serialize( manager );\n\t\tresult[ 15 ] = this.points.serialize( manager );\n\t\treturn result;\n\t}\n\n\tprotected getPixelScale(): number {\n\t\tconst container = this.root.parent as any;\n\t\tif( container != null && container.getPixelScale != null ) {\n\t\t\treturn container.getPixelScale();\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tprotected getStrokeWidthScale( points: EShapePoints ): number {\n\t\tconst style = points.style;\n\t\tif( style & EShapePointsStyle.NON_EXPANDING_WIDTH ) {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn this.getPixelScale();\n\t\t\t} else {\n\t\t\t\treturn Math.min( 1.0, this.getPixelScale() );\n\t\t\t}\n\t\t} else {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn Math.max( 1.0, this.getPixelScale() );\n\t\t\t} else {\n\t\t\t\treturn 1.0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toHitThreshold(\n\t\ttoThreshold: EShapeLineBasePointsToHitThreshold | null\n\t): number {\n\t\tconst stroke = this.stroke;\n\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\tconst strokeScale = this.getStrokeWidthScale( this.points );\n\t\treturn ( toThreshold ?\n\t\t\ttoThreshold( strokeWidth, strokeScale ) :\n\t\t\tstrokeWidth * strokeScale * 0.5\n\t\t);\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst points = this.points;\n\t\tconst threshold = this.toHitThreshold( null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tax, ay,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis.calcHitPointAbsHitTester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoHitThreshold: EShapeLineBasePointsToHitThreshold | null,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst points = this.points;\n\t\tconst threshold = this.toHitThreshold( toHitThreshold );\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\trect.width, rect.height,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected calcHitPointAbsHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: unknown\n\t): boolean {\n\t\t// (x, y) = p0 + (p1 - p0) * t where 0 <= t <= 1\n\t\t// d0 := p1 - p0\n\t\t// d1 := v - p0\n\t\t// (p0.x + d0.x * t - x)^2 + (p0.y + d0.y * t - y)^2\n\t\t// (d0.x t - d1.x)^2 + (d0.y t - d1.y)^2\n\t\t// (d0.x^2 + d0.y^2) t^2 - 2 (d0.x * d1.x + d0.y * d1.y) t + (d1.x^2 + d1.y^2)\n\t\t// a := dot( d0, d0 )\n\t\t// b := dot( d0, d1 )\n\t\t// c := dot( d1, d1 )\n\t\t// a t^2 - 2 b t + c = a (t - b / a)^2 + c - b * b / a\n\t\t// t0 = b / a  min = c - b * b / a\n\t\tconst d0x = p1x - p0x;\n\t\tconst d0y = p1y - p0y;\n\t\tconst d1x = x - p0x;\n\t\tconst d1y = y - p0y;\n\t\tconst a = d0x * d0x + d0y * d0y;\n\t\tconst b = d0x * d1x + d0y * d1y;\n\t\tconst c = d1x * d1x + d1y * d1y;\n\t\tif( 0.0001 < a ) {\n\t\t\tconst t = Math.max( 0, Math.min( 1, b / a ) );\n\t\t\tconst d = a * t * t - 2 * b * t + c;\n\t\t\tif( d < threshold * threshold ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBarPoints } from \"./e-shape-bar-points\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\n\nexport class EShapeBar extends EShapeLineBase {\n\tpoints: EShapeBarPoints;\n\n\tconstructor( position: EShapeBarPosition, size: number, width: number, style: EShapePointsStyle ) {\n\t\tsuper( EShapeType.BAR );\n\t\tthis.fill.enable = false;\n\t\tthis.stroke.set( true, undefined, undefined, width );\n\t\tthis.points = new EShapeBarPoints( this, position, size, style );\n\t}\n\n\tclone(): EShapeBar {\n\t\tconst points = this.points;\n\t\treturn new EShapeBar( points.position, points.size, this.stroke.width, points.style ).copy( this );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst size = Math.max( 0, this.points.size );\n\t\treturn super.containsAbsBBox( x, y, ax + size, ay + size );\n\t}\n}\n","import { utils } from \"pixi.js\";\n\nconst WORK_COLOR = new Float32Array( 4 );\n\nexport const buildColor = (\n\tcolor: number,\n\talpha: number,\n\tvoffset: number,\n\tvcount: number,\n\tcolors: Float32Array\n): void => {\n\tconst rgba = utils.premultiplyTintToRgba( color, alpha, WORK_COLOR );\n\tconst r = rgba[ 0 ];\n\tconst g = rgba[ 1 ];\n\tconst b = rgba[ 2 ];\n\tconst a = rgba[ 3 ];\n\n\tfor( let i = voffset << 2, imax = (voffset + vcount) << 2; i < imax; i += 4 ) {\n\t\tcolors[ i + 0 ] = r;\n\t\tcolors[ i + 1 ] = g;\n\t\tcolors[ i + 2 ] = b;\n\t\tcolors[ i + 3 ] = a;\n\t}\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture, TextureUvs, utils } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { buildColor } from \"./variant/build-color\";\n\nexport interface EShapeUploaded {\n\tupdate( shape: EShape ): void;\n\tisCompatible( shape: EShape ): boolean;\n\tgetBuffer(): EShapeBuffer;\n\tgetVertexOffset(): number;\n\tgetVertexCount(): number;\n\tgetIndexOffset(): number;\n\tgetIndexCount(): number;\n\tbuildUnit( builder: EShapeBufferUnitBuilder ): void;\n}\n\nexport abstract class EShapeUploadedBase implements EShapeUploaded {\n\tprotected buffer: EShapeBuffer;\n\n\tprotected transformLocalId: number;\n\n\tprotected vertexOffset: number;\n\tprotected vertexCount: number;\n\tprotected indexOffset: number;\n\tprotected indexCount: number;\n\n\tprotected colorFill: number;\n\tprotected alphaFill: number;\n\tprotected colorStroke: number;\n\tprotected alphaStroke: number;\n\n\tprotected sizeX: number;\n\tprotected sizeY: number;\n\tprotected strokeWidth: number;\n\tprotected strokeAlign: number;\n\tprotected strokeSide: number;\n\tprotected radius: number;\n\tprotected corner: EShapeCorner;\n\n\tprotected texture: Texture | null;\n\tprotected textureTransformId: number;\n\n\tprotected antialiasWeight: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tthis.buffer = buffer;\n\n\t\tthis.transformLocalId = -1;\n\n\t\tthis.vertexOffset = voffset;\n\t\tthis.vertexCount = vcount;\n\t\tthis.indexOffset = ioffset;\n\t\tthis.indexCount = icount;\n\n\t\tthis.colorFill = NaN;\n\t\tthis.alphaFill = -1;\n\t\tthis.colorStroke = NaN;\n\t\tthis.alphaStroke = -1;\n\n\t\tthis.sizeX = NaN;\n\t\tthis.sizeY = NaN;\n\t\tthis.strokeWidth = NaN;\n\t\tthis.strokeAlign = NaN;\n\t\tthis.strokeSide = NaN;\n\t\tthis.radius = NaN;\n\t\tthis.corner = NaN;\n\n\t\tthis.texture = null;\n\t\tthis.textureTransformId = NaN;\n\n\t\tthis.antialiasWeight = antialiasWeight;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tshape.uploaded = this;\n\t\treturn this;\n\t}\n\n\tabstract update( shape: EShape ): void;\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn true;\n\t}\n\n\tgetBuffer(): EShapeBuffer {\n\t\treturn this.buffer;\n\t}\n\n\tgetVertexOffset(): number {\n\t\treturn this.vertexOffset;\n\t}\n\n\tgetVertexCount(): number {\n\t\treturn this.vertexCount;\n\t}\n\n\tgetIndexOffset(): number {\n\t\treturn this.indexOffset;\n\t}\n\n\tgetIndexCount(): number {\n\t\treturn this.indexCount;\n\t}\n\n\tprotected toTransformLocalId( shape: EShape ) {\n\t\tshape.updateTransform();\n\t\treturn shape.transform.getLocalId();\n\t}\n\n\tprotected toTexture( shape: EShape ) {\n\t\treturn shape.texture || Texture.WHITE;\n\t}\n\n\tprotected toTextureTransformId( texture: Texture ): number {\n\t\tconst textureAny = texture as any;\n\t\tif( textureAny._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\treturn textureAny._updateID;\n\t}\n\n\tprotected toTextureUvs( texture: Texture ): TextureUvs {\n\t\treturn (texture as any)._uvs;\n\t}\n\n\tprotected updateColorFill( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst fill = shape.fill;\n\t\tconst isEnabled = shape.visible && fill.enable;\n\t\tconst color = fill.color;\n\t\tconst alpha = (isEnabled ? fill.alpha : 0);\n\t\tif( color !== this.colorFill || alpha !== this.alphaFill ) {\n\t\t\tthis.colorFill = color;\n\t\t\tthis.alphaFill = alpha;\n\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst stroke = shape.stroke;\n\t\tconst isEnabled = shape.visible && stroke.enable && 0 < stroke.width;\n\t\tconst color = stroke.color;\n\t\tconst alpha = (isEnabled ? stroke.alpha : 0);\n\t\tif( color !== this.colorStroke || alpha !== this.alphaStroke ) {\n\t\t\tthis.colorStroke = color;\n\t\t\tthis.alphaStroke = alpha;\n\t\t\tbuffer.colorStrokeBuffer.update();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorFill( buffer, shape, vertexCount );\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tconst texture = this.texture || Texture.WHITE;\n\t\tconst baseTexture = texture.baseTexture;\n\t\tif( baseTexture !== builder.baseTexture ) {\n\t\t\tbuilder.baseTexture = baseTexture;\n\t\t\tconst indexOffset = this.indexOffset;\n\t\t\tbuilder.push( texture, indexOffset );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBufferCount } from \"../e-shape-buffer-count\";\n\nexport class EShapeTextUploadeds {\n\tstatic getTextCount( shape: EShape, result: EShapeBufferCount ): EShapeBufferCount {\n\t\tconst length = shape.text.value.length;\n\t\tconst count = Math.ceil( length / 12 ) * 12;\n\t\tresult.vertexCount = count << 2;\n\t\tresult.indexCount = count << 1;\n\t\treturn result;\n\t}\n}\n","export const toLength = ( p0x: number, p0y: number, p1x: number, p1y: number ) => {\n\tconst dx01 = p1x - p0x;\n\tconst dy01 = p1y - p0y;\n\treturn Math.sqrt( dx01 * dx01 + dy01 * dy01 );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Texture } from \"pixi.js\";\nimport { UtilCharacterIterator } from \"../../util/util-character-iterator\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"../e-shape-buffer-unit-builder\";\nimport { EShapeTextAtlas, EShapeTextAtlasCharacter, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\nimport { buildColor } from \"./build-color\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\nimport { toLength } from \"./to-length\";\n\nconst FMIN: number = 0.00001;\n\nexport abstract class EShapeTextUploaded extends EShapeUploadedBase {\n\tprotected textTexture: Texture | null;\n\tprotected textTextureTransformId: number;\n\tprotected textValue: string;\n\tprotected textFamily: string;\n\tprotected textSize: number;\n\tprotected textColor: number;\n\tprotected textAlpha: number;\n\tprotected textWeight: number;\n\tprotected textStyle: number;\n\tprotected textAlignHorizontal: number;\n\tprotected textAlignVertical: number;\n\tprotected textOffsetHorizontal: number;\n\tprotected textOffsetVertical: number;\n\tprotected textOutlineWidth: number;\n\tprotected textOutlineColor: number;\n\tprotected textOutlineAlpha: number;\n\tprotected textSpacingHorizontal: number;\n\tprotected textSpacingVertical: number;\n\tprotected textDirection: number;\n\tprotected textPaddingHorizontal: number;\n\tprotected textPaddingVertical: number;\n\tprotected textClipping: boolean;\n\tprotected textVertexCount: number;\n\tprotected textIndexCount: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, vcount, icount, antialiasWeight );\n\n\t\tthis.textSize = NaN;\n\t\tthis.textFamily = \"auto\";\n\t\tthis.textValue = \"\";\n\t\tthis.textTexture = null;\n\t\tthis.textTextureTransformId = NaN;\n\t\tthis.textColor = NaN;\n\t\tthis.textAlpha = NaN;\n\t\tthis.textWeight = NaN;\n\t\tthis.textStyle = NaN;\n\t\tthis.textAlignHorizontal = NaN;\n\t\tthis.textAlignVertical = NaN;\n\t\tthis.textOffsetHorizontal = NaN;\n\t\tthis.textOffsetVertical = NaN;\n\t\tthis.textOutlineWidth = NaN;\n\t\tthis.textOutlineColor = NaN;\n\t\tthis.textOutlineAlpha = NaN;\n\t\tthis.textSpacingHorizontal = NaN;\n\t\tthis.textSpacingVertical = NaN;\n\t\tthis.textDirection = NaN;\n\t\tthis.textPaddingHorizontal = NaN;\n\t\tthis.textPaddingVertical = NaN;\n\t\tthis.textClipping = false;\n\t\tthis.textVertexCount = tvcount;\n\t\tthis.textIndexCount = ticount;\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst textCount = EShapeTextUploadeds.getTextCount( shape, this.buffer.workCount );\n\t\t\treturn ( textCount.vertexCount === this.textVertexCount );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateColor( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vertexCount = this.vertexCount - this.textVertexCount;\n\t\tthis.updateColorFillAndStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected getTextBBox(\n\t\thalign: EShapeTextAlignHorizontal,\n\t\tvalign: EShapeTextAlignVertical,\n\t\thoffset: number,\n\t\tvoffset: number,\n\t\thpadding: number,\n\t\tvpadding: number,\n\t\twidth: number, height: number,\n\t\tx0: number, y0: number,\n\t\tx1: number, y1: number,\n\t\tx2: number, y2: number,\n\t\tx3: number, y3: number,\n\t\thnx: number, hny: number,\n\t\tvnx: number, vny: number,\n\t\tresult: Point\n\t): void {\n\t\tswitch( halign ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected normalize( dx: number, dy: number, defx: number, defy: number, result: Point ): number {\n\t\tconst d = dx * dx + dy * dy;\n\t\tif( FMIN < d ) {\n\t\t\tconst l = Math.sqrt( d );\n\t\t\tconst li = 1 / l;\n\t\t\tresult.set( dx * li, dy * li );\n\t\t\treturn l;\n\t\t} else {\n\t\t\tresult.set( defx, defy );\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprotected rotateAlignHorizontalRight( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\treturn EShapeTextAlignVertical.BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.TOP;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\t}\n\t}\n\n\tprotected rotateAlignVerticalRight( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.LEFT;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\t}\n\t}\n\n\tprotected rotateAlignHorizontalLeft( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\treturn EShapeTextAlignVertical.TOP;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\t}\n\t}\n\n\tprotected rotateAlignVerticalLeft( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.LEFT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\t}\n\t}\n\n\tprotected updateTextVertex( buffer: EShapeBuffer, shape: EShape, textAtlas: EShapeTextAtlas ) {\n\t\tconst text = shape.text;\n\t\tconst textSize = text.size;\n\t\tconst textFamily = text.family;\n\t\tconst textValue = text.value;\n\t\tconst textStyle = text.style;\n\t\tconst textAlignHorizontal = text.align.horizontal;\n\t\tconst textAlignVertical = text.align.vertical;\n\t\tconst textOffsetHorizontal = text.offset.horizontal;\n\t\tconst textOffsetVertical = text.offset.vertical;\n\t\tconst textSpacingHorizontal = text.spacing.horizontal;\n\t\tconst textSpacingVertical = text.spacing.vertical;\n\t\tconst textDirection = text.direction;\n\t\tconst textPaddingHorizontal = text.padding.horizontal;\n\t\tconst textPaddingVertical = text.padding.vertical;\n\t\tconst textClipping = text.clipping;\n\t\tconst textTexture = text.texture || Texture.WHITE;\n\t\tconst textTextureTransformId = this.toTextureTransformId( textTexture );\n\n\t\tconst isCharChanged = (textValue !== this.textValue || textFamily !== this.textFamily);\n\t\tconst isCharSizeChanged = (textSize !== this.textSize);\n\t\tconst isCharStyleChanged = (textStyle !== this.textStyle);\n\t\tconst isCharAlignChanged = (textAlignHorizontal !== this.textAlignHorizontal ||\n\t\t\ttextAlignVertical !== this.textAlignVertical);\n\t\tconst isCharOffsetChanged = (textOffsetHorizontal !== this.textOffsetHorizontal ||\n\t\t\ttextOffsetVertical !== this.textOffsetVertical);\n\t\tconst isCharSpacingChanged = (textSpacingHorizontal !== this.textSpacingHorizontal ||\n\t\t\ttextSpacingVertical !== this.textSpacingVertical ||\n\t\t\ttextPaddingHorizontal !== this.textPaddingHorizontal ||\n\t\t\ttextPaddingVertical !== this.textPaddingVertical);\n\t\tconst isCharDirectionChanged = (textDirection !== this.textDirection);\n\t\tconst isClippingChanged = ( this.textClipping !== textClipping );\n\t\tconst isTextureChanged = ( textTexture !== this.textTexture ||\n\t\t\ttextTextureTransformId !== this.textTextureTransformId );\n\n\t\tif( isCharChanged || isCharSizeChanged || isCharStyleChanged ||\n\t\t\tisCharAlignChanged || isCharOffsetChanged || isCharSpacingChanged ||\n\t\t\tisCharDirectionChanged || isClippingChanged || isTextureChanged ) {\n\t\t\tthis.textSize = textSize;\n\t\t\tthis.textFamily = textFamily;\n\t\t\tthis.textValue = textValue;\n\t\t\tthis.textStyle = textStyle;\n\t\t\tthis.textAlignHorizontal = textAlignHorizontal;\n\t\t\tthis.textAlignVertical = textAlignVertical;\n\t\t\tthis.textOffsetHorizontal = textOffsetHorizontal;\n\t\t\tthis.textOffsetVertical = textOffsetVertical;\n\t\t\tthis.textSpacingHorizontal = textSpacingHorizontal;\n\t\t\tthis.textSpacingVertical = textSpacingVertical;\n\t\t\tthis.textDirection = textDirection;\n\t\t\tthis.textPaddingHorizontal = textPaddingHorizontal;\n\t\t\tthis.textPaddingVertical = textPaddingVertical;\n\t\t\tthis.textClipping = textClipping;\n\t\t\tthis.textTexture = textTexture;\n\t\t\tthis.textTextureTransformId = textTextureTransformId;\n\n\t\t\tif( isCharSizeChanged ) {\n\t\t\t\t// Invalidate the text weight to update the text steps.\n\t\t\t\tthis.textWeight = NaN;\n\t\t\t}\n\n\t\t\t// Calculate the transformed positions\n\t\t\t//\n\t\t\t//  0               1\n\t\t\t// |---------------|\n\t\t\t// |               |\n\t\t\t// |3              |2\n\t\t\t// |---------------|\n\t\t\t//\n\t\t\tconst size = shape.size;\n\t\t\tconst sx = size.x * 0.5;\n\t\t\tconst sy = size.y * 0.5;\n\t\t\tshape.updateTransform();\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = buffer.work;\n\t\t\twork.set( -sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( +sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x1 = work.x;\n\t\t\tconst y1 = work.y;\n\t\t\twork.set( +sx, +sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x2 = work.x;\n\t\t\tconst y2 = work.y;\n\t\t\tconst x3 = x0 + (x2 - x1);\n\t\t\tconst y3 = y0 + (y2 - y1);\n\n\t\t\t// Horizontal normal\n\t\t\tconst hl = toLength( x0, y0, x1, y1 );\n\t\t\tthis.normalize( internalTransform.a, internalTransform.b, 1, 0, work );\n\t\t\tlet hnx = work.x;\n\t\t\tlet hny = work.y;\n\n\t\t\t// Vertical normal\n\t\t\tconst vl = toLength( x0, y0, x3, y3 );\n\t\t\tthis.normalize( internalTransform.c, internalTransform.d, 0, 1, work );\n\t\t\tlet vnx = work.x;\n\t\t\tlet vny = work.y;\n\n\t\t\t// Calculate the width / height\n\t\t\tlet width = 0;\n\t\t\tlet height = 0;\n\t\t\tlet heightChar = 0;\n\t\t\tconst lineHeight = Math.max( 0, textSize + textSpacingVertical );\n\t\t\tlet lineWidth = 0;\n\t\t\tconst textAtlasCharacters = textAtlas.characters;\n\t\t\tconst iterator = UtilCharacterIterator.from( textValue );\n\t\t\tlet advancePrevious = 0;\n\t\t\twhile( iterator.hasNext() ) {\n\t\t\t\tconst character = iterator.next();\n\t\t\t\tif( character !== \"\\n\" ) {\n\t\t\t\t\tif( 0 < advancePrevious ) {\n\t\t\t\t\t\tlineWidth += Math.max( 0, advancePrevious + textSpacingHorizontal );\n\t\t\t\t\t}\n\t\t\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\t\t\tif( data ) {\n\t\t\t\t\t\tadvancePrevious = data.advance;\n\t\t\t\t\t\theightChar = data.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadvancePrevious = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlineWidth += advancePrevious;\n\t\t\t\t\tadvancePrevious = 0;\n\t\t\t\t\twidth = Math.max( width, lineWidth );\n\t\t\t\t\tlineWidth = 0;\n\t\t\t\t\theight += lineHeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst scale = textSize / textAtlas.font.size;\n\t\t\tlineWidth += advancePrevious;\n\t\t\twidth = Math.max( width, lineWidth ) * scale;\n\t\t\tlineWidth = 0;\n\t\t\theightChar *= scale;\n\t\t\theight += textSize;\n\n\t\t\t//\n\t\t\tlet tx0 = 0;\n\t\t\tlet ty0 = 0;\n\t\t\tlet lineWidthMaximum = NaN;\n\t\t\tswitch( textDirection ) {\n\t\t\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\ttextAlignHorizontal,\n\t\t\t\t\ttextAlignVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\t\tlineWidthMaximum = hl - textPaddingHorizontal * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t\t\t// Swap normals\n\t\t\t\twork.set( vnx, vny );\n\t\t\t\tvnx = -hnx;\n\t\t\t\tvny = -hny;\n\t\t\t\thnx = work.x;\n\t\t\t\thny = work.y;\n\n\t\t\t\t// Get text bbox\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\tthis.rotateAlignVerticalRight( textAlignVertical ),\n\t\t\t\t\tthis.rotateAlignHorizontalRight( textAlignHorizontal ),\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t\t\t// Swap normals\n\t\t\t\twork.set( vnx, vny );\n\t\t\t\tvnx = hnx;\n\t\t\t\tvny = hny;\n\t\t\t\thnx = -work.x;\n\t\t\t\thny = -work.y;\n\n\t\t\t\t// Get text bbox\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\tthis.rotateAlignVerticalLeft( textAlignVertical ),\n\t\t\t\t\tthis.rotateAlignHorizontalLeft( textAlignHorizontal ),\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t//\n\t\t\tconst textWorld = text.world = text.world || new Float32Array( 8 );\n\t\t\tif( lineWidthMaximum < width ) {\n\t\t\t\tconst dwidth = ( width - lineWidthMaximum ) * 0.5;\n\t\t\t\ttextWorld[ 0 ] = tx0 + hnx * dwidth;\n\t\t\t\ttextWorld[ 1 ] = ty0 + hny * dwidth;\n\t\t\t\ttextWorld[ 2 ] = hnx;\n\t\t\t\ttextWorld[ 3 ] = hny;\n\t\t\t\ttextWorld[ 4 ] = vnx;\n\t\t\t\ttextWorld[ 5 ] = vny;\n\t\t\t\ttextWorld[ 6 ] = lineWidthMaximum;\n\t\t\t\ttextWorld[ 7 ] = height;\n\t\t\t} else {\n\t\t\t\ttextWorld[ 0 ] = tx0;\n\t\t\t\ttextWorld[ 1 ] = ty0;\n\t\t\t\ttextWorld[ 2 ] = hnx;\n\t\t\t\ttextWorld[ 3 ] = hny;\n\t\t\t\ttextWorld[ 4 ] = vnx;\n\t\t\t\ttextWorld[ 5 ] = vny;\n\t\t\t\ttextWorld[ 6 ] = width;\n\t\t\t\ttextWorld[ 7 ] = height;\n\t\t\t}\n\n\t\t\t// Texture\n\t\t\tconst textureUvs = this.toTextureUvs( textTexture ) as any;\n\t\t\tconst uvx0 = textureUvs.x0;\n\t\t\tconst uvx1 = textureUvs.x1;\n\t\t\tconst uvx3 = textureUvs.x3;\n\t\t\tconst uvy0 = textureUvs.y0;\n\t\t\tconst uvy1 = textureUvs.y1;\n\t\t\tconst uvy3 = textureUvs.y3;\n\n\t\t\tconst duvx01 = ( uvx1 - uvx0 );\n\t\t\tconst duvy01 = ( uvy1 - uvy0 );\n\t\t\tconst duvx03 = ( uvx3 - uvx0 );\n\t\t\tconst duvy03 = ( uvy3 - uvy0 );\n\n\t\t\t// Vertices & UVs\n\t\t\tconst vcount = this.textVertexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.uvBuffer.update();\n\n\t\t\tconst lhx = lineHeight * vnx;\n\t\t\tconst lhy = lineHeight * vny;\n\n\t\t\tconst snx = scale * hnx;\n\t\t\tconst sny = scale * hny;\n\n\t\t\tconst offsetY = (heightChar - textSize) * 0.5;\n\t\t\tconst oyx = offsetY * vnx;\n\t\t\tconst oyy = offsetY * vny;\n\n\t\t\tconst offsetItalic = ( textStyle === EShapeTextStyle.NORMAL ? 0 : text.size * 0.25 );\n\t\t\tlet bx0 = tx0 - oyx + offsetItalic * snx;\n\t\t\tlet by0 = ty0 - oyy + offsetItalic * sny;\n\t\t\tlet bx3 = tx0 + oyx + textSize * vnx;\n\t\t\tlet by3 = ty0 + oyy + textSize * vny;\n\t\t\tlet cx0 = bx0;\n\t\t\tlet cy0 = by0;\n\t\t\tlet cx3 = bx3;\n\t\t\tlet cy3 = by3;\n\n\t\t\tlineWidth = 0;\n\t\t\tadvancePrevious = 0;\n\t\t\titerator.position = 0;\n\t\t\tlet lineCount = 0;\n\t\t\tlet iv = voffset * 2;\n\t\t\tfor( ; iterator.hasNext(); iv += 8 ) {\n\t\t\t\tconst character = iterator.next();\n\t\t\t\tif( character !== \"\\n\" ) {\n\t\t\t\t\tif( 0 < advancePrevious ) {\n\t\t\t\t\t\tlineWidth += Math.max( 0, advancePrevious + textSpacingHorizontal );\n\t\t\t\t\t}\n\t\t\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\t\t\tlineCount += 1;\n\t\t\t\t\tif( data ) {\n\t\t\t\t\t\tconst advance = data.advance;\n\t\t\t\t\t\tif( lineWidthMaximum < lineWidth ) {\n\t\t\t\t\t\t\tconst dots = textAtlasCharacters[ \"...\" ];\n\t\t\t\t\t\t\tif( dots ) {\n\t\t\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\t\t\tvertices, uvs, iv, dots, textAtlas,\n\t\t\t\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tconst advanceDots = dots.advance;\n\t\t\t\t\t\t\t\tconst ax = advanceDots * snx;\n\t\t\t\t\t\t\t\tconst ay = advanceDots * sny;\n\t\t\t\t\t\t\t\tcx0 = cx0 + ax;\n\t\t\t\t\t\t\t\tcy0 = cy0 + ay;\n\t\t\t\t\t\t\t\tcx3 = cx3 + ax;\n\t\t\t\t\t\t\t\tcy3 = cy3 + ay;\n\t\t\t\t\t\t\t\tadvancePrevious = advanceDots;\n\n\t\t\t\t\t\t\t\tfor( iv += 8; iterator.hasNext(); iv += 8 ) {\n\t\t\t\t\t\t\t\t\tif( iterator.advance( \"\\n\" ) ) {\n\t\t\t\t\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tlineCount += 1;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tiv -= 8;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tadvancePrevious = advance;\n\n\t\t\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tadvancePrevious = advance;\n\n\t\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\t\tvertices, uvs, iv, data, textAtlas,\n\t\t\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst ax = advance * snx;\n\t\t\t\t\t\t\tconst ay = advance * sny;\n\t\t\t\t\t\t\tcx0 = cx0 + ax;\n\t\t\t\t\t\t\tcy0 = cy0 + ay;\n\t\t\t\t\t\t\tcx3 = cx3 + ax;\n\t\t\t\t\t\t\tcy3 = cy3 + ay;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadvancePrevious = 0;\n\n\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlineWidth += advancePrevious;\n\t\t\t\t\tadvancePrevious = 0;\n\n\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t);\n\n\t\t\t\t\tbx0 += lhx;\n\t\t\t\t\tby0 += lhy;\n\t\t\t\t\tbx3 += lhx;\n\t\t\t\t\tby3 += lhy;\n\t\t\t\t\tcx0 = bx0;\n\t\t\t\t\tcy0 = by0;\n\t\t\t\t\tcx3 = bx3;\n\t\t\t\t\tcy3 = by3;\n\n\t\t\t\t\tthis.adjustTextAlignment(\n\t\t\t\t\t\tvertices,\n\t\t\t\t\t\thnx, hny,\n\t\t\t\t\t\tlineCount,\n\t\t\t\t\t\tiv,\n\t\t\t\t\t\twidth - lineWidth * scale,\n\t\t\t\t\t\ttextDirection,\n\t\t\t\t\t\ttextAlignHorizontal,\n\t\t\t\t\t\ttextAlignVertical\n\t\t\t\t\t);\n\t\t\t\t\tlineWidth = 0;\n\t\t\t\t\tlineCount = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlineWidth += advancePrevious;\n\t\t\tthis.adjustTextAlignment(\n\t\t\t\tvertices,\n\t\t\t\thnx, hny,\n\t\t\t\tlineCount,\n\t\t\t\tiv,\n\t\t\t\twidth - lineWidth * scale,\n\t\t\t\ttextDirection,\n\t\t\t\ttextAlignHorizontal,\n\t\t\t\ttextAlignVertical\n\t\t\t);\n\n\t\t\tfor( const ivmax = (voffset + vcount) * 2; iv < ivmax; iv += 2 ) {\n\t\t\t\tvertices[ iv + 0 ] = tx0;\n\t\t\t\tvertices[ iv + 1 ] = ty0;\n\t\t\t\tuvs[ iv + 0 ] = uvx0;\n\t\t\t\tuvs[ iv + 1 ] = uvy0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected writeCharacterEmpty(\n\t\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\t\tcx0: number, cy0: number,\n\t\tcx3: number, cy3: number,\n\t\tuvx0: number, uvy0: number,\n\t\tuvx3: number, uvy3: number\n\t): void {\n\t\tvertices[ iv + 0 ] = cx0;\n\t\tvertices[ iv + 1 ] = cy0;\n\t\tvertices[ iv + 2 ] = cx0;\n\t\tvertices[ iv + 3 ] = cy0;\n\t\tvertices[ iv + 4 ] = cx3;\n\t\tvertices[ iv + 5 ] = cy3;\n\t\tvertices[ iv + 6 ] = cx3;\n\t\tvertices[ iv + 7 ] = cy3;\n\n\t\tuvs[ iv + 0 ] = uvx0;\n\t\tuvs[ iv + 1 ] = uvy0;\n\t\tuvs[ iv + 2 ] = uvx0;\n\t\tuvs[ iv + 3 ] = uvy0;\n\t\tuvs[ iv + 4 ] = uvx3;\n\t\tuvs[ iv + 5 ] = uvy3;\n\t\tuvs[ iv + 6 ] = uvx3;\n\t\tuvs[ iv + 7 ] = uvy3;\n\t}\n\n\tprotected writeCharacter(\n\t\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\t\tdata: EShapeTextAtlasCharacter, atlas: EShapeTextAtlas,\n\t\tsnx: number, sny: number,\n\t\tcx0: number, cy0: number,\n\t\tcx3: number, cy3: number,\n\t\tduvx01: number, duvy01: number,\n\t\tduvx03: number, duvy03: number,\n\t\tuvx0: number, uvy0: number\n\t): void {\n\t\t// Vertices\n\t\tconst dataOffsetX = data.x - data.origin.x;\n\t\tconst dataWidth = data.width;\n\t\tconst dx0 = dataOffsetX * snx;\n\t\tconst dy0 = dataOffsetX * sny;\n\t\tconst dx1 = (dataOffsetX + dataWidth) * snx;\n\t\tconst dy1 = (dataOffsetX + dataWidth) * sny;\n\t\tvertices[ iv + 0 ] = cx0 + dx0;\n\t\tvertices[ iv + 1 ] = cy0 + dy0;\n\t\tvertices[ iv + 2 ] = cx0 + dx1;\n\t\tvertices[ iv + 3 ] = cy0 + dy1;\n\t\tvertices[ iv + 4 ] = cx3 + dx1;\n\t\tvertices[ iv + 5 ] = cy3 + dy1;\n\t\tvertices[ iv + 6 ] = cx3 + dx0;\n\t\tvertices[ iv + 7 ] = cy3 + dy0;\n\n\t\t// UVs\n\t\tconst px0 = data.x / atlas.width;\n\t\tconst py0 = data.y / atlas.height;\n\t\tconst px1 = (data.x + data.width) / atlas.width;\n\t\tconst py1 = (data.y + data.height) / atlas.height;\n\n\t\tconst dux0 = duvx01 * px0;\n\t\tconst duy0 = duvy01 * px0;\n\t\tconst dux1 = duvx01 * px1;\n\t\tconst duy1 = duvy01 * px1;\n\n\t\tconst dvx0 = duvx03 * py0;\n\t\tconst dvy0 = duvy03 * py0;\n\t\tconst dvx1 = duvx03 * py1;\n\t\tconst dvy1 = duvy03 * py1;\n\t\tuvs[ iv + 0 ] = uvx0 + dux0 + dvx0;\n\t\tuvs[ iv + 1 ] = uvy0 + duy0 + dvy0;\n\t\tuvs[ iv + 2 ] = uvx0 + dux1 + dvx0;\n\t\tuvs[ iv + 3 ] = uvy0 + duy1 + dvy0;\n\t\tuvs[ iv + 4 ] = uvx0 + dux1 + dvx1;\n\t\tuvs[ iv + 5 ] = uvy0 + duy1 + dvy1;\n\t\tuvs[ iv + 6 ] = uvx0 + dux0 + dvx1;\n\t\tuvs[ iv + 7 ] = uvy0 + duy0 + dvy1;\n\t}\n\n\tprotected moveText( vertices: Float32Array, vertexIndex: number, textCount: number, dx: number, dy: number ): void {\n\t\tfor( let i = 0, iv = vertexIndex - 8 * textCount; i < textCount; i += 1, iv += 8 ) {\n\t\t\tvertices[ iv + 0 ] += dx;\n\t\t\tvertices[ iv + 1 ] += dy;\n\t\t\tvertices[ iv + 2 ] += dx;\n\t\t\tvertices[ iv + 3 ] += dy;\n\t\t\tvertices[ iv + 4 ] += dx;\n\t\t\tvertices[ iv + 5 ] += dy;\n\t\t\tvertices[ iv + 6 ] += dx;\n\t\t\tvertices[ iv + 7 ] += dy;\n\t\t}\n\t}\n\n\tprotected moveTextHalf(\n\t\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\t\toffset: number, nx: number, ny: number\n\t): void {\n\t\toffset *= 0.5;\n\t\tthis.moveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n\t}\n\n\tprotected moveTextFull(\n\t\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\t\toffset: number, nx: number, ny: number\n\t): void {\n\t\tthis.moveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n\t}\n\n\tprotected adjustTextAlignment(\n\t\tvertices: Float32Array,\n\t\tnx: number, ny: number,\n\t\tlineCount: number, vertexIndex: number,\n\t\toffset: number,\n\t\ttextDirection: EShapeTextDirection,\n\t\ttextAlignHorizontal: EShapeTextAlignHorizontal,\n\t\ttextAlignVertical: EShapeTextAlignVertical\n\t): void {\n\t\tif( FMIN < offset ) {\n\t\t\tswitch( textDirection ) {\n\t\t\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateTextColorFill( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst color = text.color;\n\t\tconst alpha = ( shape.visible && text.enable ? text.alpha : 0 );\n\t\tif( color !== this.textColor || alpha !== this.textAlpha ) {\n\t\t\tthis.textColor = color;\n\t\t\tthis.textAlpha = alpha;\n\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset + this.vertexCount - this.textVertexCount,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColorStroke( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst outline = text.outline;\n\t\tconst color = outline.color;\n\t\tconst alpha = ( shape.visible && text.enable ? outline.alpha : 0 );\n\t\tif( color !== this.textOutlineColor || alpha !== this.textOutlineAlpha ) {\n\t\t\tthis.textOutlineColor = color;\n\t\t\tthis.textOutlineAlpha = alpha;\n\t\t\tbuffer.colorStrokeBuffer.update();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset + this.vertexCount - this.textVertexCount,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst textOutline = text.outline;\n\t\tconst textOutlineWidth = (textOutline.enable ? textOutline.width : 0);\n\t\tconst textWeight = text.weight;\n\t\tif( textWeight !== this.textWeight || textOutlineWidth !== this.textOutlineWidth ) {\n\t\t\tthis.textWeight = textWeight;\n\t\t\tthis.textOutlineWidth = textOutlineWidth;\n\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst vcount = this.textVertexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\n\t\t\tconst textAtlas = text.atlas;\n\t\t\tif( textAtlas != null ) {\n\t\t\t\tconst scale = 0.05 / (text.size / textAtlas.font.size);\n\t\t\t\tconst outlineWidth = textOutlineWidth * 0.4;\n\t\t\t\tconst weight =  -0.025 + ( textWeight === EShapeTextWeight.NORMAL ? 0.0 : 0.05 );\n\t\t\t\tfor( let i = voffset * 2, imax = i + vcount * 2; i < imax; i += 2 ) {\n\t\t\t\t\tsteps[ i + 0 ] = scale;\n\t\t\t\t\tsteps[ i + 1 ] = outlineWidth;\n\t\t\t\t}\n\t\t\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\t\t\tantialiases[ i +  0 ] = weight;\n\t\t\t\t\tantialiases[ i +  1 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  2 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  3 ] = FMIN;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = voffset * 2, imax = i + vcount * 2; i < imax; i += 2 ) {\n\t\t\t\t\tsteps[ i + 0 ] = 0;\n\t\t\t\t\tsteps[ i + 1 ] = 0;\n\t\t\t\t}\n\t\t\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\t\t\tantialiases[ i +  0 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  1 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  2 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  3 ] = FMIN;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateText( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\tconst textAtlas = shape.text.atlas;\n\t\t\tif( textAtlas != null ) {\n\t\t\t\tthis.updateTextVertex( buffer, shape, textAtlas );\n\t\t\t\tthis.updateTextColorFill( buffer, shape );\n\t\t\t\tthis.updateTextColorStroke( buffer, shape );\n\t\t\t\tthis.updateTextStep( buffer, shape );\n\t\t\t}\n\t\t}\n\t}\n\n\tinitText() {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\tconst icount = this.textIndexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\t\t\tconst ioffset = this.indexOffset + this.indexCount - icount;\n\t\t\tconst buffer = this.buffer;\n\n\t\t\t// Clippings\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tfor( let i = voffset * 3, imax = i + vcount * 3; i < imax; i += 3 ) {\n\t\t\t\tclippings[ i + 0 ] = 0;\n\t\t\t\tclippings[ i + 1 ] = 0;\n\t\t\t\tclippings[ i + 2 ] = 2;\n\t\t\t}\n\n\t\t\t// Indices\n\t\t\tbuffer.indexBuffer.update();\n\t\t\tconst indices = buffer.indices;\n\t\t\tfor( let i = 0, ii = ioffset * 3, imax = (icount >> 1); i < imax; i += 1, ii += 6 ) {\n\t\t\t\tconst j = voffset + ( i << 2 );\n\t\t\t\tindices[ ii + 0 ] = j + 0;\n\t\t\t\tindices[ ii + 1 ] = j + 1;\n\t\t\t\tindices[ ii + 2 ] = j + 3;\n\n\t\t\t\tindices[ ii + 3 ] = j + 1;\n\t\t\t\tindices[ ii + 4 ] = j + 2;\n\t\t\t\tindices[ ii + 5 ] = j + 3;\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tsuper.buildUnit( builder );\n\n\t\tif( 0 < this.textVertexCount ) {\n\t\t\tconst textTexture = this.textTexture || Texture.WHITE;\n\t\t\tconst textBaseTexture = textTexture.baseTexture;\n\t\t\tif( textBaseTexture !== builder.baseTexture ) {\n\t\t\t\tbuilder.baseTexture = textBaseTexture;\n\t\t\t\tconst indexOffset = this.indexOffset + this.indexCount - this.textIndexCount;\n\t\t\t\tbuilder.push( textTexture, indexOffset );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapePointsStyleUploadeds } from \"../e-shape-points-style-uploadeds\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeBarPoints } from \"./e-shape-bar-points\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nconst FMIN: number = 0.00001;\n\nexport class EShapeBarUploaded extends EShapeTextUploaded {\n\tprotected pointsId: number;\n\tprotected pointsStyle: EShapePointsStyle;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointsId = NaN;\n\t\tthis.pointsStyle = EShapePointsStyle.NONE;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Clipping & indices\n\t\tbuffer.clippingBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\n\t\t// Clippings\n\t\tconst ic = voffset * 3;\n\t\tclippings[ ic +  0 ] = 1;\n\t\tclippings[ ic +  1 ] = 0;\n\t\tclippings[ ic +  2 ] = 3;\n\n\t\tclippings[ ic +  3 ] = 0;\n\t\tclippings[ ic +  4 ] = 1;\n\t\tclippings[ ic +  5 ] = 5;\n\n\t\tclippings[ ic +  6 ] = 1;\n\t\tclippings[ ic +  7 ] = 0;\n\t\tclippings[ ic +  8 ] = 3;\n\n\t\tclippings[ ic +  9 ] = 0;\n\t\tclippings[ ic + 10 ] = 1;\n\t\tclippings[ ic + 11 ] = 5;\n\n\t\t// Indices\n\t\tconst ii = ioffset * 3;\n\t\tindices[ ii + 0 ] = voffset + 0;\n\t\tindices[ ii + 1 ] = voffset + 2;\n\t\tindices[ ii + 2 ] = voffset + 1;\n\n\t\tindices[ ii + 3 ] = voffset + 1;\n\t\tindices[ ii + 4 ] = voffset + 2;\n\t\tindices[ ii + 5 ] = voffset + 3;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tif( shape instanceof EShapeBar ) {\n\t\t\tconst size = shape.size;\n\t\t\tconst sizeX = size.x;\n\t\t\tconst sizeY = size.y;\n\t\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\t\tconst pointsId = shape.points.id;\n\t\t\tconst isPointsIdChanged = ( pointsId !== this.pointsId );\n\t\t\tconst pointsStyle = shape.points.style;\n\t\t\tconst isPointsStyleChanged = ( pointsStyle !== this.pointsStyle );\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeWidthChanged || isPointsIdChanged || isPointsStyleChanged ) {\n\t\t\t\tthis.sizeX = sizeX;\n\t\t\t\tthis.sizeY = sizeY;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\t\tthis.pointsId = pointsId;\n\t\t\t\tthis.pointsStyle = pointsStyle;\n\t\t\t\tbuffer.vertexBuffer.update();\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointsIdChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tconst voffset = this.vertexOffset;\n\t\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\t\tthis.updateLineVertexStepAndColorFill(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tshape.points,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.transform.internalTransform,\n\t\t\t\t\tvoffset, vcount\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateBarUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ): void {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected updateLineVertexStepAndColorFill(\n\t\tbuffer: EShapeBuffer,\n\t\tpoints: EShapeBarPoints,\n\t\tstrokeWidth: number,\n\t\tinternalTransform: Matrix,\n\t\tvoffset: number,\n\t\tvcount: number\n\t): void {\n\t\tconst iv = voffset * 2;\n\t\tconst ia = voffset * 4;\n\t\tconst vertices = buffer.vertices;\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst colorFills = buffer.colorFills;\n\t\tconst pointCount = points.length;\n\t\tconst pointValues = points.values;\n\t\tconst pointsStyle = points.style;\n\t\tconst pointsSize = points.size;\n\t\tconst scaleInvariant = EShapePointsStyleUploadeds.toScaleInvariant( pointsStyle );\n\n\t\t// First point\n\t\tconst work = buffer.work;\n\t\twork.set( pointValues[ 0 ], pointValues[ 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst p1x = work.x;\n\t\tconst p1y = work.y;\n\n\t\t// Last point\n\t\tconst lastIndex = (pointCount - 1) << 1;\n\t\twork.set( pointValues[ lastIndex + 0 ], pointValues[ lastIndex + 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tlet p2x = work.x;\n\t\tlet p2y = work.y;\n\n\t\t// Normal\n\t\tlet dx = p2x - p1x;\n\t\tlet dy = p2y - p1y;\n\t\tconst d = Math.sqrt( dx * dx + dy * dy );\n\t\tlet l = d;\n\t\tif( 0 <= pointsSize && FMIN < d ) {\n\t\t\tconst ratio = pointsSize / d;\n\t\t\tdx *= ratio;\n\t\t\tdy *= ratio;\n\t\t\tp2x = p1x + dx;\n\t\t\tp2y = p1y + dy;\n\t\t\tl = pointsSize;\n\t\t}\n\n\t\t// Other points\n\t\tconst p0x = p1x - dx;\n\t\tconst p0y = p1y - dy;\n\t\tconst p3x = p2x + dx;\n\t\tconst p3y = p2y + dy;\n\n\t\t//\n\t\tvertices[ iv + 0 ] = p1x;\n\t\tvertices[ iv + 1 ] = p1y;\n\t\tvertices[ iv + 2 ] = p1x;\n\t\tvertices[ iv + 3 ] = p1y;\n\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\tantialiases[ ia + 0 ] = p0x;\n\t\tantialiases[ ia + 1 ] = p0y;\n\t\tantialiases[ ia + 2 ] = p2x;\n\t\tantialiases[ ia + 3 ] = p2y;\n\t\tantialiases[ ia + 4 ] = p0x;\n\t\tantialiases[ ia + 5 ] = p0y;\n\t\tantialiases[ ia + 6 ] = p2x;\n\t\tantialiases[ ia + 7 ] = p2y;\n\t\tcolorFills[ ia + 0 ] = 0.0;\n\t\tcolorFills[ ia + 4 ] = 0.0;\n\n\t\tvertices[ iv + 4 ] = p2x;\n\t\tvertices[ iv + 5 ] = p2y;\n\t\tvertices[ iv + 6 ] = p2x;\n\t\tvertices[ iv + 7 ] = p2y;\n\t\tsteps[ iv + 4 ] = strokeWidth;\n\t\tsteps[ iv + 5 ] = scaleInvariant;\n\t\tsteps[ iv + 6 ] = strokeWidth;\n\t\tsteps[ iv + 7 ] = scaleInvariant;\n\t\tantialiases[ ia +  8 ] = p1x;\n\t\tantialiases[ ia +  9 ] = p1y;\n\t\tantialiases[ ia + 10 ] = p3x;\n\t\tantialiases[ ia + 11 ] = p3y;\n\t\tantialiases[ ia + 12 ] = p1x;\n\t\tantialiases[ ia + 13 ] = p1y;\n\t\tantialiases[ ia + 14 ] = p3x;\n\t\tantialiases[ ia + 15 ] = p3y;\n\t\tcolorFills[ ia +  8 ] = l;\n\t\tcolorFills[ ia + 12 ] = l;\n\n\t\t// Total length\n\t\tEShapePointsStyleUploadeds.toDash( l, strokeWidth, pointsStyle, work );\n\t\tconst dash0 = work.x;\n\t\tconst dash1 = work.y;\n\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\tcolorFills[ i + 3 ] = l;\n\t\t}\n\t}\n\n\tupdateBarUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\n\t\t\t// Uvs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst iuv = voffset * 2;\n\n\t\t\tuvs[ iuv + 0 ] = textureUvs.x0;\n\t\t\tuvs[ iuv + 1 ] = textureUvs.y0;\n\t\t\tuvs[ iuv + 2 ] = textureUvs.x3;\n\t\t\tuvs[ iuv + 3 ] = textureUvs.y3;\n\n\t\t\tuvs[ iuv + 4 ] = textureUvs.x1;\n\t\t\tuvs[ iuv + 5 ] = textureUvs.y1;\n\t\t\tuvs[ iuv + 6 ] = textureUvs.x2;\n\t\t\tuvs[ iuv + 7 ] = textureUvs.y2;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeBarUploaded } from \"./e-shape-bar-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeBarUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeBarUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 4 + tvcount;\n\t\tconst icount = 2 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeBarUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isArray = Array.isArray || (( target: any ): target is unknown[] => {\n\treturn Object.prototype.toString.call( target ) === \"[object Array]\";\n});\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeActionBases {\n\tstatic toBaseFill( shape: EShape, runtime: EShapeRuntime ): EShapeFillLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_FILL ? shape : runtime ).fill;\n\t}\n\n\tstatic toBaseStroke( shape: EShape, runtime: EShapeRuntime ): EShapeStrokeLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_STROKE ? shape : runtime ).stroke;\n\t}\n\n\tstatic toBaseText( shape: EShape, runtime: EShapeRuntime ): EShapeTextLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT ? shape : runtime ).text;\n\t}\n\n\tstatic toBaseTextOutline( shape: EShape, runtime: EShapeRuntime ): EShapeTextOutlineLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ? shape : runtime ).text.outline;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../../d-applications\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\n\nexport type EShapeActionExpression<T> = ( shape: EShape, time: number ) => T;\n\nexport class EShapeActionRuntime {\n\treset: EShapeRuntimeReset;\n\n\tconstructor( reset?: EShapeRuntimeReset ) {\n\t\tthis.reset = reset || EShapeRuntimeReset.NONE;\n\t}\n\n\ttoExpression<T>(\n\t\texpression: string, def: EShapeActionExpression<T>, defLiteral: string\n\t): EShapeActionExpression<T> {\n\t\tif( expression.trim().length <= 0 ) {\n\t\t\treturn def;\n\t\t}\n\n\t\ttry {\n\t\t\treturn Function(\n\t\t\t\t\"shape\", \"time\",\n\t\t\t\t`try{ with( shape ) { return (${expression}); } } catch( e ) { return ${defLiteral}; }`\n\t\t\t) as EShapeActionExpression<T>;\n\t\t} catch( e ) {\n\t\t\treturn def;\n\t\t}\n\t}\n\n\temit( name: string, shape: EShape, parameter1?: unknown, parameter2?: unknown ): void {\n\t\tif( parameter1 === undefined ) {\n\t\t\tshape.emit( name, shape );\n\t\t} else if( parameter2 === undefined ) {\n\t\t\tshape.emit( name, shape, parameter1 );\n\t\t} else {\n\t\t\tshape.emit( name, shape, parameter1, parameter2 );\n\t\t}\n\n\t\tconst layer = DApplications.getLayer( shape );\n\t\tif( layer ) {\n\t\t\tconst application = layer.application as any;\n\t\t\tif( \"shape\" in application ) {\n\t\t\t\tif( parameter1 === undefined ) {\n\t\t\t\t\tapplication.shape.emit( name, shape );\n\t\t\t\t} else if( parameter2 === undefined ) {\n\t\t\t\t\tapplication.shape.emit( name, shape, parameter1 );\n\t\t\t\t} else {\n\t\t\t\t\tapplication.shape.emit( name, shape, parameter1, parameter2 );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\t// OVERRIDE THIS\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression, EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nconst conditionDefault = (): boolean => true;\n\nexport class EShapeActionRuntimeConditional extends EShapeActionRuntime {\n\tprotected readonly condition: EShapeActionExpression<boolean>;\n\n\tconstructor( value: EShapeActionValue, reset: EShapeRuntimeReset ) {\n\t\tsuper( reset );\n\t\tthis.condition = this.toExpression( value.condition, conditionDefault, \"true\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlink extends EShapeActionRuntimeConditional {\n\tprotected interval: number;\n\n\tconstructor( value: EShapeActionValueBlink, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.interval = value.interval;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst interval = this.interval;\n\t\t\tconst dinterval = ( interval << 1 );\n\t\t\tconst elapsed = ( time % dinterval );\n\t\t\tif( elapsed < interval ) {\n\t\t\t\tthis.toOff( shape, runtime );\n\t\t\t\truntime.effect = time + ( interval - elapsed );\n\t\t\t} else {\n\t\t\t\tthis.toOn( shape, runtime );\n\t\t\t\truntime.effect = time + ( dinterval - elapsed );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkBrighten extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorFill extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.fill.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorStroke extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.stroke.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkDarken extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkOpacity extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tfill.color,\n\t\t\tfill.alpha * 0.5\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tstroke.color,\n\t\t\tstroke.alpha * 0.5\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkVisibility extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = true;\n\t\truntime.written |= this.reset;\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = false;\n\t\truntime.written |= this.reset;\n\t}\n}\n","import { DThemes } from \"../../theme/d-themes\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue, EThemeShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueBase implements EShapeActionValue {\n\treadonly type: EShapeActionValueType;\n\treadonly condition: string;\n\n\tconstructor( type: EShapeActionValueType, condition: string ) {\n\t\tthis.type = type;\n\t\tthis.condition = condition;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tthis.type === value.type &&\n\t\t\tthis.condition === value.condition\n\t\t);\n\t}\n\n\ttoLabel(): string {\n\t\treturn DThemes.getInstance().get<EThemeShapeActionValue>( \"EShapeActionValue\" ).toLabel( this );\n\t}\n\n\tabstract toRuntime( shape: EShape ): EShapeActionRuntime;\n\tabstract serialize( manager: EShapeResourceManagerSerialization ): number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueType {\n\tSHOW_HIDE,\n\tBLINK,\n\tTRANSFORM,\n\tOPEN,\n\tEMIT_EVENT,\n\tCHANGE_COLOR,\n\tCHANGE_TEXT,\n\tCHANGE_CURSOR,\n\tMISC\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueSubtyped<SUBTYPE extends number> extends EShapeActionValueBase {\n\treadonly subtype: SUBTYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE ) {\n\t\tsuper( type, condition );\n\t\tthis.subtype = subtype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueSubtyped) &&\n\t\t\tthis.subtype === value.subtype\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isNumber } from \"../../util/is-number\";\n\nexport class EShapeActionValues {\n\tstatic toResource( index: number, parsed: number[], resources: string[] ): string {\n\t\tif( 0 <= index && index < parsed.length ) {\n\t\t\tconst id = parsed[ index ];\n\t\t\tif( isNumber( id ) && 0 <= id && id < resources.length ) {\n\t\t\t\treturn resources[ id ];\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorTarget {\n\tCOLOR_AND_ALPHA,\n\tCOLOR,\n\tALPHA,\n\tCODE,\n\tBRIGHTNESS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionRuntimeBlinkBrighten } from \"./e-shape-action-runtime-blink-brighten\";\nimport { EShapeActionRuntimeBlinkColorFill } from \"./e-shape-action-runtime-blink-color-fill\";\nimport { EShapeActionRuntimeBlinkColorStroke } from \"./e-shape-action-runtime-blink-color-stroke\";\nimport { EShapeActionRuntimeBlinkDarken } from \"./e-shape-action-runtime-blink-darken\";\nimport { EShapeActionRuntimeBlinkOpacity } from \"./e-shape-action-runtime-blink-opacity\";\nimport { EShapeActionRuntimeBlinkVisibility } from \"./e-shape-action-runtime-blink-visibility\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlinkType } from \"./e-shape-action-value-blink-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueBlinkSerialized = [\n\tEShapeActionValueType.BLINK, number,\n\tEShapeActionValueBlinkType.COLOR_FILL | EShapeActionValueBlinkType.COLOR_STROKE,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueBlink extends EShapeActionValueSubtyped<EShapeActionValueBlinkType> {\n\treadonly interval: number;\n\treadonly color: number;\n\treadonly alpha: number;\n\n\tconstructor( subtype: EShapeActionValueBlinkType, condition: string, interval: number, color: number, alpha: number ) {\n\t\tsuper( EShapeActionValueType.BLINK, condition, subtype );\n\t\tthis.interval = interval;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueBlink) &&\n\t\t\tthis.interval === value.interval &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeBlink {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueBlinkType.BRIGHTEN:\n\t\t\treturn new EShapeActionRuntimeBlinkBrighten( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_FILL:\n\t\t\treturn new EShapeActionRuntimeBlinkColorFill( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_STROKE:\n\t\t\treturn new EShapeActionRuntimeBlinkColorStroke( this );\n\t\tcase EShapeActionValueBlinkType.DARKEN:\n\t\t\treturn new EShapeActionRuntimeBlinkDarken( this );\n\t\tcase EShapeActionValueBlinkType.OPACITY:\n\t\t\treturn new EShapeActionRuntimeBlinkOpacity( this );\n\t\tcase EShapeActionValueBlinkType.VISIBILITY:\n\t\t\treturn new EShapeActionRuntimeBlinkVisibility( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.interval},${this.color},${this.alpha}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueBlinkSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueBlink {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueBlink(\n\t\t\tserialized[ 2 ], condition, serialized[ 3 ],\n\t\t\tserialized[ 4 ], serialized[ 5 ]\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilAlpha {\n\tstatic blend( alphaA: number, alphaB: number, t: number ): number {\n\t\tconst w = Math.max( 0, Math.min( 1, t ) );\n\t\treturn Math.max( 0, Math.min( 1, alphaA * (1 - w) + alphaB * w ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAlpha } from \"../../util/util-alpha\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\n\nconst blendDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColor extends EShapeActionRuntimeConditional {\n\tprotected readonly color: number | undefined;\n\tprotected readonly alpha: number | undefined;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColor, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\n\t\tswitch( value.target ) {\n\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = undefined;\n\t\t\tbreak;\n\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\tthis.color = undefined;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\t}\n\n\t\tthis.blend = this.toExpression( value.blend, blendDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, base.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\ttarget.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbase.color,\n\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttarget.set( undefined, base.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t\ttext.set( undefined, color, alpha );\n\t\t\t\t\toutline.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tbaseText.alpha\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tbaseOutline.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t\ttext.set( undefined, color, baseText.alpha );\n\t\t\t\t\toutline.set( undefined, color, baseOutline.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\ttext.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\toutline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t\ttext.set( undefined, baseText.color, alpha );\n\t\t\t\toutline.set( undefined, baseOutline.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorType {\n\tFILL,\n\tSTROKE,\n\tFILL_AND_STROKE,\n\tTEXT,\n\tTEXT_OUTLINE,\n\tALL\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorAll extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorFill extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorFillAndStroke extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorStroke extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorText extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorTextOutline extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionRuntimeChangeColorAll } from \"./e-shape-action-runtime-change-color-all\";\nimport { EShapeActionRuntimeChangeColorFill } from \"./e-shape-action-runtime-change-color-fill\";\nimport { EShapeActionRuntimeChangeColorFillAndStroke } from \"./e-shape-action-runtime-change-color-fill-and-stroke\";\nimport { EShapeActionRuntimeChangeColorStroke } from \"./e-shape-action-runtime-change-color-stroke\";\nimport { EShapeActionRuntimeChangeColorText } from \"./e-shape-action-runtime-change-color-text\";\nimport { EShapeActionRuntimeChangeColorTextOutline } from \"./e-shape-action-runtime-change-color-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\ntype Target = EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA | EShapeActionValueChangeColorTarget.COLOR |\n\tEShapeActionValueChangeColorTarget.ALPHA;\nexport type EShapeActionValueChangeColorSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tTarget, number, number, number\n];\n\nexport class EShapeActionValueChangeColor extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly target: Target;\n\treadonly color: number;\n\treadonly alpha: number;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\ttarget: Target, color: number, alpha: number, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.target = target;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColor) &&\n\t\t\tthis.target === value.target &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColor {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst blendId = manager.add(this.blend);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.target},${this.color},${this.alpha},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColor {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColor(\n\t\t\tserialized[ 2 ], condition, serialized[ 3 ], serialized[ 4 ], serialized[ 5 ], blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeTextType {\n\tTEXT,\n\tNUMBER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nconst brightnessDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColorBrightness extends EShapeActionRuntimeConditional {\n\tprotected readonly brightness: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorBrightness, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.brightness = this.toExpression( value.brightness, brightnessDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\ttarget.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( base.color, brightness ),\n\t\t\t\tbase.alpha\n\t\t\t);\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\tfill.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseFill.color, brightness ),\n\t\t\t\tbaseFill.alpha\n\t\t\t);\n\n\t\t\tstroke.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseStroke.color, brightness ),\n\t\t\t\tbaseStroke.alpha\n\t\t\t);\n\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\tfill.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseFill.color, brightness ),\n\t\t\t\tbaseFill.alpha\n\t\t\t);\n\n\t\t\tstroke.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseStroke.color, brightness ),\n\t\t\t\tbaseStroke.alpha\n\t\t\t);\n\n\t\t\ttext.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseText.color, brightness ),\n\t\t\t\tbaseText.alpha\n\t\t\t);\n\n\t\t\toutline.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseOutline.color, brightness ),\n\t\t\t\tbaseOutline.alpha\n\t\t\t);\n\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected toColorAdjusted( color: number, brightness: number ): number {\n\t\tif( 0 <= brightness ) {\n\t\t\treturn UtilRgb.brighten( color, +brightness );\n\t\t} else {\n\t\t\treturn UtilRgb.darken( color, -brightness );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessAll extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessFill extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessFillAndStroke extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessStroke extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessText extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases} from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessTextOutline extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionRuntimeChangeColorBrightnessAll } from \"./e-shape-action-runtime-change-color-brightness-all\";\nimport { EShapeActionRuntimeChangeColorBrightnessFill } from \"./e-shape-action-runtime-change-color-brightness-fill\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessFillAndStroke\n} from \"./e-shape-action-runtime-change-color-brightness-fill-and-stroke\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessStroke\n} from \"./e-shape-action-runtime-change-color-brightness-stroke\";\nimport { EShapeActionRuntimeChangeColorBrightnessText } from \"./e-shape-action-runtime-change-color-brightness-text\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessTextOutline\n} from \"./e-shape-action-runtime-change-color-brightness-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeColorBrightnessSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.BRIGHTNESS, number\n];\n\nexport class EShapeActionValueChangeColorBrightness\n\textends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly brightness: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string, brightness: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.brightness = brightness;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorBrightness) &&\n\t\t\tthis.brightness === value.brightness\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorBrightness {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst target = EShapeActionValueChangeColorTarget.BRIGHTNESS;\n\t\tconst brightnessId = manager.add(this.brightness);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${brightnessId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorBrightnessSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorBrightness {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst brightness = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorBrightness(\n\t\t\tserialized[ 2 ], condition, brightness\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAlpha } from \"../../util/util-alpha\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nconst colorDefault = (): number | null => null;\nconst alphaDefault = (): number | null => null;\nconst blendDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColorCode extends EShapeActionRuntimeConditional {\n\tprotected readonly color: EShapeActionExpression<number | null>;\n\tprotected readonly alpha: EShapeActionExpression<number | null>;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorCode, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.color = this.toExpression( value.color, colorDefault, \"null\" );\n\t\tthis.alpha = this.toExpression( value.alpha, alphaDefault, \"null\" );\n\t\tthis.blend = this.toExpression( value.blend, blendDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, base.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\ttarget.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbase.color,\n\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttarget.set( undefined, base.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t\ttext.set( undefined, color, alpha );\n\t\t\t\t\toutline.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tbaseText.alpha\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tbaseOutline.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t\ttext.set( undefined, color, baseText.alpha );\n\t\t\t\t\toutline.set( undefined, color, baseOutline.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\ttext.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\toutline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t\ttext.set( undefined, baseText.color, alpha );\n\t\t\t\toutline.set( undefined, baseOutline.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeAll extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeFill extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeFillAndStroke extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeStroke extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeText extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeTextOutline extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionRuntimeChangeColorCodeAll } from \"./e-shape-action-runtime-change-color-code-all\";\nimport { EShapeActionRuntimeChangeColorCodeFill } from \"./e-shape-action-runtime-change-color-code-fill\";\nimport {\n\tEShapeActionRuntimeChangeColorCodeFillAndStroke\n} from \"./e-shape-action-runtime-change-color-code-fill-and-stroke\";\nimport { EShapeActionRuntimeChangeColorCodeStroke } from \"./e-shape-action-runtime-change-color-code-stroke\";\nimport { EShapeActionRuntimeChangeColorCodeText } from \"./e-shape-action-runtime-change-color-code-text\";\nimport { EShapeActionRuntimeChangeColorCodeTextOutline } from \"./e-shape-action-runtime-change-color-code-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeColorCodeSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.CODE, number, number, number\n];\n\nexport class EShapeActionValueChangeColorCode extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly color: string;\n\treadonly alpha: string;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\tcolor: string, alpha: string, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorCode) &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorCode {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst target = EShapeActionValueChangeColorTarget.CODE;\n\t\tconst colorId = manager.add(this.color);\n\t\tconst alphaId = manager.add(this.alpha);\n\t\tconst blendId = manager.add(this.blend);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${colorId},${alphaId},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorCodeSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorCode {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst color = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\tconst alpha = EShapeActionValues.toResource( 5, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorCode(\n\t\t\tserialized[ 2 ], condition, color, alpha, blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeCursor } from \"./e-shape-action-value-change-cursor\";\n\nconst nameDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeChangeCursor extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueChangeCursor ) {\n\t\tsuper( value, EShapeRuntimeReset.CURSOR );\n\t\tthis.name = this.toExpression( value.name, nameDefault, \"null\" );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tshape.cursor = name;\n\t\t\t\truntime.written |= this.reset;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeCursor } from \"./e-shape-action-runtime-change-cursor\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeCursorSerialized = [\n\tEShapeActionValueType.CHANGE_CURSOR, number, number\n];\n\nexport class EShapeActionValueChangeCursor extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_CURSOR, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeCursor) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeCursor {\n\t\treturn new EShapeActionRuntimeChangeCursor( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst nameId = manager.add(this.name);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${nameId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeCursorSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeCursor {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeCursor( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeA implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"AM\" : \"PM\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodea implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"am\" : \"pm\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeD implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getDate());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoded implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport abstract class FormatNodePrecision implements FormatNode {\n\tprotected precision: number | undefined;\n\n\tconstructor( precision?: string ) {\n\t\tif( precision != null ) {\n\t\t\tthis.precision = +precision.substring( 1, precision.length );\n\t\t} else {\n\t\t\tthis.precision = undefined;\n\t\t}\n\t}\n\n\tabstract format( target: number, step: number, date: Date ): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodee extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toExponential(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodef extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toFixed(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodefsi extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst abs = this.toAbs( target, step, date );\n\t\tif( abs < 1e-24 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e-21 ) {\n\t\t\treturn this.format_( target, 1e+24, \"y\" );\n\t\t} else if( abs < 1e-18 ) {\n\t\t\treturn this.format_( target, 1e+21, \"z\" );\n\t\t} else if( abs < 1e-15 ) {\n\t\t\treturn this.format_( target, 1e+18, \"a\" );\n\t\t} else if( abs < 1e-12 ) {\n\t\t\treturn this.format_( target, 1e+15, \"f\" );\n\t\t} else if( abs < 1e-09 ) {\n\t\t\treturn this.format_( target, 1e+12, \"p\" );\n\t\t} else if( abs < 1e-06 ) {\n\t\t\treturn this.format_( target, 1e+09, \"n\" );\n\t\t} else if( abs < 1e-03 ) {\n\t\t\treturn this.format_( target, 1e+06, \"μ\" );\n\t\t} else if( abs < 1e+00 ) {\n\t\t\treturn this.format_( target, 1e+03, \"m\" );\n\t\t} else if( abs < 1e+03 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e+06 ) {\n\t\t\treturn this.format_( target, 1e-03, \"k\" );\n\t\t} else if( abs < 1e+09 ) {\n\t\t\treturn this.format_( target, 1e-06, \"M\" );\n\t\t} else if( abs < 1e+12 ) {\n\t\t\treturn this.format_( target, 1e-09, \"G\" );\n\t\t} else if( abs < 1e+15 ) {\n\t\t\treturn this.format_( target, 1e-12, \"T\" );\n\t\t} else if( abs < 1e+18 ) {\n\t\t\treturn this.format_( target, 1e-15, \"P\" );\n\t\t} else if( abs < 1e+21 ) {\n\t\t\treturn this.format_( target, 1e-18, \"E\" );\n\t\t} else if( abs < 1e+24 ) {\n\t\t\treturn this.format_( target, 1e-21, \"Z\" );\n\t\t} else {\n\t\t\treturn this.format_( target, 1e-24, \"Y\" );\n\t\t}\n\t}\n\n\tprotected toAbs(target: number, step: number, date: Date): number {\n\t\treturn Math.abs(target);\n\t}\n\n\tprotected format_(target: number, unitInverse: number, postfix: string): string {\n\t\tconst value = target * unitInverse;\n\t\treturn `${value.toFixed(this.precision)}${postfix}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodeg extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toPrecision(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeH implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeh implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours() % 12);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeM implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMonth() + 1);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodem implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMinutes());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodemi implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMilliseconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${(target * 100) | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodep implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"../to-padded\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePadding implements FormatNode {\n\tprotected length: number;\n\tprotected character: string;\n\tprotected node: FormatNode;\n\n\tconstructor( length: number, character: string, node: FormatNode ) {\n\t\tthis.length = length;\n\t\tthis.character = character;\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn toPadded(this.node.format(target, step, date), this.length, this.character);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeParenthesis {\n\tprotected node: FormatNode;\n\n\tconstructor( node: FormatNode ) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] === \"-\") {\n\t\t\treturn `(${result.substring(1, result.length)})`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePlus implements FormatNode {\n\tprotected node: FormatNode;\n\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] !== \"-\") {\n\t\t\treturn `+${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeRP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target * 100)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderp implements FormatNode {\n\tformat(target: number, step: number, date: Date): string {\n\t\treturn `${Math.round(target)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodesdt implements FormatNode {\n\tprotected Y: FormatNode;\n\tprotected M: FormatNode;\n\tprotected D: FormatNode;\n\tprotected H: FormatNode;\n\tprotected m: FormatNode;\n\tprotected s: FormatNode;\n\tprotected mi: FormatNode;\n\n\tconstructor(\n\t\tY: FormatNode, M: FormatNode, D: FormatNode,\n\t\tH: FormatNode, m: FormatNode, s: FormatNode, mi: FormatNode\n\t) {\n\t\tthis.Y = Y;\n\t\tthis.M = M;\n\t\tthis.D = D;\n\t\tthis.H = H;\n\t\tthis.m = m;\n\t\tthis.s = s;\n\t\tthis.mi = mi;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tif (step < 1000) {\n\t\t\treturn `${this.s.format(target, step, date)}.${this.mi.format(target, step, date)}`;\n\t\t} else if (step < 60000) {\n\t\t\treturn `${this.m.format(target, step, date)}:${this.s.format(target, step, date)}`;\n\t\t} else if (step < 3600000) {\n\t\t\treturn `${this.H.format(target, step, date)}:${this.m.format(target, step, date)}`;\n\t\t} else if (step < 86400000) {\n\t\t\tconst M = this.M.format(target, step, date);\n\t\t\tconst D = this.D.format(target, step, date);\n\t\t\treturn `${M}/${D} ${this.H.format(target, step, date)}`;\n\t\t} else if (step < 2592000000) {\n\t\t\treturn `${this.M.format(target, step, date)}/${this.D.format(target, step, date)}`;\n\t\t} else {\n\t\t\treturn `${this.Y.format(target, step, date)}/${this.M.format(target, step, date)}`;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeSpace {\n\tprotected node: FormatNode;\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif( 0 < result.length && result[0] !== \"-\" ) {\n\t\t\treturn ` ${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodefsi } from \"./format-node-fsi\";\n\nexport class FormatNodessi extends FormatNodefsi {\n\tprotected toAbs( target: number, step: number, date: Date ): number {\n\t\treturn Math.abs(step);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeString implements FormatNode {\n\tprotected str: string;\n\n\tconstructor(str: string) {\n\t\tthis.str = str;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn this.str;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeY implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodey implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear() % 100);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"../to-padded\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodez implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst z = date.getTimezoneOffset();\n\t\tconst tzs = (z <= 0 ? \"+\" : \"-\");\n\t\tconst tzh = toPadded(String(Math.floor(Math.abs(z) / 60)), 2, \"0\");\n\t\tconst tzm = toPadded(String(Math.floor(Math.abs(z) % 60)), 2, \"0\");\n\t\treturn `${tzs}${tzh}:${tzm}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderd implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target)}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodes implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getSeconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node/format-node\";\nimport { FormatNodeA } from \"./format-node/format-node-a-large\";\nimport { FormatNodea } from \"./format-node/format-node-a-small\";\nimport { FormatNodeD } from \"./format-node/format-node-d-large\";\nimport { FormatNoded } from \"./format-node/format-node-d-small\";\nimport { FormatNodee } from \"./format-node/format-node-e\";\nimport { FormatNodef } from \"./format-node/format-node-f\";\nimport { FormatNodefsi } from \"./format-node/format-node-fsi\";\nimport { FormatNodeg } from \"./format-node/format-node-g\";\nimport { FormatNodeH } from \"./format-node/format-node-h-large\";\nimport { FormatNodeh } from \"./format-node/format-node-h-small\";\nimport { FormatNodeM } from \"./format-node/format-node-m-large\";\nimport { FormatNodem } from \"./format-node/format-node-m-small\";\nimport { FormatNodemi } from \"./format-node/format-node-mi\";\nimport { FormatNodeP } from \"./format-node/format-node-p-large\";\nimport { FormatNodep } from \"./format-node/format-node-p-small\";\nimport { FormatNodePadding } from \"./format-node/format-node-padding\";\nimport { FormatNodeParenthesis } from \"./format-node/format-node-parenthesis\";\nimport { FormatNodePlus } from \"./format-node/format-node-plus\";\nimport { FormatNodeRP } from \"./format-node/format-node-rp-large\";\nimport { FormatNoderp } from \"./format-node/format-node-rp-small\";\nimport { FormatNodesdt } from \"./format-node/format-node-sdt\";\nimport { FormatNodeSpace } from \"./format-node/format-node-space\";\nimport { FormatNodessi } from \"./format-node/format-node-ssi\";\nimport { FormatNodeString } from \"./format-node/format-node-string\";\nimport { FormatNodeY } from \"./format-node/format-node-y-large\";\nimport { FormatNodey } from \"./format-node/format-node-y-small\";\nimport { FormatNodez } from \"./format-node/format-node-z\";\nimport { FormatNoderd } from \"./format-node/format-noder-d\";\nimport { FormatNodes } from \"./format-node/format-nodes\";\nimport { NumberFormatter } from \"./number-formatter\";\n\n// tslint:disable-next-line: max-line-length\nconst REGEXP = /%(0|_|-|\\+|\\()?(\\.\\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g;\n\n/**\n * A NumberFormatter implementation class.\n */\nexport class NumberFormatterImpl implements NumberFormatter {\n\tprotected isDateRequired: boolean;\n\tprotected nodes: FormatNode[];\n\tprotected date: Date;\n\n\tconstructor( format: string ) {\n\t\tlet previousIndex = 0;\n\t\tlet isDateRequired = false;\n\t\tconst nodes: FormatNode[] = [];\n\t\tREGEXP.lastIndex = 0;\n\t\twhile( true ) {\n\t\t\tconst matched = REGEXP.exec( format );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst index = matched.index;\n\t\t\t\tif( previousIndex < index ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, index ) ) );\n\t\t\t\t}\n\t\t\t\tpreviousIndex = index + matched[ 0 ].length;\n\n\t\t\t\tconst all = matched[ 0 ];\n\t\t\t\tconst modifier = matched[ 1 ];\n\t\t\t\tconst precision = matched[ 2 ];\n\t\t\t\tconst specifier = matched[ 3 ];\n\n\t\t\t\tswitch( specifier ) {\n\t\t\t\tcase \"Y\": // full year\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeY() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YMD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"y\": // short year: [0, 99]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodey() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yMD\":\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"M\": // month: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeM() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"MD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"D\": // day of the month: [1, 31]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeD() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"H\": // 24-hour clock: [0, 23]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeH() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\": // 12-hour clock: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeh() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\": // minute [0, 59]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodem() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"mi\": // milliseconds [0, 999]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime3( modifier, new FormatNodemi() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"a\": // am or pm\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodea() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"A\": // AM or PM\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeA() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\": // seconds: [0, 61]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodes() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sdt\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(new FormatNodesdt(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime3( modifier, new FormatNodemi() )\n\t\t\t\t\t));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"z\": // time zone\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodez() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%\": // a % literal\n\t\t\t\t\tnodes.push( new FormatNodeString( \"%\" ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"f\": // fixed point notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodef( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"e\": // exponent notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodee( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"g\": // %f or %e\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeg( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rd\": // rounded decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderd() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\": // decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoded() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"P\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"p\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodep() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"RP\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeRP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rp\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderp() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"fsi\": // fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodefsi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ssi\": // Step-based fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodessi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnodes.push( new FormatNodeString( all ) );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( previousIndex < format.length ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, format.length ) ) );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.isDateRequired = isDateRequired;\n\t\tthis.nodes = nodes;\n\t\tthis.date = new Date();\n\t}\n\n\tprotected toModifiedNodeDatetime2( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 2, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 2, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeDatetime3( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 3, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 3, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeNumber( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\": // space for non-negative numbers\n\t\t\treturn new FormatNodeSpace( node );\n\t\tcase \"+\": // plus sign for non-negative numbers\n\t\t\treturn new FormatNodePlus( node );\n\t\tcase \"(\": // parenthesis for the negative numbers\n\t\t\treturn new FormatNodeParenthesis( node );\n\t\tdefault:\n\t\t\treturn node;\n\t\t}\n\t}\n\n\tformat( target: number, step: number ): string {\n\t\tconst nodes = this.nodes;\n\t\tconst date = this.date;\n\t\tif( this.isDateRequired ) {\n\t\t\tdate.setTime( target );\n\t\t}\n\t\tlet result = \"\";\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tresult += nodes[ i ].format( target, step, date );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"./number-formatter\";\nimport { NumberFormatterImpl } from \"./number-formatter-impl\";\n\n/**\n * An number formatter utility class.\n */\nexport class NumberFormatters {\n\t/**\n\t * Creates a number formatter of the given format.\n\t * Please refer to {@link NumberFormatter} for format details.\n\t *\n\t * @return A created number formatter\n\t */\n\tstatic create( format: string ): NumberFormatter {\n\t\treturn new NumberFormatterImpl( format );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"../../util/number-formatter\";\nimport { NumberFormatters } from \"../../util/number-formatters\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nconst numberDefault = (): number => 0;\n\nexport class EShapeActionRuntimeChangeTextNumber extends EShapeActionRuntimeConditional {\n\tprotected number: EShapeActionExpression<number>;\n\tprotected formatter: NumberFormatter | null;\n\n\tconstructor( value: EShapeActionValueChangeText, format: string ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\n\t\tthis.number = this.toExpression( value.value, numberDefault, `0` );\n\n\t\tformat = format.trim();\n\t\tthis.formatter = ( 0 < format.length ? NumberFormatters.create( format ) : null );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst value = this.number( shape, time );\n\t\t\tshape.text.value = ( this.formatter != null ? this.formatter.format( value, 0 ) : String(value) );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nconst textDefault = () => \"\";\n\nexport class EShapeActionRuntimeChangeTextText extends EShapeActionRuntimeConditional {\n\tprotected text: EShapeActionExpression<string>;\n\n\tconstructor( value: EShapeActionValueChangeText ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\t\tthis.text = this.toExpression( value.value, textDefault, `\"\"` );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tshape.text.value = String(this.text( shape, time ));\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeTextNumber } from \"./e-shape-action-runtime-change-text-number\";\nimport { EShapeActionRuntimeChangeTextText } from \"./e-shape-action-runtime-change-text-text\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeTextType } from \"./e-shape-action-value-change-text-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeTextSerialized = [\n\tEShapeActionValueType.CHANGE_TEXT, number, EShapeActionValueChangeTextType, number\n];\n\nexport class EShapeActionValueChangeText extends EShapeActionValueSubtyped<EShapeActionValueChangeTextType> {\n\treadonly value: string;\n\n\tconstructor( subtype: EShapeActionValueChangeTextType, condition: string, value: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_TEXT, condition, subtype );\n\t\tthis.value = value;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeText) &&\n\t\t\tthis.value === value.value\n\t\t);\n\t}\n\n\ttoRuntime( shape: EShape ): EShapeActionRuntimeChangeTextText | EShapeActionRuntimeChangeTextNumber {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeTextType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeTextText( this );\n\t\tcase EShapeActionValueChangeTextType.NUMBER:\n\t\t\treturn new EShapeActionRuntimeChangeTextNumber( this, shape.text.value );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst valueId = manager.add(this.value);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${valueId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeTextSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeText {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst value = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeText( serialized[ 2 ], condition, value );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueMiscType {\n\tINPUT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueEmitEvent } from \"./e-shape-action-value-emit-event\";\n\nconst nameDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeEmitEvent extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueEmitEvent ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.name = this.toExpression( value.name, nameDefault, \"null\" );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tthis.emit( name, shape );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeEmitEvent } from \"./e-shape-action-runtime-emit-event\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueEmitEventSerialized = [\n\tEShapeActionValueType.EMIT_EVENT, number, number\n];\n\nexport class EShapeActionValueEmitEvent extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.EMIT_EVENT, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueEmitEvent) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeEmitEvent {\n\t\treturn new EShapeActionRuntimeEmitEvent( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst nameId = manager.add(this.name);\n\t\treturn manager.add( `[${this.type},${conditionId},${nameId}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueEmitEventSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueEmitEvent {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueEmitEvent( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const ASCII_CHARACTERS =\n\t\" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\";\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DynamicFontAtlasCharacterOrigin {\n\tx: number;\n\ty: number;\n\n\tconstructor( x: number, y: number ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicFontAtlasCharacterOrigin } from \"./dynamic-font-atlas-chaaracter-origin\";\n\nexport class DynamicFontAtlasCharacter {\n\tref: number;\n\tlife: number;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: DynamicFontAtlasCharacterOrigin;\n\treserved: boolean;\n\n\tconstructor( advance: number, width: number, height: number, reserved: boolean ) {\n\t\tthis.ref = 1;\n\t\tthis.life = 10;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.advance = advance;\n\t\tthis.origin = new DynamicFontAtlasCharacterOrigin( 0, 0 );\n\t\tthis.reserved = reserved;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nconst VERTEX_SHADER = `\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat calcDistance( float x, float y, float dx, float dy ) {\n\tfloat xd = x + dx;\n\tfloat yd = y + dy;\n\tfloat u = xd / uSize.x;\n\tfloat v = yd / uSize.y;\n\tfloat ul = (xd - 1.0) / uSize.x;\n\tfloat vt = (yd - 1.0) / uSize.y;\n\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\n\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\n\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\n\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\n\n\treturn min( ll, lt );\n}\n\nfloat calcDistancesY( float x, float y, float dx ) {\n\tfloat d = 100.0;\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\n\t}\n\treturn d;\n}\n\nfloat calcDistances( float x, float y ) {\n\tfloat d = 100.0;\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\n\t\td = min( d, calcDistancesY( x, y, dx ) );\n\t}\n\treturn d;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat x = vTextureCoord.x * uSize.x;\n\tfloat y = vTextureCoord.y * uSize.y;\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\n}\n`;\n\nexport class DynamicSDFFontGenerator {\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _onLostBound: EventListener;\n\tprotected _onRestoreBound: EventListener;\n\tprotected _onUnloadBound: EventListener;\n\tprotected _gl: WebGLRenderingContext | null;\n\tprotected _texture: WebGLTexture | null;\n\tprotected _shaderProgram: WebGLProgram | null;\n\tprotected _vertexPositionAttribute: number;\n\tprotected _textureCoordAttribute: number;\n\tprotected _samplerUniform: WebGLUniformLocation | null;\n\tprotected _sizeUniform: WebGLUniformLocation | null;\n\tprotected _vb: WebGLBuffer | null;\n\tprotected _uvb: WebGLBuffer | null;\n\n\tconstructor() {\n\t\tthis._gl = null;\n\t\tthis._texture = null;\n\t\tthis._shaderProgram = null;\n\t\tthis._vertexPositionAttribute = NaN;\n\t\tthis._textureCoordAttribute = NaN;\n\t\tthis._samplerUniform = NaN;\n\t\tthis._sizeUniform = NaN;\n\t\tthis._vb = null;\n\t\tthis._uvb = null;\n\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = 64;\n\t\tcanvas.height = 64;\n\t\tthis._onLostBound = ( e: Event ): void => {\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis._onRestoreBound = (): void => {\n\t\t\tthis.restore();\n\t\t};\n\t\tthis._onUnloadBound = (): void => {\n\t\t\tthis.destroy();\n\t\t};\n\t\tcanvas.addEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\tcanvas.addEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\twindow.addEventListener( \"unload\", this._onUnloadBound, false );\n\t}\n\n\tinit(): this {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null && (this._gl == null || this._gl.isContextLost()) ) {\n\t\t\tconst config: WebGLContextAttributes = {\n\t\t\t\talpha: true,\n\t\t\t\tantialias: false,\n\t\t\t\tdepth: false,\n\t\t\t\tstencil: false,\n\t\t\t\tpremultipliedAlpha: false\n\t\t\t};\n\t\t\tconst gl = this._gl = (\n\t\t\t\tcanvas.getContext( \"webgl\", config ) ||\n\t\t\t\tcanvas.getContext( \"experimental-webgl\", config ) as WebGLRenderingContext | null\n\t\t\t);\n\t\t\tif( gl != null ) {\n\t\t\t\tgl.clearColor(1.0, 1.0, 1.0, 0.0);\n\t\t\t\tthis.makeVertexBuffer();\n\t\t\t\tthis.makeUvBuffer();\n\t\t\t\tthis.makeShaders();\n\t\t\t\tthis._texture = null;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\trestore(): void {\n\t\tthis.init();\n\t}\n\n\tgetCanvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tgetShader( gl: WebGLRenderingContext, code: string, type: boolean ): WebGLShader | null {\n\t\tconst shader = ( type ?\n\t\t\tgl.createShader( gl.FRAGMENT_SHADER ) :\n\t\t\tgl.createShader( gl.VERTEX_SHADER )\n\t\t);\n\t\tif( shader != null ) {\n\t\t\tgl.shaderSource( shader, code );\n\t\t\tgl.compileShader( shader );\n\t\t\tif( ! gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) {\n\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\tconsole && console.error( `Failed to compile the shader: ${gl.getShaderInfoLog(shader)}` );\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn shader;\n\t}\n\n\tmakeShaders(): WebGLShader | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vertexShader = this.getShader( gl, VERTEX_SHADER, false );\n\t\t\tif( vertexShader != null ) {\n\t\t\t\tconst fragmentShader = this.getShader( gl, FRAGMENT_SHADER, true );\n\t\t\t\tif( fragmentShader != null ) {\n\t\t\t\t\tconst shaderProgram = this._shaderProgram = gl.createProgram();\n\t\t\t\t\tif( shaderProgram != null ) {\n\t\t\t\t\t\tgl.attachShader( shaderProgram, vertexShader );\n\t\t\t\t\t\tgl.attachShader( shaderProgram, fragmentShader );\n\t\t\t\t\t\tgl.linkProgram( shaderProgram );\n\t\t\t\t\t\tif( ! gl.getProgramParameter(shaderProgram, gl.LINK_STATUS) ) {\n\t\t\t\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\t\t\t\tconsole && console.error( `Failed to link the program: ${gl.getError()}` );\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\n\t\t\t\t\t\t\tgl.useProgram( shaderProgram );\n\t\t\t\t\t\t\tthis._vertexPositionAttribute = gl.getAttribLocation( shaderProgram, \"aVertexPosition\" );\n\t\t\t\t\t\t\tthis._textureCoordAttribute = gl.getAttribLocation( shaderProgram, \"aTextureCoord\" );\n\t\t\t\t\t\t\tthis._samplerUniform = gl.getUniformLocation( shaderProgram, \"uSampler\" );\n\t\t\t\t\t\t\tthis._sizeUniform = gl.getUniformLocation( shaderProgram, \"uSize\" );\n\t\t\t\t\t\t\tgl.useProgram( null );\n\t\t\t\t\t\t\treturn shaderProgram;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyShaders(): void {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst shaderProgram = this._shaderProgram;\n\t\t\tif( shaderProgram != null ) {\n\t\t\t\tthis._shaderProgram = null;\n\t\t\t\tgl.useProgram( null );\n\t\t\t\tgl.deleteProgram( shaderProgram );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTexture( textureCanvas: HTMLCanvasElement ): WebGLTexture | null {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = textureCanvas.width;\n\t\t\tconst height = textureCanvas.height;\n\t\t\tif( canvas.width !== width || canvas.height !== height ) {\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t\tgl.viewport( 0, 0, width, height );\n\t\t\t}\n\n\t\t\tlet texture = this._texture;\n\t\t\tif( texture == null ) {\n\t\t\t\ttexture = this._texture = gl.createTexture();\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t} else {\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t}\n\t\t\treturn texture;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyTexture(): void {\n\t\tconst gl = this._gl;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && texture != null ) {\n\t\t\tthis._texture = null;\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.deleteTexture( texture );\n\t\t}\n\t}\n\n\tmakeVertexBuffer(): WebGLBuffer | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vb = this._vb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\n\t\t\tconst vertices = [\n\t\t\t\t-1.0, +1.0,\n\t\t\t\t+1.0, +1.0,\n\t\t\t\t-1.0, -1.0,\n\t\t\t\t+1.0, -1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW );\n\t\t\treturn vb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyVertexBuffer(): void {\n\t\tconst gl = this._gl;\n\t\tconst vb = this._vb;\n\t\tif( gl != null && gl.isContextLost() !== true && vb != null ) {\n\t\t\tthis._vb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( vb );\n\t\t}\n\t}\n\n\tmakeUvBuffer(): WebGLBuffer | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst uvb = this._uvb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\n\t\t\tconst uvs = [\n\t\t\t\t0.0,  0.0,\n\t\t\t\t1.0,  0.0,\n\t\t\t\t0.0,  1.0,\n\t\t\t\t1.0,  1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(uvs), gl.STATIC_DRAW );\n\t\t\treturn uvb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyUvBuffer(): void {\n\t\tconst gl = this._gl;\n\t\tconst uvb = this._uvb;\n\t\tif( gl != null && gl.isContextLost() !== true && uvb != null ) {\n\t\t\tthis._uvb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( uvb );\n\t\t}\n\t}\n\n\trender(): void {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tconst shaderProgram = this._shaderProgram;\n\t\tconst vb = this._vb;\n\t\tconst uvb = this._uvb;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null &&\n\t\t\tshaderProgram != null && vb != null && uvb != null && texture != null ) {\n\t\t\tgl.clear( gl.COLOR_BUFFER_BIT );\n\n\t\t\tgl.useProgram( shaderProgram );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\t\t\tconst vertexPositionAttribute = this._vertexPositionAttribute;\n\t\t\tgl.enableVertexAttribArray( vertexPositionAttribute );\n\t\t\tgl.vertexAttribPointer( vertexPositionAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\t\t\tconst textureCoordAttribute = this._textureCoordAttribute;\n\t\t\tgl.enableVertexAttribArray( textureCoordAttribute );\n\t\t\tgl.vertexAttribPointer( textureCoordAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.activeTexture( gl.TEXTURE0 );\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\tgl.uniform1i( this._samplerUniform, 0 );\n\t\t\tgl.uniform2f( this._sizeUniform, canvas.width, canvas.height );\n\n\t\t\tgl.drawArrays( gl.TRIANGLE_STRIP, 0, 4 );\n\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.useProgram( null );\n\t\t}\n\t}\n\n\tread( copyCanvas: HTMLCanvasElement ): void {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = canvas.width;\n\t\t\tconst height = canvas.height;\n\t\t\tcopyCanvas.width = width;\n\t\t\tcopyCanvas.height = height;\n\t\t\tconst copyContext = copyCanvas.getContext( \"2d\" );\n\t\t\tif( copyContext != null ) {\n\t\t\t\tcopyContext.drawImage( canvas, 0, 0 );\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tthis.destroyVertexBuffer();\n\t\tthis.destroyUvBuffer();\n\t\tthis.destroyShaders();\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tcanvas.removeEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\t\tcanvas.removeEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\t\twindow.removeEventListener( \"unload\", this._onUnloadBound, false );\n\t\t}\n\n\t\tconst gl = this._gl;\n\t\tif( gl != null ) {\n\t\t\tthis._gl = null;\n\t\t\tconst WebGLLoseContext = gl.getExtension( \"WEBGL_lose_context\" );\n\t\t\tif( WebGLLoseContext != null ) {\n\t\t\t\tWebGLLoseContext.loseContext();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../theme/d-themes\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicSDFFontGenerator } from \"./dynamic-sdf-font-generator\";\nimport { UtilCharacterIterator } from \"./util-character-iterator\";\n\nexport interface DynamicSDFFontAtlasFont {\n\tfamily: string;\n\tsize: number;\n\titalic: boolean;\n}\n\nexport interface DynamicSDFFontAtlasJson {\n\twidth: number;\n\theight: number;\n\tfont: DynamicSDFFontAtlasFont;\n\tcharacters: DynamicFontAtlasCharacters;\n}\n\nexport class DynamicSDFFontAtlas {\n\tprotected static GENERATOR: DynamicSDFFontGenerator | null = null;\n\tprotected static FONT_FAMILY_AUTO: string | null = null;\n\n\tprotected _id: string;\n\tprotected _generator: DynamicSDFFontGenerator | null;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _font: DynamicSDFFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _isDirty: boolean;\n\n\tconstructor( fontFamily: string ) {\n\t\tthis._id = `font-atlas:${fontFamily}`;\n\t\tthis._generator = DynamicSDFFontAtlas.getGenerator().init();\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._font = {\n\t\t\tfamily: DynamicSDFFontAtlas.toFontFamily( fontFamily ),\n\t\t\tsize: 32,\n\t\t\titalic: false\n\t\t};\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._isDirty = true;\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicSDFFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tset font( font: DynamicSDFFontAtlasFont ) {\n\t\tthis._font.family = font.family;\n\t\tthis._font.size = font.size;\n\t\tthis._font.italic = font.italic;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget generator(): DynamicSDFFontGenerator | null {\n\t\treturn this._generator;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tbegin(): void {\n\t\tthis._length = 0;\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tcharacters[ character ].ref = 0;\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data.ref <= 0 ) {\n\t\t\t\tdata.life -= 1;\n\t\t\t\tif( data.life <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t\tthis._isDirty =  true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddAscii(): void {\n\t\tthis.add( ASCII_CHARACTERS );\n\t\tthis.addChar( \"...\" );\n\t}\n\n\taddChar( character: string ): void {\n\t\tconst characters = this._characters;\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( data.ref <= 0 ) {\n\t\t\t\t\tthis._length += 1;\n\t\t\t\t}\n\t\t\t\tdata.ref += 1;\n\t\t\t} else {\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( 0, 1, 1, false );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( characters: string ): void {\n\t\tconst iterator = UtilCharacterIterator.from( characters );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.addChar( iterator.next() );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tupdate(): boolean {\n\t\tif( this._isDirty ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tconst generator = this._generator;\n\t\t\tif( canvas != null && generator != null ) {\n\t\t\t\tconst context = canvas.getContext( \"2d\" );\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tthis._isDirty = false;\n\n\t\t\t\t\tconst font = this._font;\n\t\t\t\t\tconst characters = this._characters;\n\t\t\t\t\tconst characterSize = font.size + 14;\n\t\t\t\t\tconst width = DynamicSDFFontAtlas.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * characterSize );\n\t\t\t\t\tthis._width = width;\n\t\t\t\t\tconst fontStyle = (font.italic ? \"italic \" : \"\") + (font.size + \"px \") + font.family;\n\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 0;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\n\t\t\t\t\tconst offsetX = 7;\n\t\t\t\t\tconst offsetY = ( characterSize >> 1 );\n\t\t\t\t\tlet x = 0;\n\t\t\t\t\tlet y = 0;\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tconst advance = context.measureText( character ).width;\n\t\t\t\t\t\tconst characterWidth = Math.ceil( offsetX + advance + offsetX );\n\t\t\t\t\t\tconst characterHeight = characterSize;\n\t\t\t\t\t\tif( width <= x + characterWidth ) {\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t\ty += characterSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdata.x = x;\n\t\t\t\t\t\tdata.y = y;\n\t\t\t\t\t\tdata.width = characterWidth;\n\t\t\t\t\t\tdata.height = characterHeight;\n\t\t\t\t\t\tdata.advance = advance;\n\t\t\t\t\t\tdata.origin.x = x + offsetX;\n\t\t\t\t\t\tdata.origin.y = y + offsetY;\n\n\t\t\t\t\t\tx += characterWidth;\n\t\t\t\t\t}\n\t\t\t\t\tconst height = this._height = y + characterSize;\n\n\t\t\t\t\t// Make a input canvas\n\t\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\tcanvas.height = height;\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 4;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tcontext.fillText( character, data.origin.x, data.origin.y );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Convert to SDF font texture\n\t\t\t\t\tgenerator.updateTexture( canvas );\n\t\t\t\t\tgenerator.render();\n\t\t\t\t\tgenerator.read( canvas );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\ttoJson(): DynamicSDFFontAtlasJson {\n\t\treturn {\n\t\t\twidth: this._width,\n\t\t\theight: this._height,\n\t\t\tfont: this._font,\n\t\t\tcharacters: this._characters\n\t\t};\n\t}\n\n\ttoString(): string {\n\t\treturn JSON.stringify( this.toJson() );\n\t}\n\n\tdestroy() {\n\t\tconst generator = this._generator;\n\t\tif( generator != null ) {\n\t\t\tthis._generator = null;\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\tstatic toFontFamily( fontFamily: string ) {\n\t\treturn ( fontFamily === \"auto\" ?\n\t\t\tDynamicSDFFontAtlas.getAutoFontFamily() :\n\t\t\tfontFamily\n\t\t);\n\t}\n\n\tstatic toPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic getGenerator(): DynamicSDFFontGenerator {\n\t\tif( DynamicSDFFontAtlas.GENERATOR == null ) {\n\t\t\tDynamicSDFFontAtlas.GENERATOR = new DynamicSDFFontGenerator();\n\t\t}\n\t\treturn DynamicSDFFontAtlas.GENERATOR;\n\t}\n\n\tstatic getAutoFontFamily(): string {\n\t\tif( DynamicSDFFontAtlas.FONT_FAMILY_AUTO == null ) {\n\t\t\tDynamicSDFFontAtlas.FONT_FAMILY_AUTO = (DThemes.getInstance().get( \"DBase\" ) as any).getFontFamilly() as string;\n\t\t}\n\t\treturn DynamicSDFFontAtlas.FONT_FAMILY_AUTO;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DApplicationLayerLike } from \"../../d-application-layer-like\";\nimport { DApplications } from \"../../d-applications\";\nimport { DynamicSDFFontAtlas } from \"../../util/dynamic-sdf-font-atlas\";\nimport { UtilKeyboardEvent } from \"../../util/util-keyboard-event\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeTextWeight } from \"../e-shape-text\";\n\ntype OnChange = ( shape: EShape, value: string ) => void;\ntype OnInput = ( shape: EShape, value: string ) => void;\n\nexport class EShapeActionRuntimeMiscInputData {\n\tprotected input: HTMLInputElement | null;\n\tprotected shape: EShape | null;\n\tprotected value: string;\n\tprotected onChange?: OnChange;\n\tprotected onInput?: OnInput;\n\n\tprotected point: Point;\n\tprotected rect: Rectangle;\n\n\tprotected _onInputKeyDownBound!: ( e: KeyboardEvent ) => void;\n\tprotected _onInputBlurBound!: ( e: FocusEvent ) => void;\n\tprotected _updateInputBound!: () => void;\n\tprotected _onInputChangeBound!: ( e: Event ) => void;\n\tprotected _onInputInputBound!: ( e: Event ) => void;\n\tprotected _updateInputBoundRenderer!: Renderer | null;\n\n\tconstructor() {\n\t\tthis.input = null;\n\t\tthis.shape = null;\n\t\tthis.value = \"\";\n\n\t\tthis.point = new Point();\n\t\tthis.rect = new Rectangle();\n\n\t\tthis._onInputKeyDownBound = ( e: KeyboardEvent ) => {\n\t\t\tthis.onInputKeyDown( e );\n\t\t};\n\n\t\tthis._onInputBlurBound = ( e: FocusEvent ) => {\n\t\t\tthis.onInputBlur( e );\n\t\t};\n\n\t\tthis._updateInputBound = () => {\n\t\t\tthis.updateInput();\n\t\t};\n\n\t\tthis._onInputChangeBound = () => {\n\t\t\tthis.onInputChange();\n\t\t};\n\n\t\tthis._onInputInputBound = ( e ) => {\n\t\t\tthis.onInputInput( e );\n\t\t};\n\n\t\tthis._updateInputBoundRenderer = null;\n\t}\n\n\tprotected getInput( layer: DApplicationLayerLike ): HTMLInputElement | null {\n\t\tif( this.input == null ) {\n\t\t\tlayer.application.getRootElement().appendChild(\n\t\t\t\tthis.input = this.createInput()\n\t\t\t);\n\t\t}\n\t\treturn this.input;\n\t}\n\n\tprotected createInput(): HTMLInputElement {\n\t\tconst result = document.createElement( \"input\" );\n\t\tresult.setAttribute( \"spellcheck\", \"false\" );\n\t\treturn result;\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"text\";\n\t}\n\n\tprotected initInput( shape: EShape, input: HTMLInputElement, value: string ): void {\n\t\tinput.type = this.getInputType();\n\t\tinput.value = value;\n\t\tinput.addEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\tinput.addEventListener( \"blur\", this._onInputBlurBound );\n\t\tinput.addEventListener( \"change\", this._onInputChangeBound );\n\t\tinput.addEventListener( \"input\", this._onInputInputBound );\n\n\t\t// Style\n\t\tinput.setAttribute( \"style\", this.getInputStyle( shape ) );\n\n\t\t// ReadOnly\n\t\tif( shape.readonly ) {\n\t\t\tinput.setAttribute( \"readonly\", \"readonly\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"readonly\" );\n\t\t}\n\n\t\t// Disabled\n\t\tif( shape.disabled ) {\n\t\t\tinput.setAttribute( \"disabled\", \"disabled\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"disabled\" );\n\t\t}\n\t}\n\n\tprotected getInputStyleBackground(): string {\n\t\treturn `background-color: transparent;`;\n\t}\n\n\tprotected getInputStyleBorder(): string {\n\t\treturn `border: none; box-sizing: border-box;`;\n\t}\n\n\tprotected getInputStylePadding( shape: EShape, scale: number ): string {\n\t\tconst padding = shape.text.padding;\n\t\tconst paddingVertical = 0;\n\t\tconst paddingHorizontal = padding.horizontal * scale;\n\t\treturn `padding: ${paddingVertical}px ${paddingHorizontal}px ${paddingVertical}px ${paddingHorizontal}px;`;\n\t}\n\n\tprotected getInputStyleOutline(): string {\n\t\treturn `outline: none;`;\n\t}\n\n\tprotected getInputStylePosition( rect: Rectangle, matrix: Matrix ): string {\n\t\treturn `position: absolute;` +\n\t\t\t`left: ${rect.x}px;` +\n\t\t\t`top: ${rect.y}px;` +\n\t\t\t`width: ${rect.width}px;` +\n\t\t\t`height: ${rect.height}px;` +\n\t\t\t`line-height: ${rect.height}px;` +\n\t\t\t`transform: matrix(${matrix.a},${matrix.b},${matrix.c},${matrix.d},${matrix.tx},${matrix.ty});`;\n\t}\n\n\tprotected getInputStyleText( shape: EShape, rect: Rectangle, scale: number ): string {\n\t\tconst text = shape.text;\n\t\treturn `font-family: ${DynamicSDFFontAtlas.toFontFamily( text.family )};` +\n\t\t\t`font-size: ${text.size * scale}px;` +\n\t\t\t`font-weight: ${text.weight === EShapeTextWeight.NORMAL ? \"normal\" : \"bold\" };` +\n\t\t\t`color: #${text.color.toString( 16 )};`;\n\t}\n\n\tprotected getInputStyleMargin( shape: EShape, rect: Rectangle, scale: number ): string {\n\t\treturn `margin: 0;`;\n\t}\n\n\tprotected getInputStyle( shape: EShape ): string {\n\t\tconst pivot = shape.transform.pivot;\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst rect = this.rect;\n\t\trect.x = -0.5 * sizeX + pivot.x;\n\t\trect.y = -0.5 * sizeY + pivot.y;\n\t\trect.width = sizeX;\n\t\trect.height = sizeY;\n\n\t\tshape.updateTransform();\n\t\tconst scale = 1.0;\n\t\tconst worldTransform = shape.transform.worldTransform;\n\n\t\treturn this.getInputStylePosition( rect, worldTransform ) +\n\t\t\tthis.getInputStyleMargin( shape, rect, scale ) +\n\t\t\tthis.getInputStyleText( shape, rect, scale ) +\n\t\t\tthis.getInputStyleBackground() +\n\t\t\tthis.getInputStyleBorder() +\n\t\t\tthis.getInputStylePadding( shape, scale ) +\n\t\t\tthis.getInputStyleOutline();\n\t}\n\n\tprotected onInputKeyDown( e: KeyboardEvent ): void {\n\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\tconst shape = this.shape;\n\t\t\tif( shape != null ) {\n\t\t\t\tthis.onInputChange();\n\t\t\t\tthis.hide();\n\n\t\t\t\tconst layer = DApplications.getLayer( shape );\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\t\t\tconst focusable = focusController.findFocusable( shape, false, false, direction );\n\t\t\t\t\tif( focusable != null ) {\n\t\t\t\t\t\tlayer.view.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( UtilKeyboardEvent.isOkKey( e ) ) {\n\t\t\tthis.onInputChange();\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\tprotected onInputBlur( e: FocusEvent ): void {\n\t\tthis.onInputChange();\n\t\tthis.hide();\n\t}\n\n\tprotected onInputInput( e: Event ): void {\n\t\tif( e.target instanceof HTMLInputElement ) {\n\t\t\tconst shape = this.shape;\n\t\t\tconst onInput = this.onInput;\n\t\t\tif( shape != null && onInput != null ) {\n\t\t\t\tonInput( shape, e.target.value );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInput(): void {\n\t\tconst shape = this.shape;\n\t\tif( shape != null ) {\n\t\t\tif( shape.visible ) {\n\t\t\t\tconst input = this.input;\n\t\t\t\tif( input != null ) {\n\t\t\t\t\tinput.setAttribute( \"style\", this.getInputStyle( shape ) );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tisShown( shape: EShape ): boolean {\n\t\treturn ( this.shape === shape );\n\t}\n\n\tshow(\n\t\tnewShape: EShape, value: string,\n\t\tonChange?: OnChange, onInput?: OnInput\n\t): void {\n\t\tconst oldShape = this.shape;\n\t\tif( oldShape != null && oldShape !== newShape ) {\n\t\t\tthis.hide();\n\t\t}\n\t\tif( this.shape == null ) {\n\t\t\tthis.shape = newShape;\n\t\t\tthis.value = value;\n\t\t\tthis.onChange = onChange;\n\t\t\tthis.onInput = onInput;\n\n\t\t\tconst text = newShape.text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.enable = false;\n\t\t\t}\n\n\t\t\tconst layer = DApplications.getLayer( newShape );\n\t\t\tif( layer ) {\n\t\t\t\tconst input = this.getInput( layer );\n\t\t\t\tif( input ) {\n\t\t\t\t\tthis.initInput( newShape, input, value );\n\n\t\t\t\t\tconst updateInputBound = this._updateInputBound;\n\t\t\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\t\t\tif( renderer != null ) {\n\t\t\t\t\t\trenderer.off( \"postrender\", updateInputBound );\n\t\t\t\t\t}\n\t\t\t\t\tthis._updateInputBoundRenderer = layer.renderer;\n\t\t\t\t\tlayer.renderer.on( \"postrender\", updateInputBound );\n\n\t\t\t\t\tinput.style.display = \"\";\n\t\t\t\t\tinput.focus();\n\t\t\t\t\tinput.select();\n\t\t\t\t}\n\n\t\t\t\tlayer.update();\n\t\t\t}\n\t\t}\n\t}\n\n\thide(): void {\n\t\tconst shape = this.shape;\n\t\tif( shape != null ) {\n\t\t\tthis.shape = null;\n\t\t\tthis.value = \"\";\n\n\t\t\tconst text = shape.text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.enable = true;\n\t\t\t}\n\n\t\t\tconst input = this.input;\n\t\t\tif( input != null ) {\n\t\t\t\tinput.removeEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\t\t\tinput.removeEventListener( \"blur\", this._onInputBlurBound );\n\t\t\t\tinput.removeEventListener( \"change\", this._onInputChangeBound );\n\t\t\t\tinput.removeEventListener( \"input\", this._onInputInputBound );\n\t\t\t\tinput.style.display = \"none\";\n\t\t\t}\n\n\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\tif( renderer != null ) {\n\t\t\t\tthis._updateInputBoundRenderer = null;\n\t\t\t\trenderer.off( \"postrender\", this._updateInputBound );\n\t\t\t}\n\n\t\t\tDApplications.update( shape );\n\t\t}\n\t}\n\n\tonInputChange(): void {\n\t\tconst shape = this.shape;\n\t\tconst input = this.input;\n\t\tconst onChange = this.onChange;\n\t\tif( shape != null && input != null && onChange != null ) {\n\t\t\tconst newValue = input.value;\n\t\t\tif( this.value !== newValue ) {\n\t\t\t\tonChange( shape, newValue );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeMiscInputData } from \"./e-shape-action-runtime-misc-input-data\";\n\nexport class EShapeActionRuntimeMiscInput extends EShapeActionRuntime {\n\tstatic data: EShapeActionRuntimeMiscInputData | null = null;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( ! shape.disabled ) {\n\t\t\tconst data = EShapeActionRuntimeMiscInput.getData();\n\t\t\tif( shape.focused ) {\n\t\t\t\tif( ! data.isShown( shape ) ) {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tdata.show( shape, shape.text.value, ( _: EShape, value: string ): void => {\n\t\t\t\t\t\t\tshape.text.value = value;\n\t\t\t\t\t\t\tthis.emit( \"change\", shape, value );\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( data.isShown( shape ) ) {\n\t\t\t\t\tdata.onInputChange();\n\t\t\t\t\tdata.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getData(): EShapeActionRuntimeMiscInputData {\n\t\tif( EShapeActionRuntimeMiscInput.data == null ) {\n\t\t\tEShapeActionRuntimeMiscInput.data = new EShapeActionRuntimeMiscInputData();\n\t\t}\n\t\treturn EShapeActionRuntimeMiscInput.data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeMiscInput } from \"./e-shape-action-runtime-misc-input\";\nimport { EShapeActionValueMiscType } from \"./e-shape-action-value-misc-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueMiscSerialized = [\n\tEShapeActionValueType.MISC, number, EShapeActionValueMiscType\n];\n\nexport class EShapeActionValueMisc extends EShapeActionValueSubtyped<EShapeActionValueMiscType> {\n\tconstructor( subtype: EShapeActionValueMiscType, condition: string ) {\n\t\tsuper( EShapeActionValueType.MISC, condition, subtype );\n\t}\n\n\ttoRuntime( shape: EShape ): EShapeActionRuntime {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueMiscType.INPUT:\n\t\t\treturn new EShapeActionRuntimeMiscInput();\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueMiscSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueMisc {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueMisc( serialized[ 2 ], condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueOpenType {\n\tFLOW,\n\tPAGE,\n\tPAGE_INPLACE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nconst targetDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeOpen extends EShapeActionRuntimeConditional {\n\tprotected readonly target: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueOpen, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.target = this.toExpression( value.target, targetDefault, \"null\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../../d-applications\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenFlow extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\tconst layer = DApplications.getLayer( shape );\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst application = layer.application as any;\n\t\t\t\t\tif( \"opener\" in application ) {\n\t\t\t\t\t\tapplication.opener( target );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPage extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.open( target );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPageInplace extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.location.href = target;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionRuntimeOpenFlow } from \"./e-shape-action-runtime-open-flow\";\nimport { EShapeActionRuntimeOpenPage } from \"./e-shape-action-runtime-open-page\";\nimport { EShapeActionRuntimeOpenPageInplace } from \"./e-shape-action-runtime-open-page-inplace\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpenType } from \"./e-shape-action-value-open-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueOpenSerialized = [\n\tEShapeActionValueType.OPEN, number, EShapeActionValueOpenType, number\n];\n\nexport class EShapeActionValueOpen extends EShapeActionValueSubtyped<EShapeActionValueOpenType> {\n\treadonly target: string;\n\n\tconstructor( subtype: EShapeActionValueOpenType, condition: string, target: string ) {\n\t\tsuper( EShapeActionValueType.OPEN, condition, subtype );\n\t\tthis.target = target;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpen) &&\n\t\t\tthis.target === value.target\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeOpen {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueOpenType.FLOW:\n\t\t\treturn new EShapeActionRuntimeOpenFlow( this );\n\t\tcase EShapeActionValueOpenType.PAGE:\n\t\t\treturn new EShapeActionRuntimeOpenPage( this );\n\t\tcase EShapeActionValueOpenType.PAGE_INPLACE:\n\t\t\treturn new EShapeActionRuntimeOpenPageInplace( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst targetId = manager.add(this.target);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype},${targetId}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueOpenSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueOpen {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst target = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\treturn new EShapeActionValueOpen( serialized[ 2 ], condition, target );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueShowHideType {\n\tSHOW,\n\tHIDE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueShowHide } from \"./e-shape-action-value-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\n\nexport class EShapeActionRuntimeShowHide extends EShapeActionRuntimeConditional {\n\tvisibility: boolean;\n\n\tconstructor( value: EShapeActionValueShowHide ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t\tthis.visibility = ( value.subtype === EShapeActionValueShowHideType.SHOW );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tshape.visible = this.visibility;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformMoveType {\n\tRELATIVE_X,\n\tRELATIVE_Y,\n\tABSOLUTE_X,\n\tABSOLUTE_Y,\n\tFORWARD_OR_BACKWARD,\n\tLEFT_OR_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformType {\n\tRESIZE,\n\tMOVE,\n\tROTATE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeShowHide } from \"./e-shape-action-runtime-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueShowHideSerialized = [\n\tEShapeActionValueType.SHOW_HIDE, number, EShapeActionValueShowHideType\n];\n\nexport class EShapeActionValueShowHide extends EShapeActionValueSubtyped<EShapeActionValueShowHideType> {\n\tconstructor( subtype: EShapeActionValueShowHideType, condition: string ) {\n\t\tsuper( EShapeActionValueType.SHOW_HIDE, condition, subtype );\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeShowHide {\n\t\treturn new EShapeActionRuntimeShowHide( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueShowHideSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueShowHide {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueShowHide( serialized[ 2 ], condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nconst amountDefault = (): number => 0;\n\nexport class EShapeActionRuntimeTransformMove extends EShapeActionRuntimeConditional {\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformMove, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.amount = this.toExpression( value.amount, amountDefault, \"0\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.x = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteY extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.y = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveForwardOrBackward extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX - localTransform.c * amount, oldPositionY - localTransform.d * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveLeftOrRight extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX + localTransform.a * amount, oldPositionY + localTransform.b * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tposition.x = oldPositionX + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeY extends EShapeActionRuntimeTransformMove {\n\tconstructor( action: EShapeActionValueTransformMove ) {\n\t\tsuper( action, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tposition.y = oldPositionY + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueOpetyped<\n\tSUBTYPE extends number,\n\tOPETYPE extends number\n> extends EShapeActionValueSubtyped<SUBTYPE> {\n\treadonly opetype: OPETYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE, opetype: OPETYPE ) {\n\t\tsuper( type, condition, subtype );\n\t\tthis.opetype = opetype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpetyped) &&\n\t\t\tthis.opetype === value.opetype\n\t\t);\n\t}\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteX } from \"./e-shape-action-runtime-transform-move-absolute-x\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteY } from \"./e-shape-action-runtime-transform-move-absolute-y\";\nimport {\n\tEShapeActionRuntimeTransformMoveForwardOrBackward\n} from \"./e-shape-action-runtime-transform-move-forward-or-backward\";\nimport { EShapeActionRuntimeTransformMoveLeftOrRight } from \"./e-shape-action-runtime-transform-move-left-or-right\";\nimport { EShapeActionRuntimeTransformMoveRelativeX } from \"./e-shape-action-runtime-transform-move-relative-x\";\nimport { EShapeActionRuntimeTransformMoveRelativeY } from \"./e-shape-action-runtime-transform-move-relative-y\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformMoveType } from \"./e-shape-action-value-transform-move-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformMoveSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.MOVE,\n\tEShapeActionValueTransformMoveType, number\n];\n\nexport class EShapeActionValueTransformMove\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformMoveType> {\n\treadonly amount: string;\n\n\tconstructor( opetype: EShapeActionValueTransformMoveType, condition: string, amount: string ) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.MOVE, opetype );\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformMove) &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformMove {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteX( this );\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteY( this );\n\t\tcase EShapeActionValueTransformMoveType.FORWARD_OR_BACKWARD:\n\t\t\treturn new EShapeActionRuntimeTransformMoveForwardOrBackward( this );\n\t\tcase EShapeActionValueTransformMoveType.LEFT_OR_RIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformMoveLeftOrRight( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeX( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeY( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst amountId = manager.add(this.amount);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformMoveSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformMove {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformMove( serialized[ 3 ], condition, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformResizeType {\n\tRELATIVE_SIZE,\n\tRELATIVE_HEIGHT,\n\tRELATIVE_WIDTH,\n\tABSOLUTE_SIZE,\n\tABSOLUTE_HEIGHT,\n\tABSOLUTE_WIDTH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\n\nexport class EShapeSizes {\n\tstatic toRounded( value: number ): number {\n\t\treturn Math.round( value * 100 ) / 100;\n\t}\n\n\tstatic toNormalized( size: number ): number {\n\t\tconst THRESHOLD = 0.001;\n\t\tif( Math.abs( size ) < THRESHOLD ) {\n\t\t\treturn ( size < 0 ? -THRESHOLD : +THRESHOLD );\n\t\t}\n\t\treturn EShapeSizes.toRounded( size );\n\t}\n\n\tstatic resize( shape: EShape, from: Point, to: Point, centerMode: boolean, isPerfect: boolean ): void {\n\t\tshape.disallowUploadedUpdate();\n\t\tconst position = shape.transform.position;\n\t\tif( centerMode ) {\n\t\t\tconst dx = Math.abs(to.x - from.x);\n\t\t\tconst dy = Math.abs(to.y - from.y);\n\t\t\tif (isPerfect) {\n\t\t\t\tconst hsize = Math.max(dx, dy);\n\t\t\t\tconst size = hsize + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( dx + dx ),\n\t\t\t\t\tEShapeSizes.toNormalized( dy + dy )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif( isPerfect ) {\n\t\t\t\tconst dx = to.x - from.x;\n\t\t\t\tconst dy = to.y - from.y;\n\t\t\t\tconst size = Math.max(Math.abs(dx), Math.abs(dy));\n\t\t\t\tconst x2 = from.x + (dx < 0 ? -size : +size);\n\t\t\t\tconst y2 = from.y + (dy < 0 ? -size : +size);\n\t\t\t\tconst hsize = size * 0.5;\n\t\t\t\tconst x = Math.min(from.x, x2) + hsize;\n\t\t\t\tconst y = Math.min(from.y, y2) + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x ),\n\t\t\t\t\tEShapeSizes.toRounded( y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst x0 = Math.min(from.x, to.x);\n\t\t\t\tconst y0 = Math.min(from.y, to.y);\n\t\t\t\tconst x1 = Math.max(from.x, to.x);\n\t\t\t\tconst y1 = Math.max(from.y, to.y);\n\t\t\t\tconst width = x1 - x0;\n\t\t\t\tconst height = y1 - y0;\n\t\t\t\tconst px = width * 0.5;\n\t\t\t\tconst py = height * 0.5;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( width ),\n\t\t\t\t\tEShapeSizes.toNormalized( height )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x0 + px ),\n\t\t\t\t\tEShapeSizes.toRounded( y0 + py )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\n\nconst sizeRelativeDefault = (): number => 1;\nconst sizeAbsoluteDefault = (): number => 100;\n\nexport class EShapeActionRuntimeTransformResize extends EShapeActionRuntimeConditional {\n\tprotected readonly size: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformResize, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tswitch( value.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.size = sizeRelativeDefault;\n\t\t}\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\tdsx: number, dsy: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst dx = ( -0.5 + originX ) * dsx;\n\t\tconst dy = ( -0.5 + originY ) * dsy;\n\t\tshape.updateTransform();\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * localTransform.a + dy * localTransform.c,\n\t\t\toldPositionY + dx * localTransform.b + dy * localTransform.d\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformRotateType {\n\tRELATIVE,\n\tABSOLUTE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( oldSizeY * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = EShapeSizes.toNormalized( this.size( shape, time ) );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set( sizeAbsolute, sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeRelative extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set(\n\t\t\t\tEShapeSizes.toNormalized( oldSizeX * sizeRelative ),\n\t\t\t\tEShapeSizes.toNormalized( oldSizeY * sizeRelative )\n\t\t\t);\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tsize.x = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = ( writtenWidth ? size.x : runtime.size.x );\n\t\t\tsize.x = EShapeSizes.toNormalized( oldSizeX * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightAbsolute\n} from \"./e-shape-action-runtime-transform-resize-height-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightRelative\n} from \"./e-shape-action-runtime-transform-resize-height-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeAbsolute\n} from \"./e-shape-action-runtime-transform-resize-size-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeRelative\n} from \"./e-shape-action-runtime-transform-resize-size-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthAbsolute\n} from \"./e-shape-action-runtime-transform-resize-width-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthRelative\n} from \"./e-shape-action-runtime-transform-resize-width-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformResizeSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.RESIZE,\n\tEShapeActionValueTransformResizeType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformResize\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformResizeType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformResizeType,\n\t\tcondition: string,\n\t\toriginX: number, originY: number,\n\t\tamount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.RESIZE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformResize) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformResize {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add( this.condition );\n\t\tconst amountId = manager.add( this.amount );\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformResizeSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformResize {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformResize(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nconst amountDefault = (): number => 0;\n\nexport class EShapeActionRuntimeTransformRotate extends EShapeActionRuntimeConditional {\n\tprotected originY: number;\n\tprotected originX: number;\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformRotate, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.amount = this.toExpression( `(${value.amount}) * (Math.PI / 180)`, amountDefault, \"0\" );\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\toldRotation: number, newRotation: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\tconst dx = (-0.5 + originX) * (writtenWidth ? shape.size.x : runtime.size.x);\n\t\tconst dy = (-0.5 + originY) * (writtenHeight ? shape.size.y : runtime.size.y);\n\t\tconst s = Math.sin( oldRotation ) - Math.sin( newRotation );\n\t\tconst c = Math.cos( oldRotation ) - Math.cos( newRotation );\n\t\tconst position = shape.transform.position;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * c - dy * s,\n\t\t\toldPositionY + dx * s + dy * c\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateAbsolute extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, amount,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateRelative extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = oldRotation + amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, transform.rotation,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionRuntimeTransformRotateAbsolute } from \"./e-shape-action-runtime-transform-rotate-absolute\";\nimport { EShapeActionRuntimeTransformRotateRelative } from \"./e-shape-action-runtime-transform-rotate-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformRotateType } from \"./e-shape-action-value-transform-rotate-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformRotateSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.ROTATE,\n\tEShapeActionValueTransformRotateType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformRotate\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformRotateType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformRotateType, condition: string,\n\t\toriginX: number, originY: number, amount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.ROTATE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformRotate) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformRotate {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformRotateType.ABSOLUTE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateAbsolute( this );\n\t\tcase EShapeActionValueTransformRotateType.RELATIVE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add( this.condition );\n\t\tconst amountId = manager.add( this.amount );\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformRotateSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformRotate {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformRotate(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isArray } from \"../../util/is-array\";\nimport { isNumber } from \"../../util/is-number\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlink, EShapeActionValueBlinkSerialized } from \"./e-shape-action-value-blink\";\nimport {\n\tEShapeActionValueChangeColor, EShapeActionValueChangeColorSerialized } from \"./e-shape-action-value-change-color\";\nimport {\n\tEShapeActionValueChangeColorBrightness, EShapeActionValueChangeColorBrightnessSerialized\n} from \"./e-shape-action-value-change-color-brightness\";\nimport {\n\tEShapeActionValueChangeColorCode, EShapeActionValueChangeColorCodeSerialized\n} from \"./e-shape-action-value-change-color-code\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport {\n\tEShapeActionValueChangeCursor, EShapeActionValueChangeCursorSerialized } from \"./e-shape-action-value-change-cursor\";\nimport { EShapeActionValueChangeText, EShapeActionValueChangeTextSerialized } from \"./e-shape-action-value-change-text\";\nimport { EShapeActionValueEmitEvent, EShapeActionValueEmitEventSerialized } from \"./e-shape-action-value-emit-event\";\nimport { EShapeActionValueMisc, EShapeActionValueMiscSerialized } from \"./e-shape-action-value-misc\";\nimport { EShapeActionValueOpen, EShapeActionValueOpenSerialized } from \"./e-shape-action-value-open\";\nimport { EShapeActionValueShowHide, EShapeActionValueShowHideSerialized } from \"./e-shape-action-value-show-hide\";\nimport {\n\tEShapeActionValueShowHideType\n} from \"./e-shape-action-value-show-hide-type\";\nimport {\n\tEShapeActionValueTransformMove, EShapeActionValueTransformMoveSerialized\n} from \"./e-shape-action-value-transform-move\";\nimport {\n\tEShapeActionValueTransformResize, EShapeActionValueTransformResizeSerialized\n} from \"./e-shape-action-value-transform-resize\";\nimport {\n\tEShapeActionValueTransformRotate, EShapeActionValueTransformRotateSerialized\n} from \"./e-shape-action-value-transform-rotate\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport type EShapeActionValueSerialized = EShapeActionValueShowHideSerialized |\n\tEShapeActionValueBlinkSerialized | EShapeActionValueBlinkSerialized |\n\tEShapeActionValueChangeColorSerialized | EShapeActionValueChangeColorCodeSerialized |\n\tEShapeActionValueChangeColorBrightnessSerialized | EShapeActionValueChangeTextSerialized |\n\tEShapeActionValueChangeCursorSerialized | EShapeActionValueEmitEventSerialized |\n\tEShapeActionValueOpenSerialized | EShapeActionValueTransformMoveSerialized |\n\tEShapeActionValueTransformResizeSerialized | EShapeActionValueTransformRotateSerialized |\n\tEShapeActionValueMiscSerialized;\n\nexport class EShapeActionValueDeserializer {\n\tstatic toSerialized( resource: string ): EShapeActionValueSerialized | null {\n\t\ttry {\n\t\t\tconst parsed = JSON.parse( resource );\n\t\t\tif( isArray( parsed ) ) {\n\t\t\t\tfor( let i = 0, imax = parsed.length; i < imax; ++i ) {\n\t\t\t\t\tif( ! isNumber( parsed[ i ] ) ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 2 <= parsed.length ) {\n\t\t\t\t\treturn parsed as EShapeActionValueSerialized;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserialize( id: number, manager: EShapeResourceManagerDeserialization ): EShapeActionValue {\n\t\tconst actions = manager.actions;\n\t\tconst action = actions.get( id );\n\t\tif( action != null ) {\n\t\t\treturn action;\n\t\t}\n\n\t\tconst resources = manager.resources;\n\t\tconst resource = resources[ id ];\n\t\tif( resource != null ) {\n\t\t\tconst serialized = this.toSerialized( resource );\n\t\t\tif( serialized != null ) {\n\t\t\t\tswitch( serialized[ 0 ] ) {\n\t\t\t\tcase EShapeActionValueType.SHOW_HIDE:\n\t\t\t\t\treturn EShapeActionValueShowHide.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.BLINK:\n\t\t\t\t\treturn EShapeActionValueBlink.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_COLOR:\n\t\t\t\t\tswitch( serialized[ 3 ] ) {\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA:\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColor.deserialize( serialized, manager );\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.CODE:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColorCode.deserialize( serialized, manager );\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.BRIGHTNESS:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColorBrightness.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\tcase EShapeActionValueType.CHANGE_TEXT:\n\t\t\t\t\treturn EShapeActionValueChangeText.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_CURSOR:\n\t\t\t\t\treturn EShapeActionValueChangeCursor.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.EMIT_EVENT:\n\t\t\t\t\treturn EShapeActionValueEmitEvent.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.OPEN:\n\t\t\t\t\treturn EShapeActionValueOpen.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.TRANSFORM:\n\t\t\t\t\tswitch( serialized[ 2 ] ) {\n\t\t\t\t\tcase EShapeActionValueTransformType.MOVE:\n\t\t\t\t\t\treturn EShapeActionValueTransformMove.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.RESIZE:\n\t\t\t\t\t\treturn EShapeActionValueTransformResize.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.ROTATE:\n\t\t\t\t\t\treturn EShapeActionValueTransformRotate.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeActionValueType.MISC:\n\t\t\t\t\treturn EShapeActionValueMisc.deserialize( serialized, manager );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new EShapeActionValueShowHide( EShapeActionValueShowHideType.SHOW, \"\" );\n\t}\n}\n","\nexport class EShapeImageElements {\n\tstatic imageElements: { [ src: string ]: Promise<HTMLImageElement> | HTMLImageElement | undefined } = {};\n\n\tstatic toImageElement( dataUrl: string ): Promise<HTMLImageElement> {\n\t\tconst imageElements = EShapeImageElements.imageElements;\n\t\tconst cachedImageElement = imageElements[ dataUrl ];\n\t\tif( cachedImageElement != null ) {\n\t\t\tif( cachedImageElement instanceof HTMLImageElement ) {\n\t\t\t\treturn Promise.resolve( cachedImageElement );\n\t\t\t} else {\n\t\t\t\treturn cachedImageElement;\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = new Promise<HTMLImageElement>(( resolve, reject ): void => {\n\t\t\t\tconst imageElement = document.createElement( \"img\" );\n\t\t\t\timageElement.onload = () => {\n\t\t\t\t\timageElements[ dataUrl ] = imageElement;\n\t\t\t\t\tresolve( imageElement );\n\t\t\t\t};\n\t\t\t\timageElement.onabort = imageElement.onerror = () => {\n\t\t\t\t\treject();\n\t\t\t\t};\n\t\t\t\timageElement.src = dataUrl;\n\t\t\t});\n\t\t\timageElements[ dataUrl ] = result;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDiagramSerializedFill, DDiagramSerializedStroke, DDiagramSerializedTagRange, DDiagramSerializedTagValue,\n\tDDiagramSerializedText, DDiagramSerializedTextOutline\n} from \"../d-diagram-serialized\";\nimport { EShapeActionValue } from \"./action/e-shape-action-value\";\n\nexport class EShapeResourceManagerDeserialization {\n\tresources: string[];\n\tactions: Map<number, EShapeActionValue>;\n\tfills: Map<number, DDiagramSerializedFill>;\n\tstrokes: Map<number, DDiagramSerializedStroke>;\n\ttagValues: Map<number, DDiagramSerializedTagValue>;\n\ttags: Map<number, number[]>;\n\tranges: Map<number, DDiagramSerializedTagRange>;\n\taligns: Map<number, [ number, number ]>;\n\tmargins: Map<number, [ number, number ]>;\n\ttexts: Map<number, DDiagramSerializedText>;\n\ttextOutlines: Map<number, DDiagramSerializedTextOutline>;\n\textensions: Map<number, unknown>;\n\n\tconstructor( resources: string[] ) {\n\t\tthis.resources = resources;\n\t\tthis.actions = new Map<number, EShapeActionValue>();\n\t\tthis.fills = new Map<number, DDiagramSerializedFill>();\n\t\tthis.strokes = new Map<number, DDiagramSerializedStroke>();\n\t\tthis.tags = new Map<number, number[]>();\n\t\tthis.tagValues = new Map<number, DDiagramSerializedTagValue>();\n\t\tthis.ranges = new Map<number, DDiagramSerializedTagRange>();\n\t\tthis.aligns = new Map<number, [ number, number ]>();\n\t\tthis.margins = new Map<number, [ number, number ]>();\n\t\tthis.texts = new Map<number, DDiagramSerializedText>();\n\t\tthis.textOutlines = new Map<number, DDiagramSerializedTextOutline>();\n\t\tthis.extensions = new Map<number, unknown>();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { isString } from \"../util/is-string\";\nimport { EShapeActionValueDeserializer } from \"./action/e-shape-action-value-deserializer\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeDeserializers } from \"./e-shape-deserializers\";\nimport { EShapeImageElements } from \"./e-shape-image-elements\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeGradients } from \"./variant/e-shape-gradients\";\n\nexport class EShapeDeserializer {\n\tstatic toShape(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShape> | EShape | null {\n\t\tconst shapeDeserializer = EShapeDeserializers[ item[ 0 ] ];\n\t\tif( shapeDeserializer != null ) {\n\t\t\treturn shapeDeserializer( item, manager );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic deserialize<SHAPE extends EShape>(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization, result: SHAPE\n\t): Promise<SHAPE> | SHAPE {\n\t\tresult.id = manager.resources[ item[ 1 ] ] || \"\";\n\t\tresult.transform.position.set( item[ 2 ], item[ 3 ] );\n\t\tresult.transform.rotation = item[ 6 ];\n\t\tresult.transform.skew.set( item[ 7 ], item[ 7 ] );\n\t\tresult.transform.pivot.set( item[ 21 ], item[ 22 ] );\n\t\tresult.size.set( EShapeSizes.toNormalized( item[ 4 ] ), EShapeSizes.toNormalized( item[ 5 ] ) );\n\t\tresult.fill.deserialize( item[ 8 ], manager );\n\t\tresult.stroke.deserialize( item[ 9 ], manager );\n\t\tresult.cursor = manager.resources[ item[ 10 ] ] || \"\";\n\t\tresult.text.deserialize( item[ 11 ], manager );\n\t\tresult.tag.deserialize( item[ 12 ], manager );\n\t\tresult.radius = item[ 13 ];\n\t\tresult.corner = item[ 14 ];\n\t\tresult.interactive = !! ( item[ 23 ] & 1 );\n\t\tresult.unfocusable = !! ( item[ 23 ] & 2 );\n\t\tresult.shortcut = ( 0 <= item[ 24 ] ? manager.resources[ item[ 24 ] ] : undefined );\n\t\tresult.title = ( 0 <= item[ 25 ] ? manager.resources[ item[ 25 ] ] : undefined );\n\n\t\t// Children\n\t\tlet childrenPromise: Promise<SHAPE> | null = null;\n\t\tconst childrenSerialized = item[ 20 ];\n\t\tif( 0 < childrenSerialized.length ) {\n\t\t\tconst childrenOrPromises = [];\n\t\t\tfor( let i = 0, imax = childrenSerialized.length; i < imax; ++i ) {\n\t\t\t\tconst childSerialized = childrenSerialized[ i ];\n\t\t\t\tconst childOrPromise = EShapeDeserializer.toShape( childSerialized, manager );\n\t\t\t\tif( childOrPromise != null ) {\n\t\t\t\t\tchildrenOrPromises.push( childOrPromise );\n\t\t\t\t}\n\t\t\t}\n\t\t\tchildrenPromise = Promise.all( childrenOrPromises ).then(( children: EShape[] ) => {\n\t\t\t\tresult.children = children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tchildren[ i ].parent = result;\n\t\t\t\t}\n\t\t\t\tresult.onChildTransformChange();\n\t\t\t\tresult.toDirty();\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\n\t\t// Action\n\t\tconst serializedActions = item[ 17 ];\n\t\tfor( let i = 0, imax = serializedActions.length; i < imax; ++i ) {\n\t\t\tresult.action.add( EShapeActionValueDeserializer.deserialize( serializedActions[ i ], manager ) );\n\t\t}\n\n\t\t// Gradient\n\t\tconst gradientId = item[ 19 ];\n\t\tif( 0 <= gradientId && gradientId < manager.resources.length ) {\n\t\t\tconst gradient = manager.resources[ gradientId ];\n\t\t\tif( isString( gradient ) ) {\n\t\t\t\tresult.gradient = EShapeGradients.deserializeGradient( gradient );\n\t\t\t}\n\t\t}\n\n\t\t// Image\n\t\tlet imagePromise: Promise<SHAPE> | null = null;\n\t\tconst imageId = item[ 18 ];\n\t\tif( 0 <= imageId && imageId < manager.resources.length ) {\n\t\t\tconst imageSrc = manager.resources[ imageId ];\n\t\t\tif( isString( imageSrc ) ) {\n\t\t\t\timagePromise = EShapeImageElements.toImageElement( imageSrc ).then(( imageElement ) => {\n\t\t\t\t\tresult.image = imageElement;\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( childrenPromise != null ) {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn Promise.all([ childrenPromise, imagePromise ]).then(() => {\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn childrenPromise;\n\t\t\t}\n\t\t} else {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn imagePromise;\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deserializeAll( serializeds: DDiagramSerializedItem[], resources: string[] ): Promise<EShape[]> | null {\n\t\tconst manager = new EShapeResourceManagerDeserialization( resources );\n\t\tconst shapes: Array<Promise<EShape> | EShape> = [];\n\t\tfor( let i = 0, imax = serializeds.length; i < imax; ++i ) {\n\t\t\tconst serialized = serializeds[ i ];\n\t\t\tconst shape = EShapeDeserializer.toShape( serialized, manager );\n\t\t\tif( shape == null ) {\n\t\t\t\tif( 0 < shapes.length ) {\n\t\t\t\t\tPromise.all( shapes ).then( ( resolved: EShape[] ): void => {\n\t\t\t\t\t\tfor( let j = 0, jmax = resolved.length; j < jmax; ++j ) {\n\t\t\t\t\t\t\tresolved[ j ].destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tshapes.push( shape );\n\t\t}\n\t\tif( 0 < shapes.length ) {\n\t\t\treturn Promise.all( shapes );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\n\nexport class EShapeBars {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeBar> | EShapeBar {\n\t\tconst shape = new EShapeBar( EShapeBarPosition.RIGHT, 10, 3, EShapePointsStyle.NONE );\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.points.deserialize( item[ 15 ], manager );\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeBarUploadeds } from \"../shape/variant/e-shape-bar-uploadeds\";\nimport { EShapeBars } from \"../shape/variant/e-shape-bars\";\n\nexport const loadShapeBar = () => {\n\tEShapeUploadeds[ EShapeType.BAR ] = EShapeBarUploadeds.create;\n\tEShapeDeserializers[ EShapeType.BAR ] = EShapeBars.deserialize;\n};\n","\nexport const buildStep = (\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number, vcount: number,\n\tswx: number, swy: number, px0: number, py0: number, px1: number, py1: number\n): void => {\n\tconst istart = voffset * 2;\n\tconst imax = istart + vcount * 2;\n\tconst jstart = voffset * 3;\n\tconst kstart = voffset * 4;\n\tfor( let i = istart, j = jstart, k = kstart; i < imax; i += 2, j += 3, k += 4 ) {\n\t\tconst cx = clippings[ j + 0 ];\n\t\tconst cy = clippings[ j + 1 ];\n\t\tsteps[ i + 0 ] = swx * cx;\n\t\tsteps[ i + 1 ] = swy * cy;\n\t\tantialiases[ k + 0 ] = px0;\n\t\tantialiases[ k + 1 ] = py0;\n\t\tantialiases[ k + 2 ] = px1;\n\t\tantialiases[ k + 3 ] = py1;\n\t}\n};\n","export const toStep = (\n\tsize: number,\n\tstrokeWidth: number,\n\tantialiasWeight: number,\n\tresult: Float32Array\n): Float32Array => {\n\tconst FMIN: number = 0.00001;\n\tif( FMIN < strokeWidth ) {\n\t\tconst dpc0 = size - strokeWidth;\n\t\tif( FMIN < dpc0 ) {\n\t\t\tconst pc0 = antialiasWeight / dpc0;\n\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\tconst swc = 1 / Math.max( FMIN, 1 - strokeWidth / size );\n\t\t\tresult[ 0 ] = swc;\n\t\t\tresult[ 1 ] = pc0;\n\t\t\tresult[ 2 ] = pc1;\n\t\t} else {\n\t\t\tconst pc0 = antialiasWeight / FMIN;\n\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\tconst swc = 1 / FMIN;\n\t\t\tresult[ 0 ] = swc;\n\t\t\tresult[ 1 ] = pc0;\n\t\t\tresult[ 2 ] = pc1;\n\t\t}\n\t} else {\n\t\t// Assumes strokeWidth === 0\n\t\tconst pc = antialiasWeight / Math.max( FMIN, size );\n\t\tresult[ 0 ] = 1;\n\t\tresult[ 1 ] = pc;\n\t\tresult[ 2 ] = pc;\n\t}\n\treturn result;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { buildStep } from \"./build-step\";\nimport { toLength } from \"./to-length\";\nimport { toStep } from \"./to-step\";\n\nexport const CIRCLE_VERTEX_COUNT = 9;\nexport const CIRCLE_INDEX_COUNT = 8;\n\nexport const buildCircleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\tconst ic = voffset * 3;\n\tclippings[ ic +  0 ] = 1;\n\tclippings[ ic +  1 ] = 1;\n\tclippings[ ic +  2 ] = 1;\n\n\tclippings[ ic +  3 ] = 0;\n\tclippings[ ic +  4 ] = 1;\n\tclippings[ ic +  5 ] = 1;\n\n\tclippings[ ic +  6 ] = 1;\n\tclippings[ ic +  7 ] = 1;\n\tclippings[ ic +  8 ] = 1;\n\n\tclippings[ ic +  9 ] = 1;\n\tclippings[ ic + 10 ] = 0;\n\tclippings[ ic + 11 ] = 1;\n\n\tclippings[ ic + 12 ] = 0;\n\tclippings[ ic + 13 ] = 0;\n\tclippings[ ic + 14 ] = 1;\n\n\tclippings[ ic + 15 ] = 1;\n\tclippings[ ic + 16 ] = 0;\n\tclippings[ ic + 17 ] = 1;\n\n\tclippings[ ic + 18 ] = 1;\n\tclippings[ ic + 19 ] = 1;\n\tclippings[ ic + 20 ] = 1;\n\n\tclippings[ ic + 21 ] = 0;\n\tclippings[ ic + 22 ] = 1;\n\tclippings[ ic + 23 ] = 1;\n\n\tclippings[ ic + 24 ] = 1;\n\tclippings[ ic + 25 ] = 1;\n\tclippings[ ic + 26 ] = 1;\n};\n\nexport const buildCircleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\tconst ii = ioffset * 3;\n\tindices[ ii +  0 ] = voffset + 0;\n\tindices[ ii +  1 ] = voffset + 1;\n\tindices[ ii +  2 ] = voffset + 3;\n\n\tindices[ ii +  3 ] = voffset + 1;\n\tindices[ ii +  4 ] = voffset + 4;\n\tindices[ ii +  5 ] = voffset + 3;\n\n\tindices[ ii +  6 ] = voffset + 1;\n\tindices[ ii +  7 ] = voffset + 2;\n\tindices[ ii +  8 ] = voffset + 4;\n\n\tindices[ ii +  9 ] = voffset + 2;\n\tindices[ ii + 10 ] = voffset + 5;\n\tindices[ ii + 11 ] = voffset + 4;\n\n\tindices[ ii + 12 ] = voffset + 3;\n\tindices[ ii + 13 ] = voffset + 4;\n\tindices[ ii + 14 ] = voffset + 6;\n\n\tindices[ ii + 15 ] = voffset + 4;\n\tindices[ ii + 16 ] = voffset + 7;\n\tindices[ ii + 17 ] = voffset + 6;\n\n\tindices[ ii + 18 ] = voffset + 4;\n\tindices[ ii + 19 ] = voffset + 5;\n\tindices[ ii + 20 ] = voffset + 7;\n\n\tindices[ ii + 21 ] = voffset + 5;\n\tindices[ ii + 22 ] = voffset + 8;\n\tindices[ ii + 23 ] = voffset + 7;\n};\n\nexport const buildCircleVertexAndStep = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tclippings: Float32Array,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tisStepsDirty: boolean,\n\tinternalTransform: Matrix,\n\tantialiasWeight: number,\n\twork: Point,\n\tworkStep: Float32Array\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0       1       2\n\t// |-------|-------|\n\t// |3      |4      |5\n\t// |-------|-------|\n\t// |6      |7      |8\n\t// |-------|-------|\n\t//\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\twork.set( -sx + originX, -sy + originY );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( 0 + originX, -sy + originY );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\tconst dx = x1 - x0;\n\tconst dy = y1 - y0;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst x4 = work.x;\n\tconst y4 = work.y;\n\tconst x7 = x4 + (x4 - x1);\n\tconst y7 = y4 + (y4 - y1);\n\tconst x3 = x4 - dx;\n\tconst y3 = y4 - dy;\n\n\t// Vertices\n\tconst iv = voffset * 2;\n\tvertices[ iv +  0 ] = x0;\n\tvertices[ iv +  1 ] = y0;\n\tvertices[ iv +  2 ] = x1;\n\tvertices[ iv +  3 ] = y1;\n\tvertices[ iv +  4 ] = x1 + dx;\n\tvertices[ iv +  5 ] = y1 + dy;\n\n\tvertices[ iv +  6 ] = x3;\n\tvertices[ iv +  7 ] = y3;\n\tvertices[ iv +  8 ] = x4;\n\tvertices[ iv +  9 ] = y4;\n\tvertices[ iv + 10 ] = x4 + dx;\n\tvertices[ iv + 11 ] = y4 + dy;\n\n\tvertices[ iv + 12 ] = x7 - dx;\n\tvertices[ iv + 13 ] = y7 - dy;\n\tvertices[ iv + 14 ] = x7;\n\tvertices[ iv + 15 ] = y7;\n\tvertices[ iv + 16 ] = x7 + dx;\n\tvertices[ iv + 17 ] = y7 + dy;\n\n\t// Steps and antialiases\n\tif( isStepsDirty ) {\n\t\tconst worldSizeX = toLength( x0, y0, x1, y1 );\n\t\ttoStep( worldSizeX, strokeWidth, antialiasWeight, workStep );\n\t\tconst swx = workStep[ 0 ];\n\t\tconst px0 = workStep[ 1 ];\n\t\tconst px1 = workStep[ 2 ];\n\n\t\tconst worldSizeY = toLength( x0, y0, x3, y3 );\n\t\ttoStep( worldSizeY, strokeWidth, antialiasWeight, workStep );\n\t\tconst swy = workStep[ 0 ];\n\t\tconst py0 = workStep[ 1 ];\n\t\tconst py1 = workStep[ 2 ];\n\n\t\tbuildStep(\n\t\t\tsteps, antialiases, clippings,\n\t\t\tvoffset, vcount,\n\t\t\tswx, swy, px0, py0, px1, py1\n\t\t);\n\t}\n};\n\nexport const buildCircleUv = (\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tuvs: Float32Array\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\t// UVs\n\tconst iuv = voffset * 2;\n\tuvs[ iuv +  0 ] = x0;\n\tuvs[ iuv +  1 ] = y0;\n\tuvs[ iuv +  2 ] = 0.5 * ( x0 + x1 );\n\tuvs[ iuv +  3 ] = 0.5 * ( y0 + y1 );\n\tuvs[ iuv +  4 ] = x1;\n\tuvs[ iuv +  5 ] = y1;\n\n\tuvs[ iuv +  6 ] = 0.5 * ( x0 + x3 );\n\tuvs[ iuv +  7 ] = 0.5 * ( y0 + y3 );\n\tuvs[ iuv +  8 ] = 0.5 * ( x0 + x2 );\n\tuvs[ iuv +  9 ] = 0.5 * ( y0 + y2 );\n\tuvs[ iuv + 10 ] = 0.5 * ( x1 + x2 );\n\tuvs[ iuv + 11 ] = 0.5 * ( y1 + y2 );\n\n\tuvs[ iuv + 12 ] = x3;\n\tuvs[ iuv + 13 ] = y3;\n\tuvs[ iuv + 14 ] = 0.5 * ( x3 + x2 );\n\tuvs[ iuv + 15 ] = 0.5 * ( y3 + y2 );\n\tuvs[ iuv + 16 ] = x2;\n\tuvs[ iuv + 17 ] = y2;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildCircleClipping, buildCircleIndex, buildCircleUv, buildCircleVertexAndStep, CIRCLE_VERTEX_COUNT\n} from \"./build-circle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeCircleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings & indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tconst voffset = this.vertexOffset;\n\t\tbuildCircleClipping(\n\t\t\tbuffer.clippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildCircleIndex(\n\t\t\tbuffer.indices,\n\t\t\tvoffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateCircleVertexAndStep( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateCircleUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateCircleVertexAndStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tbuildCircleVertexAndStep(\n\t\t\t\tbuffer.vertices, this.vertexOffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\tbuffer.steps, buffer.antialiases, buffer.clippings,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth, true,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tthis.antialiasWeight,\n\t\t\t\tbuffer.work, buffer.workStep\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateCircleUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tbuildCircleUv( this.vertexOffset, textureUvs, buffer.uvs );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { CIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT } from \"./build-circle\";\nimport { EShapeCircleUploaded } from \"./e-shape-circle-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeCircleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeCircleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = CIRCLE_VERTEX_COUNT + tvcount;\n\t\tconst icount = CIRCLE_INDEX_COUNT + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeCircleUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeCircle extends EShapePrimitive {\n\tconstructor( type = EShapeType.CIRCLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeCircle {\n\t\treturn new EShapeCircle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\tconst x2 = x * x;\n\t\t\t\tconst y2 = y * y;\n\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tconst x2 = x * x;\n\t\t\t\t\tconst y2 = y * y;\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tconst wx2 = wx * wx;\n\t\t\t\t\tconst wy2 = wy * wy;\n\t\t\t\t\tif( wx2 * wy2 <= x2 * wy2 + y2 * wx2 ) {\n\t\t\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeCircle } from \"./e-shape-circle\";\n\nexport class EShapeCircles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeCircle> | EShapeCircle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeCircle() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeCircleUploadeds } from \"../shape/variant/e-shape-circle-uploadeds\";\nimport { EShapeCircles } from \"../shape/variant/e-shape-circles\";\n\nexport const loadShapeCircle = () => {\n\tEShapeUploadeds[ EShapeType.CIRCLE ] = EShapeCircleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.CIRCLE ] = EShapeCircles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeGroupUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0, 1 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeGroupUploaded } from \"./e-shape-group-uploaded\";\n\nexport class EShapeGroupUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number\n\t): EShapeGroupUploaded | null {\n\t\treturn new EShapeGroupUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset\n\t\t).init( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupFillEditor implements EShapeFill {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.alpha = alpha;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.set( enable, color, alpha );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupFillEditor {\n\t\treturn new EShapeGroupFillEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupPoints implements EShapePoints {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget length(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.length;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget id(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.id;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget values(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.values;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset values( values: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.values = values;\n\t\t\t}\n\t\t}\n\t}\n\n\tget segments(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.segments;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset segments( segments: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.segments = segments;\n\t\t\t}\n\t\t}\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.style;\n\t\t\t}\n\t\t}\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.style = style;\n\t\t\t}\n\t\t}\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.copy( source );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tset( values?: number[], segments?: number[], style?: EShapePointsStyle ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.set( values, segments, style );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeGroupPoints {\n\t\treturn new EShapeGroupPoints( parent );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.toPoints( transform );\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.serialize( manager );\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\n\nexport class EShapeEditor {\n\tlocalTransform: Matrix;\n\tinternalTransform: Matrix;\n\tinternalTransformParentInverse: Matrix;\n\trotation: number;\n\tsize: Point;\n\n\tconstructor() {\n\t\tthis.localTransform = new Matrix();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis.internalTransformParentInverse = new Matrix();\n\t\tthis.rotation = 0;\n\t\tthis.size = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\nexport class EShapeTransforms {\n\tstatic prepare( shape: EShape ): void {\n\t\tconst editor = shape.editor = (shape.editor || new EShapeEditor());\n\n\t\t// Ttransform\n\t\tshape.updateTransform();\n\t\tconst parent = shape.parent;\n\t\tif( parent instanceof EShapeBase ) {\n\t\t\tparent.transform.internalTransform.copyTo(editor.internalTransformParentInverse).invert();\n\t\t} else {\n\t\t\teditor.internalTransformParentInverse.identity();\n\t\t}\n\t\tshape.transform.internalTransform.copyTo(editor.internalTransform);\n\n\t\t// Rotation\n\t\teditor.rotation = shape.transform.rotation;\n\n\t\t// Size\n\t\teditor.size.copyFrom( shape.size );\n\n\t\t//\n\t\tshape.disallowOnTransformChange();\n\t}\n\n\tstatic finalize( shape: EShape ): void {\n\t\tshape.allowOnTransformChange( true );\n\t}\n\n\tstatic apply( shape: EShape, transform: Matrix, keepSize: boolean ): void {\n\t\tconst editor = shape.editor;\n\t\tif( editor != null ) {\n\t\t\tconst newLocalTransform = editor.localTransform;\n\t\t\teditor.internalTransformParentInverse.copyTo(newLocalTransform)\n\t\t\t\t.append(transform).append(editor.internalTransform);\n\t\t\tif( keepSize ) {\n\t\t\t\tthis.applyLocal( shape, newLocalTransform );\n\t\t\t} else {\n\t\t\t\tconst size = editor.size;\n\t\t\t\tthis.applyLocal( shape, newLocalTransform, size.x, size.y );\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic applyLocal( shape: EShape, localTransform: Matrix, bx?: number, by?: number ): void {\n\t\tshape.disallowUploadedUpdate();\n\n\t\t// Reconstruct the position, the rotation and the size\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst tx = localTransform.tx;\n\t\tconst ty = localTransform.ty;\n\n\t\t// Rotation\n\t\tconst transform = shape.transform;\n\t\tconst rx = Math.atan2(-c, d); // rotation - skewX\n\t\tconst ry = Math.atan2(+b, a); // rotation + skewY\n\t\ttransform.rotation = (rx + ry) * 0.5; // Here, assumes `skewX` === `skewY`\n\n\t\t// Skew\n\t\tconst skew = (ry - rx) * 0.5;\n\t\ttransform.skew.set(skew, skew);\n\n\t\t// Position: Assumes the pivot is invariant.\n\t\t// tx = position.x - (a * px + c * py)\n\t\t// ty = position.y - (b * px + d * py)\n\t\t//\n\t\t// Thus,\n\t\t// position.x = tx + (a * px + c * py)\n\t\t// position.y = ty + (b * px + d * py)\n\t\tconst pivot = transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\ttransform.position.set(\n\t\t\ttx + (a * px + c * py),\n\t\t\tty + (b * px + d * py)\n\t\t);\n\n\t\t// Scale\n\t\tif( bx != null && by != null ) {\n\t\t\tconst sx = Math.sqrt( a * a + b * b );\n\t\t\tconst sy = Math.sqrt( c * c + d * d );\n\t\t\tshape.size.set(\n\t\t\t\tEShapeSizes.toNormalized( bx * sx ),\n\t\t\t\tEShapeSizes.toNormalized( by * sy )\n\t\t\t);\n\t\t}\n\n\t\t//\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeTransforms } from \"../e-shape-transforms\";\n\nexport class EShapeGroupSizeLayout implements EShapeLayout {\n\tprotected static WORK_TRANSFORM: Matrix = new Matrix();\n\n\tprotected shape: EShape;\n\tprotected base: Point;\n\tprotected shapeBase: Point;\n\tprotected transform: Matrix;\n\n\tconstructor( shape: EShape, bx: number, by: number ) {\n\t\tthis.shape = shape;\n\n\t\t// Base group size\n\t\tthis.base = new Point( bx, by );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase = new Point( size.x, size.y );\n\n\t\t// Transform\n\t\tthis.transform = new Matrix();\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn this.shape === shape;\n\t}\n\n\treset( shape: EShape, baseX: number, baseY: number ): void {\n\t\tthis.base.set( baseX, baseY );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase.copyFrom( size );\n\n\t\t// Transform\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tupdate(\n\t\tshape: EShape, baseX: number, baseY: number,\n\t\tpivotX: number, pivotY: number\n\t) {\n\t\tconst sx = baseX / this.base.x;\n\t\tconst sy = baseY / this.base.y;\n\t\tconst childBase = this.shapeBase;\n\t\tconst transform = EShapeGroupSizeLayout.WORK_TRANSFORM;\n\t\ttransform.identity()\n\t\t\t.append( this.transform )\n\t\t\t.translate( -pivotX, -pivotY )\n\t\t\t.scale( sx, sy )\n\t\t\t.translate( +pivotX, +pivotY );\n\t\tshape.disallowOnTransformChange();\n\t\tEShapeTransforms.applyLocal( shape, transform, childBase.x, childBase.y );\n\t\tshape.allowOnTransformChange( false );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point, Rectangle } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeLayout } from \"./e-shape-group-size-layout\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeEditor implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\tprotected _layouts: EShapeLayout[];\n\tprotected _workPoint: Point = new Point();\n\tprotected _workRectForCalcRect: Rectangle = new Rectangle();\n\tprotected _workRectForFit: Rectangle = new Rectangle();\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\n\t\tthis._parent = parent;\n\t\tthis._layouts = [];\n\t\tthis._size = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number | undefined, y?: number | undefined ): void {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupSizeEditor {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeEditor( this._parent, size.x, size.y );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\tconst parent = this._parent;\n\t\tparent.disallowOnTransformChange();\n\n\t\t// Calculate the rect\n\t\tconst rect = this.calcRect( this._workRectForFit );\n\n\t\t// Set size\n\t\tconst size = this._size;\n\t\tsize.set( rect.width, rect.height );\n\n\t\t// Position & Pivot\n\t\t// rx := rect.x\n\t\t// ry := rect.y\n\t\t//\n\t\t// | a c tx | | 1 0 +rx | | 1 0 -rx |   | a c tx + (a * rx + c * ry) | | 1 0 -rx |\n\t\t// | b d ty | | 0 1 +ry | | 0 1 -ry | = | b d ty + (b * rx + d * ry) | | 0 1 -ry |\n\t\t// | 0 0 1  | | 0 0  1  | | 0 0  1  |   | 0 0 1                      | | 0 0  1  |\n\t\t//\n\t\t// tx -> tx + (a * rx + c * ry) = poxition.x - (a * pivot.x + c * pivot.y)\n\t\t// ty -> ty + (b * rx + d * ry) = poxition.y - (b * pivot.x + d * pivot.y)\n\t\t// position.x -> position.x + (a * rx + c * ry) - (a * pivot.x + c * pivot.y)\n\t\t// position.y -> position.y + (b * rx + d * ry) - (b * pivot.x + d * pivot.y)\n\t\t// pivot.x -> 0\n\t\t// pivot.y -> 0\n\t\t//\n\t\t// a -> a', b -> b', c -> c', tx -> tx', ty -> ty'\n\t\t//\n\t\t// | a' c' tx' | | 1 0 -rx |   | a' c' tx' - (a' * rx + c' * ry) |\n\t\t// | b' d' ty' | | 0 1 -ry | = | b' d' ty' - (b' * rx + d' * ry) |\n\t\t// | 0  0  1   | | 0 0  1  |   | 0  0  1                         |\n\t\t//\n\t\t// tx' -> tx' - (a' * rx + c' * ry) = poxition.x - (a' * pivot.x + c' * pivot.y)\n\t\t// ty' -> ty' - (b' * rx + d' * ry) = poxition.y - (b' * pivot.x + d' * pivot.y)\n\t\t// pivot.x -> pivot.x + rx\n\t\t// pivot.y -> pivot.y + ry\n\t\tparent.updateTransform();\n\t\tconst transform = parent.transform;\n\t\tconst x = rect.x + rect.width * 0.5;\n\t\tconst y = rect.y + rect.height * 0.5;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst pivot = transform.pivot;\n\t\tposition.set(\n\t\t\tposition.x + (a * x + c * y) - (a * pivot.x + c * pivot.y),\n\t\t\tposition.y + (b * x + d * y) - (b * pivot.x + d * pivot.y)\n\t\t);\n\t\tpivot.set( x, y );\n\n\t\t// Reset the data\n\t\tthis.reset( parent.children, this._layouts, size );\n\n\t\t//\n\t\tparent.allowOnTransformChange( true );\n\t}\n\n\tprotected reset( children: EShape[], layouts: EShapeLayout[], size: IPoint ): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.reset( child, size.x, size.y );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif( children.length < layouts.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tcalcRect( result: Rectangle ): Rectangle {\n\t\tconst parent = this._parent;\n\t\tconst children = parent.children;\n\t\tif( children.length <= 0 ) {\n\t\t\tresult.x = 0;\n\t\t\tresult.y = 0;\n\t\t\tresult.width = 0;\n\t\t\tresult.height = 0;\n\t\t} else {\n\t\t\tconst workPoint = this._workPoint;\n\t\t\tconst workRect = this._workRectForCalcRect;\n\t\t\tchildren[ 0 ].getBoundsLocal( workPoint, false, result );\n\t\t\tfor( let i = 1, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tchild.getBoundsLocal( workPoint, false, workRect );\n\t\t\t\tresult.enlarge( workRect );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tconst parent = this._parent;\n\t\tconst size = this._size;\n\t\tconst pivot = parent.transform.pivot;\n\t\tthis.onChange_( parent.children, this._layouts, size.x, size.y, pivot.x, pivot.y, ox, oy );\n\t\tparent.onSizeChange();\n\t}\n\n\tprotected onChange_(\n\t\tchildren: EShape[],\n\t\tlayouts: EShapeLayout[],\n\t\tsx: number, sy: number,\n\t\tpx: number, py: number,\n\t\tox: number, oy: number\n\t): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor( let i = layouts.length, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = this.newLayout( child, ox, oy );\n\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\tlayouts.push( layout );\n\t\t}\n\t\tif( layouts.length !== children.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tprotected newLayout( shape: EShape, ox: number, oy: number ): EShapeLayout {\n\t\treturn shape.layout || new EShapeGroupSizeLayout( shape, ox, oy );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ObservablePoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\n\nexport class EShapeGroupSizeViewer extends ObservablePoint implements EShapeGroupSize {\n\tbase: Point;\n\n\tconstructor( cb: () => void, x: number, y: number ) {\n\t\tsuper( cb, undefined, x, y );\n\t\tthis.base = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\tthis.base.copyFrom( this );\n\t\t(this as any).cb();\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupStrokeEditor implements EShapeStroke {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.width = width;\n\t\t}\n\t}\n\n\tget align(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.align;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset align( align: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.align = align;\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.side;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.side = side;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number, width: number, side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.set( enable, color, alpha, width, side );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupStrokeEditor {\n\t\treturn new EShapeGroupStrokeEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextAlignEditor implements EShapeTextAlign {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.horizontal;\n\t\t}\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.vertical;\n\t\t}\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOffsetEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOutlineEditor implements EShapeTextOutline {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.width = width;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.copy( target );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.set( enable, color, alpha, width );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupTextOutlineEditor {\n\t\treturn new EShapeGroupTextOutlineEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextPaddingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextSpacingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupTextAlignEditor } from \"./e-shape-group-text-align-editor\";\nimport { EShapeGroupTextOffsetEditor } from \"./e-shape-group-text-offset-editor\";\nimport { EShapeGroupTextOutlineEditor } from \"./e-shape-group-text-outline-editor\";\nimport { EShapeGroupTextPaddingEditor } from \"./e-shape-group-text-padding-editor\";\nimport { EShapeGroupTextSpacingEditor } from \"./e-shape-group-text-spacing-editor\";\n\nexport class EShapeGroupTextEditor implements EShapeText {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\talign: EShapeGroupTextAlignEditor;\n\toffset: EShapeGroupTextOffsetEditor;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeGroupTextSpacingEditor;\n\tpadding: EShapeGroupTextPaddingEditor;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\n\t\tthis.align = new EShapeGroupTextAlignEditor( parent );\n\t\tthis.offset = new EShapeGroupTextOffsetEditor( parent );\n\t\tthis.outline = new EShapeGroupTextOutlineEditor( parent );\n\t\tthis.spacing = new EShapeGroupTextSpacingEditor( parent );\n\t\tthis.padding = new EShapeGroupTextPaddingEditor( parent );\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.enable = enable;\n\t\t}\n\t}\n\n\tget value(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.value;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.value = value;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.color;\n\t\t}\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.alpha = alpha;\n\t\t}\n\t}\n\n\tget family(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.family;\n\t\t}\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.family = family;\n\t\t}\n\t}\n\n\tget size(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.size;\n\t\t}\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.size = size;\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.weight;\n\t\t}\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.weight = weight;\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.style;\n\t\t}\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.style = style;\n\t\t}\n\t}\n\n\tget direction(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.direction;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset direction( direction: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.direction = direction;\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.clipping;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.clipping = clipping;\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.copy( target );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection\n\t): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.set( value, color, alpha, family, size, weight, style, direction );\n\t\t}\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.toObject();\n\t\t}\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeGroupFillEditor } from \"./e-shape-group-fill-editor\";\nimport { EShapeGroupPoints } from \"./e-shape-group-points\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeEditor } from \"./e-shape-group-size-editor\";\nimport { EShapeGroupSizeViewer } from \"./e-shape-group-size-viewer\";\nimport { EShapeGroupStrokeEditor } from \"./e-shape-group-stroke-editor\";\nimport { EShapeGroupTextEditor } from \"./e-shape-group-text-editor\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\n\nexport class EShapeGroup extends EShapeBase implements EShapeGroupPropertyParent {\n\tsize: EShapeGroupSize;\n\tfill: EShapeFill;\n\tstroke: EShapeStroke;\n\ttag: EShapeTag;\n\ttext: EShapeText;\n\n\tprotected _points?: EShapeGroupPoints;\n\n\tconstructor( type = EShapeType.GROUP ) {\n\t\tsuper( type );\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.size = this.newGroupSize();\n\t\tthis.fill = this.newGroupFill();\n\t\tthis.stroke = this.newGroupStroke();\n\t\tthis.text = this.newGroupText();\n\t\tthis.points = this.newGroupPoints();\n\t}\n\n\tprotected newGroupSize(): EShapeGroupSize {\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\treturn new EShapeGroupSizeEditor(\n\t\t\t\tthis,\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t} else {\n\t\t\tconst result = new EShapeGroupSizeViewer(\n\t\t\t\t() => {\n\t\t\t\t\tconst base = result.base;\n\t\t\t\t\tthis.transform.scale.set(\n\t\t\t\t\t\tresult.x / base.x,\n\t\t\t\t\t\tresult.y / base.y\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tprotected newGroupFill(): EShapeFill {\n\t\treturn new EShapeGroupFillEditor( this );\n\t}\n\n\tprotected newGroupStroke(): EShapeStroke {\n\t\treturn new EShapeGroupStrokeEditor( this );\n\t}\n\n\tprotected newGroupText(): EShapeText {\n\t\treturn new EShapeGroupTextEditor( this );\n\t}\n\n\tprotected newGroupPoints(): EShapePoints | undefined {\n\t\treturn new EShapeGroupPoints( this );\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\tconst size = this.size;\n\t\tif( size instanceof EShapeGroupSizeViewer ) {\n\t\t\treturn size.base;\n\t\t} else {\n\t\t\treturn size;\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\tsuper.onChildTransformChange();\n\t\tthis.size.fit();\n\t}\n\n\tget corner(): EShapeCorner {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].corner;\n\t\t}\n\t\treturn EShapeCorner.ALL;\n\t}\n\n\tset corner( corner: EShapeCorner ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].corner = corner;\n\t\t}\n\t}\n\n\tget cursor(): string {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].cursor;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset cursor( cursor: string ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].cursor = cursor;\n\t\t}\n\t}\n\n\tget gradient(): EShapeGradientLike | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst gradient = children[ i ].gradient;\n\t\t\tif( gradient != null ) {\n\t\t\t\treturn gradient;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset gradient( gradient: EShapeGradientLike | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].gradient = gradient;\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].radius;\n\t\t}\n\t\treturn 0.5;\n\t}\n\n\tset radius( radius: number ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].radius = radius;\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst image = children[ i ].image;\n\t\t\tif( image != null ) {\n\t\t\t\treturn image;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].image = image;\n\t\t}\n\t}\n\n\tget points(): EShapePoints | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn this._points;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset points( points: EShapePoints | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroup {\n\t\tconst constructor = this.constructor as new () => EShapeGroup;\n\t\tconst result = new constructor().copy( this );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst clone = children[ i ].clone();\n\t\t\tclone.parent = result;\n\t\t\tresult.children.push( clone );\n\t\t}\n\t\tresult.onChildTransformChange();\n\t\tresult.toDirty();\n\t\treturn result;\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroup } from \"./e-shape-group\";\n\nexport class EShapeGroups {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeGroup> | EShapeGroup {\n\t\tconst shape = new EShapeGroup();\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.size.init();\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeGroupUploadeds } from \"../shape/variant/e-shape-group-uploadeds\";\nimport { EShapeGroups } from \"../shape/variant/e-shape-groups\";\n\nexport const loadShapeGroup = () => {\n\tEShapeUploadeds[ EShapeType.GROUP ] = EShapeGroupUploadeds.create;\n\tEShapeDeserializers[ EShapeType.GROUP ] = EShapeGroups.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeShadowed implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\n\t\tthis._parent = parent;\n\t\tthis._size = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number | undefined, y?: number | undefined ): void {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupSizeShadowed {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeShadowed( this._parent, size.x, size.y );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tthis._parent.onSizeChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeGroup } from \"./e-shape-group\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeShadowed } from \"./e-shape-group-size-shadowed\";\n\nexport class EShapeGroupShadowed extends EShapeGroup {\n\tconstructor( type: EShapeType = EShapeType.GROUP_SHADOWED ) {\n\t\tsuper( type );\n\t}\n\n\tprotected newGroupSize(): EShapeGroupSize {\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\treturn new EShapeGroupSizeShadowed(\n\t\t\t\tthis,\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t} else {\n\t\t\treturn super.newGroupSize();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroupShadowed } from \"./e-shape-group-shadowed\";\n\nexport class EShapeGroupShadoweds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeGroupShadowed> | EShapeGroupShadowed {\n\t\tconst shape = new EShapeGroupShadowed();\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.size.init();\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeGroupShadoweds } from \"../shape/variant/e-shape-group-shadoweds\";\nimport { EShapeGroupUploadeds } from \"../shape/variant/e-shape-group-uploadeds\";\n\nexport const loadShapeGroupShadowed = () => {\n\tEShapeUploadeds[ EShapeType.GROUP_SHADOWED ] = EShapeGroupUploadeds.create;\n\tEShapeDeserializers[ EShapeType.GROUP_SHADOWED ] = EShapeGroupShadoweds.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangle {\n\t\treturn new EShapeRectangle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth && strokeSide !== EShapeStrokeSide.NONE ) {\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tif( ! this.containsAbsBBox( x, y, wx, wy ) ) {\n\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( x <= -wx ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if( +wx <= x ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport class EShapeImage extends EShapeRectangle {\n\tconstructor( image?: HTMLImageElement, type = EShapeType.IMAGE ) {\n\t\tsuper( type );\n\t\tif( image != null ) {\n\t\t\tthis.image = image;\n\t\t\tthis.size.set( image.width, image.height );\n\t\t}\n\t\tthis.fill.alpha = 1.0;\n\t}\n\n\tclone(): EShapeImage {\n\t\treturn new EShapeImage( this.image ).copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeImageElements } from \"../e-shape-image-elements\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeImage } from \"./e-shape-image\";\n\nexport class EShapeImages {\n\tstatic from( dataUrl: string ): Promise<EShapeImage> {\n\t\treturn EShapeImageElements.toImageElement( dataUrl ).then(( imageElement: HTMLImageElement ) => {\n\t\t\treturn new EShapeImage( imageElement );\n\t\t});\n\t}\n\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeImage> | EShapeImage {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeImage() );\n\t}\n}\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { toLength } from \"./to-length\";\nimport { toStep } from \"./to-step\";\n\nexport const RECTANGLE_VERTEX_COUNT = 12;\nexport const RECTANGLE_INDEX_COUNT = 8;\n\nexport const buildRectangleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\t// Clippings\n\tlet ic = voffset * 3;\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\n\tclippings[ ic + 3 ] = 0;\n\tclippings[ ic + 4 ] = 1;\n\tclippings[ ic + 5 ] = 0;\n\n\tclippings[ ic + 6 ] = 1;\n\tclippings[ ic + 7 ] = 1;\n\tclippings[ ic + 8 ] = 0;\n\tic += 9;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic +  0 ] = 1;\n\tclippings[ ic +  1 ] = 0;\n\tclippings[ ic +  2 ] = 0;\n\n\tclippings[ ic +  3 ] = 0;\n\tclippings[ ic +  4 ] = 0;\n\tclippings[ ic +  5 ] = 0;\n\n\tclippings[ ic +  6 ] = 0;\n\tclippings[ ic +  7 ] = 0;\n\tclippings[ ic +  8 ] = 0;\n\n\tclippings[ ic +  9 ] = 1;\n\tclippings[ ic + 10 ] = 0;\n\tclippings[ ic + 11 ] = 0;\n\tic += 12;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\n\tclippings[ ic + 3 ] = 0;\n\tclippings[ ic + 4 ] = 1;\n\tclippings[ ic + 5 ] = 0;\n\n\tclippings[ ic + 6 ] = 1;\n\tclippings[ ic + 7 ] = 1;\n\tclippings[ ic + 8 ] = 0;\n};\n\nexport const buildRectangleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Indices\n\tconst ii = ioffset * 3;\n\tindices[ ii +  0 ] = voffset + 0;\n\tindices[ ii +  1 ] = voffset + 1;\n\tindices[ ii +  2 ] = voffset + 3;\n\n\tindices[ ii +  3 ] = voffset + 1;\n\tindices[ ii +  4 ] = voffset + 2;\n\tindices[ ii +  5 ] = voffset + 3;\n\n\tindices[ ii +  6 ] = voffset + 0;\n\tindices[ ii +  7 ] = voffset + 5;\n\tindices[ ii +  8 ] = voffset + 4;\n\n\tindices[ ii +  9 ] = voffset + 6;\n\tindices[ ii + 10 ] = voffset + 2;\n\tindices[ ii + 11 ] = voffset + 7;\n\n\tindices[ ii + 12 ] = voffset + 4;\n\tindices[ ii + 13 ] = voffset + 5;\n\tindices[ ii + 14 ] = voffset + 9;\n\n\tindices[ ii + 15 ] = voffset + 9;\n\tindices[ ii + 16 ] = voffset + 8;\n\tindices[ ii + 17 ] = voffset + 10;\n\n\tindices[ ii + 18 ] = voffset + 8;\n\tindices[ ii + 19 ] = voffset + 11;\n\tindices[ ii + 20 ] = voffset + 10;\n\n\tindices[ ii + 21 ] = voffset + 6;\n\tindices[ ii + 22 ] = voffset + 7;\n\tindices[ ii + 23 ] = voffset + 11;\n};\n\nexport const buildRectangleVertexAndStep = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tstrokeSide: EShapeStrokeSide,\n\tisStepsDirty: boolean,\n\tinternalTransform: Matrix,\n\tantialiasWeight: number,\n\twork: Point,\n\tworkStep: Float32Array\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0       1       2\n\t// |-------|-------|\n\t// |4      |3,5,6  |7\n\t// |-------|-------|\n\t// |       |8      |\n\t// |-------|-------|\n\t//  9       10      11\n\t//\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\tconst dx = x1 - x0;\n\tconst dy = y1 - y0;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst x3 = work.x;\n\tconst y3 = work.y;\n\tconst x10 = x3 + (x3 - x1);\n\tconst y10 = y3 + (y3 - y1);\n\tconst x4 = x3 - dx;\n\tconst y4 = y3 - dy;\n\n\t// Vertices\n\tlet iv = voffset * 2;\n\tvertices[ iv + 0 ] = x0;\n\tvertices[ iv + 1 ] = y0;\n\tvertices[ iv + 2 ] = x1;\n\tvertices[ iv + 3 ] = y1;\n\tvertices[ iv + 4 ] = x1 + dx;\n\tvertices[ iv + 5 ] = y1 + dy;\n\tiv += 6;\n\n\tvertices[ iv + 0 ] = x3;\n\tvertices[ iv + 1 ] = y3;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x4;\n\tvertices[ iv + 1 ] = y4;\n\tvertices[ iv + 2 ] = x3;\n\tvertices[ iv + 3 ] = y3;\n\tvertices[ iv + 4 ] = x3;\n\tvertices[ iv + 5 ] = y3;\n\tvertices[ iv + 6 ] = x3 + dx;\n\tvertices[ iv + 7 ] = y3 + dy;\n\tiv += 8;\n\n\tvertices[ iv + 0 ] = x3;\n\tvertices[ iv + 1 ] = y3;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x10 - dx;\n\tvertices[ iv + 1 ] = y10 - dy;\n\tvertices[ iv + 2 ] = x10;\n\tvertices[ iv + 3 ] = y10;\n\tvertices[ iv + 4 ] = x10 + dx;\n\tvertices[ iv + 5 ] = y10 + dy;\n\n\tif( isStepsDirty ) {\n\t\tconst worldSizeX = toLength( x0, y0, x1, y1 );\n\t\ttoStep( worldSizeX, strokeWidth, antialiasWeight, workStep );\n\t\tconst swx = workStep[ 0 ];\n\t\tconst px0 = workStep[ 1 ];\n\t\tconst px1 = workStep[ 2 ];\n\n\t\tconst worldSizeY = toLength( x0, y0, x4, y4 );\n\t\ttoStep( worldSizeY, strokeWidth, antialiasWeight, workStep );\n\t\tconst swy = workStep[ 0 ];\n\t\tconst py0 = workStep[ 1 ];\n\t\tconst py1 = workStep[ 2 ];\n\n\t\tlet swt = swy;\n\t\tlet pt0 = py0;\n\t\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\t\tswt = 1;\n\t\t\tpt0 = py1;\n\t\t}\n\t\tlet swr = swx;\n\t\tlet pr0 = px0;\n\t\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\t\tswr = 1;\n\t\t\tpr0 = px1;\n\t\t}\n\t\tlet swb = swy;\n\t\tlet pb0 = py0;\n\t\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\t\tswb = 1;\n\t\t\tpb0 = py1;\n\t\t}\n\t\tlet swl = swx;\n\t\tlet pl0 = px0;\n\t\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\t\tswl = 1;\n\t\t\tpl0 = px1;\n\t\t}\n\t\tconst pc0 = 0.5 * (pl0 + pr0);\n\t\tconst pm0 = 0.5 * (pt0 + pb0);\n\n\t\tlet is = voffset * 2;\n\t\tlet ia = voffset * 4;\n\n\t\t// 0\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 1\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pc0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 2\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 3\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pc0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 4\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pm0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 5\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pm0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 6\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pm0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 7\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pm0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 8\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = pc0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 9\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 10\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pc0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\t// 11\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\t}\n};\n\nexport const buildRectangleUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x02 = 0.5 * ( x0 + x2 );\n\tconst y02 = 0.5 * ( y0 + y2 );\n\n\t// UVs\n\tlet iuv = voffset * 2;\n\tuvs[ iuv + 0 ] = x0;\n\tuvs[ iuv + 1 ] = y0;\n\tuvs[ iuv + 2 ] = 0.5 * ( x0 + x1 );\n\tuvs[ iuv + 3 ] = 0.5 * ( y0 + y1 );\n\tuvs[ iuv + 4 ] = x1;\n\tuvs[ iuv + 5 ] = y1;\n\tiuv += 6;\n\n\tuvs[ iuv + 0 ] = x02;\n\tuvs[ iuv + 1 ] = y02;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = 0.5 * ( x0 + x3 );\n\tuvs[ iuv + 1 ] = 0.5 * ( y0 + y3 );\n\tuvs[ iuv + 2 ] = x02;\n\tuvs[ iuv + 3 ] = y02;\n\tuvs[ iuv + 4 ] = x02;\n\tuvs[ iuv + 5 ] = y02;\n\tuvs[ iuv + 6 ] = 0.5 * ( x1 + x2 );\n\tuvs[ iuv + 7 ] = 0.5 * ( y1 + y2 );\n\tiuv += 8;\n\n\tuvs[ iuv + 0 ] = x02;\n\tuvs[ iuv + 1 ] = y02;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = x3;\n\tuvs[ iuv + 1 ] = y3;\n\tuvs[ iuv + 2 ] = 0.5 * ( x3 + x2 );\n\tuvs[ iuv + 3 ] = 0.5 * ( y3 + y2 );\n\tuvs[ iuv + 4 ] = x2;\n\tuvs[ iuv + 5 ] = y2;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleClipping, buildRectangleIndex, buildRectangleUv, buildRectangleVertexAndStep\n} from \"./build-rectangle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tconst voffset = this.vertexOffset;\n\t\tbuildRectangleClipping(\n\t\t\tbuffer.clippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildRectangleIndex(\n\t\t\tbuffer.indices,\n\t\t\tvoffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexAndStep( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexAndStep( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tbuildRectangleVertexAndStep(\n\t\t\t\tbuffer.vertices, this.vertexOffset,\n\t\t\t\tbuffer.steps, buffer.antialiases,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth, strokeSide, true,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tthis.antialiasWeight,\n\t\t\t\tbuffer.work, buffer.workStep\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tbuildRectangleUv( buffer.uvs, this.vertexOffset, textureUvs );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT } from \"./build-rectangle\";\nimport { EShapeRectangleUploaded } from \"./e-shape-rectangle-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeRectangleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeRectangleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = RECTANGLE_VERTEX_COUNT + tvcount;\n\t\tconst icount = RECTANGLE_INDEX_COUNT + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeRectangleUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeImages } from \"../shape/variant/e-shape-images\";\nimport { EShapeRectangleUploadeds } from \"../shape/variant/e-shape-rectangle-uploadeds\";\n\nexport const loadShapeImage = () => {\n\tEShapeUploadeds[ EShapeType.IMAGE ] = EShapeRectangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.IMAGE ] = EShapeImages.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeLabelUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.initText();\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateLabelVertex( buffer, shape );\n\t\tthis.updateLabelUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tupdateLabelVertex( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t}\n\t}\n\n\tupdateLabelUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tthis.texture = this.toTexture( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeLabelUploaded } from \"./e-shape-label-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeLabelUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLabelUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = tvcount;\n\t\tconst icount = ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeLabelUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeLabel extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.LABEL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeLabel {\n\t\treturn new EShapeLabel().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLabel } from \"./e-shape-label\";\n\nexport class EShapeLabels {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLabel> | EShapeLabel {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLabel() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLabelUploadeds } from \"../shape/variant/e-shape-label-uploadeds\";\nimport { EShapeLabels } from \"../shape/variant/e-shape-labels\";\n\nexport const loadShapeLabel = () => {\n\tEShapeUploadeds[ EShapeType.LABEL ] = EShapeLabelUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LABEL ] = EShapeLabels.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toIndexOf = <V>( array: V[], value: V ): number => {\n\tlet i0 = 0;\n\tlet i1 = array.length - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn -1;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { toIndexOf } from \"../../util/to-index-of\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapePointsStyleUploadeds } from \"../e-shape-points-style-uploadeds\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\nimport { toLength } from \"./to-length\";\n\nconst FMIN: number = 0.00001;\n\nexport class EShapeLineUploaded extends EShapeTextUploaded {\n\tprotected pointCount: number;\n\tprotected pointId: number;\n\tprotected pointsClosed: boolean;\n\tprotected length: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number,\n\t\tpointCount: number, pointsClosed: boolean\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointId = NaN;\n\t\tthis.pointCount = pointCount;\n\t\tthis.pointsClosed = pointsClosed;\n\t\tthis.length = 1;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tconst pointsClosed = this.pointsClosed;\n\n\t\t// Clipping & indices\n\t\tif( 2 <= pointCount ) {\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tbuffer.indexBuffer.update();\n\t\t\tconst indices = buffer.indices;\n\n\t\t\tlet ic = voffset * 3;\n\t\t\tlet ii = ioffset * 3;\n\t\t\tlet io = voffset;\n\n\t\t\t// First\n\t\t\tif( ! pointsClosed ) {\n\t\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\t\tclippings[ ic +  5 ] = 5;\n\t\t\t\tic += 6;\n\n\t\t\t\tindices[ ii + 0 ] = io + 0;\n\t\t\t\tindices[ ii + 1 ] = io + 2;\n\t\t\t\tindices[ ii + 2 ] = io + 1;\n\n\t\t\t\tindices[ ii + 3 ] = io + 1;\n\t\t\t\tindices[ ii + 4 ] = io + 2;\n\t\t\t\tindices[ ii + 5 ] = io + 3;\n\t\t\t\tio += 2;\n\t\t\t\tii += 6;\n\t\t\t}\n\n\t\t\t// Middle\n\t\t\tfor( let i = (pointsClosed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\t\tclippings[ ic +  5 ] = 5;\n\n\t\t\t\tclippings[ ic +  6 ] = 1;\n\t\t\t\tclippings[ ic +  7 ] = 0;\n\t\t\t\tclippings[ ic +  8 ] = 4;\n\n\t\t\t\tclippings[ ic +  9 ] = 0;\n\t\t\t\tclippings[ ic + 10 ] = 1;\n\t\t\t\tclippings[ ic + 11 ] = 6;\n\t\t\t\tic += 12;\n\n\t\t\t\tindices[ ii +  0 ] = io + 0;\n\t\t\t\tindices[ ii +  1 ] = io + 2;\n\t\t\t\tindices[ ii +  2 ] = io + 1;\n\n\t\t\t\tindices[ ii +  3 ] = io + 1;\n\t\t\t\tindices[ ii +  4 ] = io + 2;\n\t\t\t\tindices[ ii +  5 ] = io + 3;\n\n\t\t\t\tindices[ ii +  6 ] = io + 2;\n\t\t\t\tindices[ ii +  7 ] = io + 4;\n\t\t\t\tindices[ ii +  8 ] = io + 3;\n\n\t\t\t\tindices[ ii +  9 ] = io + 3;\n\t\t\t\tindices[ ii + 10 ] = io + 4;\n\t\t\t\tindices[ ii + 11 ] = io + 5;\n\t\t\t\tio += 4;\n\t\t\t\tii += 12;\n\t\t\t}\n\n\t\t\t// Last\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 3;\n\n\t\t\tclippings[ ic + 3 ] = 0;\n\t\t\tclippings[ ic + 4 ] = 1;\n\t\t\tclippings[ ic + 5 ] = 5;\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points != null && 2 <= points.length ) {\n\t\t\tconst pointId = points.id;\n\t\t\tconst isPointChanged = ( pointId !== this.pointId );\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\t\tif( isPointChanged || isTransformChanged || isStrokeWidthChanged ) {\n\t\t\t\tthis.pointId = pointId;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\t\tbuffer.vertexBuffer.update();\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\t\tif( isPointChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tconst voffset = this.vertexOffset;\n\t\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\t\tthis.updateLineVertexStepAndColorFill(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tpoints, strokeWidth, shape.transform.internalTransform,\n\t\t\t\t\tvoffset, vcount\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateLineUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\tif( points ) {\n\t\t\t\treturn (\n\t\t\t\t\tthis.pointCount === points.length &&\n\t\t\t\t\tthis.pointsClosed === (!!( points.style & EShapePointsStyle.CLOSED ))\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\tthis.pointCount === 0 &&\n\t\t\t\t\tthis.pointsClosed === false\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateLineVertexStepAndColorFill(\n\t\tbuffer: EShapeBuffer,\n\t\tpoints: EShapePoints,\n\t\tstrokeWidth: number,\n\t\tinternalTransform: Matrix,\n\t\tvoffset: number,\n\t\tvcount: number\n\t): void {\n\t\tlet iv = voffset * 2;\n\t\tlet ia = voffset * 4;\n\t\tconst vertices = buffer.vertices;\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst colorFills = buffer.colorFills;\n\t\tconst pointCount = points.length;\n\t\tconst pointValues = points.values;\n\t\tconst pointSegments = points.segments;\n\t\tconst pointsStyle = points.style;\n\t\tconst closed = ( (pointsStyle & EShapePointsStyle.CLOSED) !== 0 );\n\t\tconst scaleInvariant = EShapePointsStyleUploadeds.toScaleInvariant( pointsStyle );\n\n\t\t//\n\t\tlet l = 0;\n\t\tlet lprev = 0;\n\t\tlet lnext = 0;\n\t\tlet llop = 0;\n\t\tlet llo = 0;\n\t\tlet lmax = 0;\n\t\tlet pprevx = 0;\n\t\tlet pprevy = 0;\n\t\tlet px = 0;\n\t\tlet py = 0;\n\t\tlet pnextx = 0;\n\t\tlet pnexty = 0;\n\t\tlet pseg = false;\n\t\tlet psegnext = false;\n\t\tlet icfprev = voffset * 4;\n\t\tlet loffset = 0;\n\n\t\t// First point\n\t\tconst work = buffer.work;\n\t\twork.set( pointValues[ 0 ], pointValues[ 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst pfirstx = work.x;\n\t\tconst pfirsty = work.y;\n\t\tconst psegfirst = ( 0 <= toIndexOf( pointSegments, 0 ) );\n\n\t\t// Last point\n\t\tconst lastIndex = (pointCount - 1) << 1;\n\t\twork.set( pointValues[ lastIndex + 0 ], pointValues[ lastIndex + 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst plastx = work.x;\n\t\tconst plasty = work.y;\n\t\tconst pseglast = ( 0 <= toIndexOf( pointSegments, pointCount - 1 ) );\n\n\t\t// Second point\n\t\tlet psecondx = plastx;\n\t\tlet psecondy = plasty;\n\t\tlet psegsecond = pseglast;\n\t\tif( 2 < pointCount ) {\n\t\t\twork.set( pointValues[ 2 ], pointValues[ 3 ] );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tpsecondx = work.x;\n\t\t\tpsecondy = work.y;\n\t\t\tpsegsecond = ( 0 <= toIndexOf( pointSegments, 1 ) );\n\t\t}\n\n\t\t// First segment\n\t\tif( closed ) {\n\t\t\tpx = plastx;\n\t\t\tpy = plasty;\n\t\t\tpnextx = pfirstx;\n\t\t\tpnexty = pfirsty;\n\t\t\tpseg = pseglast;\n\t\t\tpsegnext = psegfirst;\n\t\t} else {\n\t\t\tpprevx = pfirstx - (psecondx - pfirstx);\n\t\t\tpprevy = pfirsty - (psecondy - pfirsty);\n\t\t\tpx = pfirstx;\n\t\t\tpy = pfirsty;\n\t\t\tpnextx = psecondx;\n\t\t\tpnexty = psecondy;\n\t\t\tpseg = psegfirst;\n\t\t\tpsegnext = psegsecond;\n\t\t\tlnext += toLength( px, py, pnextx, pnexty );\n\n\t\t\t//\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextx;\n\t\t\tantialiases[ ia + 3 ] = pnexty;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextx;\n\t\t\tantialiases[ ia + 7 ] = pnexty;\n\t\t\tcolorFills[ ia + 0 ] = llo;\n\t\t\tcolorFills[ ia + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\t\t}\n\n\t\t// Middle segments\n\t\tfor( let i = ( closed ? 0 : 1 ), imax = pointCount - i; i < imax; ++i ) {\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( i === pointCount - 2 ) {\n\t\t\t\tpnextx = plastx;\n\t\t\t\tpnexty = plasty;\n\t\t\t\tpsegnext = pseglast;\n\t\t\t} else if( i === 0 ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else if( i < pointCount - 1 ) {\n\t\t\t\tconst nextIndex = (i + 1) << 1;\n\t\t\t\twork.set( pointValues[ nextIndex + 0 ], pointValues[ nextIndex + 1 ] );\n\t\t\t\tinternalTransform.apply( work, work );\n\t\t\t\tpnextx = work.x;\n\t\t\t\tpnexty = work.y;\n\t\t\t\tpsegnext = ( 0 <= toIndexOf( pointSegments, i + 1 ) );\n\t\t\t} else {\n\t\t\t\tpnextx = pfirstx;\n\t\t\t\tpnexty = pfirsty;\n\t\t\t\tpsegnext = psegfirst;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\t\t\tlnext += toLength( px, py, pnextx, pnexty );\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tfor( let j = icfprev; j < ia + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = ia + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tcolorFills[ ia + 0 ] = llop;\n\t\t\tcolorFills[ ia + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllo = l - loffset;\n\t\t\tcolorFills[ ia + 0 ] = llo;\n\t\t\tcolorFills[ ia + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\t\t}\n\n\t\t// Last segment\n\t\t{\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( closed ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else {\n\t\t\t\tpnextx = px + (px - pprevx);\n\t\t\t\tpnexty = py + (py - pprevy);\n\t\t\t\tpsegnext = false;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tfor( let j = icfprev; j < ia + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = ia + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tlmax = Math.max( lmax, llop );\n\t\t\tcolorFills[ ia + 0 ] = llop;\n\t\t\tcolorFills[ ia + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\n\t\t\t// Total length\n\t\t\tthis.length = lmax;\n\t\t\tif( icfprev < ia ) {\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tif( closed ) {\n\t\t\t\t\tfor( let i = icfprev; i < ia; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = -1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = icfprev; i < ia; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = llop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateLineUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tif( 2 <= pointCount ) {\n\t\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\t\tconst x0 = textureUvs.x0;\n\t\t\t\tconst x1 = textureUvs.x1;\n\t\t\t\tconst x2 = textureUvs.x2;\n\t\t\t\tconst x3 = textureUvs.x3;\n\t\t\t\tconst y0 = textureUvs.y0;\n\t\t\t\tconst y1 = textureUvs.y1;\n\t\t\t\tconst y2 = textureUvs.y2;\n\t\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\t\tconst dx01 = x1 - x0;\n\t\t\t\tconst dy01 = y1 - y0;\n\t\t\t\tconst dx32 = x2 - x3;\n\t\t\t\tconst dy32 = y2 - y3;\n\n\t\t\t\t// Uvs\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t\tconst uvs = buffer.uvs;\n\t\t\t\tconst colorFills = buffer.colorFills;\n\t\t\t\tconst closed = this.pointsClosed;\n\t\t\t\tconst voffset = this.vertexOffset;\n\n\t\t\t\tlet iuv = voffset * 2;\n\t\t\t\tlet icf = voffset * 4;\n\t\t\t\tconst lengthInverse = 1 / Math.max( FMIN, this.length );\n\t\t\t\tlet r = 0;\n\n\t\t\t\t// UV: First\n\t\t\t\tif( ! closed ) {\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\t\t\t\t}\n\n\t\t\t\t// UV: Middle\n\t\t\t\tfor( let i = (closed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\t\t\t\t}\n\n\t\t\t\t// UV: Last\n\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeLineUploaded } from \"./e-shape-line-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeLineUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineUploaded | null {\n\t\tconst points = shape.points;\n\t\tconst pointsClosed = ( points ? (points.style & EShapePointsStyle.CLOSED) !== 0 : false );\n\t\tconst pointCount = ( points ? points.length : 0 );\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tlet vcount = tvcount;\n\t\tlet icount = ticount;\n\t\tif( 2 <= pointCount ) {\n\t\t\tif( pointsClosed ) {\n\t\t\t\tvcount += pointCount * 4 + 2;\n\t\t\t\ticount += pointCount * 4;\n\t\t\t} else {\n\t\t\t\tvcount += (pointCount - 2) * 4 + 2 + 2;\n\t\t\t\ticount += (pointCount - 2) * 4 + 2;\n\t\t\t}\n\t\t}\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeLineUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight,\n\t\t\t\tpointCount, pointsClosed\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { toIndexOf } from \"../../util/to-index-of\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange } from \"./e-shape-line-base-points\";\n\nexport class EShapeLinePoints implements EShapePoints {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\n\tprotected _parent: EShapePointsParent;\n\tprotected _valuesBase?: number[];\n\tprotected _valuesBaseLength: number;\n\tprotected _values: number[];\n\tprotected _segments: number[];\n\treadonly position: Point;\n\tprotected _sizeBase: Point;\n\treadonly size: Point;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\n\tconstructor(\n\t\tparent: EShapePointsParent,\n\t\tpoints: number[],\n\t\tsegments: number[],\n\t\tstyle: EShapePointsStyle\n\t) {\n\t\t// Calculate the center\n\t\tconst values: number[] = [];\n\t\tlet minX = 0;\n\t\tlet maxX = 0;\n\t\tlet minY = 0;\n\t\tlet maxY = 0;\n\t\tconst pointsLength = points.length;\n\t\tif( 2 <= pointsLength ) {\n\t\t\tminX = maxX = points[ 0 ];\n\t\t\tminY = maxY = points[ 1 ];\n\t\t\tfor( let i = 2; i < pointsLength; i += 2 ) {\n\t\t\t\tconst x = points[ i ];\n\t\t\t\tconst y = points[ i + 1 ];\n\t\t\t\tminX = Math.min( minX, x );\n\t\t\t\tmaxX = Math.max( maxX, x );\n\t\t\t\tminY = Math.min( minY, y );\n\t\t\t\tmaxY = Math.max( maxY, y );\n\t\t\t}\n\t\t}\n\t\tconst cx = (maxX + minX) * 0.5;\n\t\tconst cy = (maxY + minY) * 0.5;\n\t\tfor( let i = 0; i < pointsLength; i += 2 ) {\n\t\t\tconst x = points[ i + 0 ] - cx;\n\t\t\tconst y = points[ i + 1 ] - cy;\n\t\t\tvalues.push( x, y );\n\t\t}\n\t\tconst sx = maxX - minX;\n\t\tconst sy = maxY - minY;\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._valuesBase = undefined;\n\t\tthis._valuesBaseLength = values.length;\n\t\tthis._values = values;\n\t\tthis._segments = segments.slice( 0 );\n\t\tthis._sizeBase = new Point( sx, sy );\n\t\tthis.size = new Point( sx, sy );\n\t\tthis.position = new Point( cx, cy );\n\t\tthis._id = 0;\n\t\tthis._style = style!;\n\t}\n\n\tget length(): number {\n\t\treturn this._values.length >> 1;\n\t}\n\n\tprivate fitToParentSize() {\n\t\tconst size = this.size;\n\t\tconst parentSize = this._parent.size;\n\t\tconst ssx = parentSize.x;\n\t\tconst ssy = parentSize.y;\n\t\tconst threshold = 0.00001;\n\t\tif( threshold < Math.abs( ssx - size.x ) || threshold < Math.abs( ssy - size.y ) ) {\n\t\t\tsize.set( ssx, ssy );\n\n\t\t\tconst sizeBase = this._sizeBase;\n\t\t\tconst hasSizeBaseX = threshold < Math.abs( sizeBase.x );\n\t\t\tconst hasSizeBaseY = threshold < Math.abs( sizeBase.y );\n\t\t\tif( hasSizeBaseX || hasSizeBaseY ) {\n\t\t\t\tconst scaleX = ( hasSizeBaseX ? ssx / sizeBase.x : 1 );\n\t\t\t\tconst scaleY = ( hasSizeBaseY ? ssy / sizeBase.y : 1 );\n\n\t\t\t\tconst values = this._values;\n\t\t\t\tlet valuesBase = this._valuesBase;\n\t\t\t\tif( valuesBase == null ) {\n\t\t\t\t\tvaluesBase = [];\n\t\t\t\t\tthis._valuesBase = valuesBase;\n\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tconst x = values[ i ];\n\t\t\t\t\t\tconst y = values[ i + 1 ];\n\t\t\t\t\t\tvalues[ i ] = x * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = y * scaleY;\n\t\t\t\t\t\tvaluesBase.push( x, y );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tvalues[ i ] = valuesBase[ i ] * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = valuesBase[ i + 1 ] * scaleY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._id += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tget id(): number {\n\t\tthis.fitToParentSize();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.fitToParentSize();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\tthis.set( values, undefined, undefined );\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\t/**\n\t * Must be sorted in ascending order.\n\t */\n\tset segments( segments: number[] ) {\n\t\tthis.set( undefined, segments, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.set( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\treturn this.set( source.values, source.segments, source.style );\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet isDirty = false;\n\t\tlet isUpdated = false;\n\n\t\t// Values\n\t\tif( newValues != null ) {\n\t\t\tconst values = this._values;\n\t\t\tconst valuesBaseLength = this._valuesBaseLength;\n\t\t\tconst newValuesLength = newValues.length;\n\t\t\tconst iupdate = Math.min( newValuesLength, valuesBaseLength );\n\t\t\tthis._valuesBase = undefined;\n\t\t\tif( values !== newValues ) {\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tvalues[ i ] = newValues[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newValuesLength; ++i ) {\n\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tvalues.length = newValuesLength;\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Segments\n\t\tif( newSegments != null ) {\n\t\t\tconst segments = this._segments;\n\t\t\tif( segments !== newSegments ) {\n\t\t\t\tconst newSegmentsLength = newSegments.length;\n\t\t\t\tconst iupdate = Math.min( segments.length, newSegmentsLength );\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tsegments[ i ] = newSegments[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newSegmentsLength; ++i ) {\n\t\t\t\t\tsegments.push( newSegments[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( segments.length !== newSegmentsLength ) {\n\t\t\t\t\tsegments.length = newSegmentsLength;\n\t\t\t\t}\n\t\t\t}\n\t\t\tisUpdated = true;\n\t\t}\n\n\t\t// Style\n\t\tif( newStyle != null ) {\n\t\t\tconst oldStyle = this._style;\n\t\t\tif( oldStyle !== newStyle ) {\n\t\t\t\tthis._style = newStyle;\n\t\t\t\tif( (oldStyle & EShapePointsStyle.CLOSED) !== (newStyle & EShapePointsStyle.CLOSED) ) {\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( isDirty ) {\n\t\t\tthis._id += 1;\n\t\t\tconst parent = this._parent;\n\t\t\tparent.uploaded = undefined;\n\t\t\tparent.toDirty();\n\t\t} else if( isUpdated ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeLinePoints {\n\t\treturn new EShapeLinePoints( parent, this._values, this._segments, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${JSON.stringify(this._values)},${JSON.stringify(this._segments)},${this._style}]` );\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst pointCount = this.length;\n\t\tif( 2 <= pointCount ) {\n\t\t\tconst pointValues = this._values;\n\t\t\tconst pointSegments = this._segments;\n\t\t\tlet istart = 0;\n\t\t\tlet iend = pointCount;\n\t\t\tif( range ) {\n\t\t\t\tconst rangeResult = range( x, y, threshold, pointValues, EShapeLinePoints.WORK_RANGE );\n\t\t\t\tistart = rangeResult[ 0 ];\n\t\t\t\tiend = rangeResult[ 1 ];\n\t\t\t}\n\t\t\tfor( let i = istart, imax = Math.min( iend, pointCount - 1 ), iv = 2 * istart; i < imax; i += 1, iv += 2 ) {\n\t\t\t\tif( toIndexOf( pointSegments, i + 1 ) < 0 ) {\n\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\tconst p1x = pointValues[ iv + 2 ];\n\t\t\t\t\tconst p1y = pointValues[ iv + 3 ];\n\t\t\t\t\tif( tester( x, y, p0x, p0y, p1x, p1y, i, threshold, result ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 2 < pointCount && pointCount <= iend && (this.style & EShapePointsStyle.CLOSED) ) {\n\t\t\t\tif( toIndexOf( pointSegments, 0 ) < 0 ) {\n\t\t\t\t\tconst i = pointCount - 1;\n\t\t\t\t\tconst iv = i << 1;\n\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\tconst p1x = pointValues[ 0 ];\n\t\t\t\t\tconst p1y = pointValues[ 1 ];\n\t\t\t\t\tif( tester( x, y, p0x, p0y, p1x, p1y, i, threshold, result ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\nimport { EShapeLinePoints } from \"./e-shape-line-points\";\n\nexport class EShapeLine extends EShapeLineBase {\n\tpoints!: EShapeLinePoints;\n\n\tconstructor( line: EShapeLine );\n\tconstructor( points: number[], segments: number[], width: number, style: EShapePointsStyle );\n\tconstructor(\n\t\tlineOrPoints: EShapeLine | number[],\n\t\tsegments?: number[],\n\t\twidth?: number,\n\t\tstyle?: EShapePointsStyle\n\t) {\n\t\tsuper( EShapeType.LINE );\n\t\tif( lineOrPoints instanceof EShapeLine ) {\n\t\t\tthis.copy( lineOrPoints );\n\t\t} else {\n\t\t\tthis.fill.enable = false;\n\t\t\tthis.stroke.set( true, undefined, undefined, width! );\n\t\t\tthis.points = new EShapeLinePoints( this, lineOrPoints, segments!, style! );\n\t\t\tthis.transform.position.copyFrom( this.points.position );\n\t\t\tthis.size.copyFrom( this.points.size );\n\t\t}\n\t}\n\n\tclone(): EShapeLine {\n\t\treturn new EShapeLine( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLine } from \"./e-shape-line\";\n\nexport class EShapeLines {\n\tstatic toStrokeWidth( index: number, resources: string[] ): number {\n\t\tif( 0 <= index && index < resources.length  ) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse( resources[ index ] )[ 3 ];\n\t\t\t} catch( e ) {\n\t\t\t\t//\n\t\t\t}\n\t\t}\n\t\treturn 8;\n\t}\n\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLine> | EShapeLine | null {\n\t\tconst resources = manager.resources;\n\t\tconst resourceId = item[ 15 ];\n\t\tif( 0 <= resourceId && resourceId < resources.length ) {\n\t\t\tlet parsed = manager.extensions.get( resourceId ) as [ number[], number[], number ] | undefined;\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ resourceId ] ) as [ number[], number[], number ];\n\t\t\t\tmanager.extensions.set( resourceId, parsed );\n\t\t\t}\n\t\t\tconst shape = EShapeLines.create(\n\t\t\t\tparsed[ 0 ],\n\t\t\t\tparsed[ 1 ],\n\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\tparsed[ 2 ]\n\t\t\t);\n\t\t\treturn EShapeDeserializer.deserialize( item, manager, shape );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic create(\n\t\tpoints: number[],\n\t\tsegments: number[],\n\t\tstrokeWidth: number,\n\t\tstyle: EShapePointsStyle\n\t): EShapeLine {\n\t\treturn new EShapeLine( points, segments, strokeWidth, style );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineUploadeds } from \"../shape/variant/e-shape-line-uploadeds\";\nimport { EShapeLines } from \"../shape/variant/e-shape-lines\";\n\nexport const loadShapeLine = () => {\n\tEShapeUploadeds[ EShapeType.LINE ] = EShapeLineUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE ] = EShapeLines.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeLabelUploaded } from \"./e-shape-label-uploaded\";\n\nexport class EShapeLineOfNullsUploaded extends EShapeLabelUploaded {\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\treturn ( points == null || points.length === 0 );\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport interface EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this;\n}\n\nexport type EShapeLineOfAnyUploadedConstructor<T extends EShapeLineOfAnyUploaded> = new (\n\tbuffer: EShapeBuffer,\n\tvoffset: number, ioffset: number,\n\ttvcount: number, ticount: number,\n\tvcount: number, icount: number,\n\tantialiasWeight: number,\n\tpointCount: number\n) => T;\n\nexport class EShapeLineOfAnyUploadeds {\n\tstatic create<T extends EShapeLineOfAnyUploaded>(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number,\n\t\tvcountPerPoint: number,\n\t\tioffset: number,\n\t\ticountPerPoint: number,\n\t\tantialiasWeight: number,\n\t\tconstructor: EShapeLineOfAnyUploadedConstructor<T>\n\t): T | EShapeLineOfNullsUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst points = shape.points;\n\t\tconst pointCount = ( points ? points.length : 0 );\n\t\tconst vcount = pointCount * vcountPerPoint + tvcount;\n\t\tconst icount = pointCount * icountPerPoint + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\tif( 0 < pointCount ) {\n\t\t\t\treturn new constructor(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tvoffset, ioffset,\n\t\t\t\t\ttvcount, ticount,\n\t\t\t\t\tvcount, icount,\n\t\t\t\t\tantialiasWeight,\n\t\t\t\t\tpointCount\n\t\t\t\t).init( shape );\n\t\t\t} else {\n\t\t\t\treturn new EShapeLineOfNullsUploaded(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tvoffset, ioffset,\n\t\t\t\t\ttvcount, ticount,\n\t\t\t\t\ttvcount, ticount,\n\t\t\t\t\tantialiasWeight\n\t\t\t\t).init( shape );\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n","\nexport const copyClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet iv = voffset + vcountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet icd = iv * 3;\n\t\tlet ics = voffset * 3;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tclippings[ icd + 0 ] = clippings[ ics + 0 ];\n\t\t\tclippings[ icd + 1 ] = clippings[ ics + 1 ];\n\t\t\tclippings[ icd + 2 ] = clippings[ ics + 2 ];\n\t\t\ticd += 3;\n\t\t\tics += 3;\n\t\t}\n\t\tiv += vcountPerPoint;\n\t}\n};\n","export const copyIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvcountPerPoint: number,\n\tioffset: number,\n\ticountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet idiv = vcountPerPoint;\n\tlet ii = ioffset + icountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet iid = ii * 3;\n\t\tlet iis = ioffset * 3;\n\t\tfor( let j = 0; j < icountPerPoint; ++j ) {\n\t\t\tindices[ iid + 0 ] = indices[ iis + 0 ] + idiv;\n\t\t\tindices[ iid + 1 ] = indices[ iis + 1 ] + idiv;\n\t\t\tindices[ iid + 2 ] = indices[ iis + 2 ] + idiv;\n\t\t\tiid += 3;\n\t\t\tiis += 3;\n\t\t}\n\t\tidiv += vcountPerPoint;\n\t\tii += icountPerPoint;\n\t}\n};\n","export const copyStep = (\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet iv = voffset + vcountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet ivd = iv << 1;\n\t\tlet ivs = voffset << 1;\n\t\tlet iad = iv << 2;\n\t\tlet ias = voffset << 2;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tsteps[ ivd     ] = steps[ ivs     ];\n\t\t\tsteps[ ivd + 1 ] = steps[ ivs + 1 ];\n\t\t\tantialiases[ iad     ] = antialiases[ ias     ];\n\t\t\tantialiases[ iad + 1 ] = antialiases[ ias + 1 ];\n\t\t\tantialiases[ iad + 2 ] = antialiases[ ias + 2 ];\n\t\t\tantialiases[ iad + 3 ] = antialiases[ ias + 3 ];\n\t\t\tivd += 2;\n\t\t\tivs += 2;\n\t\t\tiad += 4;\n\t\t\tias += 4;\n\t\t}\n\t\tiv += vcountPerPoint;\n\t}\n};\n","\nexport const copyUvs = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet iv = voffset + vcountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet iuvd = iv << 1;\n\t\tlet iuvs = voffset << 1;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tuvs[ iuvd     ] = uvs[ iuvs     ];\n\t\t\tuvs[ iuvd + 1 ] = uvs[ iuvs + 1 ];\n\t\t\tiuvd += 2;\n\t\t\tiuvs += 2;\n\t\t}\n\t\tiv += vcountPerPoint;\n\t}\n};\n","import { Matrix } from \"pixi.js\";\n\nexport const copyVertex = (\n\tvertices: Float32Array,\n\tinternalTransform: Matrix,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number,\n\tpointsValues: number[]\n): void => {\n\tconst a = internalTransform.a;\n\tconst b = internalTransform.b;\n\tconst c = internalTransform.c;\n\tconst d = internalTransform.d;\n\tlet i = pointCount - 1;\n\tlet iv = voffset + i * vcountPerPoint;\n\tfor( ; 0 <= i; --i ) {\n\t\tconst ip = i << 1;\n\t\tconst px = pointsValues[ ip     ];\n\t\tconst py = pointsValues[ ip + 1 ];\n\t\tconst dx = a * px + c * py;\n\t\tconst dy = b * px + d * py;\n\t\tlet ivd = iv << 1;\n\t\tlet ivs = voffset << 1;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tvertices[ ivd     ] = vertices[ ivs     ] + dx;\n\t\t\tvertices[ ivd + 1 ] = vertices[ ivs + 1 ] + dy;\n\t\t\tivd += 2;\n\t\t\tivs += 2;\n\t\t}\n\t\tiv -= vcountPerPoint;\n\t}\n};\n","import { isNumber } from \"../../util/is-number\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\n\nexport const isStatic = ( value: EShapeLineOfAnyValue ): boolean => {\n\treturn isNumber( value ) || value == null;\n};\n","import { isFunction } from \"../../util/is-function\";\nimport { isNumber } from \"../../util/is-number\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\n\nexport const toComputed = ( index: number, value: EShapeLineOfAnyValue, def: number ): number => {\n\tif( isNumber( value ) ) {\n\t\treturn value;\n\t} else if( isFunction( value ) ) {\n\t\treturn value( index );\n\t} else if( value ) {\n\t\treturn value[ index % value.length ];\n\t}\n\treturn def;\n};\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsFillImplParent {\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsFillImpl implements EShapeLineOfAnyPointsFill {\n\tprotected _parent: EShapeLineOfAnyPointsFillImplParent;\n\tprotected _id: number;\n\tprotected _color: EShapeLineOfAnyValue;\n\tprotected _alpha: EShapeLineOfAnyValue;\n\n\tconstructor( parent: EShapeLineOfAnyPointsFillImplParent ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._color = null;\n\t\tthis._alpha = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget color(): EShapeLineOfAnyValue {\n\t\treturn this._color;\n\t}\n\n\tset color( color: EShapeLineOfAnyValue ) {\n\t\tthis.set( color, undefined );\n\t}\n\n\tget alpha(): EShapeLineOfAnyValue {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, alpha );\n\t}\n\n\tset( color?: EShapeLineOfAnyValue, alpha?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tisChanged = true;\n\t\t\tthis._color = color;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tisChanged = true;\n\t\t\tthis._alpha = alpha;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetColor( index: number, def: number ): number {\n\t\treturn toComputed( index, this._color, def );\n\t}\n\n\tgetAlpha( index: number, def: number ): number {\n\t\treturn toComputed( index, this._alpha, def );\n\t}\n\n\tisStaticColor(): boolean {\n\t\treturn isStatic( this._color );\n\t}\n\n\tisStaticAlpha(): boolean {\n\t\treturn isStatic( this._alpha );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, Texture } from \"pixi.js\";\n\nexport abstract class DynamicAtlasItem {\n\tid: string;\n\tref: number;\n\tframe: Rectangle;\n\ttexture: Texture;\n\n\twidth: number;\n\theight: number;\n\tstrokeWidth: number;\n\n\tconstructor(\n\t\tid: string,\n\t\twidth: number, height: number, strokeWidth: number,\n\t\tbaseTexture: BaseTexture\n\t) {\n\t\tthis.id = id;\n\t\tthis.ref = 0;\n\t\tconst resolution = baseTexture.resolution;\n\t\tthis.frame = new Rectangle( 0, 0, width * resolution, height * resolution );\n\t\tthis.texture = new Texture( baseTexture, new Rectangle( 0, 0, 1, 1 ) );\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.strokeWidth = strokeWidth;\n\t}\n\n\tabstract render( context: CanvasRenderingContext2D ): void;\n\n\tapplyFrame(): void {\n\t\tconst resolutionInverse = 1 / this.texture.baseTexture.resolution;\n\t\tthis.texture.frame.x = this.frame.x * resolutionInverse;\n\t\tthis.texture.frame.y = this.frame.y * resolutionInverse;\n\t\tthis.texture.frame.width = this.width;\n\t\tthis.texture.frame.height = this.height;\n\t\tthis.texture.updateUvs();\n\t\tthis.texture.emit( \"update\", this );\n\t}\n\n\tdestroy(): void {\n\t\tthis.texture.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemEmpty extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicAtlasItemFontAtlas extends DynamicAtlasItem {\n\tcanvas: HTMLCanvasElement | null;\n\n\tconstructor( atlas: DynamicSDFFontAtlas, baseTexture: BaseTexture ) {\n\t\tsuper( atlas.id, atlas.width / baseTexture.resolution, atlas.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.canvas = atlas.canvas;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst frame = this.frame;\n\t\t\tcontext.drawImage( canvas, frame.x, frame.y, frame.width, frame.height );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemImage extends DynamicAtlasItem {\n\timage: HTMLImageElement;\n\n\tconstructor( image: HTMLImageElement, baseTexture: BaseTexture ) {\n\t\tsuper( image.src, image.width / baseTexture.resolution, image.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.image = image;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tconst x = frame.x;\n\t\tconst y = frame.y;\n\t\tconst w = frame.width;\n\t\tconst h = frame.height;\n\t\tconst image = this.image;\n\n\t\tcontext.drawImage( image, x, y, w, h );\n\n\t\tcontext.drawImage( image, 0, 0, 1, h, x - 1, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, 0, w, 1, x, y - 1, w, 1 );\n\t\tcontext.drawImage( image, w - 1, 0, 1, h, x + w, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, h - 1, w, 1, x, y + h, w, 1 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Text } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemText extends DynamicAtlasItem {\n\tprotected _text: Text;\n\n\tconstructor( id: string, text: Text, baseTexture: BaseTexture ) {\n\t\tsuper( id, text.width, text.height, 0, baseTexture );\n\t\tthis._text = text;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tcontext.drawImage( this._text.canvas, frame.x, frame.y, frame.width, frame.height );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemWhite extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\n\t\tcontext.save();\n\t\tcontext.fillStyle = \"#ffffff\";\n\t\tcontext.fillRect( frame.x - 1, frame.y - 1, frame.width + 2, frame.height + 2 );\n\t\tcontext.restore();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, MIPMAP_MODES, Texture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicAtlasItemEmpty } from \"./dynamic-atlas-item-empty\";\nimport { DynamicAtlasItemWhite } from \"./dynamic-atlas-item-white\";\n\nconst MAXIMUM_TEXTURE_SIZE = 4096;\n\nexport class DynamicAtlas {\n\tprotected static INSTANCE: DynamicAtlas | null;\n\n\tprotected _canvas: HTMLCanvasElement;\n\tprotected _sortedData: DynamicAtlasItem[];\n\tprotected _idToDatum: { [ id: string ]: DynamicAtlasItem };\n\tprotected _baseTexture: BaseTexture;\n\tprotected _isDirty: boolean;\n\tprotected _predefined: { [ id: string ]: DynamicAtlasItem };\n\n\tconstructor( resolution: number ) {\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = canvas.height = 256;\n\n\t\tconst baseTexture = this._baseTexture = BaseTexture.from( canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution\n\t\t});\n\n\t\tthis._idToDatum = {};\n\t\tthis._sortedData = [];\n\t\tthis._predefined = {\n\t\t\tempty: new DynamicAtlasItemEmpty(\n\t\t\t\t\"empty\", 10, 10, 0, baseTexture\n\t\t\t),\n\t\t\twhite: new DynamicAtlasItemWhite(\n\t\t\t\t\"white\", 10, 10, 0, baseTexture\n\t\t\t)\n\t\t};\n\n\t\tthis._isDirty = true;\n\t}\n\n\tupdateFrames( width: number, data: DynamicAtlasItem[] ): number {\n\t\tconst padding = 4;\n\t\tlet x = padding;\n\t\tlet y = padding;\n\t\tlet maxRowHeight = 0;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( width < x + datum.frame.width + padding ) {\n\t\t\t\tx = padding;\n\t\t\t\ty += maxRowHeight + padding;\n\t\t\t\tmaxRowHeight = 0;\n\t\t\t}\n\t\t\tdatum.frame.x = x | 0;\n\t\t\tdatum.frame.y = y | 0;\n\t\t\tx += datum.frame.width + padding;\n\t\t\tmaxRowHeight = Math.max( maxRowHeight, datum.frame.height );\n\t\t}\n\n\t\tconst minHeight = y + maxRowHeight + padding;\n\t\tlet result = 256;\n\t\twhile( result < minHeight ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result );\n\t}\n\n\trenderFrames( width: number, height: number, data: DynamicAtlasItem[] ): void {\n\t\tconst canvas = this._canvas;\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\t\tconst context = canvas.getContext( \"2d\" );\n\t\tif( context != null ) {\n\t\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\t\tconst datum = data[ i ];\n\t\t\t\tdatum.render( context );\n\t\t\t}\n\t\t}\n\t}\n\n\tapplyFrames( data: DynamicAtlasItem[] ): void {\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.applyFrame();\n\t\t}\n\t}\n\n\tcalcCanvasWidth( data: DynamicAtlasItem[] ): number {\n\t\tlet result = 128;\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tconst size = Math.max( datum.frame.width, datum.frame.height );\n\t\t\twhile( result < size ) {\n\t\t\t\tresult <<= 1;\n\t\t\t}\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result << 1 );\n\t}\n\n\tcleanup( data: DynamicAtlasItem[] ): void {\n\t\tdata.sort( DynamicAtlas.ITEM_COMPARATOR );\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( 0 < datum.ref ) {\n\t\t\t\tdata.length = i + 1;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tdata.length = 0;\n\t}\n\n\tbegin(): void {\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.ref = 0;\n\t\t}\n\n\t\tthis._isDirty = false;\n\t}\n\n\tend(): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ datum.id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\trepack( forcibly?: boolean ): void {\n\t\tif( forcibly === true || this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst data = this._sortedData;\n\t\t\tthis.cleanup( data );\n\t\t\tconst canvasWidth = this.calcCanvasWidth( data );\n\t\t\tconst canvasHeight = this.updateFrames( canvasWidth, data );\n\t\t\tthis.renderFrames( canvasWidth, canvasHeight, data );\n\t\t\tthis._baseTexture.setRealSize( canvasWidth, canvasHeight );\n\t\t\tthis.applyFrames( data );\n\t\t}\n\t}\n\n\tget( id: string ): DynamicAtlasItem | null {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum =  idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref += 1;\n\t\t\treturn datum;\n\t\t} else {\n\t\t\tconst predefined = this._predefined[ id ];\n\t\t\tif( predefined != null ) {\n\t\t\t\tthis.set( id, predefined );\n\t\t\t\treturn predefined;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( id: string, item: DynamicAtlasItem ): DynamicAtlasItem | undefined {\n\t\tconst result = this._idToDatum[ id ];\n\t\titem.ref += 1;\n\t\tthis._idToDatum[ id ] = item;\n\t\tthis._sortedData.push( item );\n\t\tthis._isDirty = true;\n\t\treturn result;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._isDirty = true;\n\t}\n\n\tgetDefaultTexture(): Texture {\n\t\treturn this.get( \"white\" )!.texture;\n\t}\n\n\tgetBaseTexture(): BaseTexture {\n\t\treturn this._baseTexture;\n\t}\n\n\trelease( id: string ): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum = idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref -= 1;\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic ITEM_COMPARATOR = ( a: DynamicAtlasItem, b: DynamicAtlasItem ): number => {\n\t\tif( a.ref <= 0 ) {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\treturn +1;\n\t\t\t}\n\t\t} else {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tif( a.frame.height < b.frame.height ) {\n\t\t\treturn -1;\n\t\t} else if( b.frame.height < a.frame.height ) {\n\t\t\treturn +1;\n\t\t} else {\n\t\t\treturn a.frame.width - b.frame.width;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { TextMetrics, utils } from \"pixi.js\";\n\nexport class DynamicFontAtlasFont {\n\tid: string;\n\tsize: number;\n\tcolor: string;\n\theight: number;\n\n\tascent: number;\n\tdescent: number;\n\n\tconstructor( fontId: string, size: number, color: number, padding: number ) {\n\t\tthis.id = fontId;\n\t\tthis.size = size;\n\t\tthis.color = utils.hex2string( color );\n\t\tthis.height = size + padding * 2;\n\t\tconst metrics = TextMetrics.measureFont( fontId );\n\t\tthis.ascent = metrics.ascent;\n\t\tthis.descent = metrics.descent;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MIPMAP_MODES, SCALE_MODES, Texture } from \"pixi.js\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicFontAtlasFont } from \"./dynamic-font-atlas-font\";\nimport { UtilCharacterIterator } from \"./util-character-iterator\";\n\nconst PADDING = 3;\n\nexport class DynamicFontAtlas {\n\tprotected _id: string;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _context: CanvasRenderingContext2D | null;\n\tprotected _font: DynamicFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _unrefCount: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _revision: number;\n\tprotected _revisionUpdated: number;\n\tprotected _texture: Texture;\n\n\tconstructor( fontId: string, fontSize: number, fontColor: number, resolution: number ) {\n\t\tthis._id = fontId;\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._context = null;\n\t\tthis._font = new DynamicFontAtlasFont( fontId, fontSize, fontColor, PADDING );\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._unrefCount = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._revision = 0;\n\t\tthis._revisionUpdated = 0;\n\t\tthis._texture = Texture.from( this._canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution,\n\t\t\tscaleMode: SCALE_MODES.NEAREST\n\t\t});\n\n\t\tthis.add( ASCII_CHARACTERS, true );\n\t\tthis.add_( \"...\", this._characters, true );\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tprotected add_( character: string, characters: DynamicFontAtlasCharacters, reserved?: boolean ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved ) {\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount -= 1;\n\t\t\t\t\t}\n\t\t\t\t\tdata.ref += 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst advance = this.getAdvance( character );\n\t\t\t\tconst width = Math.ceil( PADDING + advance + PADDING );\n\t\t\t\tconst height = this.font.height;\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( advance, width, height, !! reserved );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._revision += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove_( character: string, characters: DynamicFontAtlasCharacters ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved && 0 < data.ref ) {\n\t\t\t\t\tdata.ref -= 1;\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup_(): void {\n\t\tif( (this._length >> 1) <= this._unrefCount ) {\n\t\t\tconst characters = this._characters;\n\t\t\tfor( const character in characters ) {\n\t\t\t\tif( characters[ character ].ref <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._length -= this._unrefCount;\n\t\t\tthis._revision += 1;\n\t\t\tthis._unrefCount = 0;\n\t\t}\n\t}\n\n\tadd( targets: string, reserved?: boolean ): void {\n\t\tconst characters = this._characters;\n\t\tconst iterator = UtilCharacterIterator.from( targets );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.add_( iterator.next(), characters, reserved );\n\t\t}\n\t}\n\n\tremove( targets: string ): void {\n\t\tconst characters = this._characters;\n\t\tconst iterator = UtilCharacterIterator.from( targets );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.remove_( iterator.next(), characters );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tgetAdvance( target: string ): number {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\treturn context.measureText( target ).width;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetContext(): CanvasRenderingContext2D | null {\n\t\tlet context = this._context;\n\t\tif( context == null ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tcontext = this._context = canvas.getContext( \"2d\", { alpha: true } );\n\t\t\t\tif( context == null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tconst font = this._font;\n\t\tif( context.font !== font.id ) {\n\t\t\tcontext.font = font.id;\n\t\t\tfont.id = context.font;\n\t\t\tcontext.textAlign = \"left\";\n\t\t\tcontext.textBaseline = \"alphabetic\";\n\t\t\tcontext.lineWidth = 0;\n\t\t\tcontext.lineCap = \"round\";\n\t\t\tcontext.lineJoin = \"miter\";\n\t\t\tcontext.miterLimit = 0;\n\t\t\tcontext.fillStyle = font.color;\n\t\t\tcontext.strokeStyle = \"#0000ff\";\n\t\t}\n\t\treturn context;\n\t}\n\n\tupdate(): boolean {\n\t\tthis.cleanup_();\n\n\t\tif( this._revisionUpdated < this._revision ) {\n\t\t\tthis._revisionUpdated = this._revision;\n\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tconst font = this._font;\n\t\t\t\tconst fontHeight = font.height;\n\t\t\t\tconst characters = this._characters;\n\t\t\t\tconst width = this._width = this.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * fontHeight );\n\n\t\t\t\tconst offsetX = PADDING;\n\t\t\t\tconst offsetY = Math.round( (fontHeight - (font.ascent + font.descent)) * 0.5 + font.ascent );\n\t\t\t\tlet x = 0;\n\t\t\t\tlet y = 0;\n\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\tif( width <= x + character.width ) {\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\ty += fontHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tcharacter.x = x;\n\t\t\t\t\tcharacter.y = y;\n\t\t\t\t\tcharacter.origin.x = x + offsetX;\n\t\t\t\t\tcharacter.origin.y = y + offsetY;\n\n\t\t\t\t\tx += character.width;\n\t\t\t\t}\n\t\t\t\tconst height = this._height = y + fontHeight;\n\n\t\t\t\t// Make a input canvas\n\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\tconst baseTexture = this._texture.baseTexture;\n\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\tconst realWidth = Math.ceil( width * resolution );\n\t\t\t\tconst realHeight = Math.ceil( height * resolution );\n\t\t\t\tcanvas.width = realWidth;\n\t\t\t\tcanvas.height = realHeight;\n\t\t\t\tconst context = this.getContext();\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tcontext.save();\n\t\t\t\t\tcontext.scale( resolution, resolution );\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\t\tcontext.fillText( key, character.origin.x, character.origin.y );\n\t\t\t\t\t}\n\t\t\t\t\tcontext.restore();\n\t\t\t\t}\n\t\t\t\tbaseTexture.setRealSize( realWidth, realHeight );\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetRevision(): number {\n\t\treturn this._revision;\n\t}\n\n\tgetRevisionUpdate(): number {\n\t\treturn this._revisionUpdated;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\tdestroy() {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\ttoPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DynamicFontAtlas } from \"./dynamic-font-atlas\";\n\nconst update = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst updateAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( update );\n};\n\nconst destroy = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst destroyAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( destroy );\n};\n\nexport class DynamicFontAtlases {\n\tprotected _atlases: Map<string, Map<number, DynamicFontAtlas>>;\n\tprotected _resolution: number;\n\n\tconstructor( layer: DApplicationLayerLike ) {\n\t\tthis._atlases = new Map<string, Map<number, DynamicFontAtlas>>();\n\t\tthis._resolution = layer.renderer.resolution;\n\n\t\tlayer.renderer.on( \"prerender\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\n\tadd( fontId: string, fontSize: number, fontColor: number, targets: string ): void {\n\t\tconst atlases = this._atlases;\n\t\tlet colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\tcolorToAtlas = new Map<number, DynamicFontAtlas>();\n\t\t\tatlases.set( fontId, colorToAtlas );\n\t\t}\n\t\tlet atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\tatlas = new DynamicFontAtlas( fontId, fontSize, fontColor, this._resolution );\n\t\t\tcolorToAtlas.set( fontColor, atlas );\n\t\t}\n\t\tatlas.add( targets );\n\t}\n\n\tremove( fontId: string, fontColor: number, targets: string ): void {\n\t\tconst colorToAtlas = this._atlases.get( fontId );\n\t\tif( colorToAtlas != null ) {\n\t\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\t\tif( atlas != null ) {\n\t\t\t\tatlas.remove( targets );\n\t\t\t}\n\t\t}\n\t}\n\n\tget( fontId: string, fontColor: number ): DynamicFontAtlas | null {\n\t\tconst atlases = this._atlases;\n\t\tconst colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn atlas;\n\t}\n\n\tupdate(): void {\n\t\tthis._atlases.forEach( updateAll );\n\t}\n\n\tdestroy() {\n\t\tconst atlases = this._atlases;\n\t\tatlases.forEach( destroyAll );\n\t\tatlases.clear();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlas } from \"./dynamic-atlas\";\nimport { DynamicAtlasItemFontAtlas } from \"./dynamic-atlas-item-font-atlas\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicSDFFontAtlases {\n\tprotected _atlases: { [ family: string ]: DynamicSDFFontAtlas };\n\n\tconstructor() {\n\t\tthis._atlases = {};\n\t}\n\n\tbegin(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.begin();\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( 0 < atlas.length ) {\n\t\t\t\tatlas.addAscii();\n\t\t\t}\n\t\t\tatlas.end();\n\t\t\tif( atlas.length <= 0 ) {\n\t\t\t\tatlas.destroy();\n\t\t\t\tdelete atlases[ family ];\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( family: string, targets: string ) {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\tatlas.add( targets );\n\t\t} else {\n\t\t\tconst newAtlas = new DynamicSDFFontAtlas( family );\n\t\t\tnewAtlas.add( targets );\n\t\t\tthis._atlases[ family ] = newAtlas;\n\t\t}\n\t}\n\n\tget( family: string ): DynamicSDFFontAtlas | null {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\treturn atlas;\n\t\t}\n\t\treturn null;\n\t}\n\n\tupdate( baseAtlas: DynamicAtlas ): void {\n\t\tconst atlases = this._atlases;\n\t\tconst baseTexture = baseAtlas.getBaseTexture();\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( atlas.update() ) {\n\t\t\t\tconst atlasId = atlas.id;\n\t\t\t\tconst item = baseAtlas.get( atlasId );\n\t\t\t\tif( item != null ) {\n\t\t\t\t\tconst width = atlas.width;\n\t\t\t\t\tconst height = atlas.height;\n\t\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\t\titem.frame.width = width;\n\t\t\t\t\titem.frame.height = height;\n\t\t\t\t\titem.width = width / resolution;\n\t\t\t\t\titem.height = height / resolution;\n\t\t\t\t\tbaseAtlas.toDirty();\n\t\t\t\t} else {\n\t\t\t\t\tbaseAtlas.set(\n\t\t\t\t\t\tatlasId,\n\t\t\t\t\t\tnew DynamicAtlasItemFontAtlas( atlas, baseTexture )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.destroy();\n\t\t}\n\t\tthis._atlases = {};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isNaN = ( target: number ): boolean => {\n\treturn target !== target;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport class Lazy<INSTANCE, OPTIONS> {\n\tinstance: INSTANCE | null;\n\tnewInstance: new ( options: OPTIONS ) => INSTANCE;\n\toptions: OPTIONS;\n\n\tconstructor( newInstance: new ( options: OPTIONS ) => INSTANCE, options: OPTIONS, base?: DBase ) {\n\t\tthis.instance = null;\n\t\tthis.newInstance = newInstance;\n\t\tthis.options = options;\n\n\t\tif( base != null ) {\n\t\t\tif( base.isActive() ) {\n\t\t\t\tsetTimeout((): void => {\n\t\t\t\t\tthis.get();\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tbase.on( \"active\", (): void => {\n\t\t\t\tthis.get();\n\t\t\t});\n\t\t}\n\t}\n\n\tget(): INSTANCE {\n\t\tlet instance = this.instance;\n\t\tif( instance == null ) {\n\t\t\tinstance = this.instance = new (this.newInstance)( this.options );\n\t\t}\n\t\treturn instance;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Returns a ceiling index of the given value.\n * The array must be sorted in an ascending order.\n *\n * @param array an array sorted in an ascending order\n * @param value a value to be searched\n * @returns a ceiling index of the given value\n */\nexport const toCeilingIndex = <V>( array: V[], value: V, size: number, offset: number ): number => {\n\tlet i0 = 0;\n\tlet i1 = Math.floor( array.length / size ) - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 * size + offset ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn Math.max( i0, i1 );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toString = ( value: unknown ): string => {\n\treturn ( value != null ? String( value ) : \"\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toSvgUrl = ( svg: string ): string => {\n\treturn `data:image/svg+xml;base64,${btoa(svg)}`;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { resources } from \"pixi.js\";\n\nexport class SVGResource extends resources.BaseImageResource {\n\treadonly source!: HTMLImageElement;\n\treadonly svg: string;\n\n\tprotected _load: Promise<void> | null = null;\n\n\tconstructor( source: string, options: any ) {\n\t\tsuper( new Image() );\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\t\tthis.svg = source;\n\n\t\tresources.BaseImageResource.crossOrigin( this.source, this.svg, options && options.crossorigin );\n\n\t\tif( ! options || options.autoLoad !== false ) {\n\t\t\tthis.load();\n\t\t}\n\t}\n\n\tload(): Promise<void> {\n\t\tif( this._load ) {\n\t\t\treturn this._load;\n\t\t}\n\n\t\tthis._load = new Promise(( resolve ): void => {\n\t\t\tconst image: HTMLImageElement = this.source;\n\n\t\t\timage.onerror = ( event ): void => {\n\t\t\t\timage.onerror = null;\n\t\t\t\t(this as any).onError.run( event ); // TODO: Fix PixiJS\n\t\t\t};\n\n\t\t\timage.onload = (): void => {\n\t\t\t\t(this.resize as any)( image.width, image.height ); // TODO: Fix PixiJS\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\timage.src = this.svg;\n\t\t});\n\n\t\treturn this._load;\n\t}\n\n\tstatic test( source: unknown, extension: string ) {\n\t\t// url file extension is SVG\n\t\treturn extension === \"svg\"\n\t\t\t// source is SVG data-uri\n\t\t\t|| (typeof source === \"string\" && source.indexOf(\"data:image/svg+xml;base64\") === 0)\n\t\t\t// source is SVG inline\n\t\t\t|| (typeof source === \"string\" && source.indexOf(\"<svg\") === 0);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, resources, SCALE_MODES, Texture } from \"pixi.js\";\nimport { SVGResource } from \"../resource/svg-resource\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\n// PixiJS's SVGResource has a issue on Microsoft Edge.\n// Edge may invoke the HTMLImageElement#onload on an unexpected timing.\n// Thus, PixiJS may lost the `load` event in some situations.\nresources.INSTALLED.push( SVGResource );\n\nexport interface UtilSvgAtlasBuilderBuildOptions {\n\tforce?: boolean;\n\tscaling?: SCALE_MODES;\n\tresolution?: number;\n}\n\nexport class UtilSvgAtlasBuilder {\n\tprotected _width: number;\n\tprotected _ratio: number;\n\tprotected _margin: number;\n\n\tprotected _frames: { [ name: string ]: Rectangle };\n\tprotected _svg: string;\n\tprotected _nextX: number;\n\tprotected _nextY: number;\n\tprotected _height: number;\n\n\tprotected _built?: { [ name: string ]: Texture };\n\n\tconstructor( width: number, ratio: number, margin: number ) {\n\t\tthis._width = width;\n\t\tthis._ratio = ratio;\n\t\tthis._margin = margin;\n\n\t\tthis._frames = {};\n\t\tthis._svg = \"\";\n\t\tthis._nextX = 0;\n\t\tthis._nextY = 0;\n\t\tthis._height = 0;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget ratio(): number {\n\t\treturn this._ratio;\n\t}\n\n\tget margin(): number {\n\t\treturn this._margin;\n\t}\n\n\tadd( name: string, width: number, height: number, path: string ): boolean {\n\t\tconst frames = this._frames;\n\t\tif( ! ( name in frames ) ) {\n\t\t\t// Position\n\t\t\tconst margin = this._margin;\n\t\t\tlet x = this._nextX;\n\t\t\tlet y = this._nextY;\n\t\t\tif( this._width <= x + width ) {\n\t\t\t\tx = 0;\n\t\t\t\ty = this._nextY + this._height + margin;\n\t\t\t\tthis._height = height;\n\t\t\t\tthis._nextY = y;\n\t\t\t} else {\n\t\t\t\tthis._height = Math.max( this._height, height );\n\t\t\t}\n\t\t\tthis._nextX = x + width + margin;\n\n\t\t\t// Frame\n\t\t\tframes[ name ] = new Rectangle( x, y, width, height );\n\n\t\t\t// Svg\n\t\t\tconst ratio = this._ratio;\n\t\t\tthis._svg += `<g transform=\"translate(${x * ratio},${y * ratio})\">${path}</g>`;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tget mappings(): { [ name: string ]: Texture } {\n\t\treturn this.build();\n\t}\n\n\tbuild( options?: UtilSvgAtlasBuilderBuildOptions ): { [ name: string ]: Texture } {\n\t\tlet built = this._built;\n\t\tif( built == null || (options && options.force) ) {\n\t\t\tconst resolution = ( options && options.resolution != null ?\n\t\t\t\toptions.resolution : (window.devicePixelRatio || 1)\n\t\t\t);\n\t\t\tconst width = this._width;\n\t\t\tconst height = Math.pow( 2, Math.ceil( Math.log( this._nextY + this._height ) / Math.LN2 ) );\n\t\t\tconst realWidth = width * resolution;\n\t\t\tconst realHeight = height * resolution;\n\t\t\tconst ratio = this._ratio;\n\t\t\tconst attrWidth = `width=\"${realWidth}\"`;\n\t\t\tconst attrHeight = `height=\"${realHeight}\"`;\n\t\t\tconst attrViewBox = `viewBox=\"0 0 ${width * ratio} ${height * ratio}\"`;\n\t\t\tconst attrXmlns = `xmlns=\"http://www.w3.org/2000/svg\"`;\n\t\t\tconst url = toSvgUrl( `<svg ${attrWidth} ${attrHeight} ${attrViewBox} ${attrXmlns}>${this._svg}</svg>` );\n\t\t\tconst scaleMode = (options && options.scaling != null ? options.scaling : SCALE_MODES.NEAREST);\n\t\t\tconst baseTexture = BaseTexture.from( url, {\n\t\t\t\tresolution,\n\t\t\t\tscaleMode\n\t\t\t});\n\t\t\tconst frames = this._frames;\n\t\t\tbuilt = this._built = {};\n\t\t\tfor( const name in frames ) {\n\t\t\t\tbuilt[ name ] = new Texture( baseTexture, frames[ name ] );\n\t\t\t}\n\t\t}\n\t\treturn built;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DMouseModifier {\n\tNONE\t\t= 0,\n\tCTRL\t\t= 1,\n\tSHIFT\t\t= 2,\n\tALT\t\t\t= 4,\n\n\tAND\t\t\t= 8,\n\tOR\t\t\t= 16,\n\n\tNOT_NONE\t= CTRL | SHIFT | ALT | OR\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase } from \"../d-base\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\n\nexport type UtilClickOutsideOnClick = ( e: InteractionEvent ) => void;\n\nexport class UtilClickOutside {\n\tprotected static point = new Point();\n\n\tstatic apply( target: DBase<any, any>, onClick: UtilClickOutsideOnClick ) {\n\t\ttarget.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === target ) {\n\t\t\t\tconst point = this.point;\n\t\t\t\tpoint.copyFrom( e.data.global );\n\t\t\t\ttarget.toLocal( point, undefined, point, true );\n\t\t\t\tconst x = point.x;\n\t\t\t\tconst y = point.y;\n\t\t\t\tif( x < 0 || y < 0 || target.width < x || target.height < y ) {\n\t\t\t\t\tonClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilDragEasingHistory {\n\tdx: number;\n\tdy: number;\n\tds: number;\n\tdt: number;\n\n\tconstructor( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n\n\tset( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DAnimationTimings {\n\tstatic LINEAR( t: number ): number {\n\t\treturn t;\n\t}\n\n\tstatic ELASTIC( t: number ): number {\n\t\treturn t * ( 3 * (1 - t) * (1 - t) + t * ( 3 * (1 - t) + t ) );\n\t}\n\n\tstatic QUAD_IN_OUT( t: number ): number {\n\t\treturn t < 0.5 ? 2 * t * t : -1 + ( 4 - 2 * t ) * t;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DAnimation, DAnimationOnEnd, DAnimationOnTime, DAnimationOptions, DAnimationTiming } from \"./d-animation\";\nimport { DAnimationTimings } from \"./d-animation-timings\";\nimport { DBase } from \"./d-base\";\n\nexport class DAnimationBase extends utils.EventEmitter implements DAnimation {\n\tprotected _id: number | null;\n\tprotected _startTime: number;\n\tprotected _duration: number;\n\tprotected _durationInverse: number;\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime | undefined;\n\tprotected _onTimeBaseBound: () => void;\n\tprotected _onStart: DAnimationOnEnd | undefined;\n\tprotected _onEnd: DAnimationOnEnd | undefined;\n\tprotected _timing: DAnimationTiming;\n\tprotected _target: DBase<any, any> | null;\n\n\tconstructor( options?: DAnimationOptions ) {\n\t\tsuper();\n\n\t\tthis._id = null;\n\t\tthis._target = null;\n\t\tthis._startTime = 0;\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 200 );\n\t\tthis._durationInverse = 1 / Math.max( 1, this._duration );\n\t\tthis._reverse = false;\n\t\tthis._onTime = ( options != null ? options.onTime : undefined );\n\t\tthis._onTimeBaseBound = () => {\n\t\t\tthis.onTimeBase();\n\t\t};\n\t\tthis._onStart = ( options != null ? options.onStart : undefined );\n\t\tthis._onEnd = ( options != null ? options.onEnd : undefined );\n\t\tthis._timing = ( options != null && options.timing != null ? options.timing : DAnimationTimings.ELASTIC );\n\t}\n\n\tget target(): DBase<any, any> | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: DBase<any, any> | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn this._duration;\n\t}\n\n\tset duration( duration: number ) {\n\t\tthis._duration = duration;\n\t\tthis._durationInverse = 1 / Math.max( 1, duration );\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._startTime = Date.now();\n\t\tthis._reverse = reverse;\n\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\n\t\t// onTime\n\t\tconst duration = this._duration;\n\t\tconst time = this.toTime( reverse ? duration : 0 );\n\t\tthis.onTime( time, reverse, 0 );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn (this._id != null);\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tprotected onTimeBase(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst reverse = this._reverse;\n\t\t\tif( elapsedTime < duration ) {\n\t\t\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? duration - elapsedTime : elapsedTime );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\t\t\t} else {\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t\t// OnEnd\n\t\t\t\tthis.onEnd( reverse );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toTime( elapsedTime: number ): number {\n\t\treturn this._timing( elapsedTime * this._durationInverse, this );\n\t}\n\n\tstop(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimation } from \"../d-animation\";\nimport { DAnimationBase } from \"../d-animation-base\";\nimport { DAnimationTimings } from \"../d-animation-timings\";\nimport { isNumber } from \"./is-number\";\nimport { UtilDragEasingHistory } from \"./util-drag-easing-history\";\n\nexport type UtilDragEasingOnMove = ( dx: number, dy: number, ds: number, time: number ) => void;\n\nexport interface UtilDragEasingDurationOptions {\n\tposition?: number;\n\tscale?: number;\n}\n\nexport interface UtilDragEasingOptions {\n\tduration?: number | UtilDragEasingDurationOptions;\n}\n\nexport class UtilDragEasing {\n\tprotected static HISTORY_CAPACITY = 5;\n\tprotected _histories: UtilDragEasingHistory[];\n\tprotected _historiesSorted: UtilDragEasingHistory[];\n\tprotected _historyBegin: number;\n\tprotected _historyEnd: number;\n\tprotected _animation: DAnimation;\n\tprotected _dx: number;\n\tprotected _dy: number;\n\tprotected _dt: number;\n\tprotected _ds: number;\n\tprotected _durationPosition: number;\n\tprotected _durationScale: number;\n\tprotected _onMove: UtilDragEasingOnMove;\n\n\tconstructor( onMove: UtilDragEasingOnMove, options?: UtilDragEasingOptions ) {\n\t\tthis._histories = [];\n\t\tthis._historiesSorted = [];\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\t\tthis._dx = 0;\n\t\tthis._dy = 0;\n\t\tthis._ds = 0;\n\t\tthis._dt = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( t: number ): void => {\n\t\t\t\tthis.onEase( t );\n\t\t\t},\n\t\t\ttiming: DAnimationTimings.LINEAR,\n\t\t\tduration: 1000\n\t\t});\n\t\tconst duration = options && options.duration;\n\t\tif( duration ) {\n\t\t\tif( isNumber( duration ) ) {\n\t\t\t\tthis._durationPosition = duration;\n\t\t\t\tthis._durationScale = duration;\n\t\t\t} else {\n\t\t\t\tthis._durationPosition = ( duration.position != null ? duration.position : 1 );\n\t\t\t\tthis._durationScale = ( duration.scale != null ? duration.scale : 1 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._durationPosition = 1;\n\t\t\tthis._durationScale = 1;\n\t\t}\n\t\tthis._onMove = onMove;\n\t}\n\n\tonStart(): void {\n\t\t// History\n\t\tconst histories = this._histories;\n\t\tfor( let i = histories.length, imax = UtilDragEasing.HISTORY_CAPACITY; i < imax; ++i ) {\n\t\t\thistories.push( new UtilDragEasingHistory( 0, 0, 1, 0 ) );\n\t\t}\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\n\t\t// Stop animation\n\t\tthis._animation.stop();\n\t}\n\n\tonMove( dx: number, dy: number, ds: number, dt: number ): void {\n\t\tconst capacity = UtilDragEasing.HISTORY_CAPACITY;\n\n\t\tconst oldHistoryEnd = this._historyEnd;\n\t\tconst newHistoryEnd = (oldHistoryEnd + 1) % capacity;\n\t\tthis._historyEnd = newHistoryEnd;\n\n\t\tconst oldHistoryBegin = this._historyBegin;\n\t\tif( newHistoryEnd < oldHistoryEnd || (0 <= oldHistoryEnd && oldHistoryEnd < oldHistoryBegin) ) {\n\t\t\tthis._historyBegin = (oldHistoryBegin + 1) % capacity;\n\t\t}\n\n\t\tthis._histories[ newHistoryEnd ].set( dx, dy, ds, dt );\n\t}\n\n\tprotected updateHistoriesSorted( dt: number ): number {\n\t\tconst unsorted = this._histories;\n\t\tconst sorted = this._historiesSorted;\n\t\tconst begin = this._historyBegin;\n\t\tconst end = this._historyEnd;\n\t\tconst length = unsorted.length;\n\t\tconst threshold = 160;\n\t\tif( end < 0 ) {\n\t\t\tsorted.length = 0;\n\t\t\treturn dt;\n\t\t} else if( end < begin ) {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; 0 <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let i = length - 1; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t} else {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t}\n\t}\n\n\tonEnd( ldt: number ): void {\n\t\tconst adt = this.updateHistoriesSorted( ldt );\n\t\tconst sorted = this._historiesSorted;\n\t\tconst sortedLength = sorted.length;\n\t\tif( 0 < sortedLength ) {\n\t\t\tlet dx = 0;\n\t\t\tlet dy = 0;\n\t\t\tlet ds = 0;\n\t\t\tlet dt = 0;\n\t\t\tfor( let i = 0; i < sortedLength; ++i ) {\n\t\t\t\tconst history = sorted[ i ];\n\t\t\t\tdx += history.dx;\n\t\t\t\tdy += history.dy;\n\t\t\t\tds += history.ds;\n\t\t\t\tdt += history.dt;\n\t\t\t}\n\t\t\tconst w = (1 - ldt / adt) / sortedLength;\n\t\t\tdx *= w;\n\t\t\tdy *= w;\n\t\t\tds = 1 + (ds - sortedLength) * w;\n\t\t\tdt *= w;\n\t\t\tthis._dx = dx;\n\t\t\tthis._dy = dy;\n\t\t\tthis._ds = ds;\n\t\t\tthis._dt = dt;\n\n\t\t\t// Start animation\n\t\t\tconst d0 = this._durationPosition * 40 * Math.sqrt( dx * dx + dy * dy );\n\t\t\tconst d1 = this._durationScale * 10000 * Math.abs( ds - 1 );\n\t\t\tconst animation = this._animation;\n\t\t\tanimation.duration = Math.max( d0, d1 );\n\t\t\tanimation.start();\n\t\t}\n\t}\n\n\tprotected onEase( time: number ): void {\n\t\tconst w = 1 - time;\n\t\tthis._onMove(\n\t\t\tthis._dx * w,\n\t\t\tthis._dy * w,\n\t\t\t1 + ( this._ds - 1 ) * w,\n\t\t\ttime\n\t\t);\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\n\nexport type DMouseModifierEvent = WheelEvent | MouseEvent | TouchEvent | interaction.InteractionEvent;\n\nexport class DMouseModifiers {\n\tstatic from( e: DMouseModifierEvent ): DMouseModifier {\n\t\tconst oe = ( \"data\" in e ? e.data.originalEvent : e );\n\t\treturn ( oe.ctrlKey ? DMouseModifier.CTRL : DMouseModifier.NONE ) |\n\t\t\t( oe.altKey ? DMouseModifier.ALT : DMouseModifier.NONE ) |\n\t\t\t( oe.shiftKey ? DMouseModifier.SHIFT : DMouseModifier.NONE );\n\t}\n\n\tstatic match( e: DMouseModifierEvent, modifier: DMouseModifier ): boolean {\n\t\tif( modifier & DMouseModifier.OR ) {\n\t\t\treturn !! (DMouseModifiers.from( e ) & modifier);\n\t\t} else {\n\t\t\treturn DMouseModifiers.from( e ) === modifier;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum UtilFileAs {\n\tTEXT,\n\tDATA_URL,\n\tBINARY_STRING,\n\tARRAY_BUTTER\n}\n\nexport interface UtilFileFacade {\n\temit( name: string, ...args: any[] ): void;\n}\n\nexport class UtilFileOpener {\n\tprotected _input: HTMLInputElement | null;\n\tprotected _as: UtilFileAs;\n\tprotected _facade: UtilFileFacade;\n\n\tconstructor( as: UtilFileAs, facade: UtilFileFacade ) {\n\t\tthis._input = null;\n\t\tthis._as = as;\n\t\tthis._facade = facade;\n\t}\n\n\topen() {\n\t\tconst input = this.getOrCreateInput();\n\t\tif( input != null ) {\n\t\t\tinput.click();\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected getOrCreateInput(): HTMLInputElement | null {\n\t\tif( \"FileReader\" in window && this._input == null ) {\n\t\t\tconst input = this._input = document.createElement( \"input\" );\n\t\t\tinput.setAttribute( \"type\", \"file\" );\n\t\t\tinput.setAttribute( \"style\", \"display:none\" );\n\t\t\tinput.addEventListener( \"change\", ( e: Event ): void => {\n\t\t\t\tthis.onInputChange( input );\n\t\t\t\tinput.value = \"\";\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t\tdocument.body.appendChild( input );\n\t\t}\n\t\treturn this._input;\n\t}\n\n\tprotected onInputChange( input: HTMLInputElement ) {\n\t\tconst files = input.files;\n\t\tif( files != null && 0 < files.length ) {\n\t\t\tconst file = files[ 0 ];\n\t\t\tconst fileReader = new FileReader();\n\t\t\tfileReader.onload = ( e: ProgressEvent ) => {\n\t\t\t\tif( e.target != null ) {\n\t\t\t\t\tconst target = e.target as any;\n\t\t\t\t\tthis.onOpen( target.result );\n\t\t\t\t}\n\t\t\t};\n\t\t\tfileReader.onabort = ( e: ProgressEvent ) => {\n\t\t\t\tthis.onAboart( e );\n\t\t\t};\n\t\t\tswitch( this._as ) {\n\t\t\tcase UtilFileAs.TEXT:\n\t\t\t\tfileReader.readAsText( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.DATA_URL:\n\t\t\t\tfileReader.readAsDataURL( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.BINARY_STRING:\n\t\t\t\tfileReader.readAsBinaryString( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.ARRAY_BUTTER:\n\t\t\t\tfileReader.readAsArrayBuffer( file );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfileReader.readAsText( file );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected onOpen( result: unknown ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"open\", result, facade );\n\t}\n\n\tprotected onAboart( e: ProgressEvent ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"abort\", e, facade );\n\t}\n\n\tprotected onCancel(): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"cancel\", facade );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { DMouseModifier } from \"../d-mouse-modifier\";\nimport { DMouseModifiers } from \"../d-mouse-modifiers\";\nimport { UtilDragEasing, UtilDragEasingOptions } from \"./util-drag-easing\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport InteractionManager = interaction.InteractionManager;\n\nexport type UtilDragOnMove = ( dx: number, dy: number, x: number, y: number, ds: number ) => void;\nexport type UtilDragOnStart = () => void;\nexport type UtilDragOnEnd = () => void;\nexport type UtilDragChecker = ( e: InteractionEvent, modifier: DMouseModifier, target: DBase ) => boolean;\n\nexport interface UtilDragCheckerOptions {\n\tstart?: UtilDragChecker;\n\tmove?: UtilDragChecker;\n}\n\nexport interface UtilDragOnOptions {\n\tstart?: UtilDragOnStart;\n\tmove?: UtilDragOnMove;\n\tend?: UtilDragOnEnd;\n}\n\nexport interface UtilDragOptions {\n\ttarget: DBase;\n\ttouch?: boolean;\n\tmodifier?: DMouseModifier;\n\tchecker?: UtilDragCheckerOptions;\n\teasing?: boolean | UtilDragEasingOptions;\n\tbind?: boolean;\n\ton?: UtilDragOnOptions;\n}\n\nconst toEasingOptions = ( options: true | UtilDragEasingOptions | undefined ): UtilDragEasingOptions | undefined => {\n\treturn ( options == null || options === true ?\n\t\tundefined : options\n\t);\n};\n\nconst toChecker = ( options?: UtilDragOptions ): { start: UtilDragChecker, move: UtilDragChecker } => {\n\tconst checker = options && options.checker;\n\tconst defaultChecker = DMouseModifiers.match;\n\tif( checker ) {\n\t\treturn {\n\t\t\tstart: checker.start || defaultChecker,\n\t\t\tmove: checker.move || defaultChecker\n\t\t};\n\t}\n\treturn {\n\t\tstart: defaultChecker,\n\t\tmove: defaultChecker\n\t};\n};\n\nexport class UtilDrag {\n\tprotected static EPSILON = 0.00001;\n\tprotected _target: DBase<any, any>;\n\tprotected _onDownBound: ( e: InteractionEvent ) => void;\n\tprotected _onMoveBound: ( e: InteractionEvent ) => void;\n\tprotected _onEndBound: ( e: InteractionEvent ) => void;\n\tprotected _onStart?: UtilDragOnStart;\n\tprotected _onMove?: UtilDragOnMove;\n\tprotected _onEnd?: UtilDragOnEnd;\n\tprotected _down: string;\n\tprotected _move: string;\n\tprotected _up: string;\n\tprotected _easing?: UtilDragEasing;\n\tprotected _modifier: DMouseModifier;\n\tprotected _checker: { start: UtilDragChecker, move: UtilDragChecker };\n\tprotected _interactionManager: InteractionManager | null;\n\tprotected _center: Point;\n\tprotected _scale: number;\n\tprotected _scalingCenter: Point;\n\tprotected _time: number;\n\n\tconstructor( options: UtilDragOptions ) {\n\t\tconst target = this._target = options.target;\n\t\tconst on = options.on;\n\t\tif( on ) {\n\t\t\tthis._onStart = on.start;\n\t\t\tthis._onMove = on.move;\n\t\t\tthis._onEnd = on.end;\n\t\t}\n\t\tthis._modifier = (options && options.modifier) || DMouseModifier.NONE;\n\t\tthis._checker = toChecker( options );\n\t\tthis._interactionManager = null;\n\t\tthis._center = new Point();\n\t\tthis._scale = 1;\n\t\tthis._scalingCenter = new Point();\n\t\tthis._time = 0;\n\n\t\tconst easing = options.easing;\n\t\tif( easing == null || easing !== false ) {\n\t\t\tconst onEasingMoveBound = ( dx: number, dy: number, ds: number, time: number ): void => {\n\t\t\t\tthis.onEasingMove( dx, dy, ds, time );\n\t\t\t};\n\t\t\tthis._easing = new UtilDragEasing( onEasingMoveBound, toEasingOptions( easing ) );\n\t\t}\n\n\t\tthis._onDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t};\n\n\t\tthis._onMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMove( e );\n\t\t};\n\n\t\tthis._onEndBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onEnd( e );\n\t\t};\n\n\t\tif( options.touch ) {\n\t\t\tthis._down = \"touchstart\";\n\t\t\tthis._move = \"touchmove\";\n\t\t\tthis._up = \"touchend\";\n\t\t} else {\n\t\t\tthis._down = UtilPointerEvent.down;\n\t\t\tthis._move = UtilPointerEvent.move;\n\t\t\tthis._up = UtilPointerEvent.up;\n\t\t}\n\n\t\tif( options.bind !== false ) {\n\t\t\ttarget.on( this._down, this._onDownBound );\n\t\t}\n\t}\n\n\tprotected calcCenterAndScale(\n\t\te: InteractionEvent, center: Point,\n\t\tinteractionManager: InteractionManager\n\t): number {\n\t\tconst oe = e.data.originalEvent;\n\t\tconst global = e.data.global;\n\t\tif( \"touches\" in oe ) {\n\t\t\tconst touches = oe.touches;\n\t\t\tconst touchesLength = touches.length;\n\t\t\tif( 0 < touchesLength ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst first = touches[ 0 ];\n\t\t\t\tlet centerX = first.clientX;\n\t\t\t\tlet centerY = first.clientY;\n\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\tcenterX += touch.clientX;\n\t\t\t\t\tcenterY += touch.clientY;\n\t\t\t\t}\n\t\t\t\tcenterX /= touchesLength;\n\t\t\t\tcenterY /= touchesLength;\n\t\t\t\tinteractionManager.mapPositionToPoint( center, centerX, centerY );\n\n\t\t\t\tif( 1 < touchesLength ) {\n\t\t\t\t\t// Calculate the maximum distance from the center\n\t\t\t\t\tlet squareDistance = 0;\n\t\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\t\tconst dx = touch.clientX - centerX;\n\t\t\t\t\t\tconst dy = touch.clientY - centerY;\n\t\t\t\t\t\tsquareDistance = Math.max( squareDistance, dx * dx + dy * dy );\n\t\t\t\t\t}\n\t\t\t\t\treturn Math.sqrt( squareDistance );\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcenter.copyFrom( global );\n\t\treturn 0;\n\t}\n\n\tonDown( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( this._checker.start( e, this._modifier, target ) ) {\n\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\tif( layer ) {\n\t\t\t\te.stopPropagation();\n\n\t\t\t\tif( target.isDragging() ) {\n\t\t\t\t\tconst interactionManager = this._interactionManager;\n\t\t\t\t\tif( interactionManager ) {\n\t\t\t\t\t\tconst center = this._center;\n\t\t\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttarget.setDragging( true );\n\n\t\t\t\t\t// Interaction manager\n\t\t\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\t\t\tthis._interactionManager = interactionManager;\n\n\t\t\t\t\t// Update the center\n\t\t\t\t\tconst center = this._center;\n\t\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\n\t\t\t\t\t//\n\t\t\t\t\tthis._time = e.data.originalEvent.timeStamp;\n\n\t\t\t\t\t// Easing util\n\t\t\t\t\tconst easing = this._easing;\n\t\t\t\t\tif( easing ) {\n\t\t\t\t\t\teasing.onStart();\n\t\t\t\t\t}\n\n\t\t\t\t\t// User-defined handler\n\t\t\t\t\tconst onStart = this._onStart;\n\t\t\t\t\tif( onStart != null ) {\n\t\t\t\t\t\tonStart();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Event handler\n\t\t\t\t\tinteractionManager.on( this._move, this._onMoveBound );\n\t\t\t\t\tinteractionManager.on( this._up, this._onEndBound );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMove( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( target.isDragging() && this._checker.move( e, this._modifier, target ) ) {\n\t\t\tconst interactionManager = this._interactionManager;\n\t\t\tif( interactionManager ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst center = this._center;\n\t\t\t\tconst centerX = center.x;\n\t\t\t\tconst centerY = center.y;\n\t\t\t\tconst newScale = this.calcCenterAndScale( e, center, interactionManager );\n\t\t\t\tconst oldScale = this._scale;\n\t\t\t\tthis._scale = newScale;\n\t\t\t\tconst oldTime = this._time;\n\t\t\t\tconst newTime = e.data.originalEvent.timeStamp;\n\t\t\t\tthis._time = newTime;\n\n\t\t\t\t// Calculate the position\n\t\t\t\tconst dx = center.x - centerX;\n\t\t\t\tconst dy = center.y - centerY;\n\t\t\t\tconst dt = newTime - oldTime;\n\t\t\t\tconst ds = ( UtilDrag.EPSILON < oldScale ? newScale / oldScale : 1 );\n\n\t\t\t\t// Easing util\n\t\t\t\tconst easing = this._easing;\n\t\t\t\tif( easing ) {\n\t\t\t\t\teasing.onMove( dx, dy, ds, dt );\n\t\t\t\t}\n\n\t\t\t\t// User-defined handler\n\t\t\t\tconst onMove = this._onMove;\n\t\t\t\tif( onMove != null ) {\n\t\t\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\t\t\tonMove( dx, dy, center.x, center.y, ds );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEnd( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( target.isDragging() ) {\n\t\t\tconst interactionManager = this._interactionManager;\n\t\t\tif( interactionManager ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst center = this._center;\n\t\t\t\tthis._scalingCenter.copyFrom( center );\n\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\n\t\t\t\t// Finalize\n\t\t\t\tconst oe = e.data.originalEvent;\n\t\t\t\tif( \"touches\" in oe ? oe.touches.length <= 0 : true ) {\n\t\t\t\t\ttarget.setDragging( false );\n\n\t\t\t\t\t// Event handler\n\t\t\t\t\tthis._interactionManager = null;\n\t\t\t\t\tinteractionManager.off( this._move, this._onMoveBound );\n\t\t\t\t\tinteractionManager.off( this._up, this._onEndBound );\n\n\t\t\t\t\t// User-defined handler\n\t\t\t\t\tconst onEnd = this._onEnd;\n\t\t\t\t\tif( onEnd != null ) {\n\t\t\t\t\t\tonEnd();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Easing util\n\t\t\t\t\tconst easing = this._easing;\n\t\t\t\t\tif( easing ) {\n\t\t\t\t\t\teasing.onEnd( e.data.originalEvent.timeStamp - this._time );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEasingMove( dx: number, dy: number, ds: number, time: number ): void {\n\t\tconst onMove = this._onMove;\n\t\tif( onMove != null ) {\n\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\tconst scalingCenter = this._scalingCenter;\n\t\t\t\tscalingCenter.set(\n\t\t\t\t\tscalingCenter.x + dx,\n\t\t\t\t\tscalingCenter.y + dy\n\t\t\t\t);\n\t\t\t\tonMove( dx, dy, scalingCenter.x, scalingCenter.y, ds );\n\t\t\t}\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst easing = this._easing;\n\t\tif( easing ) {\n\t\t\teasing.stop();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { extract, Matrix, Renderer, RenderTexture, SCALE_MODES, utils } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\n\nexport class UtilExtractor {\n\tstatic toTexture(\n\t\ttarget: DBase, resolution?: number,\n\t\tclear?: boolean, skipUpdateTransform?: boolean\n\t): RenderTexture {\n\t\tconst result = RenderTexture.create({\n\t\t\twidth: target.width,\n\t\t\theight: target.height,\n\t\t\tscaleMode: SCALE_MODES.LINEAR,\n\t\t\tresolution\n\t\t});\n\t\tconst matrix = new Matrix(\n\t\t\tundefined, undefined, undefined, undefined,\n\t\t\t-target.position.x, -target.position.y\n\t\t);\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tlayer.renderer.render( target, result, clear, matrix, skipUpdateTransform );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toPixels( renderTexture: RenderTexture, renderer: Renderer ): UtilExtractorPixels {\n\t\tconst resolution = renderTexture.resolution;\n\t\tconst frame = renderTexture.frame;\n\t\tconst width = Math.floor( frame.width * resolution );\n\t\tconst height = Math.floor( frame.height * resolution );\n\t\tconst pixels = new Uint8Array( 4 * width * height );\n\n\t\trenderer.renderTexture.bind( renderTexture );\n\t\tconst gl = (renderer as any).gl;\n\t\tgl.readPixels(\n\t\t\tframe.x * resolution,\n\t\t\tframe.y * resolution,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tgl.RGBA,\n\t\t\tgl.UNSIGNED_BYTE,\n\t\t\tpixels\n\t\t);\n\n\t\treturn {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tarray: pixels\n\t\t};\n\t}\n\n\tstatic toCanvas( pixels: UtilExtractorPixels, scale?: number, ignorePremutipliedAlpha?: boolean ): HTMLCanvasElement {\n\t\tconst width = pixels.width;\n\t\tconst height = pixels.height;\n\t\tconst array = pixels.array;\n\t\tconst canvasRenderTarget = new utils.CanvasRenderTarget( width, height, 1 );\n\n\t\tconst imageData = canvasRenderTarget.context.getImageData( 0, 0, width, height );\n\t\tif( ignorePremutipliedAlpha ) {\n\t\t\timageData.data.set( array );\n\t\t} else {\n\t\t\t(extract.Extract as any).arrayPostDivide( array, imageData.data );\n\t\t}\n\t\tcanvasRenderTarget.context.putImageData( imageData, 0, 0 );\n\n\t\t// Scale down\n\t\tif( scale != null && scale !== 1 ) {\n\t\t\tcanvasRenderTarget.context.scale( scale, scale );\n\t\t\tcanvasRenderTarget.context.drawImage( canvasRenderTarget.canvas, 0, 0 );\n\t\t\tconst scaledWidth = Math.floor( width * scale );\n\t\t\tconst scaledHeight = Math.floor( height * scale );\n\t\t\tconst scaledImageData = canvasRenderTarget.context.getImageData( 0, 0, scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.resize( scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.context.putImageData( scaledImageData, 0, 0 );\n\t\t}\n\n\t\treturn canvasRenderTarget.canvas;\n\t}\n\n\tstatic toBase64( canvas: HTMLCanvasElement, format?: string, quality?: number ): string {\n\t\treturn canvas.toDataURL( format, quality );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilFileDownloader {\n\tstatic downloadUrl( filename: string, url: string ): void {\n\t\tconst a = document.createElement( \"a\" );\n\t\tif( \"download\" in a ) {\n\t\t\ta.href = url;\n\t\t\ta.setAttribute( \"download\", filename );\n\t\t\ta.style.display = \"none\";\n\t\t\tdocument.body.appendChild( a );\n\t\t\ta.click();\n\t\t\tsetTimeout((): void => {\n\t\t\t\tdocument.body.removeChild( a );\n\t\t\t}, 66);\n\t\t} else {\n\t\t\tif( ! window.open( url ) ) {\n\t\t\t\tlocation.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic download( filename: string, contents: string ): void {\n\t\tconst blob = new Blob(\n\t\t\t[ contents ],\n\t\t\t{ type: \"text/plain\" }\n\t\t);\n\t\tif( window.navigator.msSaveBlob ) {\n\t\t\twindow.navigator.msSaveBlob( blob, filename );\n\t\t} else {\n\t\t\tthis.downloadUrl( filename, URL.createObjectURL( blob ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Renderer, RenderTexture } from \"pixi.js\";\nimport { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DApplicationLike } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { isNumber } from \"./is-number\";\nimport { UtilExtractor } from \"./util-extractor\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\nimport { UtilFileDownloader } from \"./util-file-downloader\";\n\nexport interface UtilExtractTextureResolutionOptions {\n\tsize: number;\n}\n\nexport interface UtilExtractTextureTransformOptions {\n\tupdate?: boolean;\n}\n\nexport interface UtilExtractTextureOptions {\n\ttarget: DBase;\n\tresolution?: number | UtilExtractTextureResolutionOptions;\n\ttransform?: UtilExtractTextureTransformOptions;\n\tclear?: boolean;\n}\n\nexport interface UtilExtractPixelsOptions extends UtilExtractTextureOptions {\n\trenderer?: Renderer;\n\tapplication?: DApplicationLike;\n\tlayer?: DApplicationLayerLike;\n}\n\nexport interface UtilExtractCanvasOptions extends UtilExtractPixelsOptions {\n\tscale?: number | {\n\t\tsize: number;\n\t};\n\talpha?: {\n\t\tpremultiplied?: {\n\t\t\tignore?: boolean;\n\t\t}\n\t};\n}\n\nexport interface UtilExtractBase64Options extends UtilExtractCanvasOptions {\n\tformat?: string;\n\tquality?: number;\n}\n\nexport interface UtilExtractFileOptions extends UtilExtractBase64Options {\n\tfilename: string;\n}\n\nconst toSkipUpdateTransform = ( options: UtilExtractTextureOptions ): boolean | undefined => {\n\treturn options.transform && options.transform.update;\n};\n\nconst toResolution = ( options: UtilExtractTextureOptions ): number => {\n\tconst target = options.target;\n\tif( options.resolution != null ) {\n\t\tif( isNumber( options.resolution ) ) {\n\t\t\treturn options.resolution;\n\t\t} else {\n\t\t\treturn Math.min( 1, options.resolution.size / Math.max( target.width, target.height ) );\n\t\t}\n\t} else {\n\t\treturn window.devicePixelRatio || 1;\n\t}\n};\n\nconst toIgnorePremultipliedAlpha = ( options: UtilExtractCanvasOptions ): boolean | undefined => {\n\treturn ( options.alpha && options.alpha.premultiplied && options.alpha.premultiplied.ignore );\n};\n\nconst toScale = ( pixels: UtilExtractorPixels, options: UtilExtractCanvasOptions ): number | undefined => {\n\tif( options.scale != null ) {\n\t\tif( isNumber( options.scale ) ) {\n\t\t\treturn options.scale;\n\t\t} else {\n\t\t\tconst size = options.scale.size;\n\t\t\treturn Math.min( 1, size / pixels.width, size / pixels.height );\n\t\t}\n\t}\n};\n\nconst toRenderer = ( options: UtilExtractPixelsOptions ): Renderer => {\n\tif( options.renderer ) {\n\t\treturn options.renderer;\n\t} else if( options.application ) {\n\t\treturn options.application.getLayerBase().renderer;\n\t} else if( options.layer ) {\n\t\treturn options.layer.renderer;\n\t} else {\n\t\tconst layer = DApplications.getLayer( options.target );\n\t\tif( layer ) {\n\t\t\treturn layer.renderer;\n\t\t} else {\n\t\t\tthrow new Error( \"No renderer / application / layer found.\" );\n\t\t}\n\t}\n};\n\nexport class UtilExtract {\n\tstatic texture( options: UtilExtractTextureOptions ): RenderTexture {\n\t\tconst target = options.target;\n\t\tconst resolution = toResolution( options );\n\t\tconst skipUpdateTransform = toSkipUpdateTransform( options );\n\t\treturn UtilExtractor.toTexture( target, resolution, options.clear, skipUpdateTransform );\n\t}\n\n\tstatic pixels( options: UtilExtractPixelsOptions ): UtilExtractorPixels {\n\t\tconst renderer = toRenderer( options );\n\t\treturn UtilExtractor.toPixels( this.texture( options ), renderer );\n\t}\n\n\tstatic canvas( options: UtilExtractCanvasOptions ): HTMLCanvasElement {\n\t\tconst pixels = this.pixels( options );\n\t\tconst ignorePremutipliedAlpha = toIgnorePremultipliedAlpha( options );\n\t\tconst scale = toScale( pixels, options );\n\t\treturn UtilExtractor.toCanvas( pixels, scale, ignorePremutipliedAlpha );\n\t}\n\n\tstatic base64( options: UtilExtractBase64Options ): string {\n\t\treturn UtilExtractor.toBase64( this.canvas( options ), options.format, options.quality );\n\t}\n\n\tstatic file( options: UtilExtractFileOptions ): void {\n\t\tUtilFileDownloader.downloadUrl( options.filename, this.base64( options ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCapability {\n\tNONE\t\t\t= 0,\n\n\tID\t\t\t\t= 1 << 0,\n\tPOSITION\t\t= 1 << 1,\n\tWIDTH\t\t\t= 1 << 2,\n\tHEIGHT\t\t\t= 1 << 3,\n\tROTATION\t\t= 1 << 4,\n\tSKEW\t\t\t= 1 << 5,\n\tALIGN\t\t\t= 1 << 6,\n\n\tREPLACING\t\t= 1 << 7,\n\tGROUPING\t\t= 1 << 8,\n\tFILL\t\t\t= 1 << 9,\n\tSTROKE\t\t\t= 1 << 10,\n\tSTROKE_SIDE\t\t= 1 << 11,\n\tBORDER_RADIUS\t= 1 << 12,\n\n\tTEXT\t\t\t= 1 << 13,\n\tTEXTURE\t\t\t= 1 << 14,\n\tTAG\t\t\t\t= 1 << 15,\n\tACTION\t\t\t= 1 << 16,\n\tCURSOR\t\t\t= 1 << 17,\n\tORDER_IN_LAYER\t= 1 << 18,\n\n\tCOORDINATE\t\t= ID | POSITION | WIDTH | HEIGHT | ROTATION | SKEW | ALIGN,\n\tSHAPE\t\t\t= REPLACING | GROUPING | FILL | STROKE,\n\tSHAPE_ROUNDED\t= SHAPE | BORDER_RADIUS,\n\tSHAPE_SIDED\t\t= SHAPE | STROKE_SIDE,\n\tSHAPE_SIDED_AND_ROUNDED = SHAPE | STROKE_SIDE | BORDER_RADIUS,\n\tLAYER\t\t\t= ORDER_IN_LAYER,\n\tPRIMITIVE\t\t= COORDINATE | SHAPE | TEXT | TEXTURE | TAG | ACTION | CURSOR | LAYER,\n\tSHADOW\t\t\t= NONE,\n\tALL\t\t\t\t= PRIMITIVE | STROKE_SIDE | BORDER_RADIUS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilHsv {\n\tstatic fromRgb( color: number ): [ number, number, number ] {\n\t\tconst r = (color & 0xff0000) >> 16;\n\t\tconst g = (color & 0x00ff00) >> 8;\n\t\tconst b = (color & 0x0000ff) | 0;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\t\tconst length = max - min;\n\t\tlet h = 0;\n\t\tif( 0 < length ) {\n\t\t\tif( r === max ) {\n\t\t\t\th = 60 * ( g - b ) / length;\n\t\t\t} else if( g === max ) {\n\t\t\t\th = 60 * ( b - r ) / length + 120;\n\t\t\t} else if( b === max ) {\n\t\t\t\th = 60 * ( r - g ) / length + 240;\n\t\t\t}\n\t\t\tif( h < 0 ) {\n\t\t\t\th += 360;\n\t\t\t}\n\t\t}\n\n\t\tconst s = ( length / max ) * 255;\n\t\tconst v = max;\n\t\treturn [ h, s, v ];\n\t}\n\n\tstatic toRgb( h: number, s: number, v: number ): number {\n\t\tconst max = v;\n\t\tconst min = v - (s / 255) * v;\n\t\tconst length = max - min;\n\n\t\tlet r = 0;\n\t\tlet g = 0;\n\t\tlet b = 0;\n\t\tif( h <= 60 ) {\n\t\t\tr = max;\n\t\t\tg = (h / 60) * length + min;\n\t\t\tb = min;\n\t\t} else if( h <= 120 ) {\n\t\t\tr = ((120 - h) / 60) * length + min;\n\t\t\tg = max;\n\t\t\tb = min;\n\t\t} else if( h <= 180 ) {\n\t\t\tr = min;\n\t\t\tg = max;\n\t\t\tb = ((h - 120) / 60) * length + min;\n\t\t} else if( h <= 240 ) {\n\t\t\tr = min;\n\t\t\tg = ((240 - h) / 60) * length + min;\n\t\t\tb = max;\n\t\t} else if( h <= 300 ) {\n\t\t\tr = ((h - 240) / 60) * length + min;\n\t\t\tg = min;\n\t\t\tb = max;\n\t\t} else {\n\t\t\tr = max;\n\t\t\tg = min;\n\t\t\tb = ((360 - h) / 60) * length + min;\n\t\t}\n\n\t\tr = Math.max( 0, Math.min( 255, r ) );\n\t\tg = Math.max( 0, Math.min( 255, g ) );\n\t\tb = Math.max( 0, Math.min( 255, b ) );\n\n\t\treturn (r << 16) | (g << 8) | b;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilName {\n\tprotected static _mapping: { [ key: string]: number } = {};\n\n\tstatic create( type: string ) {\n\t\tconst mapping = this._mapping;\n\t\tif( type in mapping ) {\n\t\t\treturn `${type} ${++mapping[ type ]}`;\n\t\t} else {\n\t\t\tmapping[ type ] = 1;\n\t\t\treturn `${type} 1`;\n\t\t}\n\t}\n}\n","import { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DApplicationLike, DApplicationTarget } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\n\nexport class UtilOverlay {\n\tprotected _layer: DApplicationLayerLike | null;\n\tprotected _application: DApplicationLike | null;\n\n\tconstructor( options?: { parent?: unknown; } ) {\n\t\tthis._layer = null;\n\t\tthis._application = ( options == null || options.parent == null ?\n\t\t\tDApplications.last() : null\n\t\t);\n\t}\n\n\tget picked(): DApplicationLayerLike | null {\n\t\treturn this._layer;\n\t}\n\n\tpick( target: DApplicationTarget ): DApplicationLayerLike {\n\t\tlet layer = this._layer;\n\t\tif( layer == null ) {\n\t\t\tlayer = DApplications.getLayerOverlay( target );\n\t\t\tif( ! layer ) {\n\t\t\t\tconst application = this._application;\n\t\t\t\tif( application ) {\n\t\t\t\t\tlayer = application.getLayerOverlay();\n\t\t\t\t} else {\n\t\t\t\t\tlayer = DApplications.last().getLayerOverlay();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._layer = layer;\n\t\t}\n\t\treturn layer;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilPromise {\n\tstatic IDENTITY = () => { /* DO NOTHING*/ };\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilRgba {\n\tstatic toCode( color: number, alpha: number ): string {\n\t\tconst r = ( color >> 16 ) & 0xff;\n\t\tconst g = ( color >> 8 ) & 0xff;\n\t\tconst b = ( color & 0xff );\n\t\treturn `rgba(${r},${g},${b},${alpha})`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DCornerMask } from \"../d-corner-mask\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\nexport class UtilTexturePlane {\n\tprotected static INSTANCE: UtilTexturePlane | null = null;\n\n\tprotected _backgroundCache: Map<number, Texture>;\n\tprotected _backgroundAttribute: string;\n\tprotected _borderCache: Map<number, Map<number, Texture>>;\n\tprotected _borderAttribute: ( width: number ) => string;\n\tprotected _onUpdate: () => void;\n\n\tconstructor() {\n\t\tthis._backgroundCache = new Map<number, Texture>();\n\t\tthis._backgroundAttribute = `fill=\"#fff\" stroke=\"none\"`;\n\t\tthis._borderCache = new Map<number, Map<number, Texture>>();\n\t\tthis._borderAttribute = ( width: number ): string => {\n\t\t\treturn `fill=\"none\" stroke=\"#fff\" stroke-width=\"${width}\"`;\n\t\t};\n\t\tthis._onUpdate = (): void => {\n\t\t\tDApplications.update();\n\t\t};\n\t}\n\n\tprotected toCornerTl( offset: number, size: number, tl: number ): string {\n\t\treturn ( 0 < tl ? `A${tl} ${tl} 0 0 1 ${offset + tl} ${offset}` : \"\" );\n\t}\n\n\tprotected toCornerBr( offset: number, size: number, br: number ): string {\n\t\treturn ( 0 < br ? `A${br} ${br} 0 0 1 ${offset + size - br} ${offset + size}` : \"\" );\n\t}\n\n\tprotected make( radius: number, offset: number, attr: string ): Texture {\n\t\tconst realRadius = Math.max( 0, radius - offset );\n\t\tconst size: number = realRadius * 2 + 4;\n\t\tconst realSize: number = size + offset * 2;\n\t\tconst d =\n\t\t\t`M${offset + realRadius} ${offset}` +\n\t\t\t`L${offset + size} ${offset}` +\n\t\t\t`L${offset + size} ${offset + size - realRadius}` +\n\t\t\tthis.toCornerBr( offset, size, realRadius ) +\n\t\t\t`L${offset} ${offset + size}` +\n\t\t\t`L${offset} ${offset + realRadius}` +\n\t\t\tthis.toCornerTl( offset, size, realRadius ) +\n\t\t\t`Z`;\n\t\treturn this.toSvg( realSize, attr, d );\n\t}\n\n\tprotected toSvg( realSize: number, attr: string, d: string ): Texture {\n\t\tconst resolution = (window.devicePixelRatio || 1);\n\t\tconst widthAttr = `width=\"${realSize * resolution}\"`;\n\t\tconst heightAttr = `height=\"${realSize * resolution}\"`;\n\t\tconst viewBoxAttr = `viewBox=\"0 0 ${realSize} ${realSize}\"`;\n\t\tconst svg = `<svg ${widthAttr} ${heightAttr} ${viewBoxAttr} xmlns=\"http://www.w3.org/2000/svg\">` +\n\t\t\t`<path ${attr} d=\"${d}\"></path>` +\n\t\t`</svg>`;\n\t\treturn Texture.from( toSvgUrl( svg ), {\n\t\t\tresolution\n\t\t});\n\t}\n\n\tnewBackground( radius: number ): Texture {\n\t\tconst result = this.make( radius, 0, this._backgroundAttribute );\n\t\tresult.on( \"update\", this._onUpdate );\n\t\treturn result;\n\t}\n\n\tnewBorder( radius: number, width: number ): Texture {\n\t\tconst result = this.make( radius, 0.5 * width, this._borderAttribute( width ) );\n\t\tresult.on( \"update\", this._onUpdate );\n\t\treturn result;\n\t}\n\n\tgetBackground( radius: number ): Texture {\n\t\tconst cache = this._backgroundCache;\n\n\t\tlet texture = cache.get( radius );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.newBackground( radius );\n\t\t\tcache.set( radius, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tgetBorder( radius: number, width: number ): Texture {\n\t\tconst cache = this._borderCache;\n\n\t\tlet maskToTexture = cache.get( radius );\n\t\tif( maskToTexture == null ) {\n\t\t\tmaskToTexture = new Map<DCornerMask, Texture>();\n\t\t\tcache.set( radius, maskToTexture );\n\t\t}\n\n\t\tlet texture = maskToTexture.get( width );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.newBorder( radius, width );\n\t\t\tmaskToTexture.set( width, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tstatic getInstance(): UtilTexturePlane {\n\t\tif( UtilTexturePlane.INSTANCE == null ) {\n\t\t\tUtilTexturePlane.INSTANCE = new UtilTexturePlane();\n\t\t}\n\t\treturn UtilTexturePlane.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class UtilTexture {\n\tstatic fromImage( url: string, resolution: number, onLoad: ( texture: Texture ) => void ) {\n\t\tconst texture = Texture.from( url, {\n\t\t\tresolution\n\t\t});\n\t\tif( ! texture.baseTexture.valid ) {\n\t\t\ttexture.once( \"update\", onLoad );\n\t\t} else {\n\t\t\tonLoad( texture );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport interface UtilTransitionOptions {\n\tduration?: number;\n}\n\nexport class UtilTransition {\n\tprotected _duration: number;\n\tprotected _current: DBase<any, any> | null;\n\tprotected _lastUpdate: number;\n\tprotected _updateId: number | null;\n\n\tconstructor( options?: UtilTransitionOptions ) {\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 300 );\n\t\tthis._current = null;\n\t\tthis._lastUpdate = 0;\n\t\tthis._updateId = null;\n\t}\n\n\tshow( next: DBase<any, any> | null, forcibly?: boolean ): void {\n\t\tconst updateId = this._updateId;\n\t\tif( updateId != null ) {\n\t\t\tclearTimeout( updateId );\n\t\t}\n\n\t\tconst current = this._current;\n\t\tif( next !== current ) {\n\t\t\tconst duration = this._duration;\n\t\t\tconst lastUpdate = this._lastUpdate;\n\t\t\tconst now = Date.now();\n\t\t\tconst remaining = (lastUpdate + duration) - now;\n\t\t\tif( forcibly === true || remaining <= 0 ) {\n\t\t\t\tthis.update( now, next );\n\t\t\t} else {\n\t\t\t\tthis._updateId = window.setTimeout(() => {\n\t\t\t\t\tthis.update( Date.now(), next );\n\t\t\t\t}, remaining );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected update( now: number, next: DBase<any, any> | null ) {\n\t\tconst current = this._current;\n\t\tif( current !== next ) {\n\t\t\tthis._lastUpdate = now;\n\n\t\t\tif( current !== null ) {\n\t\t\t\tcurrent.hide();\n\t\t\t}\n\n\t\t\tthis._current = next;\n\t\t\tif( next != null ) {\n\t\t\t\tnext.show();\n\t\t\t}\n\t\t}\n\t}\n\n\thide(): void {\n\t\tthis.show( null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeFont } from \"../d-font\";\nimport { DThemes } from \"../theme/d-themes\";\n\nexport interface UtilWheelEventDeltas {\n\tmode: number;\n\tdelta: number;\n\tdeltaX: number;\n\tdeltaY: number;\n\tlowest: number;\n}\n\n/*!\n* jQuery Mousewheel 3.1.13\n*\n* Copyright jQuery Foundation and other contributors\n* Released under the MIT license\n* http://jquery.org/license\n*\n* See also https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n* and https://github.com/openlayers/openlayers/blob/v5.2.0/src/ol/interaction/MouseWheelZoom.js#L51\n*/\nexport class UtilWheelEvent {\n\tprivate static INSTANCE: UtilWheelEvent | null;\n\tprivate _names: Array<\"wheel\" | \"mousewheel\" | \"DOMMouseScroll\" | \"MozMousePixelScroll\">;\n\tprivate _lowest: number | null = null;\n\tprivate _timestamp: number = 0;\n\tprivate _lineHeight: number | null = null;\n\tprivate _pageHeight: number | null = null;\n\n\tconstructor() {\n\t\tthis._names = ( \"onwheel\" in document || 9 <= (document as any).documentMode ?\n\t\t\t[ \"wheel\" ] : [ \"mousewheel\", \"DOMMouseScroll\", \"MozMousePixelScroll\" ]\n\t\t);\n\t}\n\n\ton( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.addEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\toff( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.removeEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\tgetLineHeight(): number {\n\t\tif( this._lineHeight == null ) {\n\t\t\tconst theme = DThemes.getInstance().get( \"DBase\" ) as DThemeFont;\n\t\t\tthis._lineHeight = theme.getLineHeight();\n\t\t}\n\t\treturn this._lineHeight;\n\t}\n\n\tgetPageHeight(): number {\n\t\tif( this._pageHeight == null ) {\n\t\t\tthis._pageHeight = this.getLineHeight() * 12;\n\t\t}\n\t\treturn this._pageHeight;\n\t}\n\n\tnormalize( e: any ): UtilWheelEventDeltas | null {\n\t\tlet deltaX = 0;\n\t\tlet deltaY = 0;\n\n\t\t// Old school scrollwheel delta\n\t\tif ( \"detail\" in e ) {\n\t\t\tdeltaY = e.detail * -1;\n\t\t}\n\t\tif ( \"wheelDelta\" in e ) {\n\t\t\tdeltaY = e.wheelDelta;\n\t\t}\n\t\tif ( \"wheelDeltaY\" in e ) {\n\t\t\tdeltaY = e.wheelDeltaY;\n\t\t}\n\t\tif ( \"wheelDeltaX\" in e ) {\n\t\t\tdeltaX = e.wheelDeltaX * -1;\n\t\t}\n\n\t\t// Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n\t\tif ( \"axis\" in e && e.axis === e.HORIZONTAL_AXIS ) {\n\t\t\tdeltaX = deltaY * -1;\n\t\t\tdeltaY = 0;\n\t\t}\n\n\t\t// New school wheel delta (wheel event)\n\t\tif ( \"deltaY\" in e ) {\n\t\t\tdeltaY = e.deltaY * -1;\n\t\t}\n\t\tif ( \"deltaX\" in e ) {\n\t\t\tdeltaX = e.deltaX;\n\t\t}\n\n\t\t// No change actually happened, no reason to go any further\n\t\tif ( deltaY === 0 && deltaX === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Store lowest absolute delta to normalize the delta values\n\t\tlet delta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );\n\n\t\t// Reset the this._lowest to better handle multiple device types\n\t\t// that give different a different lowestDelta\n\t\t// Ex: trackpad = 3 and mouse wheel = 120\n\t\tconst now = Date.now();\n\t\tif( this._timestamp + 200 <= now ) {\n\t\t\tthis._lowest = null;\n\t\t}\n\t\tthis._timestamp = now;\n\n\t\t//\n\t\tconst shouldAdjust = (e.type === \"mousewheel\" && delta % 120 === 0);\n\t\tif ( ! this._lowest || delta < this._lowest ) {\n\t\t\tthis._lowest = delta;\n\n\t\t\t// Adjust older deltas if necessary\n\t\t\tif ( shouldAdjust ) {\n\t\t\t\tthis._lowest /= 40;\n\t\t\t}\n\t\t}\n\n\t\t// Adjust older deltas if necessary\n\t\tif ( shouldAdjust ) {\n\t\t\t// Divide all the things by 40!\n\t\t\tdelta  /= 40;\n\t\t\tdeltaX /= 40;\n\t\t\tdeltaY /= 40;\n\t\t}\n\n\t\t// Get a whole, normalized value for the deltas\n\t\tconst lowest = this._lowest;\n\t\tdelta  = Math.floor( delta  / lowest );\n\t\tdeltaX = Math[ 1 <= deltaX ? \"floor\" : \"ceil\" ](deltaX / lowest);\n\t\tdeltaY = Math[ 1 <= deltaY ? \"floor\" : \"ceil\" ](deltaY / lowest);\n\n\t\t// Mode\n\t\tconst mode = e.deltaMode || 0;\n\t\tif( mode !== 0 ) {\n\t\t\tconst scale = ( mode === 1 ? this.getLineHeight() : this.getPageHeight() );\n\t\t\tdelta *= scale;\n\t\t\tdeltaX *= scale;\n\t\t\tdeltaY *= scale;\n\t\t}\n\n\t\treturn {\n\t\t\tmode,\n\t\t\tdelta,\n\t\t\tdeltaX,\n\t\t\tdeltaY,\n\t\t\tlowest\n\t\t};\n\t}\n\n\tstatic getInstance(): UtilWheelEvent {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tthis.INSTANCE = new UtilWheelEvent();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isFunction, isNumber } from \"../../util\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeLineOfAnyPointsSize } from \"./e-shape-line-of-any-points-size\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsSizeImplParent {\n\treadonly length: number;\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsSizeImpl implements EShapeLineOfAnyPointsSize {\n\tprotected _parent: EShapeLineOfAnyPointsSizeImplParent;\n\tprotected _id: number;\n\tprotected _x: EShapeLineOfAnyValue;\n\tprotected _y: EShapeLineOfAnyValue;\n\tprotected _limit: number | null;\n\tprotected _limitComputed: number;\n\tprotected _limitId: number;\n\tprotected _limitParentLength: number;\n\n\tconstructor( parent: EShapeLineOfAnyPointsSizeImplParent ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._x = null;\n\t\tthis._y = null;\n\t\tthis._limit = null;\n\t\tthis._limitComputed = 0;\n\t\tthis._limitId = -1;\n\t\tthis._limitParentLength = 0;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget x(): EShapeLineOfAnyValue {\n\t\treturn this._x;\n\t}\n\n\tset x( x: EShapeLineOfAnyValue ) {\n\t\tthis.set( x, undefined );\n\t}\n\n\tget y(): EShapeLineOfAnyValue {\n\t\treturn this._y;\n\t}\n\n\tset y( y: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, y );\n\t}\n\n\tget limit(): number | null {\n\t\treturn this._limit;\n\t}\n\n\tset limit( limit: number | null ) {\n\t\tthis._limit = limit;\n\t}\n\n\tset( x?: EShapeLineOfAnyValue, y?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( x !== undefined && this._x !== x ) {\n\t\t\tisChanged = true;\n\t\t\tthis._x = x;\n\t\t}\n\n\t\tif( y !== undefined && this._y !== y ) {\n\t\t\tisChanged = true;\n\t\t\tthis._y = y;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetX( index: number ): number {\n\t\treturn toComputed( index, this._x, EShapeDefaults.SIZE_X );\n\t}\n\n\tgetY( index: number ): number {\n\t\treturn toComputed( index, this._y, EShapeDefaults.SIZE_Y );\n\t}\n\n\tgetLimit(): number {\n\t\tconst limit = this._limit;\n\t\tif( limit != null ) {\n\t\t\treturn limit;\n\t\t}\n\t\tthis.updateLimitComputed();\n\t\treturn this._limitComputed;\n\t}\n\n\tprotected updateLimitComputed(): void {\n\t\tconst limitId = this._id;\n\t\tconst parent = this._parent;\n\t\tconst limitParentLength = parent.length;\n\t\tif( this._limitId !== limitId || this._limitParentLength !== limitParentLength ) {\n\t\t\tthis._limitId = limitId;\n\t\t\tthis._limitParentLength = limitParentLength;\n\t\t\tthis._limitComputed = Math.max(\n\t\t\t\tthis.calcLimit( this._x, limitParentLength, EShapeDefaults.SIZE_X ),\n\t\t\t\tthis.calcLimit( this._y, limitParentLength, EShapeDefaults.SIZE_Y )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected calcLimit( value: EShapeLineOfAnyValue, parentLenght: number, def: number ): number {\n\t\tif( isNumber( value ) ) {\n\t\t\treturn value;\n\t\t} else if( isFunction( value ) ) {\n\t\t\tif( 0 < parentLenght ) {\n\t\t\t\tlet result = value( 0 );\n\t\t\t\tfor( let i = 1; i < parentLenght; ++i ) {\n\t\t\t\t\tresult = Math.max( result, value( i ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\t} else if( value != null ) {\n\t\t\tconst l = value.length;\n\t\t\tif( 0 < l ) {\n\t\t\t\tlet result = value[ 0 ];\n\t\t\t\tfor( let i = 1; i < l; ++i ) {\n\t\t\t\t\tresult = Math.max( result, value[ i ] );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn def;\n\t\t}\n\t}\n\n\tisStaticX(): boolean {\n\t\treturn isStatic( this._x );\n\t}\n\n\tisStaticY(): boolean {\n\t\treturn isStatic( this._y );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsStrokeImplParent {\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsStrokeImpl implements EShapeLineOfAnyPointsStroke {\n\tprotected _parent: EShapeLineOfAnyPointsStrokeImplParent;\n\tprotected _id: number;\n\tprotected _color: EShapeLineOfAnyValue;\n\tprotected _alpha: EShapeLineOfAnyValue;\n\n\tconstructor( parent: EShapeLineOfAnyPointsStrokeImplParent ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._color = null;\n\t\tthis._alpha = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget color(): EShapeLineOfAnyValue {\n\t\treturn this._color;\n\t}\n\n\tset color( color: EShapeLineOfAnyValue ) {\n\t\tthis.set( color, undefined );\n\t}\n\n\tget alpha(): EShapeLineOfAnyValue {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, alpha );\n\t}\n\n\tset( color?: EShapeLineOfAnyValue, alpha?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tisChanged = true;\n\t\t\tthis._color = color;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tisChanged = true;\n\t\t\tthis._alpha = alpha;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetColor( index: number, def: number ): number {\n\t\treturn toComputed( index, this._color, def );\n\t}\n\n\tgetAlpha( index: number, def: number ): number {\n\t\treturn toComputed( index, this._alpha, def );\n\t}\n\n\tisStaticColor(): boolean {\n\t\treturn isStatic( this._color );\n\t}\n\n\tisStaticAlpha(): boolean {\n\t\treturn isStatic( this._alpha );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyPointsFillImpl } from \"./e-shape-line-of-any-points-fill-impl\";\nimport { EShapeLineOfAnyPointsSize } from \"./e-shape-line-of-any-points-size\";\nimport { EShapeLineOfAnyPointsSizeImpl } from \"./e-shape-line-of-any-points-size-impl\";\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\nimport { EShapeLineOfAnyPointsStrokeImpl } from \"./e-shape-line-of-any-points-stroke-impl\";\n\nexport type EShapeLineOfAnyPointsToHitThreshold = (\n\tsize: number,\n\tscale: number\n) => number;\n\nexport type EShapeLineOfAnyPointsTestRange = (\n\tx: number, y: number,\n\tax: number, ay: number,\n\tthreshold: number,\n\tvalues: number[],\n\tresult: [ number, number ]\n) => [ number, number ];\n\nexport type EShapeLineOfAnyPointsHitTester<RESULT> = (\n\tx: number, y: number,\n\tax: number, ay: number,\n\tpx: number, py: number,\n\tindex: number,\n\tthreshold: number,\n\tresult: RESULT\n) => boolean;\n\nexport class EShapeLineOfAnyPoints implements EShapePoints {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\n\tprotected _parent: EShapePointsParent;\n\tprotected _values: number[];\n\tprotected _valuesLength: number;\n\tprotected _segments: number[];\n\tprotected _size: EShapeLineOfAnyPointsSize;\n\tprotected _fill: EShapeLineOfAnyPointsFill;\n\tprotected _stroke: EShapeLineOfAnyPointsStroke;\n\tprotected _id: number;\n\n\tconstructor( parent: EShapePointsParent ) {\n\t\tthis._parent = parent;\n\t\tthis._values = [];\n\t\tthis._valuesLength = 0;\n\t\tthis._segments = [];\n\t\tthis._size = new EShapeLineOfAnyPointsSizeImpl( this );\n\t\tthis._fill = new EShapeLineOfAnyPointsFillImpl( parent );\n\t\tthis._stroke = new EShapeLineOfAnyPointsStrokeImpl( parent );\n\t\tthis._id = 0;\n\t}\n\n\tget length(): number {\n\t\treturn this._values.length >> 1;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\tthis.set( values, undefined, undefined );\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\tset segments( segments: number[] ) {\n\t\t// DO NOTHING\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.set( undefined, undefined, style );\n\t}\n\n\tget size(): EShapeLineOfAnyPointsSize {\n\t\treturn this._size;\n\t}\n\n\tget fill(): EShapeLineOfAnyPointsFill {\n\t\treturn this._fill;\n\t}\n\n\tget stroke(): EShapeLineOfAnyPointsStroke {\n\t\treturn this._stroke;\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\treturn this.set( source.values, source.segments, source.style );\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet isDirty = false;\n\t\tlet isUpdated = false;\n\n\t\t// Values\n\t\tif( newValues != null ) {\n\t\t\tconst values = this._values;\n\t\t\tconst valuesLength = this._valuesLength;\n\t\t\tconst newValuesLength = newValues.length;\n\t\t\tif( values !== newValues ) {\n\t\t\t\tconst iupdate = Math.min( valuesLength, newValuesLength );\n\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tvalues[ i ] = newValues[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newValuesLength; ++i ) {\n\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( valuesLength !== newValuesLength ) {\n\t\t\t\t\tvalues.length = newValuesLength;\n\t\t\t\t\tthis._valuesLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( valuesLength !== newValuesLength ) {\n\t\t\t\t\tthis._valuesLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( isDirty ) {\n\t\t\tthis._id += 1;\n\t\t\tconst parent = this._parent;\n\t\t\tparent.uploaded = undefined;\n\t\t\tparent.toDirty();\n\t\t} else if( isUpdated ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tupdateUploaded(): void {\n\t\tthis._parent.updateUploaded();\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeLineOfAnyPoints {\n\t\treturn new EShapeLineOfAnyPoints( parent );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[]` );\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst pointCount = this.length;\n\t\tconst pointValues = this._values;\n\t\tconst size = this._size;\n\t\tlet istart = 0;\n\t\tlet iend = pointCount;\n\t\tif( range ) {\n\t\t\tconst s = size.getLimit() * 0.5;\n\t\t\tconst rangeResult = range( x, y, s, s, threshold, pointValues, EShapeLineOfAnyPoints.WORK_RANGE );\n\t\t\tistart = rangeResult[ 0 ];\n\t\t\tiend = rangeResult[ 1 ];\n\t\t}\n\t\ttester = tester;\n\t\tfor( let i = istart, imax = Math.min( iend, pointCount ), iv = istart << 1; i < imax; i += 1, iv += 2 ) {\n\t\t\tconst px = pointValues[ iv     ];\n\t\t\tconst py = pointValues[ iv + 1 ];\n\t\t\tconst sx = size.getX( i ) * 0.5;\n\t\t\tconst sy = size.getY( i ) * 0.5;\n\t\t\tif( tester( x, y, sx, sy, px, py, i, threshold, result ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","import { buildColor } from \"./build-color\";\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\n\nexport const buildLineOfAnyColor = (\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpoint: EShapeLineOfAnyPointsStroke | EShapeLineOfAnyPointsFill,\n\tpointCount: number,\n\tcolors: Float32Array,\n\tisEnabled: boolean,\n\tcolorDef: number,\n\talphaDef: number\n): void => {\n\tif( isEnabled ) {\n\t\tif( point.isStaticColor() ) {\n\t\t\tconst color = point.getColor( 0, colorDef );\n\t\t\tif( point.isStaticAlpha() ) {\n\t\t\t\tconst alpha = point.getAlpha( 0, alphaDef );\n\t\t\t\tbuildColor( color, alpha, voffset, vcountPerPoint * pointCount, colors );\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst alpha = point.getAlpha( i, alphaDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( point.isStaticAlpha() ) {\n\t\t\t\tconst alpha = point.getAlpha( 0, alphaDef );\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\t\tconst alpha = point.getAlpha( i, alphaDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif( point.isStaticColor() ) {\n\t\t\tconst color = point.getColor( 0, colorDef );\n\t\t\tbuildColor( color, 0, voffset, vcountPerPoint * pointCount, colors );\n\t\t} else {\n\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\tbuildColor( color, 0, iv, vcountPerPoint, colors );\n\t\t\t}\n\t\t}\n\t}\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildLineOfAnyColor } from \"./build-line-of-any-color\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport abstract class EShapeLineOfAnyUploaded extends EShapeTextUploaded {\n\tprotected pointId: number;\n\tprotected pointCount: number;\n\tprotected pointSizeId: number;\n\tprotected pointFillId: number;\n\tprotected pointStrokeId: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number,\n\t\tpointCount: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointId = -1;\n\t\tthis.pointCount = pointCount;\n\t\tthis.pointSizeId = -1;\n\t\tthis.pointFillId = -1;\n\t\tthis.pointStrokeId = -1;\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\treturn this.pointCount === ( points ? points.length : 0 );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateLineOfAnyColorFill(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints, vcountPerPoint: number\n\t): void {\n\t\tconst pointFill = points.fill;\n\t\tconst pointFillId = pointFill.id;\n\t\tconst isPointFillChanged = ( pointFillId !== this.pointFillId );\n\n\t\tconst fill = shape.fill;\n\t\tconst isFillEnabled = shape.visible && fill.enable;\n\t\tconst colorFill = fill.color;\n\t\tconst alphaFill = (isFillEnabled ? fill.alpha : 0);\n\t\tconst isFillChanged = ( colorFill !== this.colorFill || alphaFill !== this.alphaFill );\n\n\t\tif( isPointFillChanged || isFillChanged ) {\n\t\t\tthis.colorFill = colorFill;\n\t\t\tthis.alphaFill = alphaFill;\n\t\t\tthis.pointFillId = pointFillId;\n\t\t\tbuffer.colorFillBuffer.update();\n\t\t\tbuildLineOfAnyColor(\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvcountPerPoint,\n\t\t\t\tpointFill,\n\t\t\t\tthis.pointCount,\n\t\t\t\tbuffer.colorFills,\n\t\t\t\tisFillEnabled,\n\t\t\t\tcolorFill,\n\t\t\t\talphaFill\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateLineOfAnyColorStroke(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints, vcountPerPoint: number\n\t): void {\n\t\tconst pointStroke = points.stroke;\n\t\tconst pointStrokeId = pointStroke.id;\n\t\tconst isPointStrokeChanged = ( pointStrokeId !== this.pointStrokeId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst isStrokeEnabled = shape.visible && stroke.enable;\n\t\tconst colorStroke = stroke.color;\n\t\tconst alphaStroke = (isStrokeEnabled ? stroke.alpha : 0);\n\t\tconst isStrokeChanged = ( colorStroke !== this.colorStroke || alphaStroke !== this.alphaStroke );\n\n\t\tif( isPointStrokeChanged || isStrokeChanged ) {\n\t\t\tthis.colorStroke = colorStroke;\n\t\t\tthis.alphaStroke = alphaStroke;\n\t\t\tthis.pointStrokeId = pointStrokeId;\n\t\t\tbuffer.colorStrokeBuffer.update();\n\t\t\tbuildLineOfAnyColor(\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvcountPerPoint,\n\t\t\t\tpointStroke,\n\t\t\t\tthis.pointCount,\n\t\t\t\tbuffer.colorStrokes,\n\t\t\t\tisStrokeEnabled,\n\t\t\t\tcolorStroke,\n\t\t\t\talphaStroke\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildCircleClipping, buildCircleIndex, buildCircleUv, buildCircleVertexAndStep,\n\tCIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT\n} from \"./build-circle\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfCirclesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings & indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tbuildCircleClipping(\n\t\t\tclippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildCircleIndex(\n\t\t\tindices,\n\t\t\tvoffset,\n\t\t\tioffset\n\t\t);\n\t\tcopyClipping(\n\t\t\tclippings,\n\t\t\tvoffset,\n\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\t\tcopyIndex(\n\t\t\tindices,\n\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\tioffset,\n\t\t\tCIRCLE_INDEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPoints ) {\n\t\t\tthis.updateVertexAndStep( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, CIRCLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, CIRCLE_VERTEX_COUNT );\n\t\t\tthis.updateUv( buffer, shape );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexAndStep( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\n\t\tconst pointId = points.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tif( isPointChanged || isPointSizeChanged || isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst work = buffer.work;\n\t\t\tconst workStep = buffer.workStep;\n\t\t\tif( pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\tbuildCircleVertexAndStep(\n\t\t\t\t\tvertices, voffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\tsteps, antialiases, clippings,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, true,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tantialiasWeight,\n\t\t\t\t\twork, workStep\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues\n\t\t\t\t);\n\t\t\t\tcopyStep(\n\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ];\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ];\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tbuildCircleVertexAndStep(\n\t\t\t\t\t\tvertices, voffset + i * CIRCLE_VERTEX_COUNT, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\t\tsteps, antialiases, clippings,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, true,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\twork, workStep\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tbuildCircleUv( voffset, textureUvs, uvs );\n\t\t\tcopyUvs(\n\t\t\t\tuvs,\n\t\t\t\tvoffset,\n\t\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\t\tthis.pointCount\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { CIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT } from \"./build-circle\";\nimport { EShapeLineOfAnyUploadeds } from \"./e-shape-line-of-any-uploadeds\";\nimport { EShapeLineOfCirclesUploaded } from \"./e-shape-line-of-circles-uploaded\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\n\nexport class EShapeLineOfCirclesUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineOfCirclesUploaded | EShapeLineOfNullsUploaded | null {\n\t\treturn EShapeLineOfAnyUploadeds.create(\n\t\t\tbuffer, shape,\n\t\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\t\tioffset, CIRCLE_INDEX_COUNT,\n\t\t\tantialiasWeight,\n\t\t\tEShapeLineOfCirclesUploaded\n\t\t);\n\t}\n}\n","import { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeLineOfAnyPoints, EShapeLineOfAnyPointsToHitThreshold } from \"./e-shape-line-of-any-points\";\n\nexport const toHitThreshold = (\n\ttarget: { readonly stroke: EShapeStroke, readonly points: EShapeLineOfAnyPoints; },\n\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null\n): number => {\n\tconst stroke = target.stroke;\n\tconst size = target.points.size.getLimit() + ( stroke.enable ? stroke.width * stroke.align : 0 );\n\treturn ( toThreshold ?\n\t\ttoThreshold( size, 1 ) :\n\t\tsize * 0.5\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeCircle } from \"./e-shape-circle\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfCircles extends EShapeCircle implements EShapeLineOfAny {\n\tpoints!: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfCircles ) {\n\t\tsuper( EShapeType.LINE_OF_CIRCLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis.points = new EShapeLineOfAnyPoints( this );\n\t\t}\n\n\t\tthis._tester = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, px, py );\n\t\t};\n\t}\n\n\tclone(): EShapeLineOfCircles {\n\t\treturn new EShapeLineOfCircles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbs( x - px, y - py, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbsBBox( x - px, y - py, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfCircles } from \"./e-shape-line-of-circles\";\n\nexport class EShapeLinesOfCircles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLineOfCircles> | EShapeLineOfCircles {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfCircles() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineOfCirclesUploadeds } from \"../shape/variant/e-shape-line-of-circles-uploadeds\";\nimport { EShapeLinesOfCircles } from \"../shape/variant/e-shape-lines-of-circles\";\n\nexport const loadShapeLineOfCircles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_CIRCLES ] = EShapeLineOfCirclesUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE_OF_CIRCLES ] = EShapeLinesOfCircles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeCapability } from \"./e-shape-capability\";\nimport { EShapeType } from \"./e-shape-type\";\n\nexport class EShapeCapabilities {\n\tstatic mappings: { [ type: number ]: EShapeCapability } = {};\n\n\tstatic get( type: EShapeType ): EShapeCapability {\n\t\treturn this.mappings[ type ] || EShapeCapability.PRIMITIVE;\n\t}\n\n\tstatic contains( shape: EShape | null | undefined, capability: EShapeCapability ): shape is EShape {\n\t\tif( shape != null ) {\n\t\t\tif( this.get( shape.type ) & capability ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst children = shape.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tif( this.contains( children[ i ], capability ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic set( type: EShapeType, capability: EShapeCapability ): void {\n\t\tthis.mappings[ type ] = capability;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\n\nexport enum ESnapperTargetValueType {\n\tHORIZONTAL = 0,\n\tVERTICAL = 1\n}\n\nexport class ESnapperTargetValue {\n\ttype: ESnapperTargetValueType;\n\tposition: number;\n\n\tconstructor( type: ESnapperTargetValueType, position: number ) {\n\t\tthis.type = type;\n\t\tthis.position = position;\n\t}\n\n\tserialize(): DDiagramSerializedSnapTargetValue {\n\t\treturn [ this.type, this.position ];\n\t}\n}\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { toLength } from \"./to-length\";\nimport { toStep } from \"./to-step\";\n\nexport const RECTANGLE_ROUNDED_VERTEX_COUNT = 36;\nexport const RECTANGLE_ROUNDED_INDEX_COUNT = 24;\nexport const RECTANGLE_ROUNDED_WORLD_SIZE: [ number, number, number ] = [ 0, 0, 0 ];\n\nexport const buildRectangleRoundedIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Top-left corner\n\tlet ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 2;\n\tindices[ ii + 3 ] = voffset + 1;\n\tindices[ ii + 4 ] = voffset + 3;\n\tindices[ ii + 5 ] = voffset + 2;\n\tii += 6;\n\n\t// Top-right corner\n\tindices[ ii + 0 ] = voffset + 4;\n\tindices[ ii + 1 ] = voffset + 5;\n\tindices[ ii + 2 ] = voffset + 6;\n\tindices[ ii + 3 ] = voffset + 5;\n\tindices[ ii + 4 ] = voffset + 7;\n\tindices[ ii + 5 ] = voffset + 6;\n\tii += 6;\n\n\t// Bottom-left corner\n\tindices[ ii + 0 ] = voffset + 8;\n\tindices[ ii + 1 ] = voffset + 9;\n\tindices[ ii + 2 ] = voffset + 10;\n\tindices[ ii + 3 ] = voffset + 9;\n\tindices[ ii + 4 ] = voffset + 11;\n\tindices[ ii + 5 ] = voffset + 10;\n\tii += 6;\n\n\t// Bottom-right corner\n\tindices[ ii + 0 ] = voffset + 12;\n\tindices[ ii + 1 ] = voffset + 13;\n\tindices[ ii + 2 ] = voffset + 14;\n\tindices[ ii + 3 ] = voffset + 13;\n\tindices[ ii + 4 ] = voffset + 15;\n\tindices[ ii + 5 ] = voffset + 14;\n\tii += 6;\n\n\t// Top edge\n\tindices[ ii + 0 ] = voffset + 16;\n\tindices[ ii + 1 ] = voffset + 17;\n\tindices[ ii + 2 ] = voffset + 20;\n\tindices[ ii + 3 ] = voffset + 17;\n\tindices[ ii + 4 ] = voffset + 21;\n\tindices[ ii + 5 ] = voffset + 20;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 17;\n\tindices[ ii + 1 ] = voffset + 18;\n\tindices[ ii + 2 ] = voffset + 21;\n\tindices[ ii + 3 ] = voffset + 18;\n\tindices[ ii + 4 ] = voffset + 22;\n\tindices[ ii + 5 ] = voffset + 21;\n\tii += 6;\n\n\t// Upper middle\n\tindices[ ii + 0 ] = voffset + 19;\n\tindices[ ii + 1 ] = voffset + 21;\n\tindices[ ii + 2 ] = voffset + 24;\n\tindices[ ii + 3 ] = voffset + 21;\n\tindices[ ii + 4 ] = voffset + 25;\n\tindices[ ii + 5 ] = voffset + 24;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 21;\n\tindices[ ii + 1 ] = voffset + 23;\n\tindices[ ii + 2 ] = voffset + 26;\n\tindices[ ii + 3 ] = voffset + 23;\n\tindices[ ii + 4 ] = voffset + 27;\n\tindices[ ii + 5 ] = voffset + 26;\n\tii += 6;\n\n\t// Lower middle\n\tindices[ ii + 0 ] = voffset + 24;\n\tindices[ ii + 1 ] = voffset + 25;\n\tindices[ ii + 2 ] = voffset + 28;\n\tindices[ ii + 3 ] = voffset + 25;\n\tindices[ ii + 4 ] = voffset + 30;\n\tindices[ ii + 5 ] = voffset + 28;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 26;\n\tindices[ ii + 1 ] = voffset + 27;\n\tindices[ ii + 2 ] = voffset + 30;\n\tindices[ ii + 3 ] = voffset + 27;\n\tindices[ ii + 4 ] = voffset + 32;\n\tindices[ ii + 5 ] = voffset + 30;\n\tii += 6;\n\n\t// Bottom edge\n\tindices[ ii + 0 ] = voffset + 29;\n\tindices[ ii + 1 ] = voffset + 30;\n\tindices[ ii + 2 ] = voffset + 33;\n\tindices[ ii + 3 ] = voffset + 30;\n\tindices[ ii + 4 ] = voffset + 34;\n\tindices[ ii + 5 ] = voffset + 33;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 30;\n\tindices[ ii + 1 ] = voffset + 31;\n\tindices[ ii + 2 ] = voffset + 34;\n\tindices[ ii + 3 ] = voffset + 31;\n\tindices[ ii + 4 ] = voffset + 35;\n\tindices[ ii + 5 ] = voffset + 34;\n};\n\nexport const buildRectangleRoundedVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number ],\n\twork: Point\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0   1       4   5\n\t// |---|       |---|\n\t// |2  |3      |6  |7\n\t// |---|       |---|\n\t//\n\t//\n\t//\n\t//\n\t//\n\t// |---|       |---|\n\t// |8  |9      |12 |13\n\t// |---|       |---|\n\t//  10  11      14  15\n\t//\n\t//\n\t//      16  17  18       <-- Top edge\n\t//     |---|---|\n\t//  19 |20 |21 |22  23   <-- Top\n\t// |---|---|---|---|\n\t// |       |       |\n\t// |24   25|26     |27   <-- Middle\n\t// |-------|-------|\n\t// |       |       |\n\t// |       |       |\n\t// |---|---|---|---|\n\t//  28 |29 |30 |31  32   <-- Bottom\n\t//     |---|---|\n\t//      33  34  35       <-- Bottom edge\n\t//\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst ax = Math.abs( sx );\n\tconst ay = Math.abs( sy );\n\tconst a = radius * Math.min( ax, ay );\n\tconst rx = a / ax;\n\tconst ry = a / ay;\n\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x2 = work.x;\n\tconst y2 = work.y;\n\tconst dxh = x2 - x0;\n\tconst dyh = y2 - y0;\n\tconst dxhr = rx * dxh;\n\tconst dyhr = rx * dyh;\n\tconst x1 = x0 + dxhr;\n\tconst y1 = y0 + dyhr;\n\tconst x4 = x2 + dxh;\n\tconst y4 = y2 + dyh;\n\tconst x3 = x4 - dxhr;\n\tconst y3 = y4 - dyhr;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst x11 = work.x;\n\tconst y11 = work.y;\n\tconst dxv = x11 - x2;\n\tconst dyv = y11 - y2;\n\tconst dxvr = ry * dxv;\n\tconst dyvr = ry * dyv;\n\tconst x7 = x2 + dxvr;\n\tconst y7 = y2 + dyvr;\n\tconst x5 = x7 - dxh;\n\tconst y5 = y7 - dyh;\n\tconst x6 = x5 + dxhr;\n\tconst y6 = y5 + dyhr;\n\tconst x9 = x7 + dxh;\n\tconst y9 = y7 + dyh;\n\tconst x8 = x9 - dxhr;\n\tconst y8 = y9 - dyhr;\n\tconst x10 = x11 - dxh;\n\tconst y10 = y11 - dyh;\n\tconst x12 = x11 + dxh;\n\tconst y12 = y11 + dyh;\n\tconst x20 = x11 + dxv;\n\tconst y20 = y11 + dyv;\n\tconst x15 = x20 - dxvr;\n\tconst y15 = y20 - dyvr;\n\tconst x13 = x15 - dxh;\n\tconst y13 = y15 - dyh;\n\tconst x14 = x13 + dxhr;\n\tconst y14 = y13 + dyhr;\n\tconst x17 = x15 + dxh;\n\tconst y17 = y15 + dyh;\n\tconst x16 = x17 - dxhr;\n\tconst y16 = y17 - dyhr;\n\tconst x18 = x20 - dxh;\n\tconst y18 = y20 - dyh;\n\tconst x19 = x18 + dxhr;\n\tconst y19 = y18 + dyhr;\n\tconst x22 = x20 + dxh;\n\tconst y22 = y20 + dyh;\n\tconst x21 = x22 - dxhr;\n\tconst y21 = y22 - dyhr;\n\n\t// World size\n\tworldSize[ 0 ] = toLength( x0, y0, x1, y1 );\n\tworldSize[ 1 ] = toLength( x0, y0, x2, y2 );\n\tworldSize[ 2 ] = toLength( x0, y0, x10, y10 );\n\n\t// Vertices\n\tlet iv = voffset * 2;\n\n\t// Top-left corner\n\tvertices[ iv + 0 ] = x0;\n\tvertices[ iv + 1 ] = y0;\n\tvertices[ iv + 2 ] = x1;\n\tvertices[ iv + 3 ] = y1;\n\tvertices[ iv + 4 ] = x5;\n\tvertices[ iv + 5 ] = y5;\n\tvertices[ iv + 6 ] = x6;\n\tvertices[ iv + 7 ] = y6;\n\tiv += 8;\n\n\t// Top-right corner\n\tvertices[ iv + 0 ] = x3;\n\tvertices[ iv + 1 ] = y3;\n\tvertices[ iv + 2 ] = x4;\n\tvertices[ iv + 3 ] = y4;\n\tvertices[ iv + 4 ] = x8;\n\tvertices[ iv + 5 ] = y8;\n\tvertices[ iv + 6 ] = x9;\n\tvertices[ iv + 7 ] = y9;\n\tiv += 8;\n\n\t// Bottom-left corner\n\tvertices[ iv + 0 ] = x13;\n\tvertices[ iv + 1 ] = y13;\n\tvertices[ iv + 2 ] = x14;\n\tvertices[ iv + 3 ] = y14;\n\tvertices[ iv + 4 ] = x18;\n\tvertices[ iv + 5 ] = y18;\n\tvertices[ iv + 6 ] = x19;\n\tvertices[ iv + 7 ] = y19;\n\tiv += 8;\n\n\t// Bottom-right corner\n\tvertices[ iv + 0 ] = x16;\n\tvertices[ iv + 1 ] = y16;\n\tvertices[ iv + 2 ] = x17;\n\tvertices[ iv + 3 ] = y17;\n\tvertices[ iv + 4 ] = x21;\n\tvertices[ iv + 5 ] = y21;\n\tvertices[ iv + 6 ] = x22;\n\tvertices[ iv + 7 ] = y22;\n\tiv += 8;\n\n\t// Top edge\n\tvertices[ iv + 0 ] = x1;\n\tvertices[ iv + 1 ] = y1;\n\tvertices[ iv + 2 ] = x2;\n\tvertices[ iv + 3 ] = y2;\n\tvertices[ iv + 4 ] = x3;\n\tvertices[ iv + 5 ] = y3;\n\tiv += 6;\n\n\t// Top\n\tvertices[ iv + 0 ] = x5;\n\tvertices[ iv + 1 ] = y5;\n\tvertices[ iv + 2 ] = x6;\n\tvertices[ iv + 3 ] = y6;\n\tvertices[ iv + 4 ] = x7;\n\tvertices[ iv + 5 ] = y7;\n\tvertices[ iv + 6 ] = x8;\n\tvertices[ iv + 7 ] = y8;\n\tvertices[ iv + 8 ] = x9;\n\tvertices[ iv + 9 ] = y9;\n\tiv += 10;\n\n\t// Middle\n\tvertices[ iv + 0 ] = x10;\n\tvertices[ iv + 1 ] = y10;\n\tvertices[ iv + 2 ] = x11;\n\tvertices[ iv + 3 ] = y11;\n\tvertices[ iv + 4 ] = x11;\n\tvertices[ iv + 5 ] = y11;\n\tvertices[ iv + 6 ] = x12;\n\tvertices[ iv + 7 ] = y12;\n\tiv += 8;\n\n\t// Bottom\n\tvertices[ iv + 0 ] = x13;\n\tvertices[ iv + 1 ] = y13;\n\tvertices[ iv + 2 ] = x14;\n\tvertices[ iv + 3 ] = y14;\n\tvertices[ iv + 4 ] = x15;\n\tvertices[ iv + 5 ] = y15;\n\tvertices[ iv + 6 ] = x16;\n\tvertices[ iv + 7 ] = y16;\n\tvertices[ iv + 8 ] = x17;\n\tvertices[ iv + 9 ] = y17;\n\tiv += 10;\n\n\t// Bottom edge\n\tvertices[ iv + 0 ] = x19;\n\tvertices[ iv + 1 ] = y19;\n\tvertices[ iv + 2 ] = x20;\n\tvertices[ iv + 3 ] = y20;\n\tvertices[ iv + 4 ] = x21;\n\tvertices[ iv + 5 ] = y21;\n};\n\nexport const buildRectangleRoundedClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tcorner: EShapeCorner,\n\tworldSize: [ number, number, number ]\n): void => {\n\tlet ic = voffset * 3;\n\tconst rxc = 1 - worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ryc = 1 - worldSize[ 0 ] / worldSize[ 2 ];\n\n\t// Top-left corner\n\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Top-right corner\n\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Top edge\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Top\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Middle\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Bottom\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Bottom edge\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n};\n\nexport const buildRectangleRoundedStep = (\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tvoffset: number,\n\tstrokeWidth: number,\n\tstrokeSide: EShapeStrokeSide,\n\tcorner: EShapeCorner,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number ],\n\tworkStep: Float32Array\n): void => {\n\ttoStep( worldSize[ 0 ], strokeWidth, antialiasWeight, workStep );\n\tconst swc = workStep[ 0 ];\n\tconst pc0 = workStep[ 1 ];\n\tconst pc1 = workStep[ 2 ];\n\n\ttoStep( worldSize[ 1 ], strokeWidth, antialiasWeight, workStep );\n\tconst swx = workStep[ 0 ];\n\tconst px0 = workStep[ 1 ];\n\tconst px1 = workStep[ 2 ];\n\n\ttoStep( worldSize[ 2 ], strokeWidth, antialiasWeight, workStep );\n\tconst swy = workStep[ 0 ];\n\tconst py0 = workStep[ 1 ];\n\tconst py1 = workStep[ 2 ];\n\n\tlet is = voffset * 2;\n\tlet ia = voffset * 4;\n\tconst rxc = 1 - worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ryc = 1 - worldSize[ 0 ] / worldSize[ 2 ];\n\n\tlet swt = swy;\n\tlet pt0 = py0;\n\tlet swtc = swc;\n\tlet ptc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\tswt = 1;\n\t\tpt0 = py1;\n\t\tswtc = 1;\n\t\tptc0 = pc1;\n\t}\n\tlet swr = swx;\n\tlet pr0 = px0;\n\tlet swrc = swc;\n\tlet prc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\tswr = 1;\n\t\tpr0 = px1;\n\t\tswrc = 1;\n\t\tprc0 = pc1;\n\t}\n\tlet swb = swy;\n\tlet pb0 = py0;\n\tlet swbc = swc;\n\tlet pbc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\tswb = 1;\n\t\tpb0 = py1;\n\t\tswbc = 1;\n\t\tpbc0 = pc1;\n\t}\n\tlet swl = swx;\n\tlet pl0 = px0;\n\tlet swlc = swc;\n\tlet plc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\tswl = 1;\n\t\tpl0 = px1;\n\t\tswlc = 1;\n\t\tplc0 = pc1;\n\t}\n\tconst plr0 = 0.5 * (pl0 + pr0);\n\tconst ptb0 = 0.5 * (pt0 + pb0);\n\n\t// Top-left corner\n\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\t} else {\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\t}\n\n\t// Top-right corner\n\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = ptc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\t} else {\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swt;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pt0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\t}\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tantialiases[ ia + 0 ] = plc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\t} else {\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pl0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\t}\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tantialiases[ ia + 0 ] = prc0;\n\t\tantialiases[ ia + 1 ] = pbc0;\n\t\tantialiases[ ia + 2 ] = pc1;\n\t\tantialiases[ ia + 3 ] = pc1;\n\t\tis += 2;\n\t\tia += 4;\n\t} else {\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swb;\n\t\tantialiases[ ia + 0 ] = pr0;\n\t\tantialiases[ ia + 1 ] = pb0;\n\t\tantialiases[ ia + 2 ] = px1;\n\t\tantialiases[ ia + 3 ] = py1;\n\t\tis += 2;\n\t\tia += 4;\n\t}\n\n\t// Top edge\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swt;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swt;\n\tantialiases[ ia + 0 ] = plr0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swt;\n\tantialiases[ ia + 0 ] = plr0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\t// Top\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = swt * ryc;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swt * ryc;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swt * ryc;\n\tantialiases[ ia + 0 ] = plr0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swt * ryc;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = swt * ryc;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = pt0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\t// Middle\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = 0;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = ptb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = 0;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = ptb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = 0;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = ptb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = 0;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = ptb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\t// Bottom\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = swb * ryc;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swb * ryc;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swb * ryc;\n\tantialiases[ ia + 0 ] = plr0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swb * ryc;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = swb * ryc;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\t// Bottom edge\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swb;\n\tantialiases[ ia + 0 ] = pl0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swb;\n\tantialiases[ ia + 0 ] = plr0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swb;\n\tantialiases[ ia + 0 ] = pr0;\n\tantialiases[ ia + 1 ] = pb0;\n\tantialiases[ ia + 2 ] = px1;\n\tantialiases[ ia + 3 ] = py1;\n\tis += 2;\n\tia += 4;\n};\n\nexport const buildRectangleRoundedUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * (x0 + x1);\n\tconst y4 = 0.5 * (y0 + y1);\n\tconst x5 = 0.5 * (x3 + x2);\n\tconst y5 = 0.5 * (y3 + y2);\n\n\tconst ruvx = 0.5 * worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ruvy = 0.5 * worldSize[ 0 ] / worldSize[ 2 ];\n\tconst d0x = ruvx * (x1 - x0);\n\tconst d0y = ruvx * (y1 - y0);\n\tconst d1x = ruvy * (x3 - x0);\n\tconst d1y = ruvy * (y3 - y0);\n\n\t// UVs\n\tlet iuv = voffset * 2;\n\n\t// Top-left corner\n\tuvs[ iuv + 0 ] = x0;\n\tuvs[ iuv + 1 ] = y0;\n\tuvs[ iuv + 2 ] = x0 + d0x;\n\tuvs[ iuv + 3 ] = y0 + d0y;\n\tuvs[ iuv + 4 ] = x0 + d1x;\n\tuvs[ iuv + 5 ] = y0 + d1y;\n\tuvs[ iuv + 6 ] = x0 + d0x + d1x;\n\tuvs[ iuv + 7 ] = y0 + d0y + d1y;\n\tiuv += 8;\n\n\t// Top-right corner\n\tuvs[ iuv + 0 ] = x1 - d0x;\n\tuvs[ iuv + 1 ] = y1 - d0y;\n\tuvs[ iuv + 2 ] = x1;\n\tuvs[ iuv + 3 ] = y1;\n\tuvs[ iuv + 4 ] = x1 - d0x + d1x;\n\tuvs[ iuv + 5 ] = y1 - d0y + d1y;\n\tuvs[ iuv + 6 ] = x1 + d1x;\n\tuvs[ iuv + 7 ] = y1 + d1y;\n\tiuv += 8;\n\n\t// Bottom-left corner\n\tuvs[ iuv + 0 ] = x3 - d1x;\n\tuvs[ iuv + 1 ] = y3 - d1y;\n\tuvs[ iuv + 2 ] = x3 + d0x - d1x;\n\tuvs[ iuv + 3 ] = y3 + d0y - d1y;\n\tuvs[ iuv + 4 ] = x3;\n\tuvs[ iuv + 5 ] = y3;\n\tuvs[ iuv + 6 ] = x3 + d0x;\n\tuvs[ iuv + 7 ] = y3 + d0y;\n\tiuv += 8;\n\n\t// Bottom-right corner\n\tuvs[ iuv + 0 ] = x2 - d0x - d1x;\n\tuvs[ iuv + 1 ] = y2 - d0y - d1y;\n\tuvs[ iuv + 2 ] = x2 - d1x;\n\tuvs[ iuv + 3 ] = y2 - d1y;\n\tuvs[ iuv + 4 ] = x2 - d0x;\n\tuvs[ iuv + 5 ] = y2 - d0y;\n\tuvs[ iuv + 6 ] = x2;\n\tuvs[ iuv + 7 ] = y2;\n\tiuv += 8;\n\n\t// Top edge\n\tuvs[ iuv + 0 ] = x0 + d0x;\n\tuvs[ iuv + 1 ] = y0 + d0y;\n\tuvs[ iuv + 2 ] = x4;\n\tuvs[ iuv + 3 ] = y4;\n\tuvs[ iuv + 4 ] = x1 - d0x;\n\tuvs[ iuv + 5 ] = y1 - d0y;\n\tiuv += 6;\n\n\t// Top\n\tuvs[ iuv + 0 ] = x0 + d1x;\n\tuvs[ iuv + 1 ] = y0 + d1y;\n\tuvs[ iuv + 2 ] = x0 + d1x + d0x;\n\tuvs[ iuv + 3 ] = y0 + d1y + d0y;\n\tuvs[ iuv + 4 ] = x4 + d1x;\n\tuvs[ iuv + 5 ] = y4 + d1y;\n\tuvs[ iuv + 6 ] = x1 + d1x - d0x;\n\tuvs[ iuv + 7 ] = y1 + d1y - d0y;\n\tuvs[ iuv + 8 ] = x1 + d1x;\n\tuvs[ iuv + 9 ] = y1 + d1y;\n\tiuv += 10;\n\n\t// Middle\n\tconst x02 = 0.5 * (x0 + x2);\n\tconst y02 = 0.5 * (y0 + y2);\n\tuvs[ iuv + 0 ] = 0.5 * (x0 + x3);\n\tuvs[ iuv + 1 ] = 0.5 * (y0 + y3);\n\tuvs[ iuv + 2 ] = x02;\n\tuvs[ iuv + 3 ] = y02;\n\tuvs[ iuv + 4 ] = x02;\n\tuvs[ iuv + 5 ] = y02;\n\tuvs[ iuv + 6 ] = 0.5 * (x1 + x2);\n\tuvs[ iuv + 7 ] = 0.5 * (y1 + y2);\n\tiuv += 8;\n\n\t// Bottom\n\tuvs[ iuv + 0 ] = x3 - d1x;\n\tuvs[ iuv + 1 ] = y3 - d1y;\n\tuvs[ iuv + 2 ] = x3 - d1x + d0x;\n\tuvs[ iuv + 3 ] = y3 - d1y + d0y;\n\tuvs[ iuv + 4 ] = x5 - d1x;\n\tuvs[ iuv + 5 ] = y5 - d1y;\n\tuvs[ iuv + 6 ] = x2 - d1x - d0x;\n\tuvs[ iuv + 7 ] = y2 - d1y - d0y;\n\tuvs[ iuv + 8 ] = x2 - d1x;\n\tuvs[ iuv + 9 ] = y2 - d1y;\n\tiuv += 10;\n\n\t// Bottom edge\n\tuvs[ iuv + 0 ] = x3 + d0x;\n\tuvs[ iuv + 1 ] = y3 + d0y;\n\tuvs[ iuv + 2 ] = x5;\n\tuvs[ iuv + 3 ] = y5;\n\tuvs[ iuv + 4 ] = x2 - d0x;\n\tuvs[ iuv + 5 ] = y2 - d0y;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleRoundedClipping, buildRectangleRoundedIndex, buildRectangleRoundedStep, buildRectangleRoundedUv,\n\tbuildRectangleRoundedVertex, RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\tRECTANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-rectangle-rounded\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfRectangleRoundedsUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tbuildRectangleRoundedIndex(\n\t\t\tindices,\n\t\t\tvoffset,\n\t\t\tioffset\n\t\t);\n\t\tcopyIndex(\n\t\t\tindices,\n\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\tioffset,\n\t\t\tRECTANGLE_ROUNDED_INDEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPoints ) {\n\t\t\tthis.updateVertexClippingStepAndUv( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, RECTANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, RECTANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexClippingStepAndUv(\n\t\tbuffer: EShapeBuffer,\n\t\tshape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints\n\t): void {\n\t\tconst pointId = points.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst radius = shape.radius;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY || radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t}\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.clippingBuffer.update();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t}\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst work = buffer.work;\n\t\t\tconst workStep = buffer.workStep;\n\t\t\tif( pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\t// Vertices\n\t\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues\n\t\t\t\t);\n\n\t\t\t\t// Steps & antialiases\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\tworkStep\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Clippings\n\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// UVs\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ];\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ];\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\n\t\t\t\t\tconst iv = voffset + i * RECTANGLE_ROUNDED_VERTEX_COUNT;\n\n\t\t\t\t\t// Vertices\n\t\t\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\twork\n\t\t\t\t\t);\n\n\t\t\t\t\t// Steps & antialiases\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\t\tworkStep\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Clippings\n\t\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// UVs\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT } from \"./build-rectangle-rounded\";\nimport { EShapeLineOfAnyUploadeds } from \"./e-shape-line-of-any-uploadeds\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\nimport { EShapeLineOfRectangleRoundedsUploaded } from \"./e-shape-line-of-rectangle-roundeds-uploaded\";\n\nexport class EShapeLineOfRectangleRoundedsUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineOfRectangleRoundedsUploaded | EShapeLineOfNullsUploaded | null {\n\t\treturn EShapeLineOfAnyUploadeds.create(\n\t\t\tbuffer, shape,\n\t\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\tioffset, RECTANGLE_ROUNDED_INDEX_COUNT,\n\t\t\tantialiasWeight,\n\t\t\tEShapeLineOfRectangleRoundedsUploaded\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangleRounded extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangleRounded {\n\t\treturn new EShapeRectangleRounded().copy( this );\n\t}\n\n\tprivate containsAbs_( x: number, y: number, ax: number, ay: number, r: number, corner: EShapeCorner ): boolean {\n\t\tconst bx0 = -ax + r;\n\t\tif( x <= bx0 ) {\n\t\t\tconst by0 = -ay + r;\n\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_LEFT) ) {\n\t\t\t\t// Top-left corner\n\t\t\t\tconst dx = x - bx0;\n\t\t\t\tconst dy = y - by0;\n\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t} else {\n\t\t\t\tconst by1 = +ay - r;\n\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst dx = x - bx0;\n\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\t// Middle-left box\n\t\t\t\t\treturn -ax <= x;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst bx1 = +ax - r;\n\t\t\tif( bx1 <= x ) {\n\t\t\t\tconst by0 = -ay + r;\n\t\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_RIGHT) ) {\n\t\t\t\t\t// Top-right corner\n\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\tconst dy = y - by0;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\tconst by1 = +ay - r;\n\t\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Middle-right box\n\t\t\t\t\t\treturn x <= +ax;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn -ay <= y && y <= +ay;\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tif( fill.enable || 0 < strokeWidth ) {\n\t\t\t\tconst r = this.radius * Math.min( ax, ay );\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( this.containsAbs_( x, y, ax, ay, r, corner ) ) {\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\t\tconst wr = Math.max( 0.0, r - strokeWidth );\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, wx, wy, wr, corner ) ) {\n\t\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( x <= -wx + wr ) {\n\t\t\t\t\t\t\t\t\tconst hasLeftSide = ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasLeftSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if( +wx - wr <= x ) {\n\t\t\t\t\t\t\t\t\tconst hasRightSide = ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasRightSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeRectangleRounded } from \"./e-shape-rectangle-rounded\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfRectangleRoundeds extends EShapeRectangleRounded implements EShapeLineOfAny {\n\tpoints!: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfRectangleRoundeds ) {\n\t\tsuper( EShapeType.LINE_OF_RECTANGLE_ROUNDEDS );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis.points = new EShapeLineOfAnyPoints( this );\n\t\t}\n\n\t\tthis._tester = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, px, py );\n\t\t};\n\t}\n\n\tclone(): EShapeLineOfRectangleRoundeds {\n\t\treturn new EShapeLineOfRectangleRoundeds( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbs( x - px, y - py, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbsBBox( x - px, y - py, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfRectangleRoundeds } from \"./e-shape-line-of-rectangle-roundeds\";\n\nexport class EShapeLinesOfRectangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLineOfRectangleRoundeds> | EShapeLineOfRectangleRoundeds {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfRectangleRoundeds() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineOfRectangleRoundedsUploadeds } from \"../shape/variant/e-shape-line-of-rectangle-roundeds-uploadeds\";\nimport { EShapeLinesOfRectangleRoundeds } from \"../shape/variant/e-shape-lines-of-rectangle-roundeds\";\n\nexport const loadShapeLineOfRectangleRoundeds = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_RECTANGLE_ROUNDEDS ] = EShapeLineOfRectangleRoundedsUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE_OF_RECTANGLE_ROUNDEDS ] = EShapeLinesOfRectangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_RECTANGLE_ROUNDEDS,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleClipping, buildRectangleIndex, buildRectangleUv, buildRectangleVertexAndStep,\n\tRECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT\n} from \"./build-rectangle\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfRectanglesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tbuildRectangleClipping(\n\t\t\tclippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildRectangleIndex(\n\t\t\tindices,\n\t\t\tvoffset,\n\t\t\tioffset\n\t\t);\n\t\tcopyClipping(\n\t\t\tclippings,\n\t\t\tvoffset,\n\t\t\tRECTANGLE_VERTEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\t\tcopyIndex(\n\t\t\tindices,\n\t\t\tRECTANGLE_VERTEX_COUNT,\n\t\t\tioffset,\n\t\t\tRECTANGLE_INDEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPoints ) {\n\t\t\tthis.updateVertexAndStep( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, RECTANGLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, RECTANGLE_VERTEX_COUNT );\n\t\t\tthis.updateUv( buffer, shape );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexAndStep( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\n\t\tconst pointId = points.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tif( isPointChanged || isPointSizeChanged || isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst work = buffer.work;\n\t\t\tconst workStep = buffer.workStep;\n\t\t\tif( pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\tbuildRectangleVertexAndStep(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, strokeSide, true,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tantialiasWeight,\n\t\t\t\t\twork, workStep\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues\n\t\t\t\t);\n\t\t\t\tcopyStep(\n\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ];\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ];\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tbuildRectangleVertexAndStep(\n\t\t\t\t\t\tvertices, voffset + i * RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, strokeSide, true,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\twork, workStep\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tbuildRectangleUv( uvs, voffset, textureUvs );\n\t\t\tcopyUvs( uvs, voffset, RECTANGLE_VERTEX_COUNT, this.pointCount );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT } from \"./build-rectangle\";\nimport { EShapeLineOfAnyUploadeds } from \"./e-shape-line-of-any-uploadeds\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\nimport { EShapeLineOfRectanglesUploaded } from \"./e-shape-line-of-rectangles-uploaded\";\n\nexport class EShapeLineOfRectanglesUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineOfRectanglesUploaded | EShapeLineOfNullsUploaded | null {\n\t\treturn EShapeLineOfAnyUploadeds.create(\n\t\t\tbuffer, shape,\n\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\tioffset, RECTANGLE_INDEX_COUNT,\n\t\t\tantialiasWeight,\n\t\t\tEShapeLineOfRectanglesUploaded\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfRectangles extends EShapeRectangle implements EShapeLineOfAny {\n\tpoints!: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfRectangles ) {\n\t\tsuper( EShapeType.LINE_OF_RECTANGLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis.points = new EShapeLineOfAnyPoints( this );\n\t\t}\n\n\t\tthis._tester = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, px, py );\n\t\t};\n\t}\n\n\tclone(): EShapeLineOfRectangles {\n\t\treturn new EShapeLineOfRectangles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbs( x - px, y - py, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbsBBox( x - px, y - py, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfRectangles } from \"./e-shape-line-of-rectangles\";\n\nexport class EShapeLinesOfRectangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLineOfRectangles> | EShapeLineOfRectangles {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfRectangles() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineOfRectanglesUploadeds } from \"../shape/variant/e-shape-line-of-rectangles-uploadeds\";\nimport { EShapeLinesOfRectangles } from \"../shape/variant/e-shape-lines-of-rectangles\";\n\nexport const loadShapeLineOfRectangles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_RECTANGLES ] = EShapeLineOfRectanglesUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE_OF_RECTANGLES ] = EShapeLinesOfRectangles.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_RECTANGLES,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE\n\t);\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { toLength } from \"./to-length\";\nimport { toStep } from \"./to-step\";\n\nexport const TRIANGLE_ROUNDED_VERTEX_COUNT = 22;\nexport const TRIANGLE_ROUNDED_INDEX_COUNT = 15;\nexport const TRIANGLE_ROUNDED_WORLD_SIZE: [ number, number, number, number, number ] = [ 0, 0, 0, 0, 0 ];\n\nexport const buildTriangleRoundedIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Top corner\n\tconst ii = ioffset * 3;\n\tindices[ ii +  0 ] = voffset + 0;\n\tindices[ ii +  1 ] = voffset + 1;\n\tindices[ ii +  2 ] = voffset + 3;\n\n\tindices[ ii +  3 ] = voffset + 1;\n\tindices[ ii +  4 ] = voffset + 2;\n\tindices[ ii +  5 ] = voffset + 3;\n\n\t// Bottom-right corner\n\tindices[ ii +  6 ] = voffset + 4;\n\tindices[ ii +  7 ] = voffset + 5;\n\tindices[ ii +  8 ] = voffset + 7;\n\n\tindices[ ii +  9 ] = voffset + 5;\n\tindices[ ii + 10 ] = voffset + 6;\n\tindices[ ii + 11 ] = voffset + 7;\n\n\t// Bottom-left corner\n\tindices[ ii + 12 ] = voffset + 8;\n\tindices[ ii + 13 ] = voffset + 9;\n\tindices[ ii + 14 ] = voffset + 11;\n\n\tindices[ ii + 15 ] = voffset + 9;\n\tindices[ ii + 16 ] = voffset + 10;\n\tindices[ ii + 17 ] = voffset + 11;\n\n\t// Others\n\tindices[ ii + 18 ] = voffset + 12;\n\tindices[ ii + 19 ] = voffset + 13;\n\tindices[ ii + 20 ] = voffset + 16;\n\n\tindices[ ii + 21 ] = voffset + 13;\n\tindices[ ii + 22 ] = voffset + 14;\n\tindices[ ii + 23 ] = voffset + 16;\n\n\tindices[ ii + 24 ] = voffset + 14;\n\tindices[ ii + 25 ] = voffset + 15;\n\tindices[ ii + 26 ] = voffset + 16;\n\n\t//\n\tindices[ ii + 27 ] = voffset + 12;\n\tindices[ ii + 28 ] = voffset + 16;\n\tindices[ ii + 29 ] = voffset + 19;\n\n\tindices[ ii + 30 ] = voffset + 16;\n\tindices[ ii + 31 ] = voffset + 17;\n\tindices[ ii + 32 ] = voffset + 19;\n\n\tindices[ ii + 33 ] = voffset + 17;\n\tindices[ ii + 34 ] = voffset + 18;\n\tindices[ ii + 35 ] = voffset + 19;\n\n\t//\n\tindices[ ii + 36 ] = voffset + 12;\n\tindices[ ii + 37 ] = voffset + 19;\n\tindices[ ii + 38 ] = voffset + 13;\n\n\tindices[ ii + 39 ] = voffset + 19;\n\tindices[ ii + 40 ] = voffset + 20;\n\tindices[ ii + 41 ] = voffset + 13;\n\n\tindices[ ii + 42 ] = voffset + 20;\n\tindices[ ii + 43 ] = voffset + 21;\n\tindices[ ii + 44 ] = voffset + 13;\n};\n\nexport const buildTriangleRoundedVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number, number, number ],\n\twork: Point\n): void => {\n\t// Calculate the transformed positions\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\tconst sw = 2 * sx * sy / (sx + sz);\n\tconst ry = ( sw * radius ) / ( 2 * sy );\n\tconst rz = ( 0.5 * ( sz - sw ) * radius ) / ( sz );\n\tconst rx = ( ry * sz ) / ( 2 * sx );\n\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst tx = work.x;\n\tconst ty = work.y;\n\twork.set( originX + sx, originY );\n\tinternalTransform.apply( work, work );\n\tconst dx = tx - x1;\n\tconst dy = ty - y1;\n\tconst x4 = work.x + dx;\n\tconst y4 = work.y + dy;\n\tconst x7 = tx + (tx - work.x) + dx;\n\tconst y7 = ty + (ty - work.y) + dy;\n\tconst dx14 = x4 - x1;\n\tconst dy14 = y4 - y1;\n\tconst x2 = x1 + rz * dx14;\n\tconst y2 = y1 + rz * dy14;\n\tconst x3 = x4 - ry * dx14;\n\tconst y3 = y4 - ry * dy14;\n\tconst dx47r = rx * (x7 - x4);\n\tconst dy47r = rx * (y7 - y4);\n\tconst x5 = x4 + dx47r;\n\tconst y5 = y4 + dy47r;\n\tconst x6 = x7 - dx47r;\n\tconst y6 = y7 - dy47r;\n\tconst dx71 = x1 - x7;\n\tconst dy71 = y1 - y7;\n\tconst x8 = x7 + ry * dx71;\n\tconst y8 = y7 + ry * dy71;\n\tconst x9 = x1 - rz * dx71;\n\tconst y9 = y1 - rz * dy71;\n\twork.set( originX, originY + sy - sw ); // Incenter of a triangle\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\n\tconst x10 = x1 + radius * ( x0 - x1 );\n\tconst y10 = y1 + radius * ( y0 - y1 );\n\tconst x11 = x4 + radius * ( x0 - x4 );\n\tconst y11 = y4 + radius * ( y0 - y4 );\n\tconst x12 = x7 + radius * ( x0 - x7 );\n\tconst y12 = y7 + radius * ( y0 - y7 );\n\n\t// World size\n\tconst xb = tx + dx;\n\tconst yb = ty + dy;\n\tworldSize[ 0 ] = toLength( xb, yb, x0, y0 );\n\tworldSize[ 1 ] = rx;\n\tworldSize[ 2 ] = ry;\n\tworldSize[ 3 ] = rz;\n\tworldSize[ 4 ] = 1 - 0.5 * sw / sy;\n\n\t// Vertices\n\t// Top corner\n\tconst iv = voffset * 2;\n\tvertices[ iv +  0 ] = x10;\n\tvertices[ iv +  1 ] = y10;\n\tvertices[ iv +  2 ] = x9;\n\tvertices[ iv +  3 ] = y9;\n\tvertices[ iv +  4 ] = x1;\n\tvertices[ iv +  5 ] = y1;\n\tvertices[ iv +  6 ] = x2;\n\tvertices[ iv +  7 ] = y2;\n\n\t// Bottom-right corner\n\tvertices[ iv +  8 ] = x11;\n\tvertices[ iv +  9 ] = y11;\n\tvertices[ iv + 10 ] = x3;\n\tvertices[ iv + 11 ] = y3;\n\tvertices[ iv + 12 ] = x4;\n\tvertices[ iv + 13 ] = y4;\n\tvertices[ iv + 14 ] = x5;\n\tvertices[ iv + 15 ] = y5;\n\n\t// Bottom-left corner\n\tvertices[ iv + 16 ] = x12;\n\tvertices[ iv + 17 ] = y12;\n\tvertices[ iv + 18 ] = x6;\n\tvertices[ iv + 19 ] = y6;\n\tvertices[ iv + 20 ] = x7;\n\tvertices[ iv + 21 ] = y7;\n\tvertices[ iv + 22 ] = x8;\n\tvertices[ iv + 23 ] = y8;\n\n\t// Others\n\tvertices[ iv + 24 ] = x0;\n\tvertices[ iv + 25 ] = y0;\n\n\tvertices[ iv + 26 ] = x10;\n\tvertices[ iv + 27 ] = y10;\n\n\tvertices[ iv + 28 ] = x2;\n\tvertices[ iv + 29 ] = y2;\n\tvertices[ iv + 30 ] = x3;\n\tvertices[ iv + 31 ] = y3;\n\n\tvertices[ iv + 32 ] = x11;\n\tvertices[ iv + 33 ] = y11;\n\n\tvertices[ iv + 34 ] = x5;\n\tvertices[ iv + 35 ] = y5;\n\tvertices[ iv + 36 ] = x6;\n\tvertices[ iv + 37 ] = y6;\n\n\tvertices[ iv + 38 ] = x12;\n\tvertices[ iv + 39 ] = y12;\n\n\tvertices[ iv + 40 ] = x8;\n\tvertices[ iv + 41 ] = y8;\n\tvertices[ iv + 42 ] = x9;\n\tvertices[ iv + 43 ] = y9;\n};\n\nexport const buildTriangleRoundedClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tcorner: EShapeCorner,\n\tradius: number\n): void => {\n\t// Top corner\n\tlet iv = voffset * 3;\n\tconst w = 1 - radius;\n\tif( corner & EShapeCorner.TOP ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Others\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n\tiv += 6;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n\tiv += 6;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n};\n\nexport const buildTriangleRoundedStep = (\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number, number, number ],\n\tworkStep: Float32Array\n): void => {\n\tconst wsr = worldSize[ 0 ];\n\ttoStep( wsr, strokeWidth, antialiasWeight, workStep );\n\tconst swc = workStep[ 0 ];\n\tconst pc0 = workStep[ 1 ];\n\tconst pc1 = workStep[ 2 ];\n\n\ttoStep( radius * wsr, strokeWidth, antialiasWeight, workStep );\n\tconst swr = workStep[ 0 ];\n\tconst pr0 = workStep[ 1 ];\n\tconst pr1 = workStep[ 2 ];\n\n\tconst istart = voffset << 1;\n\tconst imax = (voffset + TRIANGLE_ROUNDED_VERTEX_COUNT) << 1;\n\tconst jstart = voffset * 3;\n\tconst kstart = voffset * 4;\n\tfor( let i = istart, j = jstart, k = kstart; i < imax; i += 2, j += 3, k += 4 ) {\n\t\tconst cx = clippings[ j + 0 ];\n\t\tconst cy = clippings[ j + 1 ];\n\t\tconst cz = clippings[ j + 2 ];\n\t\tlet sw = swc;\n\t\tlet p0 = pc0;\n\t\tlet p1 = pc1;\n\t\tif( 0.5 < cz ) {\n\t\t\tsw = swr;\n\t\t\tp0 = pr0;\n\t\t\tp1 = pr1;\n\t\t}\n\t\tsteps[ i + 0 ] = sw * cx;\n\t\tsteps[ i + 1 ] = sw * cy;\n\t\tantialiases[ k + 0 ] = p0;\n\t\tantialiases[ k + 1 ] = p0;\n\t\tantialiases[ k + 2 ] = p1;\n\t\tantialiases[ k + 3 ] = p1;\n\t}\n};\n\nexport const buildTriangleRoundedUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tradius: number,\n\tworldSize: [ number, number, number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * ( x0 + x1 );\n\tconst y4 = 0.5 * ( y0 + y1 );\n\n\tconst c = worldSize[ 4 ];\n\tconst x5 = x4 + c * ( x3 - x0 );\n\tconst y5 = y4 + c * ( y3 - y0 );\n\n\tconst rx = worldSize[ 1 ];\n\tconst ry = worldSize[ 2 ];\n\tconst rz = worldSize[ 3 ];\n\tconst x6 = x4 + rz * (x3 - x4);\n\tconst y6 = y4 + rz * (y3 - y4);\n\tconst x7 = x4 + radius * (x5 - x4);\n\tconst y7 = y4 + radius * (y5 - y4);\n\tconst x8 = x4 + rz * (x2 - x4);\n\tconst y8 = y4 + rz * (y2 - y4);\n\n\tconst x9 = x2 + ry * (x4 - x2);\n\tconst y9 = y2 + ry * (y4 - y2);\n\tconst x10 = x2 + radius * (x5 - x2);\n\tconst y10 = y2 + radius * (y5 - y2);\n\tconst x11 = x2 + rx * (x3 - x2);\n\tconst y11 = y2 + rx * (y3 - y2);\n\n\tconst x12 = x3 + rx * (x2 - x3);\n\tconst y12 = y3 + rx * (y2 - y3);\n\tconst x13 = x3 + radius * (x5 - x3);\n\tconst y13 = y3 + radius * (y5 - y3);\n\tconst x14 = x3 + ry * (x4 - x3);\n\tconst y14 = y3 + ry * (y4 - y3);\n\n\t// Uvs\n\t// Top corner\n\tlet iuv = voffset * 2;\n\tuvs[ iuv + 0 ] = x7;\n\tuvs[ iuv + 1 ] = y7;\n\tuvs[ iuv + 2 ] = x6;\n\tuvs[ iuv + 3 ] = y6;\n\tuvs[ iuv + 4 ] = x4;\n\tuvs[ iuv + 5 ] = y4;\n\tuvs[ iuv + 6 ] = x8;\n\tuvs[ iuv + 7 ] = y8;\n\tiuv += 8;\n\n\t// Bottom-right corner\n\tuvs[ iuv + 0 ] = x10;\n\tuvs[ iuv + 1 ] = y10;\n\tuvs[ iuv + 2 ] = x9;\n\tuvs[ iuv + 3 ] = y9;\n\tuvs[ iuv + 4 ] = x2;\n\tuvs[ iuv + 5 ] = y2;\n\tuvs[ iuv + 6 ] = x11;\n\tuvs[ iuv + 7 ] = y11;\n\tiuv += 8;\n\n\t// Bottom-left corner\n\tuvs[ iuv + 0 ] = x13;\n\tuvs[ iuv + 1 ] = y13;\n\tuvs[ iuv + 2 ] = x12;\n\tuvs[ iuv + 3 ] = y12;\n\tuvs[ iuv + 4 ] = x3;\n\tuvs[ iuv + 5 ] = y3;\n\tuvs[ iuv + 6 ] = x14;\n\tuvs[ iuv + 7 ] = y14;\n\tiuv += 8;\n\n\t// Others\n\tuvs[ iuv +  0 ] = x5;\n\tuvs[ iuv +  1 ] = y5;\n\n\tuvs[ iuv +  2 ] = x7;\n\tuvs[ iuv +  3 ] = y7;\n\n\tuvs[ iuv +  4 ] = x8;\n\tuvs[ iuv +  5 ] = y8;\n\tuvs[ iuv +  6 ] = x9;\n\tuvs[ iuv +  7 ] = y9;\n\n\tuvs[ iuv +  8 ] = x10;\n\tuvs[ iuv +  9 ] = y10;\n\n\tuvs[ iuv + 10 ] = x11;\n\tuvs[ iuv + 11 ] = y11;\n\tuvs[ iuv + 12 ] = x12;\n\tuvs[ iuv + 13 ] = y12;\n\n\tuvs[ iuv + 14 ] = x13;\n\tuvs[ iuv + 15 ] = y13;\n\n\tuvs[ iuv + 16 ] = x14;\n\tuvs[ iuv + 17 ] = y14;\n\tuvs[ iuv + 18 ] = x6;\n\tuvs[ iuv + 19 ] = y6;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleRoundedClipping, buildTriangleRoundedIndex, buildTriangleRoundedStep,\n\tbuildTriangleRoundedUv, buildTriangleRoundedVertex, TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\tTRIANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-triangle-rounded\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfTriangleRoundedsUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.indexBuffer.update();\n\t\tbuildTriangleRoundedIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\t\tcopyIndex(\n\t\t\tbuffer.indices,\n\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\tthis.indexOffset,\n\t\t\tTRIANGLE_ROUNDED_INDEX_COUNT,\n\t\t\tthis.pointCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPoints ) {\n\t\t\tthis.updateVertexClippingStepAndUv( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, TRIANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, TRIANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexClippingStepAndUv(\n\t\tbuffer: EShapeBuffer,\n\t\tshape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints\n\t): void {\n\t\tconst pointId = points.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst radius = shape.radius;\n\t\tconst isRadiusChanged = ( radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( this.corner !== corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isRadiusChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.clippingBuffer.update();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t}\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst work = buffer.work;\n\t\t\tconst workStep = buffer.workStep;\n\t\t\tif( pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\t// Vertices\n\t\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues\n\t\t\t\t);\n\n\t\t\t\t// Clippings\n\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tradius\n\t\t\t\t\t);\n\t\t\t\t\tcopyClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Steps & antialiases\n\t\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tradius,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\tworkStep\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// UVs\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tradius,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ];\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ];\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\n\t\t\t\t\tconst iv = voffset + i * TRIANGLE_ROUNDED_VERTEX_COUNT;\n\n\t\t\t\t\t// Vertices\n\t\t\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\twork\n\t\t\t\t\t);\n\n\t\t\t\t\t// Clippings\n\t\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tradius\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Steps & antialiases\n\t\t\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tradius,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\t\t\tworkStep\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// UVs\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tradius,\n\t\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT } from \"./build-triangle-rounded\";\nimport { EShapeLineOfAnyUploadeds } from \"./e-shape-line-of-any-uploadeds\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\nimport { EShapeLineOfTriangleRoundedsUploaded } from \"./e-shape-line-of-triangle-roundeds-uploaded\";\n\nexport class EShapeLineOfTriangleRoundedsUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineOfTriangleRoundedsUploaded | EShapeLineOfNullsUploaded | null {\n\t\treturn EShapeLineOfAnyUploadeds.create(\n\t\t\tbuffer, shape,\n\t\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\tioffset, TRIANGLE_ROUNDED_INDEX_COUNT,\n\t\t\tantialiasWeight,\n\t\t\tEShapeLineOfTriangleRoundedsUploaded\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeTriangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.TRIANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangle {\n\t\treturn new EShapeTriangle().copy( this );\n\t}\n\n\tprotected containsAbs_( x: number, y: number, a: number, ay1: number, ay2: number ): boolean {\n\t\t// a = 2 * ay / ax\n\t\t// y = + a * x + ay1\n\t\t// y = - a * x + ay1\n\t\t// y = ay2;\n\t\treturn ( +a * x + ay1 - y <= 0 && -a * x + ay1 - y <= 0 && y <= ay2 );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tconst fill = this.fill;\n\t\t\tif( fill.enable ) {\n\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\n\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nconst FMIN = 0.00001;\n\nexport class EShapeTriangleRounded extends EShapeTriangle {\n\tconstructor( type = EShapeType.TRIANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangleRounded {\n\t\treturn new EShapeTriangleRounded().copy( this );\n\t}\n\n\tprotected containsCorner_( x: number, y: number, r: number, aw: number ) {\n\t\tconst fill = this.fill;\n\t\tif( fill.enable ) {\n\t\t\tif( x * x + y * y <= r * r ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = stroke.width;\n\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\tconst d = x * x + y * y;\n\t\t\t\tif( d <= r * r ) {\n\t\t\t\t\tconst w = Math.max( 0.0, r * ( 1 - strokeWidth / aw ) );\n\t\t\t\t\tif( w * w <= d ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected containsCorner(\n\t\tx: number, y: number,\n\t\tx0: number, y0: number,\n\t\tx1: number, y1: number,\n\t\tx2: number, y2: number,\n\t\tx3: number, y3: number,\n\t\tr12: number, r13: number,\n\t\taw: number,\n\t\tradius: number\n\t) {\n\t\tconst xl = x1 + r12 * ( x2 - x1 ) - x0;\n\t\tconst yl = y1 + r12 * ( y2 - y1 ) - y0;\n\t\tconst n = Math.sqrt( xl * xl + yl * yl );\n\t\tif( FMIN < n ) {\n\t\t\tconst ni = 1 / n;\n\t\t\tconst nlx = xl * ni;\n\t\t\tconst nly = yl * ni;\n\n\t\t\tconst xr = x1 + r13 * ( x3 - x1 ) - x0;\n\t\t\tconst yr = y1 + r13 * ( y3 - y1 ) - y0;\n\t\t\tconst nrx = xr * ni;\n\t\t\tconst nry = yr * ni;\n\n\t\t\tconst det = nlx * nry - nrx * nly;\n\t\t\tif( FMIN < Math.abs( det ) ) {\n\t\t\t\tconst deti = 1 / det;\n\t\t\t\tconst xc = x - x0;\n\t\t\t\tconst yc = y - y0;\n\t\t\t\tconst dx = ( +nry * xc - nrx * yc ) * deti;\n\t\t\t\tconst dy = ( -nly * xc + nlx * yc ) * deti;\n\t\t\t\tif( this.containsCorner_( dx, dy, n, aw * radius ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ) {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\t\t\t\tconst radius = this.radius;\n\n\t\t\t\tconst x0 = 0;\n\t\t\t\tconst y0 = ay - aw;\n\t\t\t\tconst x1 = 0;\n\t\t\t\tconst y1 = -ay;\n\t\t\t\tconst x4 = +ax;\n\t\t\t\tconst y4 = +ay;\n\t\t\t\tconst x7 = -x4;\n\t\t\t\tconst y7 = +y4;\n\t\t\t\tconst x10 = x1 + radius * ( x0 - x1 );\n\t\t\t\tconst y10 = y1 + radius * ( y0 - y1 );\n\t\t\t\tconst x11 = x4 + radius * ( x0 - x4 );\n\t\t\t\tconst y11 = y4 + radius * ( y0 - y4 );\n\t\t\t\tconst y12 = +y11;\n\t\t\t\tconst x12 = -x11;\n\n\t\t\t\tconst c0 = -a * x + y10 - y <= 0;\n\t\t\t\tconst c1 = +a * x + y10 - y <= 0;\n\t\t\t\tconst c2 = y <= y11;\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tif( ! c0 && ! c1 && (corner & EShapeCorner.TOP) ) {\n\t\t\t\t\t// Top corner\n\t\t\t\t\tconst rz = ( 0.5 * ( az - aw ) * radius ) / ( az );\n\t\t\t\t\tif( this.containsCorner( x, y, x10, y10, x1, y1, x7, y7, x4, y4, rz, rz, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c0 && ! c2 && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x12, y12, x7, y7, x4, y4, x1, y1, rx, ry, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c1 && ! c2 && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x11, y11, x4, y4, x1, y1, x7, y7, ry, rx, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Others\n\t\t\t\t\tconst fill = this.fill;\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst stroke = this.stroke;\n\t\t\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeTriangleRounded } from \"./e-shape-triangle-rounded\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfTriangleRoundeds extends EShapeTriangleRounded implements EShapeLineOfAny {\n\tpoints!: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfTriangleRoundeds ) {\n\t\tsuper( EShapeType.LINE_OF_TRIANGLE_ROUNDEDS );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis.points = new EShapeLineOfAnyPoints( this );\n\t\t}\n\n\t\tthis._tester = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, px, py );\n\t\t};\n\t}\n\n\tclone(): EShapeLineOfTriangleRoundeds {\n\t\treturn new EShapeLineOfTriangleRoundeds( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbs( x - px, y - py, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbsBBox( x - px, y - py, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfTriangleRoundeds } from \"./e-shape-line-of-triangle-roundeds\";\n\nexport class EShapeLinesOfTriangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLineOfTriangleRoundeds> | EShapeLineOfTriangleRoundeds {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfTriangleRoundeds() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineOfTriangleRoundedsUploadeds } from \"../shape/variant/e-shape-line-of-triangle-roundeds-uploadeds\";\nimport { EShapeLinesOfTriangleRoundeds } from \"../shape/variant/e-shape-lines-of-triangle-roundeds\";\n\nexport const loadShapeLineOfTriangleRoundeds = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_TRIANGLE_ROUNDEDS ] = EShapeLineOfTriangleRoundedsUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE_OF_TRIANGLE_ROUNDEDS ] = EShapeLinesOfTriangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_TRIANGLE_ROUNDEDS,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { buildStep } from \"./build-step\";\nimport { toLength } from \"./to-length\";\nimport { toStep } from \"./to-step\";\n\nexport const TRIANGLE_VERTEX_COUNT = 7;\nexport const TRIANGLE_INDEX_COUNT = 3;\nexport const TRIANGLE_WORLD_SIZE: [ number, number, number ] = [ 0, 0, 0 ];\n\nexport const buildTriangleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\t// Clippings\n\tlet iv = voffset * 3;\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 1;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 1;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n};\n\nexport const buildTriangleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Indices\n\tconst ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 2;\n\n\tindices[ ii + 3 ] = voffset + 0;\n\tindices[ ii + 4 ] = voffset + 3;\n\tindices[ ii + 5 ] = voffset + 4;\n\n\tindices[ ii + 6 ] = voffset + 0;\n\tindices[ ii + 7 ] = voffset + 5;\n\tindices[ ii + 8 ] = voffset + 6;\n};\n\nexport const buildTriangleVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number ],\n\twork: Point\n): void => {\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\tconst sw = 2 * sx * sy / (sx + sz);\n\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst tx = work.x;\n\tconst ty = work.y;\n\twork.set( originX + sx, originY );\n\tinternalTransform.apply( work, work );\n\tconst dx = tx - x0;\n\tconst dy = ty - y0;\n\tconst x1 = work.x + dx;\n\tconst y1 = work.y + dy;\n\tconst x2 = tx + (tx - work.x) + dx;\n\tconst y2 = ty + (ty - work.y) + dy;\n\twork.set( originX, originY + sy - sw ); // Incenter of a triangle\n\tinternalTransform.apply( work, work );\n\tconst x3 = work.x;\n\tconst y3 = work.y;\n\n\t// World size\n\tconst xb = tx + dx;\n\tconst yb = ty + dy;\n\tworldSize[ 0 ] = toLength( xb, yb, x3, y3 );\n\tworldSize[ 1 ] = toLength( x1, y1, xb, yb );\n\tworldSize[ 2 ] = toLength( x0, y0, tx, ty );\n\n\t// Vertices\n\tconst iv = voffset << 1;\n\tvertices[ iv +  0 ] = x3;\n\tvertices[ iv +  1 ] = y3;\n\n\tvertices[ iv +  2 ] = x0;\n\tvertices[ iv +  3 ] = y0;\n\tvertices[ iv +  4 ] = x1;\n\tvertices[ iv +  5 ] = y1;\n\n\tvertices[ iv +  6 ] = x1;\n\tvertices[ iv +  7 ] = y1;\n\tvertices[ iv +  8 ] = x2;\n\tvertices[ iv +  9 ] = y2;\n\n\tvertices[ iv + 10 ] = x2;\n\tvertices[ iv + 11 ] = y2;\n\tvertices[ iv + 12 ] = x0;\n\tvertices[ iv + 13 ] = y0;\n};\n\nexport const buildTriangleStep = (\n\tsteps: Float32Array,\n\tantialiases: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tstrokeWidth: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number ],\n\tworkStep: Float32Array\n): void => {\n\ttoStep( worldSize[ 0 ], strokeWidth, antialiasWeight, workStep );\n\tconst swc = workStep[ 0 ];\n\tconst pc0 = workStep[ 1 ];\n\tconst pc1 = workStep[ 2 ];\n\n\tbuildStep(\n\t\tsteps,\n\t\tantialiases,\n\t\tclippings,\n\t\tvoffset,\n\t\tvcount,\n\t\tswc, swc,\n\t\tpc0, pc0,\n\t\tpc1, pc1\n\t);\n};\n\nexport const buildTriangleUv = (\n\tuvs: Float32Array,\n\ttextureUvs: TextureUvs,\n\tvoffset: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * ( x0 + x1 );\n\tconst y4 = 0.5 * ( y0 + y1 );\n\n\tconst c = 1 - 0.5 * worldSize[ 0 ] / worldSize[ 2 ];\n\tconst x5 = x4 + c * ( x3 - x0 );\n\tconst y5 = y4 + c * ( y3 - y0 );\n\n\tconst iuv = voffset << 1;\n\tuvs[ iuv +  0 ] = x5;\n\tuvs[ iuv +  1 ] = y5;\n\n\tuvs[ iuv +  2 ] = x4;\n\tuvs[ iuv +  3 ] = y4;\n\tuvs[ iuv +  4 ] = x2;\n\tuvs[ iuv +  5 ] = y2;\n\n\tuvs[ iuv +  6 ] = x2;\n\tuvs[ iuv +  7 ] = y2;\n\tuvs[ iuv +  8 ] = x3;\n\tuvs[ iuv +  9 ] = y3;\n\n\tuvs[ iuv + 10 ] = x3;\n\tuvs[ iuv + 11 ] = y3;\n\tuvs[ iuv + 12 ] = x4;\n\tuvs[ iuv + 13 ] = y4;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleClipping, buildTriangleIndex, buildTriangleStep, buildTriangleUv, buildTriangleVertex,\n\tTRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT, TRIANGLE_WORLD_SIZE\n} from \"./build-triangle\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfTrianglesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tbuildTriangleClipping(\n\t\t\tclippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildTriangleIndex(\n\t\t\tindices,\n\t\t\tvoffset,\n\t\t\tioffset\n\t\t);\n\t\tcopyClipping(\n\t\t\tclippings,\n\t\t\tvoffset,\n\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\t\tcopyIndex(\n\t\t\tindices,\n\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\tioffset,\n\t\t\tTRIANGLE_INDEX_COUNT,\n\t\t\tpointCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPoints ) {\n\t\t\tthis.updateVertexStepAndUvs( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexStepAndUvs( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\n\t\tconst pointId = points.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t}\n\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst work = buffer.work;\n\t\t\tconst workStep = buffer.workStep;\n\t\t\tif( pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\tbuildTriangleVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tvoffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues\n\t\t\t\t);\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\tbuildTriangleStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\t\t\tworkStep\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps, antialiases,\n\t\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildTriangleUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ];\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ];\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tconst iv = voffset + i * TRIANGLE_VERTEX_COUNT;\n\n\t\t\t\t\tbuildTriangleVertex(\n\t\t\t\t\t\tvertices,\n\t\t\t\t\t\tiv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\t\t\twork\n\t\t\t\t\t);\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\t\tbuildTriangleStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tantialiases,\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\t\t\t\tworkStep\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildTriangleUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT } from \"./build-triangle\";\nimport { EShapeLineOfAnyUploadeds } from \"./e-shape-line-of-any-uploadeds\";\nimport { EShapeLineOfNullsUploaded } from \"./e-shape-line-of-nulls-uploaded\";\nimport { EShapeLineOfTrianglesUploaded } from \"./e-shape-line-of-triangles-uploaded\";\n\nexport class EShapeLineOfTrianglesUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeLineOfTrianglesUploaded | EShapeLineOfNullsUploaded | null {\n\t\treturn EShapeLineOfAnyUploadeds.create(\n\t\t\tbuffer, shape,\n\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\t\tioffset, TRIANGLE_INDEX_COUNT,\n\t\t\tantialiasWeight,\n\t\t\tEShapeLineOfTrianglesUploaded\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfTriangles extends EShapeTriangle implements EShapeLineOfAny {\n\tpoints!: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfTriangles ) {\n\t\tsuper( EShapeType.LINE_OF_TRIANGLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis.points = new EShapeLineOfAnyPoints( this );\n\t\t}\n\n\t\tthis._tester = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, px, py );\n\t\t};\n\t}\n\n\tclone(): EShapeLineOfTriangles {\n\t\treturn new EShapeLineOfTriangles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbs( x - px, y - py, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox( x: number, y: number, ax: number, ay: number, px: number, py: number ): boolean {\n\t\treturn super.containsAbsBBox( x - px, y - py, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this.points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfTriangles } from \"./e-shape-line-of-triangles\";\n\nexport class EShapeLinesOfTriangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLineOfTriangles> | EShapeLineOfTriangles {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfTriangles() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineOfTrianglesUploadeds } from \"../shape/variant/e-shape-line-of-triangles-uploadeds\";\nimport { EShapeLinesOfTriangles } from \"../shape/variant/e-shape-lines-of-triangles\";\n\nexport const loadShapeLineOfTriangles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_TRIANGLES ] = EShapeLineOfTrianglesUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE_OF_TRIANGLES ] = EShapeLinesOfTriangles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeNullUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0, 1 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeNullUploaded } from \"./e-shape-null-uploaded\";\n\nexport class EShapeNullUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number\n\t): EShapeNullUploaded | null {\n\t\treturn new EShapeNullUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset\n\t\t).init( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeNull extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.NULL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeNull {\n\t\treturn new EShapeNull().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeNull } from \"./e-shape-null\";\n\nexport class EShapeNulls {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeNull> | EShapeNull {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeNull() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeNullUploadeds } from \"../shape/variant/e-shape-null-uploadeds\";\nimport { EShapeNulls } from \"../shape/variant/e-shape-nulls\";\n\nexport const loadShapeNull = () => {\n\tEShapeUploadeds[ EShapeType.NULL ] = EShapeNullUploadeds.create;\n\tEShapeDeserializers[ EShapeType.NULL ] = EShapeNulls.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport class EShapeRectangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeRectangle> | EShapeRectangle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeRectangle() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeRectangleUploadeds } from \"../shape/variant/e-shape-rectangle-uploadeds\";\nimport { EShapeRectangles } from \"../shape/variant/e-shape-rectangles\";\n\nexport const loadShapeRectangle = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE ] = EShapeRectangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.RECTANGLE ] = EShapeRectangles.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleRoundedClipping, buildRectangleRoundedIndex, buildRectangleRoundedStep,\n\tbuildRectangleRoundedUv, buildRectangleRoundedVertex, RECTANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-rectangle-rounded\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.indexBuffer.update();\n\t\tbuildRectangleRoundedIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexClippingStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst radius = shape.radius;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY || radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\tbuffer.vertices, voffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\tbuffer.work\n\t\t\t);\n\n\t\t\t// Steps & antialiases\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.antialiases,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\tcorner,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\tbuffer.workStep\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Clippings\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.clippingBuffer.update();\n\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tcorner,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// UVs\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT } from \"./build-rectangle-rounded\";\nimport { EShapeRectangleRoundedUploaded } from \"./e-shape-rectangle-rounded-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeRectangleRoundedUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeRectangleRoundedUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = RECTANGLE_ROUNDED_VERTEX_COUNT + tvcount;\n\t\tconst icount = RECTANGLE_ROUNDED_INDEX_COUNT + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeRectangleRoundedUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangleRounded } from \"./e-shape-rectangle-rounded\";\n\nexport class EShapeRectangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeRectangleRounded> | EShapeRectangleRounded {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeRectangleRounded() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeRectangleRoundedUploadeds } from \"../shape/variant/e-shape-rectangle-rounded-uploadeds\";\nimport { EShapeRectangleRoundeds } from \"../shape/variant/e-shape-rectangle-roundeds\";\n\nexport const loadShapeRectangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE_ROUNDED ] = EShapeRectangleRoundedUploadeds.create;\n\tEShapeDeserializers[ EShapeType.RECTANGLE_ROUNDED ] = EShapeRectangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleClipping, buildTriangleIndex, buildTriangleStep, buildTriangleUv,\n\tbuildTriangleVertex, TRIANGLE_VERTEX_COUNT, TRIANGLE_WORLD_SIZE\n} from \"./build-triangle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\tconst buffer = this.buffer;\n\t\tbuffer.clippingBuffer.update();\n\t\tbuffer.indexBuffer.update();\n\t\tbuildTriangleClipping(\n\t\t\tbuffer.clippings,\n\t\t\tthis.vertexOffset\n\t\t);\n\t\tbuildTriangleIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexStepAndUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\tconst voffset = this.vertexOffset;\n\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuildTriangleVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tvoffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign,\n\t\t\t\tstrokeWidth,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\tbuffer.work\n\t\t\t);\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuildTriangleStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.antialiases,\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE,\n\t\t\t\t\tbuffer.workStep\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t\tbuildTriangleUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tvoffset,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT } from \"./build-triangle\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\nimport { EShapeTriangleUploaded } from \"./e-shape-triangle-uploaded\";\n\nexport class EShapeTriangleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeTriangleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = TRIANGLE_VERTEX_COUNT + tvcount;\n\t\tconst icount = TRIANGLE_INDEX_COUNT + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeTriangleUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nexport class EShapeTriangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeTriangle> | EShapeTriangle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeTriangle() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeTriangleUploadeds } from \"../shape/variant/e-shape-triangle-uploadeds\";\nimport { EShapeTriangles } from \"../shape/variant/e-shape-triangles\";\n\nexport const loadShapeTriangle = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE ] = EShapeTriangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.TRIANGLE ] = EShapeTriangles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleRoundedClipping, buildTriangleRoundedIndex, buildTriangleRoundedStep,\n\tbuildTriangleRoundedUv, buildTriangleRoundedVertex, TRIANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-triangle-rounded\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.indexBuffer.update();\n\t\tbuildTriangleRoundedIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexClippingStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst radius = shape.radius;\n\t\tconst isRadiusChanged = ( radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isRadiusChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst work = buffer.work;\n\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tvoffset,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tsizeX,\n\t\t\t\tsizeY,\n\t\t\t\tstrokeAlign,\n\t\t\t\tstrokeWidth,\n\t\t\t\tradius,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\twork\n\t\t\t);\n\n\t\t\tif( isRadiusChanged || isCornerChanged ) {\n\t\t\t\tbuffer.clippingBuffer.update();\n\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tcorner,\n\t\t\t\t\tradius\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.antialiases,\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.radius,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE,\n\t\t\t\t\tbuffer.workStep\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tradius,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT } from \"./build-triangle-rounded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\nimport { EShapeTriangleRoundedUploaded } from \"./e-shape-triangle-rounded-uploaded\";\n\nexport class EShapeTriangleRoundedUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number,\n\t\tantialiasWeight: number\n\t): EShapeTriangleRoundedUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = TRIANGLE_ROUNDED_VERTEX_COUNT + tvcount;\n\t\tconst icount = TRIANGLE_ROUNDED_INDEX_COUNT + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeTriangleRoundedUploaded(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, ioffset,\n\t\t\t\ttvcount, ticount,\n\t\t\t\tvcount, icount,\n\t\t\t\tantialiasWeight\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangleRounded } from \"./e-shape-triangle-rounded\";\n\nexport class EShapeTriangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeTriangleRounded> | EShapeTriangleRounded {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeTriangleRounded() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeTriangleRoundedUploadeds } from \"../shape/variant/e-shape-triangle-rounded-uploadeds\";\nimport { EShapeTriangleRoundeds } from \"../shape/variant/e-shape-triangle-roundeds\";\n\nexport const loadShapeTriangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE_ROUNDED ] = EShapeTriangleRoundedUploadeds.create;\n\tEShapeDeserializers[ EShapeType.TRIANGLE_ROUNDED ] = EShapeTriangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.TRIANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadShapeBar } from \"./load-shape-bar\";\nimport { loadShapeCircle } from \"./load-shape-circle\";\nimport { loadShapeGroup } from \"./load-shape-group\";\nimport { loadShapeGroupShadowed } from \"./load-shape-group-shadowed\";\nimport { loadShapeImage } from \"./load-shape-image\";\nimport { loadShapeLabel } from \"./load-shape-label\";\nimport { loadShapeLine } from \"./load-shape-line\";\nimport { loadShapeLineOfCircles } from \"./load-shape-line-of-circles\";\nimport { loadShapeLineOfRectangleRoundeds } from \"./load-shape-line-of-rectangle-roundeds\";\nimport { loadShapeLineOfRectangles } from \"./load-shape-line-of-rectangles\";\nimport { loadShapeLineOfTriangleRoundeds } from \"./load-shape-line-of-triangle-roundeds\";\nimport { loadShapeLineOfTriangles } from \"./load-shape-line-of-triangles\";\nimport { loadShapeNull } from \"./load-shape-null\";\nimport { loadShapeRectangle } from \"./load-shape-rectangle\";\nimport { loadShapeRectangleRounded } from \"./load-shape-rectangle-rounded\";\nimport { loadShapeTriangle } from \"./load-shape-triangle\";\nimport { loadShapeTriangleRounded } from \"./load-shape-triangle-rounded\";\n\nexport const loadShapeAll = () => {\n\tloadShapeBar();\n\tloadShapeCircle();\n\tloadShapeGroupShadowed();\n\tloadShapeGroup();\n\tloadShapeImage();\n\tloadShapeLabel();\n\tloadShapeLine();\n\tloadShapeNull();\n\tloadShapeRectangleRounded();\n\tloadShapeRectangle();\n\tloadShapeTriangleRounded();\n\tloadShapeTriangle();\n\tloadShapeLineOfCircles();\n\tloadShapeLineOfRectangleRoundeds();\n\tloadShapeLineOfRectangles();\n\tloadShapeLineOfTriangleRoundeds();\n\tloadShapeLineOfTriangles();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadMenuItemAll } from \"./load-menu-item-all\";\nimport { loadShapeAll } from \"./load-shape-all\";\n\nexport const loadAll = () => {\n\tloadMenuItemAll();\n\tloadShapeAll();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGroupFillViewer implements EShapeFill {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupFillViewer {\n\t\treturn new EShapeGroupFillViewer();\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\n\nexport class EShapeGroupStrokeViewer implements EShapeStroke {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget align(): number {\n\t\treturn 0.0;\n\t}\n\n\tset align( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn EShapeStrokeSide.NONE;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, side?: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupStrokeViewer {\n\t\treturn new EShapeGroupStrokeViewer();\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\n\nexport class EShapeGroupTextAlignViewer implements EShapeTextAlign {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextOffsetViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeGroupTextOutlineViewer implements EShapeTextOutline {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupTextOutlineViewer {\n\t\treturn new EShapeGroupTextOutlineViewer();\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextPaddingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextSpacingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeGroupTextAlignViewer } from \"./e-shape-group-text-align-viewer\";\nimport { EShapeGroupTextOffsetViewer } from \"./e-shape-group-text-offset-viewer\";\nimport { EShapeGroupTextOutlineViewer } from \"./e-shape-group-text-outline-viewer\";\nimport { EShapeGroupTextPaddingViewer } from \"./e-shape-group-text-padding-viewer\";\nimport { EShapeGroupTextSpacingViewer } from \"./e-shape-group-text-spacing-viewer\";\n\nexport class EShapeGroupTextViewer implements EShapeText {\n\talign: EShapeGroupTextAlignViewer;\n\toffset: EShapeGroupTextOffsetViewer;\n\toutline: EShapeGroupTextOutlineViewer;\n\tspacing: EShapeGroupTextSpacingViewer;\n\tpadding: EShapeGroupTextPaddingViewer;\n\n\tconstructor() {\n\t\tthis.align = new EShapeGroupTextAlignViewer();\n\t\tthis.offset = new EShapeGroupTextOffsetViewer();\n\t\tthis.outline = new EShapeGroupTextOutlineViewer();\n\t\tthis.spacing = new EShapeGroupTextSpacingViewer();\n\t\tthis.padding = new EShapeGroupTextPaddingViewer();\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget value(): string {\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget family(): string {\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget size(): number {\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\t// DO NOTHING\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\t// DO NOTHING\n\t}\n\n\tget direction(): number {\n\t\treturn EShapeTextDirection.LEFT_TO_RIGHT;\n\t}\n\n\tset direction( direction: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget clipping(): boolean {\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class EShapeBufferCount {\n\tvertexCount: number;\n\tindexCount: number;\n\n\tconstructor() {\n\t\tthis.vertexCount = 0;\n\t\tthis.indexCount = 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class EShapeBufferUnit {\n\ttexture: Texture;\n\tindexOffset: number;\n\n\tconstructor( texture: Texture, indexOffset: number ) {\n\t\tthis.texture = texture;\n\t\tthis.indexOffset = indexOffset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Texture } from \"pixi.js\";\nimport { EShapeBufferUnit } from \"./e-shape-buffer-unit\";\n\nexport class EShapeBufferUnitBuilder {\n\tindex: number;\n\tbaseTexture: BaseTexture | null;\n\tunits: EShapeBufferUnit[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t\tthis.units = [];\n\t}\n\n\tbegin(): void {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t}\n\n\tpush( texture: Texture, indexOffset: number ): void {\n\t\tif( this.index < this.units.length ) {\n\t\t\tconst unit = this.units[ this.index ];\n\t\t\tunit.texture = texture;\n\t\t\tunit.indexOffset = indexOffset;\n\t\t} else {\n\t\t\tthis.units.push( new EShapeBufferUnit( texture, indexOffset ) );\n\t\t}\n\t\tthis.index += 1;\n\t}\n\n\tend(): void {\n\t\tif( this.units.length !== this.index ) {\n\t\t\tthis.units.length = this.index;\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tthis.units.length = 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, DRAW_MODES, Geometry, Point, Renderer, Shader, Texture } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBufferCount } from \"./e-shape-buffer-count\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\nimport { EShapeUploadeds } from \"./e-shape-uploadeds\";\n\nexport class EShapeBuffer {\n\tvertices: Float32Array;\n\tvertexCapacity: number;\n\tprotected vertexCount: number;\n\tvertexBuffer: Buffer;\n\n\tclippings: Float32Array;\n\tclippingBuffer: Buffer;\n\n\tsteps: Float32Array;\n\tstepBuffer: Buffer;\n\n\tantialiases: Float32Array;\n\tantialiasBuffer: Buffer;\n\n\tcolorFills: Float32Array;\n\tcolorFillBuffer: Buffer;\n\n\tcolorStrokes: Float32Array;\n\tcolorStrokeBuffer: Buffer;\n\n\tuvs: Float32Array;\n\tuvBuffer: Buffer;\n\n\tindices: Uint16Array | Uint32Array;\n\tindexCapacity: number;\n\tprotected indexCount: number;\n\tindexBuffer: Buffer;\n\n\tprotected renderer: Renderer;\n\tprotected geometry: Geometry;\n\n\tprotected builder: EShapeBufferUnitBuilder;\n\n\twork: Point;\n\tworkStep: Float32Array;\n\tworkCount: EShapeBufferCount;\n\n\tconstructor( ntriangles: number, renderer: Renderer, shader: Shader ) {\n\t\tconst nindices = ntriangles * 3;\n\t\tconst nvertices = nindices;\n\n\t\tthis.vertices = new Float32Array( nvertices * 2 );\n\t\tthis.vertexCapacity = nvertices;\n\t\tthis.vertexCount = 0;\n\t\tthis.vertexBuffer = new Buffer( this.vertices, false, false );\n\n\t\tthis.clippings = new Float32Array( nvertices * 3 );\n\t\tthis.clippingBuffer = new Buffer( this.clippings, false, false );\n\n\t\tthis.steps = new Float32Array( nvertices * 2 );\n\t\tthis.stepBuffer = new Buffer( this.steps, false, false );\n\n\t\tthis.antialiases = new Float32Array( nvertices * 4 );\n\t\tthis.antialiasBuffer = new Buffer( this.antialiases, false, false );\n\n\t\tthis.colorFills = new Float32Array( nvertices * 4 );\n\t\tthis.colorFillBuffer = new Buffer( this.colorFills, false, false );\n\n\t\tthis.colorStrokes = new Float32Array( nvertices * 4 );\n\t\tthis.colorStrokeBuffer = new Buffer( this.colorStrokes, false, false );\n\n\t\tthis.uvs = new Float32Array( nvertices * 2 );\n\t\tthis.uvBuffer = new Buffer( this.uvs, false, false );\n\n\t\tconst isIndicesShort = ( nvertices <= 65535 );\n\t\tthis.indices = ( isIndicesShort ? new Uint16Array( nindices ) : new Uint32Array( nindices ) );\n\t\tthis.indexCapacity = ntriangles;\n\t\tthis.indexCount = 0;\n\t\tthis.indexBuffer = new Buffer( this.indices, false, true );\n\n\t\tthis.renderer = renderer;\n\n\t\tthis.builder = new EShapeBufferUnitBuilder();\n\n\t\tthis.work = new Point();\n\t\tthis.workStep = new Float32Array( 3 );\n\t\tthis.workCount = new EShapeBufferCount();\n\n\t\tthis.geometry = new Geometry()\n\t\t\t.addIndex( this.indexBuffer )\n\t\t\t.addAttribute( \"aPosition\", this.vertexBuffer, 2 )\n\t\t\t.addAttribute( \"aClipping\", this.clippingBuffer, 3 )\n\t\t\t.addAttribute( \"aStep\", this.stepBuffer, 2 )\n\t\t\t.addAttribute( \"aAntialias\", this.antialiasBuffer, 4 )\n\t\t\t.addAttribute( \"aColorFill\", this.colorFillBuffer, 4 )\n\t\t\t.addAttribute( \"aColorStroke\", this.colorStrokeBuffer, 4 )\n\t\t\t.addAttribute( \"aUv\", this.uvBuffer, 2 );\n\t}\n\n\trender( shader: Shader ): void {\n\t\tconst renderer = this.renderer;\n\t\t(renderer.geometry as any).bind( this.geometry );\n\n\t\tconst units = this.builder.units;\n\t\tconst unitCount = units.length;\n\t\tif( 0 < unitCount ) {\n\t\t\tconst type = DRAW_MODES.TRIANGLES;\n\n\t\t\tlet unit0 = null;\n\t\t\tlet unit1 = units[ 0 ];\n\t\t\tlet ioffset0 = 0;\n\t\t\tlet ioffset1 = unit1.indexOffset * 3;\n\t\t\tlet vcount = 0;\n\t\t\tlet texture = Texture.WHITE;\n\t\t\tfor( let i = 0, imax = unitCount - 1; i < imax; ++i ) {\n\t\t\t\tunit0 = unit1;\n\t\t\t\tunit1 = units[ i + 1 ];\n\t\t\t\tioffset0 = ioffset1;\n\t\t\t\tioffset1 = unit1.indexOffset * 3;\n\t\t\t\tvcount = ioffset1 - ioffset0;\n\t\t\t\ttexture = unit0.texture || Texture.WHITE;\n\t\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\t\trenderer.geometry.draw( type, vcount, ioffset0 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvcount = this.indexCount * 3 - ioffset1;\n\t\t\ttexture = unit1.texture || Texture.WHITE;\n\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\trenderer.geometry.draw( type, vcount, ioffset1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tisCompatible( shape: EShape, uploaded: EShapeUploaded, vindex: number, iindex: number ): boolean {\n\t\treturn (\n\t\t\tuploaded.getBuffer() === this &&\n\t\t\tuploaded.getVertexOffset() === vindex &&\n\t\t\tuploaded.getIndexOffset() === iindex &&\n\t\t\tuploaded.isCompatible( shape )\n\t\t);\n\t}\n\n\tupdate( iterator: EShapeRendererIterator, antialiasWeight: number ): boolean {\n\t\tconst builder = this.builder;\n\t\tbuilder.begin();\n\n\t\tlet vindex = 0;\n\t\tlet iindex = 0;\n\t\tlet shape = iterator.get();\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst uploaded = shape.uploaded;\n\t\t\tif( uploaded == null || ! this.isCompatible( shape, uploaded, vindex, iindex ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.update( shape );\n\t\t\tuploaded.buildUnit( builder );\n\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\t\t}\n\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst creater = EShapeUploadeds[ shape.type ] || EShapeUploadeds[ EShapeType.GROUP ];\n\t\t\tif( creater == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst uploaded = creater( this, shape, vindex, iindex, antialiasWeight );\n\t\t\tif( uploaded == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.buildUnit( builder );\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\t\t}\n\n\t\tbuilder.end();\n\t\tthis.vertexCount = vindex;\n\t\tthis.indexCount = iindex;\n\n\t\treturn 0 < builder.units.length;\n\t}\n\n\tdestroy(): void {\n\t\tthis.geometry.destroy();\n\t\tthis.builder.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\n\nconst DUMMY_SHAPES: EShape[] = [];\n\nexport class EShapeRendererIteratorDatum {\n\tprotected index: number;\n\tprotected shapes: EShape[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.shapes = DUMMY_SHAPES;\n\t}\n\n\treset( shapes: EShape[] ) {\n\t\tthis.index = -1;\n\t\tthis.shapes = shapes;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst index = this.index = this.index + 1;\n\t\tconst shapes = this.shapes;\n\t\tif( index < shapes.length ) {\n\t\t\treturn shapes[ index ];\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRendererIteratorDatum } from \"./e-shape-renderer-iterator-datum\";\n\nexport class EShapeRendererIterator {\n\tprotected _index: number;\n\tprotected _data: EShapeRendererIteratorDatum[];\n\tprotected _datum: EShapeRendererIteratorDatum;\n\tprotected _current: EShape | null;\n\n\tconstructor() {\n\t\tthis._index = -1;\n\t\tthis._datum = new EShapeRendererIteratorDatum();\n\t\tthis._data = [ this._datum ];\n\t\tthis._current = null;\n\t}\n\n\treset( shapes: EShape[] ): EShape | null {\n\t\tthis._index = 0;\n\t\tconst current = this._datum = this._data[ 0 ];\n\t\tcurrent.reset( shapes );\n\t\tthis._current = null;\n\t\treturn this.next();\n\t}\n\n\tget(): EShape | null {\n\t\treturn this._current;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst datum = this._datum;\n\t\tconst shape = datum.next();\n\t\tif( shape != null ) {\n\t\t\tthis._current = shape;\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst datumIndex = this._index = this._index + 1;\n\t\t\t\tconst data = this._data;\n\t\t\t\tif( datumIndex < data.length ) {\n\t\t\t\t\tconst newDatum = data[ datumIndex ];\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t} else {\n\t\t\t\t\tconst newDatum = new EShapeRendererIteratorDatum();\n\t\t\t\t\tdata.push( newDatum );\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shape;\n\t\t} else {\n\t\t\tconst datumIndex = this._index = this._index - 1;\n\t\t\tconst data = this._data;\n\t\t\tif( 0 <= datumIndex ) {\n\t\t\t\tthis._datum = data[ datumIndex ];\n\t\t\t\tthis._current = null;\n\t\t\t\treturn this.next();\n\t\t\t} else {\n\t\t\t\tthis._current = null;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, BLEND_MODES, ObjectRenderer, Renderer, Shader, Texture, utils } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicAtlasItemImage } from \"../util/dynamic-atlas-item-image\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec3 aClipping;\nattribute vec2 aStep;\nattribute vec4 aAntialias;\nattribute vec4 aColorFill;\nattribute vec4 aColorStroke;\nattribute vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float pixelScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse( in vec2 v ) {\n\treturn vec2( -v.y, v.x );\n}\n\nvec2 toTransformedPosition( in vec2 v ) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toAntialias01( in vec4 antialias, in float scale ) {\n\t// Taylor series of 1 / ( 1 - a ) = 1 + a + a^2 + ....\n\treturn 1.0 + min( vec4( 1.0 ), antialias * scale );\n}\n\nvec4 toAntialias2( in vec2 step, in vec4 antialias, in float scale ) {\n\tfloat x = min( 0.4, step.x * scale );\n\tfloat y = 0.5 - antialias.x;\n\tfloat z = 0.5 - antialias.x - step.y;\n\treturn vec4( y, z, y - max( 0.01, y - x ), z - max( 0.01, z - x ) );\n}\n\nvec2 toPosition3456( in float type, in vec2 p, in vec2 pprev, in vec2 pnext, in float strokeWidth, out float shift ) {\n\tvec2 d0 = p - pprev;\n\tvec2 d1 = pnext - p;\n\tfloat l0 = dot( d0, d0 );\n\tfloat l1 = dot( d1, d1 );\n\tvec2 nd0 = normalize( toInverse( d0 ) );\n\tvec2 nd1 = normalize( toInverse( d1 ) );\n\tvec2 n0 = 0.00001 < l0 ? nd0 : nd1;\n\tvec2 n1 = 0.00001 < l1 ? nd1 : nd0;\n\tvec2 n0i = toInverse( n0 );\n\tvec2 n1i = toInverse( n1 );\n\tfloat direction = sign( 4.5 - type );\n\n\t// Offset\n\tfloat cross = dot( n0i, n1 );\n\tfloat crossInverse = ( 0.00001 < abs( cross ) ? 1.0 / cross : 0.0 );\n\tfloat b = dot(n1 - n0, n0) * crossInverse;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, pmiter - pprev );\n\tfloat miterAngle1 = dot( n1i, pmiter - pnext );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = ( type == 4.0 || type == 6.0 ? n1 : n0 );\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterAngle0 || miterAngle1 < 0.0 || miterSide < 0.0 ?\n\t\tpbevel : pmiter\n\t);\n\t/*\n\tvec2 presult = (\n\t\tmiterAngle0 < 0.0 && 0.0 <= miterAngle1 && miterLength < 50.0 ?\n\t\tpmiter : pbevel\n\t);\n\t*/\n\tvec2 ni = ( type == 4.0 || type == 6.0 ? n1i : n0i );\n\tshift = dot( ni, p - presult );\n\treturn toTransformedPosition( presult );\n}\n\nvec2 toStep3456( in float type ) {\n\treturn ( type < 4.5 ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 ) );\n}\n\nvec4 toAntialias3456( in float strokeWidth, in float scale ) {\n\tfloat a = antialiasWeight / max( 0.0001, strokeWidth );\n\treturn toAntialias01( vec4( a, a, a, a ), scale );\n}\n\nfloat toDotAndDashScale( in float scale, in float strokeWidthScale ) {\n\treturn (\n\t\tscale == 4.0 || scale == 5.0 || scale == 6.0 || scale == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec4 toColorStroke3456( in float shift, in float scale ) {\n\tfloat x = aColorFill.x + shift;\n\tfloat y = scale * aColorFill.y;\n\tfloat z = scale * aColorFill.z;\n\tfloat w = aColorFill.w;\n\treturn vec4( x, y, z, w );\n}\n\nfloat toStrokeWidthScale( in float scale ) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tpixelScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin( 1.0, pixelScale ) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax( 1.0, pixelScale ) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvoid main(void) {\n\tvec2 p012 = toTransformedPosition( aPosition );\n\n\tfloat type = aClipping.z;\n\n\t// type === 0 or 1\n\tvec4 a01 = toAntialias01( aAntialias, pixelScale );\n\n\t// type === 2\n\tvec4 a2 = toAntialias2( aStep, aAntialias, pixelScale );\n\n\t// type === 3, 4, 5 or 6\n\tfloat shift3456 = 0.0;\n\tfloat strokeWidthScale = toStrokeWidthScale( aStep.y );\n\tfloat strokeWidth = strokeWidthScale * aStep.x;\n\tvec2 p3456 = toPosition3456( type, aPosition, aAntialias.xy, aAntialias.zw, strokeWidth, shift3456 );\n\tvec2 step3456 = toStep3456( type );\n\tvec4 a3456 = toAntialias3456( strokeWidth, pixelScale );\n\tvec4 colorStroke3456 = toColorStroke3456( shift3456, toDotAndDashScale( aStep.y, strokeWidthScale ) );\n\n\t//\n\tgl_Position = vec4( ( 2.5 < type ? p3456 : p012 ), 0.0, 1.0 );\n\tvAntialias = ( 1.5 < type ? ( 2.5 < type ? a3456 : a2 ) : a01 );\n\tvClipping = aClipping;\n\tvStep = ( 2.5 < type ? step3456 : aStep );\n\tvColorFill = ( 2.5 < type ? aColorStroke : aColorFill );\n\tvColorStroke = ( 2.5 < type ? colorStroke3456 : aColorStroke );\n\tvUv = aUv;\n}`;\n\nconst FRAGMENT_SHADER_NO_AA = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = step( vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = step( 0.0, lm );\n\tfloat ls1 = step( lp0, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - step( lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nconst FRAGMENT_SHADER = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = smoothstep( 1.0 - (d.zw - d.xy), vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat ld = 0.5 * pixelScale;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = smoothstep( 0.0, 0.0 + ld, lm );\n\tfloat ls1 = smoothstep( lp0, lp0 + ld, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - smoothstep( lt - ld, lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nexport class EShapeRenderer extends ObjectRenderer {\n\tprotected _shader: Shader | null;\n\tprotected _iterator: EShapeRendererIterator;\n\tprotected _bufferSize: number;\n\tprotected _bufferSizeMax: number;\n\n\tconstructor( renderer: Renderer ) {\n\t\tsuper( renderer );\n\t\tthis._shader = Shader.from( VERTEX_SHADER, FRAGMENT_SHADER );\n\t\tthis._iterator = new EShapeRendererIterator();\n\t\tthis._bufferSize = 5000;\n\t\tthis._bufferSizeMax = this.getBufferSizeMax( renderer );\n\t}\n\n\tprotected getBufferSizeMax( renderer: Renderer ): number {\n\t\tconst context = renderer.context;\n\t\tconst extensions = context.extensions as any;\n\t\tif( 1 < context.webGLVersion || !! extensions.uint32ElementIndex ) {\n\t\t\treturn 1431655765; // 2^32 / 3\n\t\t}\n\t\treturn 21845; // 2^16 / 3\n\t}\n\n\tupdateAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\t// Texture\n\t\t// Do not access the shape.image.src here.\n\t\t// It slows down the rendering speed significantly.\n\t\tconst imageSrc = shape.imageSrc;\n\t\tif( imageSrc != null ) {\n\t\t\tconst textureItem = atlas.get( imageSrc );\n\t\t\tif( textureItem != null ) {\n\t\t\t\tshape.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\tconst newTextureItem = new DynamicAtlasItemImage( shape.image!, baseTexture );\n\t\t\t\tshape.texture = newTextureItem.texture;\n\t\t\t\tatlas.set( newTextureItem.id, newTextureItem );\n\t\t\t}\n\t\t} else {\n\t\t\tshape.texture = defaultTexture;\n\t\t}\n\n\t\t// Font texture atlas\n\t\tconst text = shape.text;\n\t\tconst textValue = text.value;\n\t\tif( 0 < textValue.length ) {\n\t\t\tfontAtlases.add( text.family, textValue );\n\t\t}\n\t}\n\n\tupdateAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateAtlas( shape, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateAtlas( child, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tthis.updateAtlases( child.children, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateFontAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tconst text = shape.text;\n\t\tconst fontAtlas = fontAtlases.get( text.family );\n\t\tif( fontAtlas != null ) {\n\t\t\tconst textureItem = atlas.get( fontAtlas.id );\n\t\t\tif( textureItem != null ) {\n\t\t\t\ttext.atlas = fontAtlas;\n\t\t\t\ttext.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\ttext.atlas = undefined;\n\t\t\t\ttext.texture = defaultTexture;\n\t\t\t}\n\t\t} else {\n\t\t\ttext.atlas = undefined;\n\t\t\ttext.texture = defaultTexture;\n\t\t}\n\t}\n\n\tupdateFontAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateFontAtlas( shape, atlas, fontAtlases, defaultTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateFontAtlas( child, atlas, fontAtlases, defaultTexture );\n\t\t\t\tthis.updateFontAtlases( child.children, atlas, fontAtlases, defaultTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\trender_( container: EShapeContainer, shapes: EShape[], isDirty: boolean ): void {\n\t\tconst renderer = this.renderer;\n\t\tconst shader = this._shader;\n\n\t\tif( shader != null && 0 < shapes.length ) {\n\t\t\tconst resolution = renderer.resolution;\n\t\t\tconst buffers = container.getBuffers();\n\t\t\tconst antialiasWeight = container.getAntialiasWeight( resolution );\n\n\t\t\t// Update textures\n\t\t\tif( isDirty ) {\n\t\t\t\t// Atlases\n\t\t\t\tconst atlas = container.getAtlas( resolution );\n\t\t\t\tconst fontAtlases = container.getFontAtlases();\n\t\t\t\tatlas.begin();\n\t\t\t\tfontAtlases.begin();\n\t\t\t\tconst defaultTexture = atlas.getDefaultTexture();\n\t\t\t\tconst baseTexture: BaseTexture = atlas.getBaseTexture();\n\t\t\t\tthis.updateAtlases( shapes, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tfontAtlases.end();\n\t\t\t\tfontAtlases.update( atlas );\n\t\t\t\tthis.updateFontAtlases( shapes, atlas, fontAtlases, defaultTexture );\n\t\t\t\tatlas.end();\n\t\t\t\tatlas.repack();\n\n\t\t\t\t// Update buffers\n\t\t\t\tthis.updateBuffers( shapes, buffers, renderer, shader, antialiasWeight );\n\t\t\t}\n\n\t\t\t// Render buffers\n\t\t\tshader.uniforms.pixelScale = container.toPixelScale( resolution );\n\t\t\tshader.uniforms.antialiasWeight = antialiasWeight;\n\t\t\tshader.uniforms.translationMatrix = container.worldTransform.toArray( true );\n\t\t\trenderer.shader.bind( shader, false );\n\t\t\trenderer.state!.setBlendMode(utils.correctBlendMode(BLEND_MODES.NORMAL, true));\n\t\t\tfor( let i = 0, imax = buffers.length; i < imax; ++i ) {\n\t\t\t\tbuffers[ i ].render( shader );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected increaseBufferSize(): boolean {\n\t\tconst bufferSize = this._bufferSize;\n\t\tconst bufferSizeMax = this._bufferSizeMax;\n\t\tif( bufferSize < bufferSizeMax ) {\n\t\t\tthis._bufferSize = Math.min( bufferSizeMax, bufferSize << 1 );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getBufferSize(): number {\n\t\treturn this._bufferSize;\n\t}\n\n\tupdateBuffers(\n\t\tshapes: EShape[], buffers: EShapeBuffer[],\n\t\trenderer: Renderer, shader: Shader,\n\t\tantialiasWeight: number\n\t): void {\n\t\tconst iterator = this._iterator;\n\t\titerator.reset( shapes );\n\t\tlet ib = 0;\n\t\tconst ibmax = buffers.length;\n\t\tfor( ; iterator.get() != null && ib < ibmax; ++ib ) {\n\t\t\tif( ! buffers[ ib ].update( iterator, antialiasWeight ) ) {\n\t\t\t\t// Failed to update the shapes.\n\t\t\t\t// This is most likely caused by small buffers.\n\t\t\t\t// So increase the buffer size.\n\t\t\t\tthis.increaseBufferSize();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif( ib < ibmax ) {\n\t\t\tfor( let jb = ib; jb < ibmax; ++jb ) {\n\t\t\t\tbuffers[ jb ].destroy();\n\t\t\t}\n\t\t\tbuffers.length = ib;\n\t\t}\n\n\t\twhile( iterator.get() != null ) {\n\t\t\tconst buffer = new EShapeBuffer( this.getBufferSize(), renderer, shader );\n\t\t\tif( buffer.update( iterator, antialiasWeight ) ) {\n\t\t\t\tbuffers.push( buffer );\n\t\t\t} else {\n\t\t\t\tbuffer.destroy();\n\n\t\t\t\t// Again, increase the buffer size;\n\t\t\t\tif( ! this.increaseBufferSize() ) {\n\t\t\t\t\t// No way to render\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Renderer } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport \"./e-shape-renderer\";\nimport { EShapeRenderer } from \"./e-shape-renderer\";\n\nexport class EShapeContainer extends DisplayObject {\n\tstatic SHAPE_RENDERER: EShapeRenderer | null = null;\n\n\treadonly children: EShape[];\n\tprotected _childrenId: number;\n\tprotected _childrenIdRendered: number;\n\n\tprotected _atlas: DynamicAtlas | null;\n\tprotected _fontAtlases: DynamicSDFFontAtlases;\n\n\tprotected _pixelScale: number;\n\tprotected _pixelScaleId: number;\n\n\tprotected _work: Point;\n\n\tprotected _buffers: EShapeBuffer[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.children = [];\n\n\t\tthis._childrenId = 0;\n\t\tthis._childrenIdRendered = -1;\n\n\t\tthis._atlas = null;\n\t\tthis._fontAtlases = new DynamicSDFFontAtlases();\n\n\t\tthis._pixelScale = 1;\n\t\tthis._pixelScaleId = NaN;\n\n\t\tthis._work = new Point();\n\n\t\tthis._buffers = [];\n\t}\n\n\tcalculateBounds(): void {\n\t\tthis._bounds.clear();\n\t}\n\n\tonChildTransformChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoDirty(): number {\n\t\treturn this._childrenId += 1;\n\t}\n\n\tisDirty(): boolean {\n\t\treturn this._childrenIdRendered < this._childrenId;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( !this.visible || this.worldAlpha <= 0 || !this.renderable ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst childrenId = this._childrenId;\n\t\tconst childrenIdRendered = this._childrenIdRendered;\n\t\tthis._childrenIdRendered = childrenId;\n\t\tconst isChildrenDirty = childrenIdRendered < childrenId;\n\t\tconst children = this.children;\n\n\t\tlet shapeRenderer: EShapeRenderer | null = EShapeContainer.SHAPE_RENDERER;\n\t\tif( shapeRenderer == null ) {\n\t\t\tshapeRenderer = EShapeContainer.SHAPE_RENDERER = new EShapeRenderer( renderer );\n\t\t}\n\t\trenderer.batch.setObjectRenderer( shapeRenderer );\n\n\t\tconst mask = this._mask;\n\t\tif( mask ) {\n\t\t\trenderer.mask.push( this, mask );\n\t\t\tshapeRenderer.render_( this, children, isChildrenDirty );\n\t\t\trenderer.mask.pop( this, mask );\n\t\t} else {\n\t\t\tshapeRenderer.render_( this, children, isChildrenDirty );\n\t\t}\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tgetFontAtlases(): DynamicSDFFontAtlases {\n\t\treturn this._fontAtlases;\n\t}\n\n\tgetAtlas( resolution: number ): DynamicAtlas {\n\t\tlet atlas = this._atlas;\n\t\tif( atlas == null ) {\n\t\t\tatlas = new DynamicAtlas( resolution );\n\t\t\tthis._atlas = atlas;\n\t\t}\n\t\treturn atlas;\n\t}\n\n\tgetBuffers(): EShapeBuffer[] {\n\t\treturn this._buffers;\n\t}\n\n\ttoPixelScale( resolution: number ): number {\n\t\tthis.updateTransform();\n\t\tconst transform = this.transform;\n\t\tconst worldID = (transform as any)._worldID;\n\t\tif( worldID !== this._pixelScaleId ) {\n\t\t\tthis._pixelScaleId = worldID;\n\t\t\tconst worldTransform = transform.worldTransform;\n\t\t\tconst a = worldTransform.a;\n\t\t\tconst b = worldTransform.b;\n\t\t\tconst scale = Math.sqrt( a * a + b * b );\n\t\t\tthis._pixelScale = 1 / ( resolution * scale );\n\t\t}\n\t\treturn this._pixelScale;\n\t}\n\n\tgetPixelScale(): number {\n\t\treturn this._pixelScale;\n\t}\n\n\tgetAntialiasWeight( resolution: number ): number {\n\t\treturn 1.25 / resolution;\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tconst childResult = child.contains( childLocal );\n\t\t\t\tif( childResult != null ) {\n\t\t\t\t\tif( handler == null || handler( childResult ) ) {\n\t\t\t\t\t\treturn childResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thitTestBBox( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tif( child.containsBBox( childLocal ) ) {\n\t\t\t\t\tif( handler == null || handler( child ) ) {\n\t\t\t\t\t\treturn child;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdestroy(): void {\n\t\t// Buffer\n\t\tconst buffers = this._buffers;\n\t\tif( buffers != null ) {\n\t\t\tfor( let i = 0, imax = buffers.length; i < imax; ++i ) {\n\t\t\t\tbuffers[ i ].destroy();\n\t\t\t}\n\t\t}\n\t\tthis._buffers.length = 0;\n\n\t\t// Shapes\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\nexport class EShapeSearch {\n\tstatic COMPARATOR_INDEX = ( a: EShape, b: EShape ): number => {\n\t\treturn a.index - b.index;\n\t}\n\n\tstatic toIndices( shapes: EShape[] ): number[] {\n\t\tconst result = [];\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tresult.push( shapes[ i ].index );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toDepth( shape: EShape ): number {\n\t\tlet result = 0;\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tresult += 1;\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toSharedParent( first: EShape, shape: EShape ): EShape | EShapeContainer {\n\t\tconst depthA = this.toDepth( first );\n\t\tconst depthB = this.toDepth( shape );\n\t\tif( depthA < depthB ) {\n\t\t\tlet parent = first.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( shape, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t} else {\n\t\t\tlet parent = shape.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( first, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t}\n\t}\n\n\tstatic toOfParent( shape: EShape, parent: EShape | EShapeContainer ) {\n\t\tlet shapeParent = shape.parent;\n\t\twhile( shapeParent !== parent && shapeParent instanceof EShapeBase ) {\n\t\t\tshape = shapeParent;\n\t\t\tshapeParent = shapeParent.parent;\n\t\t}\n\t\treturn shape;\n\t}\n\n\tstatic isParent( shape: EShape, target: EShape | null ): boolean {\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tif( parent === target ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic toSelected( shape: EShape ): EShape | null {\n\t\tlet target: EShape | EShapeContainer | null = shape;\n\t\twhile( target instanceof EShapeBase ) {\n\t\t\tif( target.selected ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t\ttarget = target.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildById( shape: { children: EShape[] }, id: string, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.id === id ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildById( child, id, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildByType( shape: { children: EShape[] }, type: EShapeType, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildByType( child, type, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChild(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean\n\t): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChild( child, matcher, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildrenByType(\n\t\tshape: { children: EShape[] }, type: EShapeType, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildrenByType( child, type, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic findChildren(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildren( child, matcher, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeSearch } from \"./e-shape-search\";\n\nexport class EShapeDeleter {\n\tstatic delete(\n\t\tparent: EShape | EShapeContainer, shapes?: EShape[], generateListOfDetachedShapes?: boolean\n\t): EShape[] | null {\n\t\tconst children = parent.children;\n\t\tconst length = children.length;\n\n\t\t// Update indices\n\t\tfor( let i = 0; i < length; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.selected ) {\n\t\t\t\tchild.index = length + i;\n\t\t\t} else {\n\t\t\t\tchild.index = i;\n\t\t\t}\n\t\t}\n\n\t\t// Sort\n\t\tchildren.sort( EShapeSearch.COMPARATOR_INDEX );\n\n\t\t// Detach\n\t\tif( generateListOfDetachedShapes === true ) {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.index -= length;\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tconst size = children.length - (i + 1);\n\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\tconst result = children.splice( i + 1, size );\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst result = children.splice( 0, children.length );\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tchildren.length = i + 1;\n\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t}\n\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\tparent.toDirty();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tchildren.length = 0;\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class EShapeResourceManagerSerialization {\n\tprotected resources: string[];\n\tprotected resourceToIndex: Map<string, number>;\n\n\tconstructor() {\n\t\tthis.resources = [];\n\t\tthis.resourceToIndex = new Map<string, number>();\n\t}\n\n\tadd( resource: string ): number {\n\t\tconst resources = this.resources;\n\t\tconst resourceToIndex = this.resourceToIndex;\n\t\tconst result = resourceToIndex.get( resource );\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\tconst index = resources.length;\n\t\tresources.push( resource );\n\t\tresourceToIndex.set( resource, index );\n\t\treturn index;\n\t}\n\n\tserialize(): string[] {\n\t\treturn this.resources;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\n\nexport const EShapeRuntimes: {\n\t[ type: number ]: (new ( shape: EShape ) => EShapeRuntime) | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapGrid } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\n\nexport class ESnapperGrid extends utils.EventEmitter {\n\tprotected _isEnabled: boolean;\n\tprotected _size: number;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis.emit( \"change\", size, this );\n\t\t}\n\t}\n\n\tsnap( value: number, result: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst size = this._size;\n\t\t\tresult.set( value, Math.round( value / size ) * size );\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapGrid {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis._size\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapGrid ): void {\n\t\tif( serialized[ 0 ] !== 0 ) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\n\t\tthis.size = serialized[ 1 ];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class ESnapperResult {\n\tdistance: number;\n\tresult: number;\n\tthreshold: number;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.result = 0;\n\t\tthis.threshold = 10;\n\t}\n\n\treset( value: number, scale: number ): void {\n\t\tthis.distance = NaN;\n\t\tthis.result = value;\n\t\tthis.threshold = ( 0.0001 < scale ? 10 / scale : 10 );\n\t}\n\n\tset( value: number, snapped: number ): void {\n\t\tconst newDistance = Math.abs( snapped - value );\n\t\tif( newDistance <= this.threshold ) {\n\t\t\tconst oldDistance = this.distance;\n\t\t\tif( oldDistance !== oldDistance || newDistance < oldDistance ) {\n\t\t\t\tthis.distance = newDistance;\n\t\t\t\tthis.result = snapped;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, utils } from \"pixi.js\";\nimport { DDiagramSerializedSnap } from \"../d-diagram-serialized\";\nimport { isNaN } from \"../util/is-nan\";\nimport { ESnapperGrid } from \"./e-snapper-grid\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperResultScale } from \"./e-snapper-result-scale\";\nimport { ESnapperTarget } from \"./e-snapper-target\";\n\nconst EPSILON = 0.00001;\n\nexport interface ESnapperModifier extends DisplayObject {\n\twidth: number;\n\theight: number;\n}\n\nexport enum ESnapperModifierAnchor {\n\tNONE,\n\tTOP_LEFT,\n\tTOP_CENTER,\n\tTOP_RIGHT,\n\tMIDDLE_LEFT,\n\tMIDDLE_RIGHT,\n\tBOTTOM_LEFT,\n\tBOTTOM_CENTER,\n\tBOTTOM_RIGHT,\n\tROTATION\n}\n\nexport interface ESnapperParentCanvas {\n\tscale: {\n\t\tx: number,\n\t\ty: number\n\t};\n\twidth: number;\n\theight: number;\n}\n\nexport interface ESnapperParent {\n\tcanvas: ESnapperParentCanvas | null;\n}\n\nexport class ESnapper extends utils.EventEmitter {\n\tprotected _points: Point[];\n\tprotected _normals: Point[];\n\tprotected _lengths: number[];\n\n\tprotected _workScale: Point;\n\tprotected _workScaleResult: ESnapperResultScale;\n\n\tprotected _workTranslate: Point;\n\n\tprotected _workSnap: Point;\n\tprotected _workSnapRectangle: Rectangle;\n\tprotected _workSnapResultX: ESnapperResult;\n\tprotected _workSnapResultY: ESnapperResult;\n\n\tprotected _parent: ESnapperParent;\n\n\tprotected _isEnabled: boolean;\n\n\tgrid: ESnapperGrid;\n\n\ttarget: ESnapperTarget;\n\n\tconstructor( parent: ESnapperParent ) {\n\t\tsuper();\n\n\t\tthis._points = [\n\t\t\tnew Point(), // Top left\n\t\t\tnew Point(), // Top right\n\t\t\tnew Point(), // Bottom left\n\t\t\tnew Point(), // Bottom right\n\t\t\tnew Point()  // Center\n\t\t];\n\n\t\tthis._normals = [\n\t\t\tnew Point(),\n\t\t\tnew Point()\n\t\t];\n\n\t\tthis._lengths = [\n\t\t\t1,\n\t\t\t1\n\t\t];\n\n\t\tthis._workScale = new Point();\n\t\tthis._workSnapResultX = new ESnapperResult();\n\t\tthis._workSnapResultY = new ESnapperResult();\n\t\tthis._workScaleResult = {\n\t\t\tdistance: 0,\n\t\t\tscale: new Point()\n\t\t};\n\n\t\tthis._workTranslate = new Point();\n\n\t\tthis._workSnapRectangle = new Rectangle();\n\t\tthis._workSnap = new Point();\n\n\t\t// Grid\n\t\tthis.grid = new ESnapperGrid();\n\n\t\t// Target\n\t\tthis.target = new ESnapperTarget();\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._isEnabled = true;\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tprotected prepare( modifier: ESnapperModifier ): void {\n\t\tmodifier.updateTransform();\n\t\tconst localTransform = modifier.transform.localTransform;\n\t\tconst sx = modifier.width;\n\t\tconst sy = modifier.height;\n\n\t\tconst points = this._points;\n\t\tpoints[ 0 ].set( 0, 0 );\n\t\tpoints[ 1 ].set( sx, 0 );\n\t\tpoints[ 2 ].set( sx, sy );\n\t\tpoints[ 3 ].set( 0, sy );\n\t\tpoints[ 4 ].set( sx * 0.5, sy * 0.5 );\n\n\t\tlocalTransform.apply( points[ 0 ], points[ 0 ] );\n\t\tlocalTransform.apply( points[ 1 ], points[ 1 ] );\n\t\tlocalTransform.apply( points[ 2 ], points[ 2 ] );\n\t\tlocalTransform.apply( points[ 3 ], points[ 3 ] );\n\t\tlocalTransform.apply( points[ 4 ], points[ 4 ] );\n\t}\n\n\tprepareForTranslate( modifier: ESnapperModifier ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\t\t}\n\t}\n\n\tprotected snap( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tconst canvas = this._parent.canvas;\n\t\tconst x = this._workSnapResultX;\n\t\tconst y = this._workSnapResultY;\n\n\t\t// Canvas\n\t\tif( canvas != null ) {\n\t\t\tconst scale = Math.max( canvas.scale.x, canvas.scale.y );\n\t\t\tx.reset( px, scale );\n\t\t\ty.reset( py, scale );\n\t\t\tx.set( px, 0 );\n\t\t\tx.set( px, canvas.width );\n\t\t\ty.set( py, 0 );\n\t\t\ty.set( py, canvas.height );\n\t\t} else {\n\t\t\tx.reset( px, 1 );\n\t\t\ty.reset( py, 1 );\n\t\t}\n\n\t\t// Target\n\t\tthis.target.snap( px, py, x, y );\n\n\t\t// Grid\n\t\tthis.grid.snap( px, x );\n\t\tthis.grid.snap( py, y );\n\n\t\t//\n\t\tresult.x = ( isNaN( x.distance ) ? NaN : x.result );\n\t\tresult.y = ( isNaN( y.distance ) ? NaN : y.result );\n\t\treturn result;\n\t}\n\n\ttoSnapped( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tif( this._isEnabled ) {\n\t\t\tthis.snap( point, result );\n\t\t\tconst x = result.x;\n\t\t\tconst y = result.y;\n\t\t\tresult.set(\n\t\t\t\tisNaN( x ) ? px : x,\n\t\t\t\tisNaN( y ) ? py : y\n\t\t\t);\n\t\t} else {\n\t\t\tresult.set( px, py );\n\t\t}\n\t\treturn result;\n\t}\n\n\ttoTranslationSnapped( delta: IPoint, result: IPoint ): IPoint {\n\t\tconst dx = delta.x;\n\t\tconst dy = delta.y;\n\t\tlet x = NaN;\n\t\tlet y = NaN;\n\t\tif( this._isEnabled ) {\n\t\t\tconst workTranslate = this._workTranslate;\n\t\t\tconst points = this._points;\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tworkTranslate.set( point.x + dx, point.y + dy );\n\t\t\t\tthis.snap( workTranslate, workTranslate );\n\n\t\t\t\t// X\n\t\t\t\tif( ! isNaN( workTranslate.x ) ) {\n\t\t\t\t\tconst newDx = workTranslate.x - point.x;\n\t\t\t\t\tif( isNaN( x ) || Math.abs( newDx - dx ) < Math.abs( x - dx ) ) {\n\t\t\t\t\t\tx = newDx;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Y\n\t\t\t\tif( ! isNaN( workTranslate.y ) ) {\n\t\t\t\t\tconst newDy = workTranslate.y - point.y;\n\t\t\t\t\tif( isNaN( y ) || Math.abs( newDy - dy ) < Math.abs( y - dy ) ) {\n\t\t\t\t\t\ty = newDy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresult.x = ( isNaN( x ) ? dx : x );\n\t\tresult.y = ( isNaN( y ) ? dy : y );\n\t\treturn result;\n\t}\n\n\tprepareForRotate( modifier: ESnapperModifier ): void {\n\t\t//\n\t}\n\n\tprotected getGridSizeRotation(): number {\n\t\treturn 5;\n\t}\n\n\tprotected toRadian( value: number ): number {\n\t\treturn value / 180 * Math.PI;\n\t}\n\n\tprotected toDegree( value: number ): number {\n\t\treturn value / Math.PI * 180;\n\t}\n\n\ttoRotationSnapped( baseRotation: number, deltaRotation: number ): number {\n\t\tif( this._isEnabled ) {\n\t\t\tconst gridSize = this.getGridSizeRotation();\n\t\t\tconst newRotation = baseRotation + deltaRotation;\n\t\t\tconst newRotationDegree = Math.round( this.toDegree( newRotation ) );\n\t\t\tconst newRotationDegreeResidual = newRotationDegree % 90;\n\t\t\tif( Math.abs( newRotationDegreeResidual ) <= gridSize ) {\n\t\t\t\treturn this.toRadian( newRotationDegree - newRotationDegreeResidual ) - baseRotation;\n\t\t\t} else {\n\t\t\t\tif( 90 - gridSize <= newRotationDegreeResidual ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree + (90 - newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else if( newRotationDegreeResidual <= -90 + gridSize ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree - (90 + newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else {\n\t\t\t\t\treturn deltaRotation;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn deltaRotation;\n\t}\n\n\tprotected calcNormalizedVector( p0: IPoint, p1: IPoint, result: Point ): number {\n\t\tconst dx = p1.x - p0.x;\n\t\tconst dy = p1.y - p0.y;\n\t\tconst l = Math.sqrt( dx * dx + dy * dy );\n\t\tif( EPSILON < l ) {\n\t\t\tconst d = 1 / l;\n\t\t\tresult.x = dx * d;\n\t\t\tresult.y = dy * d;\n\t\t} else {\n\t\t\tresult.x = 1;\n\t\t\tresult.y = 0;\n\t\t}\n\t\treturn l;\n\t}\n\n\tprepareForScale( modifier: ESnapperModifier, anchor: ESnapperModifierAnchor ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 2 ], points[ 1 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 2 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 2 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 1 ], points[ 2 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setScaleSnappedResult(\n\t\tdistance: number,\n\t\tlength: number,\n\t\tmove: number,\n\t\taxis: boolean, // true => x axis, false y axis\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tif( EPSILON < length ) {\n\t\t\tif( isNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst newScale = 1 + move / length;\n\t\t\t\tif( axis ) {\n\t\t\t\t\tresult.scale.x = newScale;\n\t\t\t\t} else {\n\t\t\t\t\tresult.scale.y = newScale;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnapped1D(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\taxis: boolean,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\t\tthis.snap( work, work );\n\t\tconst x = work.x;\n\t\tconst y = work.y;\n\n\t\t// X coordinate\n\t\tif( ! isNaN( x ) ) {\n\t\t\tconst nx = Math.abs( normal.x );\n\t\t\tif( EPSILON < nx ) {\n\t\t\t\tconst dx = (x - tx) / normal.x;\n\t\t\t\tconst distance = Math.abs( dx );\n\t\t\t\tconst mx = (x - point.x) / normal.x;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, mx, axis, result );\n\t\t\t}\n\t\t}\n\n\t\t// Y coordinate\n\t\tif( ! isNaN( y ) ) {\n\t\t\tconst ny = Math.abs( normal.y );\n\t\t\tif( EPSILON < ny ) {\n\t\t\t\tconst dy = (y - ty) / normal.y;\n\t\t\t\tconst distance = Math.abs( dy );\n\t\t\t\tconst my = (y - point.y) / normal.y;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, my, axis, result );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedX(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, true, result );\n\t}\n\n\tprotected calcScaleSnappedY(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, false, result );\n\t}\n\n\tcalcScaleSnapped2D(\n\t\ttransform: Matrix, point: Point, normals: IPoint[],\n\t\tlengths: number[], result: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\n\t\tthis.snap( work, work );\n\t\tlet x = work.x;\n\t\tlet y = work.y;\n\t\tif( isNaN( x ) ) {\n\t\t\tif( isNaN( y ) ) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tx = tx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( isNaN( y ) ) {\n\t\t\t\ty = ty;\n\t\t\t}\n\t\t}\n\n\t\t// (x, y) = (tx, ty) + normalA * a + normalB * b\n\t\t// dx = x - tx\n\t\t// dy = y - ty\n\t\t// V = ( a, b )^T\n\t\t// D = ( dx, dy )^T\n\t\t// A = | normalA.x normalB.x |\n\t\t//     | normalA.y normalB.y |\n\t\t// A V = D\n\t\t// det A = normalA.x * normalB.y - normalB.x * normalA.y\n\t\t// A^-1 = |  normalB.y -normalB.x | / det A\n\t\t//        | -normalA.y  normalA.x |\n\t\tconst detA = normals[ 0 ].x * normals[ 1 ].y - normals[ 1 ].x * normals[ 0 ].y;\n\t\tif( EPSILON < Math.abs( detA ) ) {\n\t\t\tconst dx = x - tx;\n\t\t\tconst dy = y - ty;\n\t\t\tconst distance = Math.abs( dx * dx + dy * dy );\n\t\t\tif( isNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst mdx = x - point.x;\n\t\t\t\tconst mdy = y - point.y;\n\t\t\t\tconst mx = ( +normals[ 1 ].y * mdx - normals[ 1 ].x * mdy ) / detA;\n\t\t\t\tconst my = ( -normals[ 0 ].y * mdx + normals[ 0 ].x * mdy ) / detA;\n\t\t\t\tresult.scale.set(\n\t\t\t\t\t1 + mx / lengths[ 0 ],\n\t\t\t\t\t1 + my / lengths[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedXY(\n\t\ttransform: Matrix,\n\t\tpointO: Point,\n\t\tpointX: Point,\n\t\tpointY: Point,\n\t\tnormals: IPoint[],\n\t\tlengths: number[],\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped2D( transform, pointO, normals, lengths, result );\n\t\tthis.calcScaleSnappedX( transform, pointY, normals[ 0 ], lengths[ 0 ], result );\n\t\tthis.calcScaleSnappedY( transform, pointX, normals[ 1 ], lengths[ 1 ], result );\n\t}\n\n\ttoScaleSnapped(\n\t\ttransform: Matrix, anchor: ESnapperModifierAnchor, keepRatio: boolean, scale: IPoint\n\t): boolean {\n\t\tif( this._isEnabled ) {\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tconst work = this._workScaleResult;\n\t\t\twork.distance = NaN;\n\t\t\twork.scale.set( scale.x, scale.y );\n\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 0 ], points[ 1 ], points[ 3 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 1 ], points[ 0 ], points[ 2 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 3 ], points[ 2 ], points[ 0 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 2 ], points[ 3 ], points[ 1 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( ! isNaN( work.distance ) ) {\n\t\t\t\tscale.copyFrom( work.scale );\n\t\t\t\tif( keepRatio ) {\n\t\t\t\t\tswitch( anchor ) {\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\t\t\tscale.x = scale.y = Math.max( scale.x, scale.y );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\t\t\tscale.x = scale.y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\t\t\tscale.y = scale.x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): void {\n\t\tthis.enable();\n\t\tthis.target.reset();\n\t\tthis.grid.reset();\n\t}\n\n\tserialize(): DDiagramSerializedSnap {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis.target.serialize(),\n\t\t\tthis.grid.serialize()\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnap ): void {\n\t\tif( serialized[ 0 ] !== 0 ) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\t\tthis.target.deserialize( serialized[ 1 ] );\n\t\tthis.grid.deserialize( serialized[ 2 ] );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapTarget, DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperTargetValue, ESnapperTargetValueType } from \"./e-snapper-target-value\";\n\nexport class ESnapperTarget extends utils.EventEmitter {\n\tvalues: ESnapperTargetValue[];\n\tprotected _isVisible: boolean;\n\tprotected _isEnabled: boolean;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.values = [];\n\t\tthis._isVisible = true;\n\t\tthis._isEnabled = true;\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tadd( target: ESnapperTargetValue, index?: number ): void {\n\t\tif( index != null ) {\n\t\t\tthis.values.splice( index, 0, target );\n\t\t} else {\n\t\t\tthis.values.push( target );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.values.length;\n\t}\n\n\treplace( index: number, value: ESnapperTargetValue ): ESnapperTargetValue | null {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalues[ index ] = value;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tif( indexA !== indexB ) {\n\t\t\tconst values = this.values;\n\t\t\tconst valueA = values[ indexA ];\n\t\t\tvalues[ indexA ] = values[ indexB ];\n\t\t\tvalues[ indexB ] = valueA;\n\t\t}\n\t}\n\n\tget visible(): boolean {\n\t\treturn this._isVisible;\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._isVisible !== visible ) {\n\t\t\tthis._isVisible = visible;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tsnap( px: number, py: number, x: ESnapperResult, y: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst values = this.values;\n\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\tconst value = values[ i ];\n\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\tx.set( px, value.position );\n\t\t\t\t} else {\n\t\t\t\t\ty.set( py, value.position );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._isVisible = true;\n\t\tthis.values.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapTarget {\n\t\tconst targets: DDiagramSerializedSnapTargetValue[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\ttargets.push( values[ i ].serialize() );\n\t\t}\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\t(this._isVisible ? 1 : 0),\n\t\t\ttargets\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapTarget ): void {\n\t\t// Availability\n\t\tthis._isEnabled = ( serialized[ 0 ] !== 0 );\n\n\t\t// Visibility\n\t\tthis._isVisible = ( serialized[ 1 ] !== 0 );\n\n\t\t// Values\n\t\tconst sources = serialized[ 2 ];\n\t\tconst values = this.values;\n\t\tvalues.length = 0;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i ) {\n\t\t\tconst source = sources[ i ];\n\t\t\tvalues.push( new ESnapperTargetValue( source[ 0 ], source[ 1 ] ) );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DCommandFlag {\n\tNONE = 0,\n\n\t/**\n\t * Commands with a `UNSTORABLE` flag will not be queued to the `done` queue.\n\t */\n\tUNSTORABLE = 1,\n\n\t/**\n\t * Commands with a `CLEAR` flag clears the command queue.\n\t */\n\tCLEAR = 2\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DAnimation, DAnimationOnEnd, DAnimationOnTime, DAnimationOptions } from \"./d-animation\";\nimport { DBase } from \"./d-base\";\n\nexport class DAnimationEmpty extends utils.EventEmitter implements DAnimation {\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime | undefined;\n\tprotected _onStart: DAnimationOnEnd | undefined;\n\tprotected _onEnd: DAnimationOnEnd | undefined;\n\tprotected _target: DBase<any, any> | null;\n\tprotected _isStarted: boolean;\n\n\tconstructor( options?: DAnimationOptions ) {\n\t\tsuper();\n\n\t\tthis._target = null;\n\t\tthis._reverse = false;\n\t\tthis._isStarted = false;\n\t\tthis._onTime = ( options != null ? options.onTime : undefined );\n\t\tthis._onStart = ( options != null ? options.onStart : undefined );\n\t\tthis._onEnd = ( options != null ? options.onEnd : undefined );\n\t}\n\n\tget target(): DBase<any, any> | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: DBase<any, any> | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn 0;\n\t}\n\n\tset duration( duration: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._isStarted = true;\n\t\tthis._reverse = reverse;\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// onTime\n\t\tthis.onTime( reverse ? 1 : 0, reverse, 0 );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onTime( reverse ? 0 : 1, reverse, 0 );\n\t\tif( this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// OnEnd\n\t\tthis.onEnd( reverse );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn this._isStarted;\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tstop(): void {\n\t\tthis._isStarted = false;\n\t}\n\n\tend(): void {\n\t\tconst isStarted = this._isStarted;\n\t\tif( isStarted ) {\n\t\t\tthis._isStarted = false;\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst time = ( reverse ? 0 : 1 );\n\t\t\tthis.onTime( time, reverse, 0 );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimationOptions } from \"./d-animation\";\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\n\nexport interface DAnimationFadeInShiftOptions {\n\tx?: number | null;\n\ty?: number | null;\n}\n\nexport interface DAnimationFadeInOptions extends DAnimationOptions {\n\tshift?: DAnimationFadeInShiftOptions;\n}\n\nexport class DAnimationFadeIn extends DAnimationBase {\n\tprotected _shiftX: number;\n\tprotected _shiftY: number;\n\n\tprotected _storedX: number = 0;\n\tprotected _storedY: number = 0;\n\tprotected _storedAlpha: number = 0;\n\tprotected _storedTime: number = 0;\n\tprotected _storedTarget: DBase<any, any> | null = null;\n\n\tprotected _layer: DApplicationLayerLike | null = null;\n\n\tprotected _onPrerenderBound: () => void;\n\tprotected _onPostrenderBound: () => void;\n\n\tconstructor( options?: DAnimationFadeInOptions ) {\n\t\tsuper( options );\n\n\t\t// Shifts\n\t\tif( options != null && options.shift != null ) {\n\t\t\tconst shift = options.shift;\n\t\t\tthis._shiftX = (shift.x != null ? shift.x : 0);\n\t\t\tthis._shiftY = (shift.y != null ? shift.y : 15);\n\t\t} else {\n\t\t\tthis._shiftX = 0;\n\t\t\tthis._shiftY = 15;\n\t\t}\n\n\t\tthis._onPrerenderBound = () => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tthis._onPostrenderBound = () => {\n\t\t\tthis.onPostrender();\n\t\t};\n\t}\n\n\tstop(): void {\n\t\tthis._storedTime = 0;\n\t\tthis.removeEventListeners();\n\t\tsuper.stop();\n\t}\n\n\tprotected addEventListeners( target: DBase<any, any> ): void {\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tthis._layer = layer;\n\t\t\tconst renderer = layer.renderer;\n\t\t\trenderer.on( \"prerender\", this._onPrerenderBound );\n\t\t\trenderer.on( \"postrender\", this._onPostrenderBound );\n\t\t}\n\t}\n\n\tprotected removeEventListeners(): void {\n\t\tconst layer = this._layer;\n\t\tif( layer ) {\n\t\t\tthis._layer = null;\n\t\t\tconst renderer = layer.renderer;\n\t\t\trenderer.off( \"prerender\", this._onPrerenderBound );\n\t\t\trenderer.off( \"postrender\", this._onPostrenderBound );\n\t\t}\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget = this._target;\n\t\tif( target != null ) {\n\t\t\tthis._storedTime = 0;\n\t\t\tthis.removeEventListeners();\n\t\t\tthis.addEventListeners( target );\n\t\t\tif( ! isReverse ) {\n\t\t\t\ttarget.visible = true;\n\t\t\t}\n\t\t\tsuper.onStart( isReverse );\n\t\t}\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst layer = this._layer;\n\t\t\tif( layer ) {\n\t\t\t\tlayer.disallowUpdate();\n\t\t\t\tthis._storedTime = time;\n\t\t\t\tsuper.onTime( time, isReverse, elapsedTime );\n\t\t\t\tlayer.allowUpdate();\n\t\t\t\tlayer.render();\n\t\t\t} else {\n\t\t\t\tthis._storedTime = time;\n\t\t\t\tsuper.onTime( time, isReverse, elapsedTime );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tthis.removeEventListeners();\n\t\t\tif( isReverse ) {\n\t\t\t\ttarget.visible = false;\n\t\t\t}\n\t\t\tsuper.onEnd( isReverse );\n\t\t}\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst storedTime = this._storedTime;\n\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tthis._storedX = position.x;\n\t\t\tthis._storedY = position.y;\n\t\t\tposition.set(\n\t\t\t\tposition.x - this._shiftX * ( 1 - storedTime ),\n\t\t\t\tposition.y - this._shiftY * ( 1 - storedTime )\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\tthis._storedAlpha = target.alpha;\n\t\t\ttarget.alpha = storedTime;\n\t\t}\n\t}\n\n\tprotected onPostrender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tposition.set(\n\t\t\t\tthis._storedX,\n\t\t\t\tthis._storedY\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\ttarget.alpha = this._storedAlpha;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\n\nexport class DApplicationPadding implements DPadding {\n\tleft: number;\n\ttop: number;\n\tright: number;\n\tbottom: number;\n\n\tconstructor( top: number, right: number, bottom: number, left: number ) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.right = right;\n\t\tthis.bottom = bottom;\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tgetTop(): number {\n\t\treturn this.left;\n\t}\n\n\tgetRight(): number {\n\t\treturn this.right;\n\t}\n\n\tgetBottom(): number {\n\t\treturn this.bottom;\n\t}\n\n\tgetLeft(): number {\n\t\treturn this.left;\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ): void {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationPadding } from \"./d-application-padding\";\nimport { DPadding, DPaddingLike } from \"./d-padding\";\nimport { isNumber } from \"./util/is-number\";\n\n/**\n * PixiJS options\n */\ninterface PixiApplicationOptions {\n\twidth: number;\n\theight: number;\n\tautoStart: boolean;\n\tbackgroundColor: number;\n\ttransparent: boolean;\n\tresolution: number;\n\tantialias: boolean;\n}\n\ninterface DApplicationLayerBackgroundOptions {\n\tcolor?: number | null;\n}\n\ninterface DApplicationLayerOptionsOptions {\n\troot: HTMLElement;\n\tpadding?: number | DPaddingLike;\n\twidth?: number;\n\theight?: number;\n\tbackground?: DApplicationLayerBackgroundOptions;\n\tresolution: number;\n\tantialias?: boolean;\n\n\t/**\n\t * Sets to true if a layer is a overlay layer.\n\t */\n\toverlay: boolean;\n}\n\n/**\n * DApplicationLayer options\n */\nexport class DApplicationLayerOptions {\n\tprivate _root: HTMLElement;\n\tprivate _pixi: PixiApplicationOptions;\n\tprivate _padding: DPadding;\n\tprivate _overlay: boolean;\n\n\tconstructor( options: DApplicationLayerOptionsOptions ) {\n\t\t// Root\n\t\tconst root = this._root = options.root;\n\n\t\t// Overlay mode or not\n\t\tthis._overlay = options.overlay;\n\n\t\t// Padding\n\t\tconst padding = options && options.padding;\n\t\tif( isNumber( padding ) ) {\n\t\t\tthis._padding = new DApplicationPadding( padding, padding, padding, padding );\n\t\t} else if( padding != null ) {\n\t\t\tthis._padding = new DApplicationPadding(\n\t\t\t\tpadding.top || 0,\n\t\t\t\tpadding.right || 0,\n\t\t\t\tpadding.bottom || 0,\n\t\t\t\tpadding.left || 0\n\t\t\t);\n\t\t} else {\n\t\t\tthis._padding = new DApplicationPadding( 6, 6, 6, 6 );\n\t\t}\n\n\t\t// Width & height\n\t\tlet width = 100;\n\t\tlet height = 100;\n\t\tif( options ) {\n\t\t\tif( options.width != null ) {\n\t\t\t\twidth = options.width;\n\t\t\t\tif( options.height != null ) {\n\t\t\t\t\theight = options.height;\n\t\t\t\t} else {\n\t\t\t\t\theight = root.getBoundingClientRect().height;\n\t\t\t\t}\n\t\t\t} else if( options.height != null ) {\n\t\t\t\twidth = root.getBoundingClientRect().width;\n\t\t\t\theight = options.height;\n\t\t\t} else {\n\t\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\t\twidth = bbox.width;\n\t\t\t\theight = bbox.height;\n\t\t\t}\n\t\t} else {\n\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\twidth = bbox.width;\n\t\t\theight = bbox.height;\n\t\t}\n\n\t\t// Background color\n\t\tconst background = options && options.background;\n\t\tlet backgroundColor = 0;\n\t\tlet transparent = true;\n\t\tif( background != null ) {\n\t\t\tconst color = background.color;\n\t\t\tif( color != null ) {\n\t\t\t\tbackgroundColor = color;\n\t\t\t\ttransparent = false;\n\t\t\t}\n\t\t}\n\n\t\t// Resolution\n\t\tconst resolution = options.resolution;\n\n\t\t// Antialias\n\t\tconst antialias = ( options && options.antialias != null ? options.antialias : false );\n\n\t\t// Pixi\n\t\tthis._pixi = {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tautoStart: false,\n\t\t\tbackgroundColor,\n\t\t\ttransparent,\n\t\t\tresolution,\n\t\t\tantialias\n\t\t};\n\t}\n\n\t/**\n\t * Returns a root element.\n\t * `HTMLCanvasElement` and other DOM elements are created in this element.\n\t * The default root element is `document.body`.\n\t */\n\tgetRootElement(): HTMLElement {\n\t\treturn this._root;\n\t}\n\n\t/**\n\t * Sets a root element and updates the canvas width and height\n\t * if `updateWidthAndHeight` is not false.\n\t *\n\t * @param root new root element\n\t * @param updateWidthAndHeight false to preserve the canvas width / height\n\t */\n\tsetRootElement( root: HTMLElement, updateWidthAndHeight?: boolean ): this {\n\t\tif( this._root !== root ) {\n\t\t\tthis._root = root;\n\t\t\tif( updateWidthAndHeight !== false ) {\n\t\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\t\tconst pixi = this._pixi;\n\t\t\t\tpixi.width = bbox.width;\n\t\t\t\tpixi.height = bbox.height;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas width.\n\t */\n\tgetWidth(): number {\n\t\treturn this._pixi.width;\n\t}\n\n\t/**\n\t * Sets a canvas width.\n\t *\n\t * @param width new canvas width\n\t */\n\tsetWidth( width: number ): this {\n\t\tthis._pixi.width = width;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas height.\n\t */\n\tgetHeight(): number {\n\t\treturn this._pixi.height;\n\t}\n\n\t/**\n\t * Sets a canvas height.\n\t *\n\t * @param height new canvas height\n\t */\n\tsetHeight( height: number ): this {\n\t\tthis._pixi.height = height;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns padding sizes.\n\t * The default padding size is 6.\n\t */\n\tgetPadding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\t/**\n\t * Sets padding sizes.\n\t *\n\t * @param left new left padding\n\t * @param top new top padding\n\t * @param right new right padding\n\t * @param bottom new bottom padding\n\t * @asse getPadding\n\t */\n\tsetPadding( left: number, top: number, right: number, bottom: number ): this {\n\t\tconst padding = this._padding;\n\t\tpadding.left = left;\n\t\tpadding.top = top;\n\t\tpadding.right = right;\n\t\tpadding.bottom = bottom;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a background color.\n\t */\n\tgetBackgroundColor(): number {\n\t\treturn this._pixi.backgroundColor;\n\t}\n\n\t/**\n\t * Sets a background color.\n\t *\n\t * @param color new background color\n\t */\n\tsetBackgroundColor( color: number ): this {\n\t\tthis._pixi.backgroundColor = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an antialias setting.\n\t * The default antialias setting is false.\n\t */\n\tgetAntialias(): boolean {\n\t\treturn this._pixi.antialias;\n\t}\n\n\t/**\n\t * Sets an antialias setting.\n\t *\n\t * @param antialias new antialias setting\n\t */\n\tsetAntialias( antialias: boolean ): this {\n\t\tthis._pixi.antialias = antialias;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns true if a layer is supposed to be an overlay layer.\n\t */\n\tisOverlay(): boolean {\n\t\treturn this._overlay;\n\t}\n\n\tgetPixiApplicationOptions(): PixiApplicationOptions {\n\t\treturn this._pixi;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport {\n\tDControllerFocus, DFocusable, DFocusableContainer, DFocusableMightBe\n} from \"./d-controller-focus\";\n\nconst isFocusable = ( target: any ): target is DFocusable => {\n\treturn ( target != null && (\"setState\" in target) );\n};\n\nconst isFocusableContainer = ( target: any ): target is DFocusableContainer => {\n\treturn ( target != null && \"children\" in target );\n};\n\ninterface Selectable {\n\tselect(): void;\n}\n\nconst isSelectable = ( target: any ): target is Selectable => {\n\treturn ( target != null && \"select\" in target );\n};\n\nexport class DControllerDefaultFocus implements DControllerFocus {\n\tprivate _focused: DFocusable | null = null;\n\n\tsetFocused( focusable: DFocusable | null, isFocused: boolean, select: boolean ): DFocusable | null {\n\t\tif( isFocused ) {\n\t\t\tconst previous = this._focused;\n\t\t\tif( previous !== focusable ) {\n\t\t\t\tif( previous != null ) {\n\t\t\t\t\tprevious.setState( DBaseState.FOCUSED, false );\n\t\t\t\t}\n\n\t\t\t\tthis._focused = focusable;\n\t\t\t\tif( focusable != null && this.isFocusable( focusable ) ) {\n\t\t\t\t\tfocusable.setState( DBaseState.FOCUSED, true );\n\t\t\t\t\tif( select && isSelectable( focusable ) ) {\n\t\t\t\t\t\tfocusable.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn previous;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\tif( focusable != null && this._focused === focusable ) {\n\t\t\t\tthis._focused = null;\n\t\t\t\tfocusable.setState( DBaseState.FOCUSED, false );\n\t\t\t\tif( select && isSelectable( focusable ) ) {\n\t\t\t\t\tfocusable.select();\n\t\t\t\t}\n\t\t\t\treturn focusable;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFocused(): DFocusable | null {\n\t\treturn this._focused;\n\t}\n\n\tfindFocusableParent( mightBeFocusable: DFocusableMightBe | null ): DFocusable | null {\n\t\tlet current: DFocusableMightBe | DFocusableContainer | null = mightBeFocusable;\n\t\twhile( current != null ) {\n\t\t\tif( this.isFocusable( current ) ) {\n\t\t\t\treturn current;\n\t\t\t} else {\n\t\t\t\tcurrent = current.parent;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected isFocusable( target: unknown ): target is DFocusable {\n\t\treturn (\n\t\t\tisFocusable( target ) &&\n\t\t\t! target.hasState( DBaseState.DISABLED | DBaseState.UNFOCUSABLE ) &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tprotected isFocusRoot( target: unknown ): target is DFocusable {\n\t\treturn (\n\t\t\tisFocusable( target ) &&\n\t\t\ttarget.hasState( DBaseState.FOCUS_ROOT ) &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tfindFocusable(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean, direction: boolean\n\t): DFocusable | null {\n\t\tif( direction ) {\n\t\t\tconst result = this.findFocusableNext( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t// Siblings\n\t\t\t\t\tfor( let i = index + 1, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( this.isFocusRoot( parent ) ) {\n\t\t\t\t\t\tfor( let i = 0, imax = index + 1; i < imax; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parent\n\t\t\t\t\treturn this.findFocusable( parent, false, false, true );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = this.findFocusablePrevious( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t// Siblings\n\t\t\t\t\tfor( let i = index - 1; 0 <= i; --i ) {\n\t\t\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( this.isFocusRoot( parent ) ) {\n\t\t\t\t\t\tfor( let i = children.length - 1; index <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn parent;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parent\n\t\t\t\t\treturn this.findFocusable( parent, true, false, false );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected findFocusableNext(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Target children\n\t\tif( includesTargetChildren && isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\tif( found != null ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Siblings\n\t\tif( this.isFocusRoot( target ) ) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n\n\tprotected findFocusablePrevious(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target children\n\t\tif( includesTargetChildren && isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\tif( found != null ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Siblings\n\t\tif( this.isFocusRoot( target ) ) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandClear implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DDialogCloseOn {\n\tNONE = 0,\n\tESC = 1,\n\tCLICK_OUTSIDE = 2\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandRedo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandUndo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DCommand } from \"./d-command\";\nimport { DCommandClear } from \"./d-command-clear\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DCommandRedo } from \"./d-command-redo\";\nimport { DCommandUndo } from \"./d-command-undo\";\nimport { DControllerCommand } from \"./d-controller-command\";\n\nconst isCommandStorable = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.UNSTORABLE ) === 0;\n};\n\nconst isCommandClear = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.CLEAR ) !== 0;\n};\n\nexport class DControllerDefaultCommand extends utils.EventEmitter implements DControllerCommand {\n\tprotected _position: number;\n\tprotected _done: DCommand[];\n\tprotected _waiting: DCommand[];\n\tprotected _executing: Promise<void> | null;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._position = 0;\n\t\tthis._done = [];\n\t\tthis._waiting = [];\n\t\tthis._executing = null;\n\t}\n\n\tlast(): DCommand | null {\n\t\tconst done = this._done;\n\t\tconst waiting = this._waiting;\n\n\t\tif( waiting.length <= 0 ) {\n\t\t\tif( 0 < done.length ) {\n\t\t\t\treturn done[ done.length - 1 ];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn waiting[ waiting.length - 1 ];\n\t\t}\n\t}\n\n\tpush( command: DCommand ): void {\n\t\tconst waiting = this._waiting;\n\t\twaiting.push( command );\n\t\tthis.next();\n\t}\n\n\tnext() {\n\t\tif( this._executing == null ) {\n\t\t\tconst waiting = this._waiting;\n\t\t\tif( 0 < waiting.length ) {\n\t\t\t\tconst command = waiting.shift();\n\t\t\t\tif( command != null ) {\n\t\t\t\t\tif( command instanceof DCommandUndo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( this._position < done.length ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - 1 - this._position ];\n\t\t\t\t\t\t\tthis._position += 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.undo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if( command instanceof DCommandRedo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( 0 < this._position ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - this._position ];\n\t\t\t\t\t\t\tthis._position -= 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.redo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst isClear = isCommandClear( command );\n\t\t\t\t\t\tconst isStorable = isCommandStorable( command );\n\t\t\t\t\t\tif( isClear || isStorable ) {\n\t\t\t\t\t\t\tconst size = ( isClear ? this._done.length : this._position );\n\t\t\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\t\t\tthis.remove( size );\n\t\t\t\t\t\t\t\tthis._position = 0;\n\t\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst result = command.execute();\n\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst done = this._done;\n\t\tconst size = done.length - 100;\n\t\tif( 0 < size ) {\n\t\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\t\tdone[ i ].destroy();\n\t\t\t\tdone.shift();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove( size: number ): boolean {\n\t\tconst done = this._done;\n\t\tif( 0 < size ) {\n\t\t\tconst ifrom = Math.max( 0, done.length - size );\n\t\t\tsize = done.length - ifrom;\n\t\t\tif( 0 < size ) {\n\t\t\t\tfor( let i = ifrom, imax = done.length; i < imax; ++i ) {\n\t\t\t\t\tdone[ i ].destroy();\n\t\t\t\t}\n\n\t\t\t\tdone.splice( ifrom, done.length - ifrom );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onSuccess( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tif( isCommandStorable( command ) ) {\n\t\t\tthis._done.push( command );\n\t\t\tthis.emit( \"dirty\", this );\n\t\t} else if( command instanceof DCommandUndo || command instanceof DCommandRedo ) {\n\t\t\tthis.emit( \"dirty\", this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tthis.next();\n\t}\n\n\tprotected onFail( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tconst waiting = this._waiting;\n\t\tcommand.destroy();\n\t\tfor( let i = 0, imax = waiting.length; i < imax; ++i ) {\n\t\t\twaiting[ i ].destroy();\n\t\t}\n\t\twaiting.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tsize(): number {\n\t\treturn this._done.length;\n\t}\n\n\tclear(): void {\n\t\tthis.push( new DCommandClear() );\n\t}\n\n\tredo(): void {\n\t\tif( this.isRedoable() ) {\n\t\t\tthis._waiting.push( new DCommandRedo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tundo(): void {\n\t\tif( this.isUndoable() ) {\n\t\t\tthis._waiting.push( new DCommandUndo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tisRedoable(): boolean {\n\t\treturn ( 0 < this._position && this._executing == null );\n\t}\n\n\tisUndoable(): boolean {\n\t\treturn ( this._position < this._done.length && this._executing == null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DControllerFocus, DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport class DControllerKeyboard extends utils.EventEmitter {\n\tinit( element: HTMLElement, stage: Container, focusController: DControllerFocus ) {\n\t\telement.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keydown\", e );\n\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyDown( current ) ) {\n\t\t\t\t\t\tif( current.onKeyDown( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\t\tconst next = ( focused != null ?\n\t\t\t\t\tfocusController.findFocusable(\n\t\t\t\t\t\tfocused, false, focused.hasState( DBaseState.FOCUS_ROOT ) || direction, direction\n\t\t\t\t\t) :\n\t\t\t\t\tfocusController.findFocusable( stage, false, true, direction )\n\t\t\t\t);\n\t\t\t\tif( next != null ) {\n\t\t\t\t\tfocusController.setFocused( next, true, true );\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"keyup\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keyup\", e );\n\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyUp( current ) ) {\n\t\t\t\t\t\tif( current.onKeyUp( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected hasOnKeyDown( target: any ): target is { onKeyDown( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyDown\" in target;\n\t}\n\n\tprotected hasOnKeyUp( target: any ): target is { onKeyUp( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyUp\" in target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerCommand } from \"./d-controller-command\";\nimport { DControllerDefaultCommand } from \"./d-controller-default-command\";\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllerKeyboard } from \"./d-controller-keyboard\";\nimport { DDocument } from \"./d-document\";\n\nexport class DControllers {\n\tprotected static KEYBOARD: DControllerKeyboard | null;\n\tprotected static COMMAND: DControllerCommand | null;\n\tprotected static DOCUMENT: DControllerDocument<any> | null;\n\n\t// Keyboard\n\tstatic getKeyboardController(): DControllerKeyboard {\n\t\tif( this.KEYBOARD == null ) {\n\t\t\tthis.KEYBOARD = new DControllerKeyboard();\n\t\t}\n\t\treturn this.KEYBOARD;\n\t}\n\n\tstatic setKeyboardController( instance: DControllerKeyboard ): DControllerKeyboard | null {\n\t\tconst result = this.KEYBOARD;\n\t\tthis.KEYBOARD = instance;\n\t\treturn result;\n\t}\n\n\t// Command\n\tstatic getCommandController(): DControllerCommand {\n\t\tif( this.COMMAND == null ) {\n\t\t\tthis.COMMAND = new DControllerDefaultCommand();\n\t\t}\n\t\treturn this.COMMAND;\n\t}\n\n\tstatic setCommandController( instance: DControllerCommand ): DControllerCommand | null {\n\t\tconst result = this.COMMAND;\n\t\tthis.COMMAND = instance;\n\t\treturn result;\n\t}\n\n\t// Document\n\tstatic getDocumentController<DOCUMENT extends DDocument>(): DControllerDocument<DOCUMENT> {\n\t\tif( this.DOCUMENT == null ) {\n\t\t\tthrow new Error( \"Not supported\" );\n\t\t}\n\t\treturn this.DOCUMENT;\n\t}\n\n\tstatic setDocumentController<DOCUMENT extends DDocument>(\n\t\tinstance: DControllerDocument<DOCUMENT>\n\t): DControllerDocument<DOCUMENT> | null {\n\t\tconst result = this.DOCUMENT;\n\t\tthis.DOCUMENT = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Application, interaction, Point } from \"pixi.js\";\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplicationLayerOptions } from \"./d-application-layer-options\";\nimport { DApplicationLike } from \"./d-application-like\";\nimport { DBase } from \"./d-base\";\nimport { DControllerDefaultFocus } from \"./d-controller-default-focus\";\nimport { DControllerFocus, DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { DControllers } from \"./d-controllers\";\nimport { DPadding } from \"./d-padding\";\nimport { DynamicFontAtlases } from \"./util/dynamic-font-atlases\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEvent, UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\ninterface DblClickable {\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean;\n}\n\nconst isDblClickable = ( target: any ): target is DblClickable => {\n\treturn target != null && target.onDblClick != null;\n};\n\ninterface Wheelable {\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean;\n}\n\nconst isWheelable = ( target: any ): target is Wheelable => {\n\treturn target != null && target.onWheel != null;\n};\n\nexport class DApplicationLayer extends Application implements DApplicationLayerLike {\n\tprotected _options: DApplicationLayerOptions;\n\tprotected _renderId: number | null = null;\n\tprotected _renderBound: () => void;\n\tprotected _isUpdateAllowed: boolean;\n\tprotected _refitLimit: number;\n\tprotected _reflowLimit: number;\n\tprotected _focus?: DControllerFocus;\n\tprotected _elementContainer: HTMLDivElement;\n\tprotected _dynamicFontAtlases: DynamicFontAtlases | null = null;\n\tprotected _isVisible: boolean;\n\n\treadonly application: DApplicationLike;\n\n\tconstructor( application: DApplicationLike, options: DApplicationLayerOptions ) {\n\t\tsuper( options.getPixiApplicationOptions() );\n\n\t\tthis.application = application;\n\t\tconst stageAny = this.stage as any;\n\t\tstageAny.layer = this;\n\t\tstageAny.application = application;\n\n\t\tthis._options = options;\n\t\tthis._isUpdateAllowed = true;\n\t\tthis._refitLimit = 5;\n\t\tthis._reflowLimit = 5;\n\t\tthis._isVisible = true;\n\n\t\tthis._renderBound = (): void => {\n\t\t\tif( this._renderId != null ) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\t// Canvas initialization\n\t\tconst rootElement = options.getRootElement();\n\t\tconst elementContainer = document.createElement( \"div\" );\n\t\telementContainer.setAttribute( \"style\",\n\t\t\t\"position: absolute; top: 0; left: 0; width: 0; height: 0;\" +\n\t\t\t\"margin: 0; padding: 0; outline: none;\"\n\t\t);\n\t\tthis._elementContainer = elementContainer;\n\t\tconst children = rootElement.children;\n\t\tif( options.isOverlay() ) {\n\t\t\tif( 3 <= children.length ) {\n\t\t\t\tconst thirdChild = children[ 2 ];\n\t\t\t\trootElement.insertBefore( this.view, thirdChild );\n\t\t\t\trootElement.insertBefore( elementContainer, thirdChild );\n\t\t\t} else {\n\t\t\t\trootElement.appendChild( this.view );\n\t\t\t\trootElement.appendChild( elementContainer );\n\t\t\t}\n\n\t\t\tconst oldOnChildrenChange = stageAny.onChildrenChange;\n\t\t\tstageAny.onChildrenChange = () => {\n\t\t\t\tthis.updateVisibility();\n\t\t\t\toldOnChildrenChange.call( stageAny );\n\t\t\t};\n\t\t} else {\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst firstChild = children[ 0 ];\n\t\t\t\trootElement.insertBefore( this.view, firstChild );\n\t\t\t\trootElement.insertBefore( elementContainer, firstChild );\n\t\t\t} else {\n\t\t\t\trootElement.appendChild( this.view );\n\t\t\t\trootElement.appendChild( elementContainer );\n\t\t\t}\n\t\t}\n\t\tconst rootElementStyle = rootElement.style;\n\t\tif( rootElement !== document.body ) {\n\t\t\tconst rootElementStylePosition = window.getComputedStyle( rootElement ).position;\n\t\t\tif( rootElementStylePosition === \"static\" ) {\n\t\t\t\trootElementStyle.position = \"relative\";\n\t\t\t}\n\t\t}\n\t\trootElementStyle.margin = \"0\";\n\t\trootElementStyle.padding = \"0\";\n\t\trootElementStyle.overflow = \"hidden\";\n\t\tconst viewStyle = this.view.style;\n\t\tviewStyle.position = \"absolute\";\n\t\tviewStyle.top = \"0\";\n\t\tviewStyle.left = \"0\";\n\t\tviewStyle.width = \"100%\";\n\t\tviewStyle.height = \"100%\";\n\t\tviewStyle.display = \"block\";\n\t\tviewStyle.outline = \"none\";\n\n\t\t// Focus handling\n\t\tlet hasFocus = false;\n\t\tconst focusController = this.getFocusController();\n\t\tconst onBlurBound = (): void => {\n\t\t\tif( ! hasFocus ) {\n\t\t\t\tfocusController.setFocused( null, true, false );\n\t\t\t}\n\t\t};\n\t\trootElement.addEventListener( \"focus\", ( e ): void => {\n\t\t\thasFocus = true;\n\t\t}, true );\n\t\trootElement.addEventListener( \"blur\", ( e ): void => {\n\t\t\thasFocus = false;\n\t\t\tsetTimeout( onBlurBound, 0 );\n\t\t}, true );\n\t\tthis.view.setAttribute( \"tabindex\", \"0\" );\n\n\t\tDControllers.getKeyboardController().init( this.view, this.stage, focusController );\n\n\t\tconst interactionManager: interaction.InteractionManager = this.renderer.plugins.interaction;\n\t\tinteractionManager.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target == null ) {\n\t\t\t\tfocusController.setFocused( null, true, false );\n\t\t\t}\n\t\t});\n\n\t\t// Resize handling\n\t\tconst onResize = (): void => {\n\t\t\tconst bbox = options.getRootElement().getBoundingClientRect();\n\t\t\tthis.renderer.resize( bbox.width, bbox.height );\n\t\t\tthis.resizeChildren( bbox.width, bbox.height, options.getPadding() );\n\t\t\tthis.update();\n\t\t};\n\t\twindow.addEventListener( \"resize\", onResize );\n\t\twindow.addEventListener( \"orientationchange\", onResize );\n\n\t\t// Mouse wheel handling\n\t\tconst wheelGlobal = new Point();\n\t\tconst wheelEventUtil = UtilWheelEvent.getInstance();\n\t\twheelEventUtil.on( this.view, ( e: WheelEvent | Event ): void => {\n\t\t\tconst wheelEvent = e as WheelEvent;\n\t\t\tUtilPointerEvent.toGlobal( wheelEvent, interactionManager, wheelGlobal );\n\t\t\tlet current = interactionManager.hitTest( wheelGlobal );\n\t\t\tconst deltas = wheelEventUtil.normalize( e );\n\t\t\tif( deltas != null ) {\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isWheelable( current ) ) {\n\t\t\t\t\t\tif( current.onWheel( wheelEvent, deltas, wheelGlobal ) ) {\n\t\t\t\t\t\t\twheelEvent.preventDefault();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Double click handling\n\t\tUtilPointerEvent.onDblClick( this.view, ( e: MouseEvent | TouchEvent ) => {\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isDblClickable( current ) ) {\n\t\t\t\t\t\tif( current.onDblClick( e, interactionManager ) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//\n\t\tthis.stage.interactive = true;\n\t}\n\n\tdisallowUpdate(): void {\n\t\tthis._isUpdateAllowed = false;\n\t}\n\n\tallowUpdate(): void {\n\t\tthis._isUpdateAllowed = true;\n\t}\n\n\tupdate(): void {\n\t\tif( this._isUpdateAllowed && this._renderId == null ) {\n\t\t\tthis._renderId = requestAnimationFrame( this._renderBound );\n\t\t}\n\t}\n\n\tprotected updateVisibility(): void {\n\t\tif( this._options.isOverlay() ) {\n\t\t\tif( 0 < this.stage.children.length ) {\n\t\t\t\tif( ! this._isVisible ) {\n\t\t\t\t\tthis._isVisible = true;\n\t\t\t\t\tthis.view.style.display = \"block\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( this._isVisible ) {\n\t\t\t\t\tthis._isVisible = false;\n\t\t\t\t\tthis.view.style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trender(): void {\n\t\tthis.refit();\n\t\tthis.reflow();\n\n\t\t// Please note why the following line is here.\n\t\t//\n\t\t// Before this line, the update method does not enque a rendering task\n\t\t// because `this._renderId` is not null. As a result, this prevents\n\t\t// an unintentional rendering loop caused by the refit or the reflow.\n\t\t//\n\t\t// After this line, the update method enques a rendering task.\n\t\t// Namely, in the DisplayObject#render(Renderer) method, allowed to enque\n\t\t// a rendering task. For instance, please refer to the DDiagramShape#update().\n\t\tthis._renderId = null;\n\n\t\t// Render\n\t\tsuper.render();\n\t}\n\n\tget width(): number {\n\t\treturn this.screen.width;\n\t}\n\n\tget height(): number {\n\t\treturn this.screen.height;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._options.getPadding();\n\t}\n\n\tprotected resizeChildren( width: number, height: number, padding: DPadding ): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( width, height, padding );\n\t\t\t}\n\t\t}\n\t}\n\n\trefit(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isChildrenDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t\tisChildrenDirty = isChildrenDirty || child.isChildrenDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `refit` process, need to refit again.\n\t\t\tif( ! isChildrenDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treflow(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t\tisDirty = isDirty || child.isDirty() || child.hasDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `reflow` process, need to reflow again.\n\t\t\tif( ! isDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFocusController(): DControllerFocus {\n\t\tif( this._focus == null ) {\n\t\t\tthis._focus = new DControllerDefaultFocus();\n\t\t}\n\t\treturn this._focus;\n\t}\n\n\tgetElementContainer(): HTMLElement {\n\t\treturn this._elementContainer;\n\t}\n\n\tgetDynamicFontAtlases(): DynamicFontAtlases {\n\t\tif( this._dynamicFontAtlases == null ) {\n\t\t\tthis._dynamicFontAtlases = new DynamicFontAtlases( this );\n\t\t}\n\t\treturn this._dynamicFontAtlases;\n\t}\n}\n","import { Container, Renderer } from \"pixi.js\";\nimport { DApplicationLayer } from \"./d-application-layer\";\nimport { DApplicationLayerOptions } from \"./d-application-layer-options\";\nimport { DApplicationLike } from \"./d-application-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DPaddingLike } from \"./d-padding\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DApplicationBackgroundOptions {\n\tcolor?: number;\n}\n\nexport interface DApplicationOptions {\n\t/**\n\t * A root element selector or a root element.\n\t * `HTMLCanvasElement` and other DOM elements are created in this element.\n\t * The default root element is `document.body`.\n\t */\n\troot?: string | HTMLElement;\n\n\t/**\n\t * Padding settings.\n\t */\n\tpadding?: number | DPaddingLike;\n\n\t/**\n\t * A canvas width.\n\t */\n\twidth?: number;\n\n\t/**\n\t * A canvas height.\n\t */\n\theight?: number;\n\n\t/**\n\t * A background setting.\n\t */\n\tbackground?: DApplicationBackgroundOptions;\n\n\t/**\n\t * An antialias setting.\n\t */\n\tantialias?: boolean;\n\n\t/**\n\t * A resolution.\n\t * The default value is `devicePixelRatio`.\n\t */\n\tresolution?: number;\n\n\t/**\n\t * An overlay layer setting.\n\t * The overlay layer is used by modal UI elements including DDialog\n\t * to provide the better interoperability with DOM-based UI elements\n\t * and WebGL-based UI elements.\n\t * However, an extra layer requires extra memory.\n\t * Set to true to enable the overlay layer.\n\t * The default value is false.\n\t */\n\toverlay?: boolean;\n}\n\nexport class DApplication implements DApplicationLike {\n\tprotected _options?: DApplicationOptions;\n\tprotected _root: HTMLElement;\n\tprotected _base: DApplicationLayer;\n\tprotected _overlay?: DApplicationLayer;\n\tprotected _resolution: number;\n\tprotected _isOverlayEnabled: boolean;\n\n\tconstructor( options?: DApplicationOptions ) {\n\t\tDApplications.add( this );\n\n\t\t// Root\n\t\tthis._root = this.toRootElement( options );\n\n\t\t// Resolution\n\t\tconst resolution = ( options && options.resolution != null ?\n\t\t\toptions.resolution : (window.devicePixelRatio || 1)\n\t\t);\n\t\tthis._resolution = resolution;\n\n\t\t// Remove the accessibility plugin\n\t\tdelete (Renderer as any).__plugins.accessibility;\n\n\t\t// Options\n\t\tthis._options = options;\n\n\t\t// Base layer\n\t\tconst base = this._base = this.newLayerBase( options );\n\n\t\t// Overlay layer\n\t\tthis._isOverlayEnabled = !! ( options && options.overlay );\n\t\tif( ! this._isOverlayEnabled ) {\n\t\t\tthis._overlay = base;\n\t\t}\n\t}\n\n\tget stage(): Container {\n\t\treturn this._base.stage;\n\t}\n\n\tgetRootElement(): HTMLElement {\n\t\treturn this._root;\n\t}\n\n\tgetResolution(): number {\n\t\treturn this._resolution;\n\t}\n\n\tprotected toRootElement( options?: DApplicationOptions ): HTMLElement {\n\t\tconst root = options && options.root;\n\t\tif( root != null ) {\n\t\t\tif( isString( root ) ) {\n\t\t\t\tconst found = document.querySelector<HTMLElement>( root );\n\t\t\t\tif( found ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t}\n\t\treturn document.body;\n\t}\n\n\tprotected toLayerBaseOptions( options?: DApplicationOptions ): DApplicationLayerOptions {\n\t\tconst root = this._root;\n\t\tconst resolution = this._resolution;\n\t\tif( options ) {\n\t\t\treturn new DApplicationLayerOptions({\n\t\t\t\troot,\n\t\t\t\tpadding: options.padding,\n\t\t\t\twidth: options.width,\n\t\t\t\theight: options.height,\n\t\t\t\tbackground: options.background,\n\t\t\t\tresolution,\n\t\t\t\tantialias: options.antialias,\n\t\t\t\toverlay: false\n\t\t\t});\n\t\t}\n\t\treturn new DApplicationLayerOptions({\n\t\t\troot,\n\t\t\tresolution,\n\t\t\toverlay: false\n\t\t});\n\t}\n\n\tprotected newLayerBase( options?: DApplicationOptions ): DApplicationLayer {\n\t\treturn new DApplicationLayer( this, this.toLayerBaseOptions( options ) );\n\t}\n\n\tgetLayerBase(): DApplicationLayer {\n\t\treturn  this._base;\n\t}\n\n\tprotected toLayerOverlayOptions( options?: DApplicationOptions ): DApplicationLayerOptions {\n\t\tconst root = this._root;\n\t\tconst resolution = this._resolution;\n\t\tif( options ) {\n\t\t\treturn new DApplicationLayerOptions({\n\t\t\t\troot,\n\t\t\t\tpadding: options.padding,\n\t\t\t\twidth: options.width,\n\t\t\t\theight: options.height,\n\t\t\t\tbackground: {\n\t\t\t\t\tcolor: null\n\t\t\t\t},\n\t\t\t\tresolution,\n\t\t\t\tantialias: options.antialias,\n\t\t\t\toverlay: true\n\t\t\t});\n\t\t}\n\t\treturn new DApplicationLayerOptions({\n\t\t\troot,\n\t\t\tresolution,\n\t\t\toverlay: true\n\t\t});\n\t}\n\n\tprotected newLayerOverlay( options?: DApplicationOptions ): DApplicationLayer {\n\t\treturn new DApplicationLayer( this, this.toLayerOverlayOptions( options ) );\n\t}\n\n\tgetLayerOverlay(): DApplicationLayer {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tif( this._overlay == null ) {\n\t\t\t\tthis._overlay = this.newLayerOverlay( this._options );\n\t\t\t}\n\t\t\treturn this._overlay;\n\t\t} else {\n\t\t\treturn this._base;\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tconst base = this._base;\n\t\t\tbase.update();\n\n\t\t\tconst overlay = this._overlay;\n\t\t\tif( overlay ) {\n\t\t\t\toverlay.update();\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._base.update();\n\t\t}\n\t}\n\n\trender(): void {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tconst base = this._base;\n\t\t\tbase.render();\n\n\t\t\tconst overlay = this._overlay;\n\t\t\tif( overlay ) {\n\t\t\t\toverlay.render();\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._base.render();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DBoardOptions<THEME extends DThemeBoard = DThemeBoard> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeBoard extends DThemeBase {\n\n}\n\nexport class DBoard<\n\tTHEME extends DThemeBoard = DThemeBoard,\n\tOPTIONS extends DBoardOptions<THEME> = DBoardOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBoard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DButtonGroup } from \"./d-button-group\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\n/**\n * Base button options.\n */\nexport interface DButtonBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase = DThemeButtonBase\n> extends DImageBaseOptions<VALUE, THEME> {\n\t/**\n\t * True to turn a toggle mode on.\n\t */\n\ttoggle?: boolean;\n\n\t/**\n\t * A button group.\n\t */\n\tgroup?: DButtonGroup;\n}\n\n/**\n * A base button theme.\n */\nexport interface DThemeButtonBase extends DThemeImageBase {\n\t/**\n\t * Returns true to turn a toggle mode on.\n\t */\n\tisToggle(): boolean;\n}\n\n// Option parser\nconst isToggle = <VALUE, THEME extends DThemeButtonBase>(\n\ttheme: DThemeButtonBase, options: DButtonBaseOptions<VALUE, THEME> | undefined\n): boolean => {\n\tif( options != null && options.toggle != null ) {\n\t\treturn options.toggle;\n\t}\n\treturn theme.isToggle();\n};\n\nexport class DButtonBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase = DThemeButtonBase,\n\tOPTIONS extends DButtonBaseOptions<VALUE, THEME> = DButtonBaseOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected _isToggle!: boolean;\n\tprotected _onActiveUpBound!: () => void;\n\tprotected _onActiveUpBoundTarget!: Container | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.buttonMode = true;\n\t\tthis._isToggle = isToggle( this.theme, options );\n\t\tthis._onActiveUpBound = (): void => {\n\t\t\tthis.setPressed( false );\n\t\t\tconst target = this._onActiveUpBoundTarget;\n\t\t\tif( target != null ) {\n\t\t\t\ttarget.off( UtilPointerEvent.up, this._onActiveUpBound );\n\t\t\t}\n\t\t};\n\t\tthis._onActiveUpBoundTarget = null;\n\t\tthis.setActiveHandlers();\n\n\t\t// Group\n\t\tif( options != null && options.group != null ) {\n\t\t\toptions.group.add( this );\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\tsuper.onShortcut( e );\n\t\tthis.onClick();\n\t}\n\n\tisToggle(): boolean {\n\t\treturn this._isToggle;\n\t}\n\n\tprotected setActiveHandlers(): void {\n\t\tUtilPointerEvent.onClick( this, (): void => {\n\t\t\tthis.onClick();\n\t\t});\n\n\t\tif( ! this.isToggle() ) {\n\t\t\tthis.on( UtilPointerEvent.down, (): void => {\n\t\t\t\tthis.setPressed( true );\n\t\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst target = this._onActiveUpBoundTarget = layer.stage;\n\t\t\t\t\ttarget.on( UtilPointerEvent.up, this._onActiveUpBound );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\t\tthis.buttonMode = DBaseStates.isActionable( newState );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n\n\tonClick(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tthis.emit( \"active\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onToggleStart(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onToggleEnd(): void {\n\t\tthis.emit( this.isActive() ? \"active\" : \"inactive\", this );\n\t}\n\n\tprotected onActivateKeyDown(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t} else {\n\t\t\t\tthis.setPressed( true );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tif( this.isPressed() ) {\n\t\t\t\t\tthis.emit( \"active\", this );\n\t\t\t\t}\n\t\t\t\tthis.setPressed( false );\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown();\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp();\n\t\t}\n\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tdestroy(): void {\n\t\t// Group\n\t\tconst options = this._options;\n\t\tif( options != null && options.group != null ) {\n\t\t\toptions.group.remove( this );\n\t\t}\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButton extends DThemeButtonBase {\n\n}\n\nexport class DButton<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DButtonAmbientOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient = DThemeButtonAmbient\n> extends DButtonOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonAmbient extends DThemeButton {\n\n}\n\nexport class DButtonAmbient<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient = DThemeButtonAmbient,\n\tOPTIONS extends DButtonAmbientOptions<VALUE, THEME> = DButtonAmbientOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonAmbient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheck extends DThemeButtonBase {\n\n}\n\nexport class DButtonCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\n\nexport interface DButtonCheckRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheckRight = DThemeButtonCheckRight\n> extends DButtonCheckOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheckRight extends DThemeButtonCheck {\n\n}\n\nexport class DButtonCheckRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheckRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonPrimary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonPrimary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DAnimation } from \"./d-animation\";\nimport { DAnimationFadeIn } from \"./d-animation-fade-in\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DFocusable } from \"./d-controller-focus\";\nimport { DDialogCloseOn } from \"./d-dialog-close-on\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilOverlay } from \"./util/util-overlay\";\n\nexport interface DDialogOptions<THEME extends DThemeDialog = DThemeDialog> extends DBaseOptions<THEME> {\n\tcloseOn?: DDialogCloseOn;\n\tanimation?: DAnimation;\n}\n\nexport interface DThemeDialog extends DThemeBase {\n\tcloseOn(): DDialogCloseOn;\n}\n\n/**\n * A base class for dialogs.\n *\n * If multiple application instances are there, better to set\n * the constructor option `parent` to an `application.stage`\n * so that the dialog picks a right application.\n *\n * By default, the dialog assumes the last created application is\n * the one it belongs to at the time when it is created.\n */\nexport class DDialog<\n\tTHEME extends DThemeDialog = DThemeDialog,\n\tOPTIONS extends DDialogOptions<THEME> = DDialogOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _animation!: DAnimation;\n\tprotected _closeOn!: DDialogCloseOn;\n\tprotected _focusable!: DFocusable | null;\n\tprotected _isOpened!: boolean;\n\tprotected _overlay!: UtilOverlay;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.visible = false;\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\t\tthis._focusable = null;\n\t\tthis._isOpened = false;\n\n\t\t// Animation\n\t\tconst animation = this._animation = ( options && options.animation ?\n\t\t\toptions.animation : new DAnimationFadeIn() );\n\t\tanimation.target = this;\n\t\tanimation.on( \"end\", ( isReverse: boolean ): void => {\n\t\t\tthis.onAnimationEnd( isReverse );\n\t\t});\n\n\t\t// Close-on\n\t\tconst closeOn = this._closeOn = ( options && options.closeOn != null ?\n\t\t\toptions.closeOn : this.theme.closeOn()\n\t\t);\n\t\tif( closeOn & DDialogCloseOn.CLICK_OUTSIDE ) {\n\t\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\t\tthis.onCloseOn();\n\t\t\t});\n\t\t}\n\n\t\tthis._overlay = new UtilOverlay();\n\t}\n\n\tprotected onAnimationEnd( isReverse: boolean ) {\n\t\tif( isReverse ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent ) {\n\t\t\t\tparent.removeChild( this );\n\t\t\t}\n\t\t} else {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tthis._focusable = focusController.getFocused();\n\t\t\t\tconst firstFocusable = focusController.findFocusable( this, false, true, true );\n\t\t\t\tfocusController.setFocused( firstFocusable || this, true, true );\n\t\t\t}\n\t\t}\n\t}\n\n\topen(): void {\n\t\tif( ! this._isOpened ) {\n\t\t\tconst layer = this._overlay.pick( this );\n\t\t\tthis._isOpened = true;\n\t\t\tlayer.stage.addChild( this );\n\t\t\tthis.onOpen();\n\t\t}\n\t}\n\n\tprotected onOpen(): void {\n\t\tthis.emit( \"open\", this );\n\n\t\t// Animation\n\t\tthis._animation.start();\n\t}\n\n\tisOpened(): boolean {\n\t\treturn this._isOpened;\n\t}\n\n\tclose() {\n\t\tif( this._isOpened ) {\n\t\t\tthis._isOpened = false;\n\t\t\tthis.onClose();\n\t\t}\n\t}\n\n\tprotected onClose(): void {\n\t\t// Focus\n\t\tconst focusable = this._focusable;\n\t\tif( focusable != null ) {\n\t\t\tthis._focusable = null;\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().setFocused( focusable, true, false );\n\t\t\t}\n\t\t}\n\n\t\t// Animation\n\t\tthis._animation.start( true );\n\n\t\tthis.emit( \"close\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialog\";\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tconst closeOn = this._closeOn;\n\t\tif( closeOn & DDialogCloseOn.ESC ) {\n\t\t\tif( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\t\tthis.onCloseOn();\n\t\t\t}\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tthis.close();\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn true;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DHtmlElementWhen {\n\tFOCUSED,\n\tALWAYS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutHorizontalOptions<THEME extends DThemeLayout> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutHorizontal extends DThemeLayout {\n\n}\n\nexport class DLayoutHorizontal<\n\tTHEME extends DThemeLayoutHorizontal = DThemeLayoutHorizontal,\n\tOPTIONS extends DLayoutHorizontalOptions<THEME> = DLayoutHorizontalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutHorizontal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DButtonPrimary } from \"./d-button-primary\";\nimport { DCoordinatePosition, DCoordinateSize } from \"./d-coordinate\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DDialogCommandOptions<\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand\n> extends DDialogOptions<THEME> {\n\tok?: string;\n\tcancel?: string;\n}\n\nexport interface DThemeDialogCommand extends DThemeDialog {\n\tgetOk(): string | null;\n\tgetCancel(): string | null;\n\tgetLayoutX(): DCoordinatePosition;\n\tgetLayoutY(): DCoordinatePosition;\n\tgetLayoutWidth(): DCoordinateSize;\n\tgetLayoutHeight(): DCoordinateSize;\n}\n\nexport class DDialogCommand<\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand,\n\tOPTIONS extends DDialogCommandOptions<THEME> = DDialogCommandOptions<THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _promise: Promise<void> | null = null;\n\tprotected _resolve: (() => void) | null = null;\n\tprotected _reject: (() => void) | null = null;\n\tprotected _buttonLayout?: DLayoutHorizontal;\n\tprotected _buttonOk?: DButton;\n\tprotected _buttonCancel?: DButton;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: theme.getLayoutX(),\n\t\t\ty: theme.getLayoutY(),\n\t\t\twidth: theme.getLayoutWidth(),\n\t\t\theight: theme.getLayoutHeight()\n\t\t});\n\n\t\tthis.onInit( layout, options );\n\n\t\t// Buttons\n\t\tconst ok = ( options && options.ok || theme.getOk() );\n\t\tconst cancel = ( options && options.cancel || theme.getCancel() );\n\t\tif( ok != null || cancel != null ) {\n\t\t\tconst buttonLayout = new DLayoutHorizontal({\n\t\t\t\tparent: layout,\n\t\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: this.padding.getTop()\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._buttonLayout = buttonLayout;\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t\tif( ok != null && cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._buttonOk = new DButton({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( ok != null ) {\n\t\t\t\tthis._buttonOk = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\t// OVERRIDE THIS\n\t}\n\n\topen(): Promise<void> {\n\t\tsuper.open();\n\t\treturn this._promise!;\n\t}\n\n\tprotected onOpen() {\n\t\tsuper.onOpen();\n\n\t\tif( this._promise == null ) {\n\t\t\tthis._promise = new Promise(( resolve, reject ): void => {\n\t\t\t\tthis._resolve = resolve;\n\t\t\t\tthis._reject = reject;\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onClose() {\n\t\tsuper.onClose();\n\n\t\tconst reject = this._reject;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tif( reject != null ) {\n\t\t\treject();\n\t\t}\n\t}\n\n\tprotected onOk() {\n\t\tconst resolve = this._resolve;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tthis.close();\n\n\t\tif( resolve != null ) {\n\t\t\tresolve();\n\t\t}\n\n\t\tthis.emit( \"ok\", this );\n\t}\n\n\tprotected onCancel() {\n\t\tconst reject = this._reject;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tthis.close();\n\n\t\tif( reject != null ) {\n\t\t\treject();\n\t\t}\n\n\t\tthis.emit( \"cancel\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogCommand\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Rectangle, Renderer, Text } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DHtmlElementWhen } from \"./d-html-element-when\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { isString } from \"./util/is-string\";\n\nexport type DHtmlElementElementCreator<T> = ( parent: HTMLElement ) => T;\n\nexport type DHtmlElementStyle<THEME extends DThemeHtmlElement> = (\n\ttarget: HTMLElement,\n\tstate: DBaseState, theme: THEME,\n\telementRect: Rectangle, clipperRect: Rectangle\n) => void;\n\nexport type DHtmlElementStyleBefore<THEME extends DThemeHtmlElement> =\n\t( target: HTMLElement, theme: THEME ) => void;\n\nexport type DHtmlElementStyleAfter<THEME extends DThemeHtmlElement> =\n\t( target: HTMLElement, theme: THEME ) => void;\n\nexport interface DHtmlElementElementOptions<ELEMENT, THEME extends DThemeHtmlElement> {\n\tcreator?: DHtmlElementElementCreator<ELEMENT>;\n\tstyle?: DHtmlElementStyle<THEME>;\n}\n\nexport interface DHtmlElementClipperOptions<THEME extends DThemeHtmlElement> {\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\n\tstyle?: DHtmlElementStyle<THEME>;\n}\n\nexport interface DHtmlElementBeforeOptions<THEME extends DThemeHtmlElement> {\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\n\tstyle?: DHtmlElementStyleBefore<THEME>;\n}\n\nexport interface DHtmlElementAfterOptions<THEME extends DThemeHtmlElement> {\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\n\tstyle?: DHtmlElementStyleAfter<THEME>;\n}\n\nexport interface DHtmlElementOptions<\n\tVALUE = unknown,\n\tELEMENT extends HTMLElement = HTMLElement,\n\tTHEME extends DThemeHtmlElement<ELEMENT> = DThemeHtmlElement<ELEMENT>\n> extends DImageBaseOptions<VALUE, THEME> {\n\telement?: DHtmlElementElementOptions<ELEMENT, THEME>;\n\tclipper?: DHtmlElementClipperOptions<THEME>;\n\tbefore?: DHtmlElementBeforeOptions<THEME>;\n\tafter?: DHtmlElementAfterOptions<THEME>;\n\twhen?: DHtmlElementWhen | (keyof typeof DHtmlElementWhen);\n\tselect?: boolean;\n}\n\nexport interface DThemeHtmlElement<\n\tELEMENT extends HTMLElement = HTMLElement\n> extends DThemeImageBase {\n\tgetElementCreator(): DHtmlElementElementCreator<ELEMENT> | null;\n\tsetElementStyle(\n\t\ttarget: ELEMENT, state: DBaseState,\n\t\telementRect: Rectangle, clipperRect: Rectangle\n\t): void;\n\tgetClipperCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\n\tsetClipperStyle(\n\t\ttarget: HTMLDivElement, state: DBaseState,\n\t\telementRect: Rectangle, clipperRect: Rectangle\n\t): void;\n\tgetBeforeCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\n\tsetBeforeStyle( target: HTMLDivElement ): void;\n\tgetAfterCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\n\tsetAfterStyle( target: HTMLDivElement ): void;\n\tgetWhen(): DHtmlElementWhen;\n\tgetSelect(): boolean;\n}\n\nexport class DHtmlElement<\n\tVALUE = unknown,\n\tELEMENT extends HTMLElement = HTMLElement,\n\tTHEME extends DThemeHtmlElement<ELEMENT> = DThemeHtmlElement<ELEMENT>,\n\tOPTIONS extends DHtmlElementOptions<VALUE, ELEMENT, THEME> = DHtmlElementOptions<VALUE, ELEMENT, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected _workPoint!: Point | null;\n\n\tprotected _clipper!: HTMLDivElement | null;\n\tprotected _clipperCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\n\tprotected _clipperStyle!: DHtmlElementStyle<THEME> | undefined;\n\tprotected _clipperRect!: Rectangle | null;\n\n\tprotected _element!: ELEMENT | null;\n\tprotected _elementCreator!: DHtmlElementElementCreator<ELEMENT> | null;\n\tprotected _elementStyle!: DHtmlElementStyle<THEME> | undefined;\n\tprotected _elementRect!: Rectangle | null;\n\tprotected _isElementShown!: boolean;\n\tprotected _isElementSelected!: boolean;\n\tprotected _onElementFocusedBound!: ( e: FocusEvent ) => void;\n\n\tprotected _before!: HTMLDivElement | null;\n\tprotected _beforeCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\n\tprotected _beforeStyle!: DHtmlElementStyleBefore<THEME> | undefined;\n\tprotected _onBeforeFocusedBound!: ( e: FocusEvent ) => void;\n\n\tprotected _after!: HTMLDivElement | null;\n\tprotected _afterCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\n\tprotected _afterStyle!: DHtmlElementStyleAfter<THEME> | undefined;\n\tprotected _onAfterFocusedBound!: ( e: FocusEvent ) => void;\n\n\tprotected _isStarted!: boolean;\n\tprotected _select!: boolean;\n\tprotected _doSelectBound!: () => void;\n\tprotected _when!: DHtmlElementWhen;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._workPoint = null;\n\n\t\tconst theme = this.theme;\n\t\tconst clipper = options && options.clipper;\n\t\tconst clipperCreator = (clipper && clipper.creator) || theme.getClipperCreator();\n\t\tthis._clipper = null;\n\t\tthis._clipperCreator = clipperCreator;\n\t\tthis._clipperRect = null;\n\n\t\tconst element = options && options.element;\n\t\tconst elementCreator = (element && element.creator) || theme.getElementCreator();\n\t\tthis._element = null;\n\t\tthis._elementCreator = elementCreator;\n\t\tthis._elementStyle = element && element.style;\n\t\tthis._elementRect = null;\n\t\tthis._isElementShown = false;\n\t\tthis._isElementSelected = false;\n\t\tthis._onElementFocusedBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onElementFocused( e );\n\t\t};\n\n\t\tconst before = options && options.before;\n\t\tthis._before = null;\n\t\tthis._beforeCreator = (before && before.creator) || theme.getBeforeCreator();\n\t\tthis._beforeStyle = before && before.style;\n\t\tthis._onBeforeFocusedBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onBeforeFocused( e );\n\t\t};\n\n\t\tconst after = options && options.after;\n\t\tthis._after = null;\n\t\tthis._afterCreator = (after && after.creator) || theme.getAfterCreator();\n\t\tthis._afterStyle = after && after.style;\n\t\tthis._onAfterFocusedBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onAfterFocused( e );\n\t\t};\n\n\t\tthis._isStarted = false;\n\t\tthis._select = ( options && options.select != null ?\n\t\t\toptions.select : theme.getSelect()\n\t\t);\n\t\tthis._doSelectBound = () => {\n\t\t\tthis.doSelect();\n\t\t};\n\t\tconst when = ( options && options.when != null ?\n\t\t\t( isString( options.when ) ? DHtmlElementWhen[ options.when ] : options.when ) :\n\t\t\ttheme.getWhen()\n\t\t);\n\t\tthis._when = when;\n\t\tif( when === DHtmlElementWhen.ALWAYS ) {\n\t\t\tthis.start();\n\t\t}\n\t}\n\n\tget element(): ELEMENT | null {\n\t\treturn this._element;\n\t}\n\n\tprotected onFocused(): void {\n\t\tsuper.onFocused();\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\n\t\t\tthis.start();\n\t\t} else {\n\t\t\tconst element = this._element;\n\t\t\tif( element ) {\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onBlured(): void {\n\t\tsuper.onBlured();\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\n\t\t\tthis.onEndByBlured();\n\t\t\tthis.cancel();\n\t\t}\n\t}\n\n\tprotected isStartable(): boolean {\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\n\t\t\treturn ! this.isDisabled();\n\t\t}\n\t\treturn true;\n\t}\n\n\tstart(): void {\n\t\tif( ! this._isStarted && this.isStartable() ) {\n\t\t\tthis._isStarted = true;\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( this._isStarted ) {\n\t\t\tthis._isStarted = false;\n\t\t\tthis.doStart( renderer );\n\t\t}\n\t\tsuper.render( renderer );\n\t\tif( this._isElementShown ) {\n\t\t\tthis.updateElement( renderer );\n\t\t}\n\t}\n\n\tprotected doStart( renderer: Renderer ): void {\n\t\tif( ! this._isElementShown ) {\n\t\t\tthis._isElementShown = true;\n\n\t\t\tthis.onStart();\n\n\t\t\tconst clipper = this.getClipper();\n\t\t\tif( clipper ) {\n\t\t\t\tconst before = this.getBefore( clipper );\n\t\t\t\tconst element = this.getElement( clipper );\n\t\t\t\tconst after = this.getAfter( clipper );\n\t\t\t\tif( element ) {\n\t\t\t\t\tconst resolution = renderer.resolution;\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\n\t\t\t\t\tconst clipperRect = this.getClipperRect( elementRect, resolution );\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tconst state = this.state;\n\t\t\t\t\tthis.setClipperStyle( clipper, state, theme, elementRect, clipperRect );\n\t\t\t\t\tthis.setElementStyle( element, state, theme, elementRect, clipperRect );\n\t\t\t\t\tif( before ) {\n\t\t\t\t\t\tthis.setBeforeStyle( before, theme );\n\t\t\t\t\t}\n\t\t\t\t\tif( after ) {\n\t\t\t\t\t\tthis.setAfterStyle( after, theme );\n\t\t\t\t\t}\n\t\t\t\t\tthis.onElementAttached( element, before, after );\n\n\t\t\t\t\t// Show HTML elements\n\t\t\t\t\tclipper.style.display = \"\";\n\t\t\t\t\tif( this.isFocused() ) {\n\t\t\t\t\t\telement.focus();\n\t\t\t\t\t}\n\t\t\t\t\tclipper.scrollTop = 0;\n\t\t\t\t\tclipper.scrollLeft = 0;\n\n\t\t\t\t\t// Select the element if required.\n\t\t\t\t\t// Note that a selecting without the setTimeout causes a keystroke drop on Microsoft Edge.\n\t\t\t\t\tif( this._isElementSelected && this._select && (\"select\" in element) ) {\n\t\t\t\t\t\tsetTimeout( this._doSelectBound, 0 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected doSelect(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tconst element = this._element;\n\t\t\tif( element && this._isElementSelected && this._select && (\"select\" in element) ) {\n\t\t\t\tthis._isElementSelected = false;\n\t\t\t\t(element as any).select();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected createText( formatted: string ): Text | DDynamicText {\n\t\tconst result = super.createText( formatted );\n\t\tif( this._isElementShown ) {\n\t\t\tthis.onStart();\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * Please note that this method does not update transforms.\n\t *\n\t * @param elementRect\n\t * @param resolution\n\t */\n\tprotected getClipperRect( elementRect: Rectangle, resolution: number ): Rectangle {\n\t\tconst point = this._workPoint = ( this._workPoint || new Point( 0, 0 ) );\n\t\tconst rect = this._clipperRect = ( this._clipperRect || new Rectangle() );\n\n\t\tlet x0 = elementRect.x;\n\t\tlet y0 = elementRect.y;\n\t\tlet x1 = x0 + elementRect.width;\n\t\tlet y1 = y0 + elementRect.height;\n\n\t\tlet current = this.parent;\n\t\twhile( current instanceof DBase ) {\n\t\t\tcurrent.getClippingRect( this, rect );\n\n\t\t\tpoint.set( rect.x, rect.y );\n\t\t\tcurrent.toGlobal( point, point, false );\n\t\t\tconst x = ( (point.x * resolution) | 0 ) / resolution;\n\t\t\tconst y = ( (point.y * resolution) | 0 ) / resolution;\n\n\t\t\tpoint.set( rect.x + rect.width, rect.y + rect.height );\n\t\t\tcurrent.toGlobal( point, point, true );\n\t\t\tconst w = point.x - x;\n\t\t\tconst h = point.y - y;\n\n\t\t\tx0 = Math.min( Math.max( x0, x ), x + w );\n\t\t\ty0 = Math.min( Math.max( y0, y ), y + h );\n\n\t\t\tx1 = Math.min( Math.max( x1, x ), x + w );\n\t\t\ty1 = Math.min( Math.max( y1, y ), y + h );\n\n\t\t\tcurrent = current.parent;\n\t\t}\n\n\t\trect.x = x0;\n\t\trect.y = y0;\n\t\trect.width = x1 - x0;\n\t\trect.height = y1 - y0;\n\t\treturn rect;\n\t}\n\n\t/**\n\t * Please note that this method does not update transforms.\n\t *\n\t * @param resolution\n\t */\n\tprotected getElementRect( resolution: number ): Rectangle {\n\t\tconst point = this._workPoint = ( this._workPoint || new Point( 0, 0 ) );\n\t\tconst rect = this._elementRect = ( this._elementRect != null ? this._elementRect : new Rectangle() );\n\n\t\tpoint.set( 0, 0 );\n\t\tthis.toGlobal( point, point, false );\n\t\trect.x = point.x;\n\t\trect.y = point.y;\n\n\t\tpoint.set( this.width, this.height );\n\t\tthis.toGlobal( point, point, true );\n\t\trect.width = point.x - rect.x;\n\t\trect.height = point.y - rect.y;\n\n\t\t// Rounds pixels as Pixi.js does\n\t\trect.x = ( (rect.x * resolution) | 0 ) / resolution;\n\t\trect.y = ( (rect.y * resolution) | 0 ) / resolution;\n\n\t\treturn rect;\n\t}\n\n\tcancel(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tthis._isElementShown = false;\n\n\t\t\tthis.onCancel();\n\n\t\t\tconst clipper = this._clipper;\n\t\t\tif( clipper != null ) {\n\t\t\t\tclipper.style.display = \"none\";\n\t\t\t}\n\n\t\t\tconst element = this._element;\n\t\t\tif( element != null ) {\n\t\t\t\tthis.onElementDetached( element, this._before, this._after );\n\t\t\t}\n\t\t\tthis._isElementSelected = false;\n\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst view = layer.view;\n\t\t\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\n\t\t\t\t\tview.focus();\n\t\t\t\t}\n\n\t\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\t\tif( this.containsPoint( interactionManager.mouse.global ) && ! this.isHovered() ) {\n\t\t\t\t\tthis.setHovered( true );\n\t\t\t\t\tview.style.cursor = this.cursor;\n\t\t\t\t}\n\n\t\t\t\tlayer.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onStart(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onCancel(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onElementAttached(\n\t\telement: ELEMENT, before: HTMLDivElement | null, after: HTMLDivElement | null\n\t): void {\n\t\tif( before ) {\n\t\t\tbefore.addEventListener( \"focus\", this._onBeforeFocusedBound );\n\t\t}\n\t\tif( after ) {\n\t\t\tafter.addEventListener( \"focus\", this._onAfterFocusedBound );\n\t\t}\n\t\telement.addEventListener( \"focus\", this._onElementFocusedBound, true );\n\t}\n\n\tprotected onElementDetached(\n\t\telement: ELEMENT, before: HTMLDivElement | null, after: HTMLDivElement | null\n\t): void {\n\t\tif( before ) {\n\t\t\tbefore.removeEventListener( \"focus\", this._onBeforeFocusedBound );\n\t\t}\n\t\tif( after ) {\n\t\t\tafter.removeEventListener( \"focus\", this._onAfterFocusedBound );\n\t\t}\n\t\telement.removeEventListener( \"focus\", this._onElementFocusedBound, true );\n\t}\n\n\tprotected getElement( clipper: HTMLDivElement ): ELEMENT | null {\n\t\tlet result = this._element;\n\t\tif( result == null ) {\n\t\t\tconst creator = this._elementCreator;\n\t\t\tif( creator ) {\n\t\t\t\tresult = creator( clipper );\n\t\t\t\tthis._element = result;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getClipper(): HTMLDivElement | null {\n\t\tlet result = this._clipper;\n\t\tif( result == null ) {\n\t\t\tconst creator = this._clipperCreator;\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( creator && layer ) {\n\t\t\t\tresult = creator( layer.getElementContainer() );\n\t\t\t\tthis._clipper = result;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getBefore( clipper: HTMLDivElement ): HTMLDivElement | null {\n\t\tlet result = this._before;\n\t\tif( result == null ) {\n\t\t\tconst creator = this._beforeCreator;\n\t\t\tif( creator ) {\n\t\t\t\tresult = creator( clipper );\n\t\t\t\tthis._before = result;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getAfter( clipper: HTMLDivElement ): HTMLDivElement | null {\n\t\tlet result = this._after;\n\t\tif( result == null ) {\n\t\t\tconst creator = this._afterCreator;\n\t\t\tif( creator ) {\n\t\t\t\tresult = creator( clipper );\n\t\t\t\tthis._after = result;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected setElementStyle(\n\t\ttarget: ELEMENT,\n\t\tstate: DBaseState, theme: THEME,\n\t\telementRect: Rectangle, clipperRect: Rectangle\n\t): void {\n\t\tconst style = this._elementStyle;\n\t\tif( style ) {\n\t\t\treturn style( target, state, theme, elementRect, clipperRect );\n\t\t} else {\n\t\t\treturn this.theme.setElementStyle( target, state, elementRect, clipperRect );\n\t\t}\n\t}\n\n\tprotected setClipperStyle(\n\t\ttarget: HTMLDivElement,\n\t\tstate: DBaseState, theme: THEME,\n\t\telementRect: Rectangle, clipperRect: Rectangle\n\t): void {\n\t\tconst style = this._clipperStyle;\n\t\tif( style ) {\n\t\t\treturn style( target, state, theme, elementRect, clipperRect );\n\t\t} else {\n\t\t\treturn this.theme.setClipperStyle( target, state, elementRect, clipperRect );\n\t\t}\n\t}\n\n\tprotected setBeforeStyle( target: HTMLDivElement, theme: THEME ): void {\n\t\tconst style = this._beforeStyle;\n\t\tif( style ) {\n\t\t\treturn style( target, theme );\n\t\t} else {\n\t\t\treturn this.theme.setBeforeStyle( target );\n\t\t}\n\t}\n\n\tprotected setAfterStyle( target: HTMLDivElement, theme: THEME ): void {\n\t\tconst style = this._afterStyle;\n\t\tif( style ) {\n\t\t\treturn style( target, theme );\n\t\t} else {\n\t\t\treturn this.theme.setAfterStyle( target );\n\t\t}\n\t}\n\n\tprotected onBeforeFocused( e: FocusEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.findFocusable( this, false, false, false );\n\t\t\tlayer.view.focus();\n\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\n\tprotected onAfterFocused( e: FocusEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.findFocusable( this, false, false, true );\n\t\t\tlayer.view.focus();\n\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\n\tprotected onElementFocused( e: FocusEvent ): void {\n\t\tif( this._when === DHtmlElementWhen.ALWAYS ) {\n\t\t\tif( ! this.isFocused() ) {\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEndByBlured(): void {\n\t\tthis.onEnd();\n\t}\n\n\tprotected onEnd(): void {\n\t\t// DO NOTHING\n\t}\n\n\tend(): void {\n\t\tthis.onEnd();\n\t\tthis.cancel();\n\t}\n\n\tselect(): this {\n\t\tconst element = this._element;\n\t\tif( element != null && this._isElementShown && this._select && \"select\" in element ) {\n\t\t\t(element as any).select();\n\t\t} else {\n\t\t\tthis._isElementSelected = true;\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected updateElement( renderer: Renderer ) {\n\t\tif( this._isElementShown ) {\n\t\t\tif( this.worldVisible ) {\n\t\t\t\tconst element = this._element;\n\t\t\t\tconst clipper = this._clipper;\n\t\t\t\tif( element && clipper ) {\n\t\t\t\t\tconst resolution = renderer.resolution;\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\n\t\t\t\t\tconst clipperRect = this.getClipperRect( elementRect, resolution );\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tconst state = this.state;\n\t\t\t\t\tthis.setClipperStyle( clipper, state, theme, elementRect, clipperRect );\n\t\t\t\t\tthis.setElementStyle( element, state, theme, elementRect, clipperRect );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cancel();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DHtmlElement\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DPickerDatetimeMask {\n\tNONE = 0,\n\tDATE = 1,\n\tHOURS = 2,\n\tMINUTES = 4,\n\tSECONDS = 8,\n\tALL = DATE | HOURS | MINUTES | SECONDS\n}\n","import { interaction } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DHtmlElement, DHtmlElementOptions, DThemeHtmlElement } from \"./d-html-element\";\nimport { isString } from \"./util/is-string\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DInputEditingOptions<VALUE = unknown> {\n\tformatter?: ( value: VALUE ) => string;\n\tunformatter?: ( text: string ) => VALUE;\n\tvalidator?: ( value: VALUE ) => string | null;\n}\n\nexport interface DInputOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput = DThemeInput\n> extends DHtmlElementOptions<VALUE, HTMLInputElement, THEME> {\n\tdescription?: string;\n\tediting?: DInputEditingOptions<VALUE>;\n}\n\nexport interface DThemeInput extends DThemeHtmlElement<HTMLInputElement> {\n\tgetEditingFormatter(): ( value: any, caller: any ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: any ) => any;\n\tgetEditingValidator(): ( value: any, caller: any ) => unknown;\n}\n\nexport abstract class DInput<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput = DThemeInput,\n\tOPTIONS extends DInputOptions<VALUE, THEME> = DInputOptions<VALUE, THEME>\n> extends DHtmlElement<VALUE, HTMLInputElement, THEME, OPTIONS> {\n\tprotected _description!: string;\n\n\tprotected _onInputKeyDownBound!: ( e: KeyboardEvent ) => void;\n\tprotected _onInputChangeBound!: ( e: Event ) => void;\n\tprotected _onInputInputBound!: ( e: Event ) => void;\n\n\tprotected _editingFormatter!: ( value: VALUE, caller: any ) => string;\n\tprotected _editingUnformatter!: ( text: string, caller: any ) => VALUE;\n\tprotected _editingValidator!: ( value: VALUE, caller: any ) => unknown;\n\tprotected _editingValidationResult!: unknown;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._editingValidationResult = null;\n\t\tthis._editingValidator = ( options && options.editing && options.editing.validator ) ||\n\t\t\tthis.theme.getEditingValidator();\n\n\t\tsuper.init( options );\n\n\t\tthis._description = ( options && options.description ) || \"\";\n\n\t\tthis._editingFormatter = ( options && options.editing && options.editing.formatter ) ||\n\t\t\t( options && options.text && options.text.formatter ) ||\n\t\t\tthis.theme.getEditingFormatter();\n\t\tthis._editingUnformatter = ( options && options.editing && options.editing.unformatter ) ||\n\t\t\tthis.theme.getEditingUnformatter();\n\n\t\tthis._onInputKeyDownBound = ( e: KeyboardEvent ): void => {\n\t\t\tthis.onInputKeyDown( e );\n\t\t};\n\t\tthis._onInputChangeBound = (): void => {\n\t\t\tthis.onInputChange();\n\t\t};\n\t\tthis._onInputInputBound = ( e: Event ): void => {\n\t\t\tthis.onInputInput( e );\n\t\t};\n\t}\n\n\tget value(): VALUE {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tprotected onTextChange(): void {\n\t\tsuper.onTextChange();\n\t\tthis.validate();\n\t}\n\n\tvalidate(): unknown {\n\t\tconst result = this._editingValidator( this._textValueComputed, this );\n\t\tif( this._editingValidationResult !== result ) {\n\t\t\tthis._editingValidationResult = result;\n\t\t\tthis.setInvalid( result != null );\n\t\t\tif( this.isHovered() ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst editingValidationResult = this._editingValidationResult;\n\t\tif( isString( editingValidationResult ) ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = editingValidationResult;\n\t\t\t}\n\t\t} else {\n\t\t\tsuper.applyTitle();\n\t\t}\n\t}\n\n\tprotected onStart(): void {\n\t\tsuper.onStart();\n\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\ttext.visible = false;\n\t\t}\n\t}\n\n\tprotected onCancel(): void {\n\t\tsuper.onCancel();\n\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\ttext.visible = true;\n\t\t}\n\t}\n\n\tprotected onEnd(): void {\n\t\tsuper.onEnd();\n\t\tthis.onInputChange();\n\t}\n\n\tprotected onElementAttached(\n\t\telement: HTMLInputElement, before: HTMLDivElement | null, after: HTMLDivElement | null\n\t): void {\n\t\tsuper.onElementAttached( element, before, after );\n\t\telement.type = this.getInputType();\n\t\telement.value = this._editingFormatter( this._textValueComputed, this );\n\t\telement.addEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\telement.addEventListener( \"change\", this._onInputChangeBound );\n\t\telement.addEventListener( \"input\", this._onInputInputBound );\n\t}\n\n\tprotected onElementDetached(\n\t\telement: HTMLInputElement, before: HTMLDivElement | null, after: HTMLDivElement | null\n\t): void {\n\t\tsuper.onElementDetached( element, before, after );\n\t\telement.removeEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\telement.removeEventListener( \"change\", this._onInputChangeBound );\n\t\telement.removeEventListener( \"input\", this._onInputInputBound );\n\t}\n\n\tprotected onInputKeyDown( e: KeyboardEvent ) {\n\t\tif( UtilKeyboardEvent.isOkKey( e ) ) {\n\t\t\tthis.end();\n\t\t\tthis.emit( \"enter\", this );\n\t\t} else if( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\tthis.cancel();\n\t\t}\n\t}\n\n\tprotected onInputChange() {\n\t\tif( this._isElementShown ) {\n\t\t\tconst element = this._element;\n\t\t\tif( element != null ) {\n\t\t\t\tconst newValue = this.toValue( element.value );\n\t\t\t\tconst oldValue = this._textValueComputed;\n\t\t\t\tif( oldValue !== newValue ) {\n\t\t\t\t\tthis.text = newValue;\n\t\t\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onInputInput( e: Event ) {\n\t\tif( e.target instanceof HTMLInputElement ) {\n\t\t\tthis.emit( \"input\", this.toValue( e.target.value ), this );\n\t\t}\n\t}\n\n\tprotected onDownThis( e: interaction.InteractionEvent ): void {\n\t\tif( this.isFocused() ) {\n\t\t\tthis.start();\n\t\t}\n\t\tsuper.onDownThis( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInput\";\n\t}\n\n\tprotected abstract toValue( valueAsString: string ): VALUE;\n\tprotected abstract getInputType(): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DInputNumberOptions<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber\n> extends DInputOptions<number, THEME> {\n\tstep?: number | null;\n\tmin?: number | null;\n\tmax?: number | null;\n}\n\nexport interface DThemeInputNumber extends DThemeInput {\n\tgetEditingFormatter(): ( value: number, caller: any ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: any ) => number;\n\tgetEditingValidator(): ( value: number, caller: any ) => unknown;\n\tgetTextValue( state: DBaseState ): number;\n\tnewTextValue(): DStateAwareOrValueMightBe<number>;\n\tgetStep(): number | null;\n\tgetMin(): number | null;\n\tgetMax(): number | null;\n}\n\n// Option parser\nconst toStep = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.step != null ? options.step : theme.getStep() );\n\t}\n\treturn null;\n};\n\nconst toMin = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.min != null ? options.min : theme.getMin() );\n\t}\n\treturn null;\n};\n\nconst toMax = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.max != null ? options.max : theme.getMax() );\n\t}\n\treturn null;\n};\n\nexport abstract class DInputNumber<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber,\n\tOPTIONS extends DInputNumberOptions<THEME> = DInputNumberOptions<THEME>\n> extends DInput<number, THEME, OPTIONS> {\n\tprotected _step!: number | null;\n\tprotected _min!: number | null;\n\tprotected _max!: number | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst theme = this.theme;\n\t\tthis._step = toStep( theme, options );\n\t\tthis._min = toMin( theme, options );\n\t\tthis._max = toMax( theme, options );\n\t}\n\n\tget step(): number | null {\n\t\treturn this._step;\n\t}\n\n\tset step( step: number | null ) {\n\t\tif( this._step !== step ) {\n\t\t\tthis._step = step;\n\t\t\tthis.updateInputStep();\n\t\t}\n\t}\n\n\tget min(): number | null {\n\t\treturn this._min;\n\t}\n\n\tset min( min: number | null ) {\n\t\tif( this._min !== min ) {\n\t\t\tthis._min = min;\n\t\t\tthis.updateInputMin();\n\t\t}\n\t}\n\n\tget max(): number | null {\n\t\treturn this._max;\n\t}\n\n\tset max( max: number | null ) {\n\t\tif( this._max !== max ) {\n\t\t\tthis._max = max;\n\t\t\tthis.updateInputMax();\n\t\t}\n\t}\n\n\tprotected toValue( valueAsString: string ): number {\n\t\tconst result = this._editingUnformatter( valueAsString, this );\n\t\tif( result === result /* NaN Check */ ) {\n\t\t\tif( this._min != null && result < this._min ) {\n\t\t\t\treturn this._min;\n\t\t\t}\n\t\t\tif( this._max != null && this._max < result ) {\n\t\t\t\treturn this._max;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn this.value;\n\t}\n\n\tprotected updateInputStep(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tconst element = this._element;\n\t\t\tif( element ) {\n\t\t\t\tthis.initInputStep( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInputMin(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tconst element = this._element;\n\t\t\tif( element ) {\n\t\t\t\tthis.initInputMin( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInputMax(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tconst element = this._element;\n\t\t\tif( element ) {\n\t\t\t\tthis.initInputMax( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected initInputStep( input: HTMLInputElement ): void {\n\t\tif( this._step != null ) {\n\t\t\tinput.step = String( this._step );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"step\" );\n\t\t}\n\t}\n\n\tprotected initInputMin( input: HTMLInputElement ): void {\n\t\tif( this._min != null ) {\n\t\t\tinput.min = `${this._min}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"min\" );\n\t\t}\n\t}\n\n\tprotected initInputMax( input: HTMLInputElement ): void {\n\t\tif( this._max != null ) {\n\t\t\tinput.max = `${this._max}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"max\" );\n\t\t}\n\t}\n\n\tprotected onElementAttached(\n\t\telement: HTMLInputElement, before: HTMLDivElement | null, after: HTMLDivElement | null\n\t): void {\n\t\tsuper.onElementAttached( element, before, after );\n\t\tthis.initInputStep( element );\n\t\tthis.initInputMin( element );\n\t\tthis.initInputMax( element );\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"number\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputRealOptions<\n\tTHEME extends DThemeInputReal = DThemeInputReal\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputReal extends DThemeInputNumber {\n\n}\n\nexport class DInputReal<\n\tTHEME extends DThemeInputReal = DThemeInputReal,\n\tOPTIONS extends DInputRealOptions<THEME> = DInputRealOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText\n> extends DTextBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeText extends DThemeTextBase {\n\n}\n\nexport class DText<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText,\n\tOPTIONS extends DTextOptions<VALUE, THEME> = DTextOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DInputLabelOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeInputLabel extends DThemeText {\n\n}\n\nexport class DInputLabel<\n\tVALUE = unknown,\n\tTHEME extends DThemeInputLabel = DThemeInputLabel,\n\tOPTIONS extends DInputLabelOptions<VALUE, THEME> = DInputLabelOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DInputLabel, DInputLabelOptions } from \"./d-input-label\";\nimport { DLayoutOptions } from \"./d-layout\";\nimport { DLayoutHorizontal, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\n\ninterface InputOptions {\n\tweight?: number;\n}\n\ninterface Input extends DisplayObject {\n\treadonly height: number;\n}\n\nexport interface DInputAndLabelOptions<\n\tINPUT_OPTIONS extends InputOptions = InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DLayoutOptions<THEME> {\n\tinput?: INPUT_OPTIONS;\n\tlabel?: DInputLabelOptions;\n\tspace?: DLayoutSpaceOptions;\n}\n\nexport interface DThemeInputAndLabel extends DThemeLayoutHorizontal {\n\n}\n\nexport abstract class DInputAndLabel<\n\tINPUT extends Input,\n\tINPUT_OPTIONS extends InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputAndLabelOptions<INPUT_OPTIONS, THEME> = DInputAndLabelOptions<INPUT_OPTIONS, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _input: INPUT;\n\tprotected _label: DInputLabel;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.addChild( this._label = new DInputLabel( options != null ? options.label : undefined ) );\n\t\tthis.addChild( this._input = this.createInput( options != null ? options.input : undefined ) );\n\t\tif( options != null && options.space != null ) {\n\t\t\tthis.addChild( new DLayoutSpace( options.space ) );\n\t\t}\n\t}\n\n\tget input() {\n\t\treturn this._input;\n\t}\n\n\tget label() {\n\t\treturn this._label;\n\t}\n\n\tprotected abstract createInput( options?: INPUT_OPTIONS | { weight: number } ): INPUT;\n\n\tprotected getType(): string {\n\t\treturn \"DInputAndLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\n\nexport interface DInputRealAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputRealOptions, THEME> {}\n\nexport class DInputRealAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputRealAndLabelOptions<THEME> = DInputRealAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputReal, DInputRealOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputRealOptions<DThemeInputReal> ): DInputReal {\n\t\treturn new DInputReal( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DInputTextOptions<\n\tTHEME extends DThemeInputText = DThemeInputText\n> extends DInputOptions<string, THEME> {\n\n}\n\nexport interface DThemeInputText extends DThemeInput {\n\tgetEditingFormatter(): ( value: string, caller: any ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: any ) => string;\n\tgetEditingValidator(): ( value: string, caller: any ) => unknown;\n\tgetTextFormatter(): ( value: string, caller: any ) => string;\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\nexport class DInputText<\n\tTHEME extends DThemeInputText = DThemeInputText,\n\tOPTIONS extends DInputTextOptions<THEME> = DInputTextOptions<THEME>\n> extends DInput<string, THEME, OPTIONS> {\n\tprotected toValue( valueAsString: string ): string {\n\t\treturn this._editingUnformatter( valueAsString, this );\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"text\";\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\n\nexport interface DInputTextAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputTextOptions, THEME> {}\n\nexport class DInputTextAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputTextAndLabelOptions<THEME> = DInputTextAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputText, DInputTextOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputTextOptions<DThemeInputText> ): DInputText {\n\t\treturn new DInputText( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color\";\n\nexport class DPickerColorAndAlpha implements DColorAndAlpha {\n\tprotected _colorAndAlpha: DColorAndAlpha;\n\tprotected _onColorChange: ( color: number ) => void;\n\tprotected _onAlphaChange: ( alpha: number ) => void;\n\n\tconstructor(\n\t\tcolorAndAlpha: DColorAndAlpha,\n\t\tonColorChange: ( color: number ) => void,\n\t\tonAlphaChange: ( alpha: number ) => void\n\t) {\n\t\tthis._colorAndAlpha = colorAndAlpha;\n\t\tthis._onColorChange = onColorChange;\n\t\tthis._onAlphaChange = onAlphaChange;\n\t}\n\n\tget color() {\n\t\treturn this._colorAndAlpha.color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._colorAndAlpha.color !== color ) {\n\t\t\tconst callback = this._onColorChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( color );\n\t\t\t}\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._colorAndAlpha.alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._colorAndAlpha.alpha !== alpha ) {\n\t\t\tconst callback = this._onAlphaChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( alpha );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DColorAndAlpha } from \"./d-color\";\n\nexport class DPickerColorRecent extends utils.EventEmitter {\n\tprotected _recents: DColorAndAlpha[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DColorAndAlpha[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tget( index: number ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, colorAndAlpha: DColorAndAlpha ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = {\n\t\t\t\tcolor: colorAndAlpha.color,\n\t\t\t\talpha: colorAndAlpha.alpha\n\t\t\t};\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( colorAndAlpha: DColorAndAlpha ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tconst recent = recents[ i ];\n\t\t\tif( recent.color === colorAndAlpha.color && recent.alpha === colorAndAlpha.alpha ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( colorAndAlpha: DColorAndAlpha ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push({\n\t\t\tcolor: colorAndAlpha.color,\n\t\t\talpha: colorAndAlpha.alpha\n\t\t});\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DInputRealAndLabel } from \"./d-input-real-and-label\";\nimport { DInputTextAndLabel } from \"./d-input-text-and-label\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\nimport { UtilHsv } from \"./util/util-hsv\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilRgb } from \"./util/util-rgb\";\n\nexport interface DPickerColorOptions<THEME extends DThemePickerColor = DThemePickerColor> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColor extends DThemeBase {\n\tgetMainWidth(): number;\n\tgetMainHeight(): number;\n\tgetMainTexture(): Texture;\n\tgetMainPointerTexture(): Texture;\n\tgetMainPointerColor(): number;\n\tgetMainPointerAlpha(): number;\n\n\tgetBaseHeight(): number;\n\tgetBaseMargin(): number;\n\tgetBaseTexture(): Texture;\n\tgetBasePointerTexture(): Texture;\n\tgetBasePointerColor(): number;\n\tgetBasePointerAlpha(): number;\n\n\tgetAlphaHeight(): number;\n\tgetAlphaMargin(): number;\n\tgetAlphaTexture(): Texture;\n\tgetAlphaCheckerboardTexture(): Texture;\n\tgetAlphaPointerTexture(): Texture;\n\tgetAlphaPointerColor(): number;\n\tgetAlphaPointerAlpha(): number;\n\n\tgetRecentMargin(): number;\n\tgetRecentColorMargin(): number;\n\tgetRecentColorWidth(): number;\n\tgetRecentColorHeight(): number;\n\tgetRecentColorCount(): number;\n\tgetRecentCheckerboardTexture(): Texture;\n\tgetRecents(): DColorAndAlpha[];\n\n\tgetInputMargin(): number;\n\tgetInputLabelWidth(): number;\n\n\tgetSampleWidth(): number;\n\tgetSampleHeight(): number;\n\tgetSampleCheckerboardTexture(): Texture;\n}\n\nexport class DPickerColor<\n\tTHEME extends DThemePickerColor = DThemePickerColor,\n\tOPTIONS extends DPickerColorOptions<THEME> = DPickerColorOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLORS: DPickerColorRecent | null = null;\n\n\tprotected _mainBaseSprite!: Sprite;\n\tprotected _mainSprite!: Sprite;\n\tprotected _mainPointerSprite!: Sprite;\n\tprotected _pointerPoint!: Point;\n\tprotected _onMainMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onMainUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _baseSprite!: Sprite;\n\tprotected _basePointerSprite!: Sprite;\n\tprotected _onBaseMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onBaseUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _alphaCheckerboardSprite!: Sprite;\n\tprotected _alphaSprite!: Sprite;\n\tprotected _alphaPointerSprite!: Sprite;\n\tprotected _onAlphaMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAlphaUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _recentColorSprites!: Sprite[];\n\tprotected _recent!: DPickerColorRecent;\n\n\tprotected _inputAndLabelColor!: DInputTextAndLabel;\n\tprotected _inputAndLabelAlpha!: DInputRealAndLabel;\n\n\tprotected _sampleCurrentCheckerboardSprite!: Sprite;\n\tprotected _sampleCurrentSprite!: Sprite;\n\tprotected _sampleNewCheckerboardSprite!: Sprite;\n\tprotected _sampleNewSprite!: Sprite;\n\n\tprotected _current!: DColorAndAlpha;\n\tprotected _currentPicker!: DPickerColorAndAlpha;\n\tprotected _base!: number;\n\tprotected _new!: DColorAndAlpha;\n\tprotected _newPicker!: DPickerColorAndAlpha;\n\n\tget current(): DColorAndAlpha {\n\t\treturn this._currentPicker;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this._newPicker;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this._recent;\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tthis._base = 0xff0000;\n\t\tthis._new = { color: 0xffffff, alpha: 1 };\n\t\tthis._newPicker = new DPickerColorAndAlpha( this._new, ( color ) => {\n\t\t\tthis.setColorNew( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaNew( alpha );\n\t\t});\n\t\tthis._current = { color: 0xffffff, alpha: 1 };\n\t\tthis._currentPicker = new DPickerColorAndAlpha( this._current, ( color ) => {\n\t\t\tthis.setColorCurrent( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaCurrent( alpha );\n\t\t});\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._pointerPoint = new Point();\n\n\t\t// Main\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst mainBaseSprite = this._mainBaseSprite = new Sprite( Texture.WHITE );\n\t\tmainBaseSprite.x = paddingLeft;\n\t\tmainBaseSprite.y = paddingTop;\n\t\tmainBaseSprite.width = mainWidth;\n\t\tmainBaseSprite.height = mainHeight;\n\t\tmainBaseSprite.interactive = true;\n\t\tthis.addChild( mainBaseSprite );\n\n\t\tconst mainSprite = this._mainSprite = new Sprite( theme.getMainTexture() );\n\t\tmainSprite.x = paddingLeft;\n\t\tmainSprite.y = paddingTop;\n\t\tmainSprite.tint = this._base;\n\t\tmainSprite.interactive = false;\n\t\tthis.addChild( mainSprite );\n\n\t\t// Main event handling\n\t\tthis._onMainMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainMove( e );\n\t\t};\n\t\tthis._onMainUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainUp( e );\n\t\t};\n\t\tmainBaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onMainDown( e );\n\t\t});\n\n\t\t// Base color picker\n\t\tconst baseSprite = this._baseSprite = new Sprite( theme.getBaseTexture() );\n\t\tbaseSprite.x = paddingLeft;\n\t\tbaseSprite.y = mainBaseSprite.y + mainBaseSprite.height + theme.getBaseMargin();\n\t\tbaseSprite.interactive = true;\n\t\tthis.addChild( baseSprite );\n\n\t\t// Base event\n\t\tthis._onBaseMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseMove( e );\n\t\t};\n\t\tthis._onBaseUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseUp( e );\n\t\t};\n\t\tbaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onBaseDown( e );\n\t\t});\n\n\t\t// Alpha picker\n\t\tconst alphaCheckerboardSprite = this._alphaCheckerboardSprite =\n\t\t\tnew Sprite( theme.getAlphaCheckerboardTexture() );\n\t\talphaCheckerboardSprite.x = padding.getLeft();\n\t\talphaCheckerboardSprite.y = baseSprite.y + theme.getBaseHeight() + theme.getBaseMargin();\n\t\talphaCheckerboardSprite.interactive = false;\n\t\tthis.addChild( alphaCheckerboardSprite );\n\n\t\tconst alphaSprite = new Sprite( theme.getAlphaTexture() );\n\t\talphaSprite.tint = this._new.color;\n\t\talphaSprite.interactive = true;\n\t\talphaCheckerboardSprite.addChild( alphaSprite );\n\n\t\t// Alpha event\n\t\tthis._onAlphaMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaMove( e );\n\t\t};\n\t\tthis._onAlphaUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaUp( e );\n\t\t};\n\t\talphaSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onAlphaDown( e );\n\t\t});\n\n\t\t// Pointers\n\t\tconst mainPointerSprite = this._mainPointerSprite = new Sprite( theme.getMainPointerTexture() );\n\t\tmainPointerSprite.x = paddingLeft;\n\t\tmainPointerSprite.y = paddingTop;\n\t\tmainPointerSprite.anchor.x = 0.5;\n\t\tmainPointerSprite.anchor.y = 0.5;\n\t\tmainPointerSprite.tint = theme.getMainPointerColor();\n\t\tmainPointerSprite.alpha = theme.getMainPointerAlpha();\n\t\tmainPointerSprite.interactive = false;\n\t\tthis.addChild( mainPointerSprite );\n\n\t\tconst alphaPointerSprite = this._alphaPointerSprite = new Sprite( theme.getAlphaPointerTexture() );\n\t\talphaPointerSprite.x = mainWidth;\n\t\talphaPointerSprite.y = alphaCheckerboardSprite.height * 0.5;\n\t\talphaPointerSprite.tint = theme.getAlphaPointerColor();\n\t\talphaPointerSprite.alpha = theme.getAlphaPointerAlpha();\n\t\talphaPointerSprite.anchor.set( 0.5, 0.5 );\n\t\talphaPointerSprite.interactive = false;\n\t\talphaCheckerboardSprite.addChild( alphaPointerSprite );\n\n\t\tconst basePointerSprite = this._basePointerSprite = new Sprite( theme.getBasePointerTexture() );\n\t\tbasePointerSprite.x = 0;\n\t\tbasePointerSprite.y = baseSprite.height * 0.5;\n\t\tbasePointerSprite.tint = theme.getBasePointerColor();\n\t\tbasePointerSprite.alpha = theme.getBasePointerAlpha();\n\t\tbasePointerSprite.anchor.set( 0.5, 0.5 );\n\t\tbasePointerSprite.interactive = false;\n\t\tbaseSprite.addChild( basePointerSprite );\n\n\t\t// Recently used\n\t\tthis._recentColorSprites = [];\n\t\tconst recentColorSprites = this._recentColorSprites;\n\t\tconst recentColorCount = theme.getRecentColorCount();\n\t\tconst recentColorWidth = theme.getRecentColorWidth();\n\t\tconst recentColorHeight = theme.getRecentColorHeight();\n\t\tconst recentColorWidthHalf = recentColorWidth * 0.5;\n\t\tconst recentColorHeightHalf = recentColorHeight * 0.5;\n\t\tconst recentColorMargin = theme.getRecentColorMargin();\n\t\tconst recentColorY = alphaCheckerboardSprite.y + theme.getAlphaHeight() + theme.getRecentMargin();\n\t\tconst recentCheckerboardTexture = theme.getRecentCheckerboardTexture();\n\t\tif( DPickerColor.RECENT_COLORS == null ) {\n\t\t\tDPickerColor.RECENT_COLORS = new DPickerColorRecent(\n\t\t\t\ttheme.getRecents().slice( 0 ),\n\t\t\t\trecentColorCount\n\t\t\t);\n\t\t}\n\t\tconst recent = this._recent = DPickerColor.RECENT_COLORS;\n\t\trecent.on( \"change\", () => {\n\t\t\tthis.onRecentChange();\n\t\t});\n\t\tconst onRecentClick = ( e: InteractionEvent ) => {\n\t\t\tconst checkerboardSprite = e.currentTarget;\n\t\t\tif( checkerboardSprite instanceof Container ) {\n\t\t\t\tconst sprite = checkerboardSprite.children[ 0 ];\n\t\t\t\tif( sprite instanceof Sprite ) {\n\t\t\t\t\tthis.setColorNew( sprite.tint );\n\t\t\t\t\tthis.setAlphaNew( sprite.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor( let i = 0; i < recentColorCount; ++i ) {\n\t\t\tconst x = paddingLeft + i * (recentColorWidth + recentColorMargin);\n\n\t\t\tconst checkerboardSprite = new Sprite( recentCheckerboardTexture );\n\t\t\tcheckerboardSprite.x = x + recentColorWidthHalf;\n\t\t\tcheckerboardSprite.y = recentColorY + recentColorHeightHalf;\n\t\t\tcheckerboardSprite.anchor.x = 0.5;\n\t\t\tcheckerboardSprite.anchor.y = 0.5;\n\t\t\tcheckerboardSprite.buttonMode = true;\n\t\t\tcheckerboardSprite.interactive = true;\n\t\t\tUtilPointerEvent.onClick( checkerboardSprite, onRecentClick );\n\t\t\tthis.addChild( checkerboardSprite );\n\n\t\t\tconst sprite = new Sprite( Texture.WHITE );\n\t\t\tconst recentColorAndAlpha = recent.get( i );\n\t\t\tif( recentColorAndAlpha != null ) {\n\t\t\t\tsprite.tint = recentColorAndAlpha.color;\n\t\t\t\tsprite.alpha = recentColorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t\tsprite.width = recentColorWidth;\n\t\t\tsprite.height = recentColorHeight;\n\t\t\tsprite.anchor.x = 0.5;\n\t\t\tsprite.anchor.y = 0.5;\n\t\t\tsprite.interactive = false;\n\t\t\tcheckerboardSprite.addChild( sprite );\n\t\t\trecentColorSprites.push( sprite );\n\t\t}\n\n\t\t// Input color\n\t\tconst inputMargin = theme.getInputMargin();\n\t\tconst inputY = recentColorY + recentColorHeight + inputMargin;\n\t\tconst inputWidth = mainWidth * 0.5;\n\t\tconst inputAndLabelColor = this._inputAndLabelColor = new DInputTextAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getInputLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"#\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"FFFFFF\"\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( code: string ): void => {\n\t\t\t\t\t\tconst color = UtilRgb.fromCode( code );\n\t\t\t\t\t\tif( color != null ) {\n\t\t\t\t\t\t\tthis.setColorNew( color );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst inputAndLabelAlpha = this._inputAndLabelAlpha = new DInputRealAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY + inputAndLabelColor.height + inputMargin,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getInputLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"A\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: 1\n\t\t\t\t},\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1,\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( value: number ) => {\n\t\t\t\t\t\tthis.setAlphaNew( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Samples\n\t\tconst sampleWidth = theme.getSampleWidth();\n\t\tconst sampleHeight = theme.getSampleHeight();\n\t\tconst sampleX = paddingLeft + mainWidth * 0.75 - sampleWidth;\n\t\tconst sampleY = inputY + (inputAndLabelColor.height + inputMargin + inputAndLabelAlpha.height - sampleHeight) * 0.5;\n\n\t\tconst sampleCurrentCheckerboardSprite = this._sampleCurrentCheckerboardSprite =\n\t\t\tnew Sprite( theme.getSampleCheckerboardTexture() );\n\t\tsampleCurrentCheckerboardSprite.x = sampleX;\n\t\tsampleCurrentCheckerboardSprite.y = sampleY;\n\t\tsampleCurrentCheckerboardSprite.width = sampleWidth;\n\t\tsampleCurrentCheckerboardSprite.height = sampleHeight;\n\t\tsampleCurrentCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleCurrentCheckerboardSprite );\n\n\t\tconst current = this._current;\n\t\tconst sampleCurrentSprite = this._sampleCurrentSprite = new Sprite( Texture.WHITE );\n\t\tsampleCurrentSprite.x = sampleX;\n\t\tsampleCurrentSprite.y = sampleY;\n\t\tsampleCurrentSprite.tint = current.color;\n\t\tsampleCurrentSprite.alpha = current.alpha;\n\t\tsampleCurrentSprite.width = sampleWidth;\n\t\tsampleCurrentSprite.height = sampleHeight;\n\t\tsampleCurrentSprite.interactive = true;\n\t\tsampleCurrentSprite.buttonMode = true;\n\t\tUtilPointerEvent.onClick( sampleCurrentSprite, (): void => {\n\t\t\tthis.setColorNew( current.color );\n\t\t\tthis.setAlphaNew( current.alpha );\n\t\t});\n\t\tthis.addChild( sampleCurrentSprite );\n\n\t\tconst sampleNewCheckerboardSprite = this._sampleNewCheckerboardSprite =\n\t\t\tnew Sprite( theme.getSampleCheckerboardTexture() );\n\t\tsampleNewCheckerboardSprite.x = sampleX + sampleWidth;\n\t\tsampleNewCheckerboardSprite.y = sampleY;\n\t\tsampleNewCheckerboardSprite.width = sampleWidth;\n\t\tsampleNewCheckerboardSprite.height = sampleHeight;\n\t\tsampleNewCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleNewCheckerboardSprite );\n\n\t\tconst sampleNewSprite = this._sampleNewSprite = new Sprite( Texture.WHITE );\n\t\tsampleNewSprite.x = sampleX + sampleWidth;\n\t\tsampleNewSprite.y = sampleY;\n\t\tsampleNewSprite.tint = this._new.color;\n\t\tsampleNewSprite.alpha = this._new.alpha;\n\t\tsampleNewSprite.width = sampleWidth;\n\t\tsampleNewSprite.height = sampleHeight;\n\t\tsampleNewSprite.interactive = false;\n\t\tthis.addChild( sampleNewSprite );\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + mainWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = inputY + inputAndLabelColor.height + inputMargin + inputAndLabelAlpha.height + paddingBottom;\n\t\t}\n\t}\n\n\tprotected onMainDown( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onMainMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onMainUpBound );\n\t\t}\n\t}\n\n\tprotected onMainMove( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\t}\n\n\tprotected onMainUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onMainMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onMainUpBound );\n\t\t}\n\t}\n\n\tprotected toMainHex( b: number, w0: number, w1: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, w0 * 255 + w1 * (( b >> shift ) & 0xff) ) ) << shift;\n\t}\n\n\tprotected toMainColor( base: number, tx: number, ty: number, width: number, height: number ): number {\n\t\tconst hw = width * 0.5;\n\t\tconst ux = Math.max( 0, Math.min( 1, ((tx - hw) * ( 1 - ty / height ) + hw) / width ) );\n\t\tconst uy = Math.max( 0, Math.min( 1, ty / height ) );\n\t\tconst w1 = Math.abs( 0.5 * uy  - ux );\n\t\tconst w0 = 1 - w1 - uy;\n\t\tconst r = this.toMainHex( base, w0, w1, 16 );\n\t\tconst g = this.toMainHex( base, w0, w1, 8 );\n\t\tconst b = this.toMainHex( base, w0, w1, 0 );\n\t\treturn r | g | b;\n\t}\n\n\tprotected onMainPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingTop = padding.getTop();\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - paddingLeft ) );\n\t\tconst y = Math.max( 0, Math.min( mainHeight, point.y - paddingTop ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.position.set( paddingLeft + x, paddingTop + y );\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base, x, y, mainWidth, mainHeight ) );\n\t}\n\n\tprotected setColorCurrent( color: number ) {\n\t\tthis._sampleCurrentSprite.tint = this._current.color = color;\n\t}\n\n\tprotected setAlphaCurrent( alpha: number ) {\n\t\tthis._sampleCurrentSprite.alpha = this._current.alpha = alpha;\n\t}\n\n\tprotected setColorNew( color: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\n\t\t// Base color\n\t\tconst hsv = UtilHsv.fromRgb( color );\n\t\tthis._mainSprite.tint = this._base = UtilHsv.toRgb( hsv[ 0 ], 255, 255 );\n\n\t\t// Move the base pointer\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, hsv[ 0 ] / 360 ) ) * mainWidth;\n\n\t\t// Move the main pointer\n\t\tconst ns = Math.max( 0, Math.min( 1, hsv[ 1 ] / 255 ) );\n\t\tconst nv = Math.max( 0, Math.min( 1, 1 - hsv[ 2 ] / 255 ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.tint = (nv < 0.45 ? theme.getMainPointerColor() : 0xffffff);\n\t\tmainPointerSprite.position.set(\n\t\t\tpadding.getLeft() + ns * mainWidth,\n\t\t\tpadding.getTop() + nv * mainHeight\n\t\t);\n\n\t\t// New color\n\t\tthis.onColorNew( color );\n\t}\n\n\tprotected onColorNew( color: number ) {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.disallowUpdate();\n\t\t}\n\t\tthis._sampleNewSprite.tint = this._new.color = color;\n\t\tthis._inputAndLabelColor.input.value = UtilRgb.toCode( color );\n\t\tthis.emit( \"newcolorchange\", color, this );\n\t\tif( layer ) {\n\t\t\tlayer.allowUpdate();\n\t\t\tlayer.update();\n\t\t}\n\t}\n\n\tprotected onBaseDown( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onBaseUpBound );\n\t\t}\n\t}\n\n\tprotected onBaseMove( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\t}\n\n\tprotected onBaseUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onBaseUpBound );\n\t\t}\n\t}\n\n\tprotected toBaseHex( t: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, t * 6 * 255 ) ) << shift;\n\t}\n\n\tprotected toBaseColor( t: number ): number {\n\t\tif( t <= 0.167 ) {\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 8 );\n\t\t} else if( t <= 0.333 ) {\n\t\t\tt = 0.333 - t;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 16 );\n\t\t} else if( t <= 0.5 ) {\n\t\t\tt -= 0.333;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 0 );\n\t\t} else if( t < 0.667 ) {\n\t\t\tt = 0.667 - t;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 8 );\n\t\t} else if( t < 0.883 ) {\n\t\t\tt -= 0.667;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 16 );\n\t\t} else {\n\t\t\tt = 0.883 - t;\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 0 );\n\t\t}\n\t}\n\n\tprotected onBasePick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = x;\n\t\tthis.onColorBase( this.toBaseColor( x / mainWidth ) );\n\t}\n\n\tprotected setColorBase( h: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, h / 360 ) ) * mainWidth;\n\t\tthis.onColorBase( UtilHsv.toRgb( h, 255, 255 ) );\n\t}\n\n\tprotected onColorBase( color: number ) {\n\t\tthis._mainSprite.tint = this._base = color;\n\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base,\n\t\t\tmainPointerSprite.x - padding.getLeft(),\n\t\t\tmainPointerSprite.y - padding.getTop(),\n\t\t\tmainWidth,\n\t\t\tmainHeight\n\t\t));\n\t}\n\n\tprotected onAlphaDown( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onAlphaUpBound );\n\t\t}\n\t}\n\n\tprotected onAlphaMove( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\t}\n\n\tprotected onAlphaUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onAlphaUpBound );\n\t\t}\n\t}\n\n\tprotected onAlphaPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tthis._alphaPointerSprite.x = x;\n\t\tthis.onAlphaNew( x / mainWidth );\n\t}\n\n\tprotected setAlphaNew( alpha: number ): void {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis._alphaPointerSprite.x = Math.max( 0, Math.min( 1, alpha ) ) * mainWidth;\n\t\tthis.onAlphaNew( alpha );\n\t}\n\n\tprotected onAlphaNew( alpha: number ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.disallowUpdate();\n\t\t}\n\t\tthis._sampleNewSprite.alpha = this._new.alpha = alpha;\n\t\tthis._inputAndLabelAlpha.input.value = Number( alpha.toFixed( 2 ) );\n\t\tthis.emit( \"newalphachange\", alpha, this );\n\t\tif( layer ) {\n\t\t\tlayer.allowUpdate();\n\t\t\tlayer.update();\n\t\t}\n\t}\n\n\tprotected onRecentChange(): void {\n\t\tconst sprites = this._recentColorSprites;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = sprites.length; i < imax; ++i ) {\n\t\t\tconst sprite = sprites[ i ];\n\t\t\tconst colorAndAlpha = recent.get( i );\n\t\t\tif( colorAndAlpha != null ) {\n\t\t\t\tsprite.tint = colorAndAlpha.color;\n\t\t\t\tsprite.alpha = colorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\ntype Callback = ( target: DPickerColorGradientPoint ) => void;\n\nexport interface DPickerColorGradientPointLike {\n\tcolor: number;\n\talpha: number;\n\tposition: number;\n}\n\nexport class DPickerColorGradientPoint implements DPickerColorGradientPointLike {\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _position: number;\n\tprotected _callback: Callback;\n\tprotected _selected: boolean;\n\n\tconstructor( color: number, alpha: number, position: number, selected: boolean, callback: Callback ) {\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._position = position;\n\t\tthis._callback = callback;\n\t\tthis._selected = selected;\n\t}\n\n\tset( color: number, alpha: number, position: number, selected: boolean ) {\n\t\tif( this._color !== color || this._alpha !== alpha || this._position !== position || this._selected !== selected ) {\n\t\t\tthis._color = color;\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._position = position;\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget color() {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget position() {\n\t\treturn this._position;\n\t}\n\n\tset position( position: number ) {\n\t\tif( this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget selected() {\n\t\treturn this._selected;\n\t}\n\n\tset selected( selected: boolean ) {\n\t\tif( this._selected !== selected ) {\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\ttoObject(): DPickerColorGradientPointLike {\n\t\treturn {\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tposition: this._position\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DPickerColorGradientPoint, DPickerColorGradientPointLike } from \"./d-picker-color-gradient-point\";\n\nconst POINT_SORTER = ( a: DPickerColorGradientPoint, b: DPickerColorGradientPoint ): number => {\n\treturn a.position - b.position;\n};\n\nexport interface DPickerColorGradientDataLike {\n\tpoints: DPickerColorGradientPointLike[];\n\tdirection: number;\n}\n\nexport class DPickerColorGradientData extends utils.EventEmitter {\n\tprotected _points: DPickerColorGradientPoint[];\n\tprotected _direction: number;\n\tprotected _selected: DPickerColorGradientPoint | null;\n\n\tprotected _onChangeBound: ( target: DPickerColorGradientPoint ) => void;\n\tprotected _workColor: number[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._onChangeBound = ( target: DPickerColorGradientPoint ): void => {\n\t\t\tthis.onChange( target );\n\t\t};\n\n\t\tconst first = new DPickerColorGradientPoint( 0xffffff, 1, 0, false, this._onChangeBound );\n\t\tconst second = new DPickerColorGradientPoint( 0x808080, 1, 1, true, this._onChangeBound );\n\t\tthis._points = [ first, second ];\n\t\tthis._direction = -90;\n\t\tthis._selected = second;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t}\n\n\tprotected onChange( target: DPickerColorGradientPoint ): void {\n\t\tconst isSelectionChanged = ( target.selected && this._selected !== target );\n\t\tif( isSelectionChanged ) {\n\t\t\tconst selected = this._selected;\n\t\t\tif( selected != null ) {\n\t\t\t\t(selected as any)._selected = false;\n\t\t\t}\n\t\t\tthis._selected = target;\n\t\t}\n\t\tthis._points.sort( POINT_SORTER );\n\t\tif( isSelectionChanged ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tget points(): DPickerColorGradientPoint[] {\n\t\treturn this._points;\n\t}\n\n\tget direction(): number {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: number ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis.emit( \"directionchange\", direction, this );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget selected(): DPickerColorGradientPoint | null {\n\t\treturn this._selected;\n\t}\n\n\tsize(): number {\n\t\treturn this._points.length;\n\t}\n\n\tget( index: number ): DPickerColorGradientPoint | null {\n\t\tconst points = this._points;\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\treturn points[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\taddAt( position: number ): DPickerColorGradientPoint {\n\t\tconst points = this._points;\n\t\tlet previous: DPickerColorGradientPoint | null = null;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tif( position <= point.position ) {\n\t\t\t\tif( previous != null ) {\n\t\t\t\t\tconst span = point.position - previous.position;\n\t\t\t\t\tif( 0.001 < span ) {\n\t\t\t\t\t\tconst rgb0 = utils.hex2rgb( point.color, this._workColor );\n\t\t\t\t\t\tconst r0 = rgb0[ 0 ];\n\t\t\t\t\t\tconst g0 = rgb0[ 1 ];\n\t\t\t\t\t\tconst b0 = rgb0[ 2 ];\n\n\t\t\t\t\t\tconst rgb1 = utils.hex2rgb( previous.color, this._workColor );\n\t\t\t\t\t\tconst r1 = rgb1[ 0 ];\n\t\t\t\t\t\tconst g1 = rgb1[ 1 ];\n\t\t\t\t\t\tconst b1 = rgb1[ 2 ];\n\n\t\t\t\t\t\tconst ratio = (position - previous.position) / span;\n\t\t\t\t\t\tconst r = r0 * ratio + r1 * (1 - ratio);\n\t\t\t\t\t\tconst g = g0 * ratio + g1 * (1 - ratio);\n\t\t\t\t\t\tconst b = b0 * ratio + b1 * (1 - ratio);\n\n\t\t\t\t\t\tconst rgb = this._workColor;\n\t\t\t\t\t\trgb[ 0 ] = r;\n\t\t\t\t\t\trgb[ 1 ] = g;\n\t\t\t\t\t\trgb[ 2 ] = b;\n\n\t\t\t\t\t\tconst color = utils.rgb2hex( rgb );\n\t\t\t\t\t\tconst alpha = point.alpha * ratio + previous.alpha * (1 - ratio);\n\t\t\t\t\t\treturn this.add( color, alpha, position, true );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn this.add( point.color, point.alpha, position, true );\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevious = point;\n\t\t}\n\t\tif( previous != null ) {\n\t\t\treturn this.add( previous.color, previous.alpha, position, true );\n\t\t} else {\n\t\t\treturn this.add( 0xffffff, 1.0, position, true );\n\t\t}\n\t}\n\n\tadd( color: number, alpha: number, position: number, selected: boolean ): DPickerColorGradientPoint {\n\t\tconst result = new DPickerColorGradientPoint( color, alpha, position, selected, this._onChangeBound );\n\t\tthis._points.push( result );\n\t\tthis._onChangeBound( result );\n\t\treturn result;\n\t}\n\n\tremove( point: DPickerColorGradientPoint ): boolean {\n\t\tconst points = this._points;\n\t\tif( 2 < points.length ) {\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tif( points[ i ] === point ) {\n\t\t\t\t\tpoints.splice( i, 1 );\n\t\t\t\t\tconst isSelectionChanged = ( this._selected === point );\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tif( i + 1 < imax ) {\n\t\t\t\t\t\t\tthis._selected = points[ i ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._selected = points[ i - 1 ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): void {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = -90;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tpoints.push( new DPickerColorGradientPoint( 0xffffff, 0, 0, false, this._onChangeBound ) );\n\t\tpoints.push( new DPickerColorGradientPoint( 0xffffff, 0, 1, false, this._onChangeBound ) );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoObject(): DPickerColorGradientDataLike {\n\t\tconst pointsCopy = [];\n\t\tconst points = this._points;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tpointsCopy.push( points[ i ].toObject() );\n\t\t}\n\t\treturn {\n\t\t\tpoints: pointsCopy,\n\t\t\tdirection: this._direction\n\t\t};\n\t}\n\n\tfromObject( data: DPickerColorGradientDataLike ): void {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = data.direction;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tfor( let i = 0, imax = data.points.length; i < imax; ++i ) {\n\t\t\tconst pointLike = data.points[ i ];\n\t\t\tconst point = new DPickerColorGradientPoint(\n\t\t\t\tpointLike.color, pointLike.alpha, pointLike.position,\n\t\t\t\tfalse, this._onChangeBound\n\t\t\t);\n\t\t\tpoints.push( point );\n\t\t}\n\t\tpoints.sort( POINT_SORTER );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, Geometry, Mesh, Point, Rectangle, Shader, Texture, TextureUvs, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( 0.75, 0.65, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}`;\n\ntype Parts = Array<{ data: DPickerColorGradientDataLike | null, rect: Rectangle }>;\n\nexport class DPickerColorGradientDataView extends Mesh {\n\tprotected _nPointsPerData: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _colors: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _lastHitIndex: number;\n\n\tprotected _workColor: number[];\n\tprotected _workPoint: Point;\n\n\tprotected _parts: Parts;\n\n\tprotected constructor(\n\t\tnPointsPerData: number,\n\t\tvertices: Float32Array, uvs: Float32Array, colors: Float32Array, indices: Uint16Array,\n\t\tparts: Parts, geometry: Geometry, shader: Shader\n\t) {\n\t\tsuper( geometry, shader );\n\n\t\tthis.interactive = true;\n\t\tthis.interactiveChildren = false;\n\t\tthis.cursor = \"pointer\";\n\n\t\tthis._nPointsPerData = nPointsPerData;\n\t\tthis._vertices = vertices;\n\t\tthis._uvs = uvs;\n\t\tthis._colors = colors;\n\t\tthis._indices = indices;\n\t\tthis._lastHitIndex = -1;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t\tthis._workPoint = new Point();\n\t\tthis._parts = parts;\n\n\t\tshader.uniforms.uSampler.on( \"update\", (): void => {\n\t\t\tthis.update();\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tthis.update();\n\t}\n\n\tgetRectangle( index: number ): Rectangle | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].rect;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetRectangle( index: number, x: number, y: number, width: number, height: number ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tconst rect = parts[ index ].rect;\n\t\t\trect.x = x;\n\t\t\trect.y = y;\n\t\t\trect.width = width;\n\t\t\trect.height = height;\n\t\t}\n\t}\n\n\tgetData( index: number ): DPickerColorGradientDataLike | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].data;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetData( index: number, data: DPickerColorGradientDataLike | null ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tparts[ index ].data = data;\n\t\t}\n\t}\n\n\tgetLastHitIndex(): number {\n\t\treturn this._lastHitIndex;\n\t}\n\n\tprivate setColors( ic: number, colors: Float32Array, rgb: number[], alpha: number ) {\n\t\tcolors[ ic + 0 ] = rgb[ 0 ];\n\t\tcolors[ ic + 1 ] = rgb[ 1 ];\n\t\tcolors[ ic + 2 ] = rgb[ 2 ];\n\t\tcolors[ ic + 3 ] = alpha;\n\t\tcolors[ ic + 4 ] = rgb[ 0 ];\n\t\tcolors[ ic + 5 ] = rgb[ 1 ];\n\t\tcolors[ ic + 6 ] = rgb[ 2 ];\n\t\tcolors[ ic + 7 ] = alpha;\n\t}\n\n\tprivate setColorsHex( ic: number, colors: Float32Array, color: number, alpha: number ) {\n\t\tconst rgb = utils.hex2rgb( color, this._workColor );\n\t\tthis.setColors( ic, colors, rgb, alpha );\n\t}\n\n\tprivate setColorsWhite( ic: number, colors: Float32Array ) {\n\t\tconst rgb = this._workColor;\n\t\trgb[ 0 ] = 1;\n\t\trgb[ 1 ] = 1;\n\t\trgb[ 2 ] = 1;\n\t\tthis.setColors( ic, colors, rgb, 0 );\n\t}\n\n\tprivate setColorsPoint( ic: number, data: DPickerColorGradientDataLike, index: number, colors: Float32Array ) {\n\t\tconst point = data.points[ index ];\n\t\tif( point != null ) {\n\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t} else {\n\t\t\tthis.setColorsWhite( ic, colors );\n\t\t}\n\t}\n\n\tprotected setVertices( iv: number, vertices: Float32Array, position: number, rect: Rectangle ) {\n\t\tconst y = rect.y + rect.height * position;\n\t\tvertices[ iv + 0 ] = rect.x;\n\t\tvertices[ iv + 1 ] = y;\n\t\tvertices[ iv + 2 ] = rect.x + rect.width;\n\t\tvertices[ iv + 3 ] = y;\n\t}\n\n\tprotected setUvs( iv: number, uvs: Float32Array, position: number, textureUvs: TextureUvs ) {\n\t\tconst x0 = textureUvs.x0 + (textureUvs.x3 - textureUvs.x0) * position;\n\t\tconst y0 = textureUvs.y0 + (textureUvs.y3 - textureUvs.y0) * position;\n\t\tconst x1 = textureUvs.x1 + (textureUvs.x2 - textureUvs.x1) * position;\n\t\tconst y1 = textureUvs.y1 + (textureUvs.y2 - textureUvs.y1) * position;\n\t\tuvs[ iv + 0 ] = x0;\n\t\tuvs[ iv + 1 ] = y0;\n\t\tuvs[ iv + 2 ] = x1;\n\t\tuvs[ iv + 3 ] = y1;\n\t}\n\n\tprivate newIndices( ii: number, iv: number, size: number, indices: Uint16Array ): Uint16Array {\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tindices[ ii + 0 ] = iv + 0;\n\t\t\tindices[ ii + 1 ] = iv + 1;\n\t\t\tindices[ ii + 2 ] = iv + 2;\n\n\t\t\tindices[ ii + 3 ] = iv + 2;\n\t\t\tindices[ ii + 4 ] = iv + 1;\n\t\t\tindices[ ii + 5 ] = iv + 3;\n\n\t\t\tii += 6;\n\t\t\tiv += 2;\n\t\t}\n\t\treturn indices;\n\t}\n\n\tprotected _calculateBounds() {\n\t\tconst rect = this._parts[ 0 ].rect;\n\t\tconst bounds = this._bounds;\n\t\tconst work = this._workPoint;\n\t\twork.set( rect.x, rect.y );\n\t\tbounds.addPoint( work );\n\t\twork.set( rect.x + rect.width, rect.y + rect.height );\n\t\tbounds.addPoint( work );\n\t}\n\n\tupdate(): void {\n\t\tconst vertices = this._vertices;\n\t\tconst uvs = this._uvs;\n\t\tconst colors = this._colors;\n\t\tconst indices = this._indices;\n\n\t\tconst texture = this.shader.uniforms.uSampler;\n\t\tif( texture._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\tlet iv = 0;\n\t\tlet nv = 0;\n\t\tlet ic = 0;\n\t\tlet ii = 0;\n\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst data = parts[ i ].data;\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( data == null ) {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic, colors );\n\t\t\t\tthis.setVertices( iv + 4, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic + 8, colors );\n\t\t\t\tthis.newIndices( ii, nv, 1, indices );\n\t\t\t\tiv += 4 * 2;\n\t\t\t\tic += 4 * 4;\n\t\t\t\tnv += 4;\n\t\t\t\tii += 6;\n\t\t\t} else {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, 0, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\t\t\t\tconst pointSize = data.points.length;\n\t\t\t\tfor( let j = 0, jmax = Math.min( pointSize, this._nPointsPerData ); j < jmax; ++j ) {\n\t\t\t\t\tconst point = data.points[ j ];\n\t\t\t\t\tthis.setVertices( iv, vertices, point.position, rect );\n\t\t\t\t\tthis.setUvs( iv, uvs, point.position, textureUvs );\n\t\t\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t\t\t\tiv += 2 * 2;\n\t\t\t\t\tic += 2 * 4;\n\t\t\t\t}\n\t\t\t\tthis.setVertices( iv, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, pointSize - 1, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\n\t\t\t\tthis.newIndices( ii, nv, pointSize + 1, indices );\n\t\t\t\tii += (pointSize + 1) * 6;\n\t\t\t\tnv += (pointSize + 2) * 2;\n\t\t\t}\n\t\t}\n\n\t\tthis.size = ii;\n\n\t\tconst geometry = this.geometry;\n\t\tgeometry.getBuffer( \"aPosition\" ).update();\n\t\tgeometry.getBuffer( \"aUv\" ).update();\n\t\tgeometry.getBuffer( \"aColor\" ).update();\n\t\tgeometry.getIndex().update();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\tconst local = this.toLocal( point, undefined, this._workPoint );\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( rect.contains( local.x, local.y ) ) {\n\t\t\t\tthis._lastHitIndex = i;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic from( size: number, nPointsPerData: number, texture: Texture = Texture.WHITE ) {\n\t\tconst vertices = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst uvs = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst colors = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 4 );\n\t\tconst indices = new Uint16Array( size * ( nPointsPerData + 1 ) * 6 );\n\n\t\tconst parts: Parts = [];\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tparts.push({\n\t\t\t\tdata: null,\n\t\t\t\trect: new Rectangle()\n\t\t\t});\n\t\t}\n\n\t\tconst geometry = new Geometry()\n\t\t\t.addIndex( new Buffer( indices, false, true ) )\n\t\t\t.addAttribute( \"aPosition\", new Buffer( vertices, false, false ), 2 )\n\t\t\t.addAttribute( \"aUv\", new Buffer( uvs, false, false ), 2 )\n\t\t\t.addAttribute( \"aColor\", new Buffer( colors, false, false ), 4 );\n\t\tconst shader = Shader.from( VERTEX_SHADER, FRAGMENT_SHADER, { uSampler: texture } );\n\n\t\treturn new DPickerColorGradientDataView(\n\t\t\tnPointsPerData,\n\t\t\tvertices, uvs, colors, indices,\n\t\t\tparts, geometry, shader\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\n\nconst isEqual = ( a: DPickerColorGradientDataLike, b: DPickerColorGradientDataLike ) => {\n\tif( a.direction !== b.direction ) {\n\t\treturn false;\n\t}\n\n\tconst ap = a.points;\n\tconst bp = b.points;\n\tif( ap.length !== bp.length ) {\n\t\treturn false;\n\t}\n\n\tfor( let j = 0, jmax = ap.length; j < jmax; ++j ) {\n\t\tconst apj = ap[ j ];\n\t\tconst bpj = bp[ j ];\n\t\tif( apj.color !== bpj.color || apj.alpha !== bpj.alpha || apj.position !== bpj.position ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n};\n\nexport class DPickerColorGradientRecent extends utils.EventEmitter {\n\tprotected _recents: DPickerColorGradientDataLike[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DPickerColorGradientDataLike[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tgetCapacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tget( index: number ): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, points: DPickerColorGradientDataLike ): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = points;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( points: DPickerColorGradientDataLike ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tif( isEqual( recents[ i ], points ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( points: DPickerColorGradientDataLike ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push( points );\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DInputReal } from \"./d-input-real\";\nimport { DPickerColor } from \"./d-picker-color\";\nimport { DPickerColorGradientData, DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientDataView } from \"./d-picker-color-gradient-data-view\";\nimport { DPickerColorGradientPoint } from \"./d-picker-color-gradient-point\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DPickerColorGradientOptions<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColorGradient extends DThemeBase {\n\tgetGradientPointsWidth(): number;\n\tgetGradientPointsMargin(): number;\n\n\tgetGradientAnchorTexture(): Texture;\n\tgetGradientAnchorOutlinedTexture(): Texture;\n\tgetGradientAnchorOutlineTexture(): Texture;\n\n\tgetGradientDirectionMargin(): number;\n\tgetGradientDirectionTexture(): Texture;\n\n\tgetGradientRecentColumn(): number;\n\tgetGradientRecentWidth(): number;\n\tgetGradientRecentMargin(): number;\n\tgetGradientRecentCount(): number;\n\tgetGradientRecents(): DPickerColorGradientDataLike[];\n}\n\nexport class DPickerColorGradient<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient,\n\tOPTIONS extends DPickerColorGradientOptions<THEME> = DPickerColorGradientOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLOR_GRADIENT: DPickerColorGradientRecent | null = null;\n\n\tprotected _picker!: DPickerColor;\n\tprotected _view!: DPickerColorGradientDataView;\n\tprotected _anchors!: Sprite[];\n\tprotected _recent!: DPickerColorGradientRecent;\n\n\tprotected _onAnchorDownBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _data!: DPickerColorGradientData;\n\tprotected _work!: Point;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._work = new Point();\n\n\t\t// Picker\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\t\tconst gradientPointsMargin = theme.getGradientPointsMargin();\n\t\tconst picker = this._picker = new DPickerColor({\n\t\t\tx: paddingLeft + gradientPointsWidth + gradientPointsMargin,\n\t\t\ty: paddingTop\n\t\t});\n\t\tpicker.on( \"newcolorchange\", ( color: number ): void => {\n\t\t\tthis.onAnchorColorChange( color );\n\t\t});\n\t\tpicker.on( \"newalphachange\", ( alpha: number ): void => {\n\t\t\tthis.onAnchorAlphaChange( alpha );\n\t\t});\n\t\tthis.addChild( picker );\n\n\t\t// Points view\n\t\tconst view = this._view = DPickerColorGradientDataView.from( 17, 10 );\n\t\tview.setRectangle( 0, paddingLeft, paddingTop, gradientPointsWidth, picker.height );\n\t\tthis.addChild( view );\n\t\tview.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( view.getLastHitIndex() === 0 ) {\n\t\t\t\tthis.onViewDown( e );\n\t\t\t}\n\t\t});\n\n\t\t// Anchor\n\t\tthis._onAnchorDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorDown( e );\n\t\t};\n\t\tthis._onAnchorMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorMove( e );\n\t\t};\n\t\tthis._onAnchorUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorUp( e );\n\t\t};\n\t\tthis._anchors = [];\n\n\t\t//\n\t\tconst inputLabelWidth = picker.theme.getInputLabelWidth();\n\t\tconst inputWidth = picker.theme.getMainWidth() * 0.5;\n\t\tconst inputMargin = 5;\n\t\tconst inputDirectionMargin = theme.getGradientDirectionMargin();\n\t\tconst inputDirectionTexture = theme.getGradientDirectionTexture();\n\t\tconst inputLeft = picker.x + picker.width + inputDirectionMargin;\n\t\tconst inputDirection = new DInputReal({\n\t\t\tparent: this,\n\t\t\tx: inputLeft + inputLabelWidth + inputMargin,\n\t\t\ty: paddingTop,\n\t\t\twidth: inputWidth - inputLabelWidth - inputMargin,\n\t\t\tstep: 1,\n\t\t\timage: {\n\t\t\t\tsource: inputDirectionTexture,\n\t\t\t\talign: {\n\t\t\t\t\twith: DAlignWith.BORDER\n\t\t\t\t},\n\t\t\t\tmargin: {\n\t\t\t\t\thorizontal: -inputDirectionTexture.width - inputMargin\n\t\t\t\t}\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tchange: ( value: number ) => {\n\t\t\t\t\t(this._data as any)._direction = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Recent gradients\n\t\tconst recentColumn = theme.getGradientRecentColumn();\n\t\tconst recentWidth = theme.getGradientRecentWidth();\n\t\tconst recentMargin = theme.getGradientRecentMargin();\n\t\tconst recentWidthAndMargin = recentWidth + recentMargin;\n\t\tconst x0 = inputLeft;\n\t\tconst y0 = inputDirection.y + inputDirection.height + inputDirectionMargin;\n\t\tif( DPickerColorGradient.RECENT_COLOR_GRADIENT == null ) {\n\t\t\tDPickerColorGradient.RECENT_COLOR_GRADIENT = new DPickerColorGradientRecent(\n\t\t\t\ttheme.getGradientRecents(),\n\t\t\t\ttheme.getGradientRecentCount()\n\t\t\t);\n\t\t}\n\t\tthis._recent = DPickerColorGradient.RECENT_COLOR_GRADIENT;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = recent.getCapacity(); i < imax; ++i ) {\n\t\t\tconst ix = i % recentColumn;\n\t\t\tconst x = x0 + ix * recentWidthAndMargin;\n\t\t\tconst iy = (i / recentColumn) | 0;\n\t\t\tconst y = y0 + iy * recentWidthAndMargin;\n\t\t\tview.setRectangle( 1 + i, x, y, recentWidth, recentWidth );\n\t\t}\n\t\trecent.on( \"change\", (): void => {\n\t\t\tthis.onRecentUpdate();\n\t\t});\n\t\tUtilPointerEvent.onClick( view, ( e: InteractionEvent ): void => {\n\t\t\tconst lastHitIndex = view.getLastHitIndex();\n\t\t\tif( 1 <= lastHitIndex ) {\n\t\t\t\tthis.onRecentClick( view.getData( lastHitIndex ) );\n\t\t\t}\n\t\t});\n\n\t\t// Points\n\t\tconst data = this._data = new DPickerColorGradientData();\n\t\tdata.on( \"change\", (): void => {\n\t\t\tthis.updateAnchors();\n\t\t\tview.update();\n\t\t});\n\t\tdata.on( \"selectionchange\", ( point: DPickerColorGradientPoint ): void => {\n\t\t\tthis.onAnchorSelect( point );\n\t\t});\n\t\tdata.on( \"directionchange\", ( value: number ): void => {\n\t\t\tinputDirection.value = value;\n\t\t});\n\t\tview.setData( 0, data );\n\t\tview.update();\n\t\tinputDirection.value = data.direction;\n\t\tthis.updateAnchors();\n\t\tconst selected = data.selected;\n\t\tif( selected != null ) {\n\t\t\tthis.onAnchorSelect( selected );\n\t\t}\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + gradientPointsWidth + gradientPointsMargin +\n\t\t\t\tpicker.width + inputDirectionMargin + (recentColumn - 1) * recentMargin +\n\t\t\t\trecentColumn * recentWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = paddingTop + picker.height + paddingBottom;\n\t\t}\n\t}\n\n\tget data(): DPickerColorGradientData {\n\t\treturn this._data;\n\t}\n\n\tget recent() {\n\t\treturn this._recent;\n\t}\n\n\tprotected onRecentClick( recentData: DPickerColorGradientDataLike | null ) {\n\t\tconst data = this._data;\n\t\tif( recentData != null ) {\n\t\t\tdata.fromObject( recentData );\n\t\t} else {\n\t\t\tdata.reset();\n\t\t}\n\t}\n\n\tprotected onRecentUpdate() {\n\t\tconst recent = this._recent;\n\t\tconst view = this._view;\n\t\tfor( let i = 0, imax = recent.size(); i < imax; ++i ) {\n\t\t\tview.setData( 1 + i, recent.get( i ) );\n\t\t}\n\t\tview.update();\n\t\tDApplications.update( this );\n\t}\n\n\tprotected toAnchorPosition( e: InteractionEvent ) {\n\t\tconst local = this.toLocal( e.data.global, undefined, this._work );\n\t\treturn Math.max( 0, Math.min( 1, (local.y - this.padding.getTop()) / this._picker.height ) );\n\t}\n\n\tprotected onViewDown( e: InteractionEvent ) {\n\t\tthis._data.addAt( this.toAnchorPosition( e ) );\n\t\tthis.onAnchorDragStart();\n\t}\n\n\tprotected onAnchorDown( e: InteractionEvent ) {\n\t\tconst target = e.target;\n\t\tif( target instanceof Sprite ) {\n\t\t\tconst data = this._data;\n\t\t\tconst index = this._anchors.indexOf( target );\n\t\t\tif( 0 <= index && index < data.points.length ) {\n\t\t\t\tdata.points[ index ].selected = true;\n\t\t\t\tthis.onAnchorDragStart();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorSelect( point: DPickerColorGradientPoint ) {\n\t\tconst picker = this._picker;\n\t\tpicker.current.color = point.color;\n\t\tpicker.current.alpha = point.alpha;\n\t\tpicker.new.color = point.color;\n\t\tpicker.new.alpha = point.alpha;\n\t}\n\n\tprotected onAnchorColorChange( color: number ) {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.color = color;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorAlphaChange( alpha: number ) {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.alpha = alpha;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorDragStart() {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onAnchorUpBound );\n\t\t}\n\t}\n\n\tprotected onAnchorMove( e: InteractionEvent ): void {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.position = this.toAnchorPosition( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onAnchorUpBound );\n\t\t}\n\t}\n\n\tprotected updateAnchors() {\n\t\tconst theme = this.theme;\n\t\tconst anchorTexture = theme.getGradientAnchorTexture();\n\t\tconst anchorOutlinedTexture = theme.getGradientAnchorOutlinedTexture();\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\n\t\tconst data = this._data;\n\t\tconst pointSize = data.points.length;\n\n\t\tconst anchors = this._anchors;\n\t\tconst anchorSize = anchors.length;\n\t\tfor( let i = anchorSize; i < pointSize; ++i ) {\n\t\t\tconst newAnchor = new Sprite( anchorTexture );\n\t\t\tnewAnchor.anchor.set( 0.5, 0.5 );\n\t\t\tnewAnchor.cursor = \"pointer\";\n\t\t\tnewAnchor.interactive = true;\n\t\t\tnewAnchor.on( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\tanchors.push( newAnchor );\n\t\t\tthis.addChild( newAnchor );\n\t\t}\n\n\t\tfor( let i = anchorSize - 1; pointSize <= i; --i ) {\n\t\t\tconst oldAnchor = anchors[ i ];\n\t\t\toldAnchor.off( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\toldAnchor.destroy();\n\t\t}\n\t\tanchors.length = pointSize;\n\n\t\tconst y = this.padding.getTop();\n\t\tconst right = this.padding.getLeft() + gradientPointsWidth;\n\t\tconst height = this._picker.height;\n\t\tfor( let i = 0; i < pointSize; ++i ) {\n\t\t\tconst point = data.points[ i ];\n\t\t\tconst anchor = anchors[ i ];\n\t\t\tanchor.tint = point.color;\n\t\t\tanchor.position.set(\n\t\t\t\tright,\n\t\t\t\ty + height * point.position\n\t\t\t);\n\t\t\tanchor.texture = (point.selected ? anchorOutlinedTexture : anchorTexture);\n\t\t}\n\n\t\tDApplications.update( this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isDeleteKey( e ) ) {\n\t\t\tconst points = this._data;\n\t\t\tif( points != null ) {\n\t\t\t\tconst selected = points.selected;\n\t\t\t\tif( selected != null ) {\n\t\t\t\t\tpoints.remove( selected );\n\t\t\t\t\tsuper.onKeyDown( e );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColorGradient, DPickerColorGradientOptions } from \"./d-picker-color-gradient\";\nimport { DPickerColorGradientData } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\n\nexport interface DDialogColorGradientOptions<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerColorGradientOptions;\n}\n\nexport interface DThemeDialogColorGradient extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColorGradient<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient,\n\tOPTIONS extends DDialogColorGradientOptions<THEME> = DDialogColorGradientOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerColorGradient;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerColorGradient( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\n\t\tthis.on( \"ok\", (): void => {\n\t\t\tconst data = picker.data;\n\t\t\tconst recent = picker.recent;\n\t\t\tif( ! recent.contains( data ) ) {\n\t\t\t\trecent.add( data.toObject() );\n\t\t\t}\n\t\t});\n\t}\n\n\tget data(): DPickerColorGradientData {\n\t\treturn this._picker.data;\n\t}\n\n\tget recent(): DPickerColorGradientRecent {\n\t\treturn this._picker.recent;\n\t}\n\n\tget picker(): DPickerColorGradient {\n\t\treturn this._picker;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis._picker.onKeyDown( e );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogColorGradient, DDialogColorGradientOptions } from \"./d-dialog-color-gradient\";\nimport { DPickerColorGradientData } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientDataView } from \"./d-picker-color-gradient-data-view\";\n\nexport interface DButtonColorGradientOptions<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient\n> extends DButtonOptions<DPickerColorGradientData, THEME> {\n\tdialog?: DDialogColorGradientOptions;\n}\n\nexport interface DThemeButtonColorGradient extends DThemeButton {\n\tgetViewBaseTexture(): Texture | null;\n\tgetTextFormatter(): ( value: DPickerColorGradientData, caller: DButtonColorGradient ) => string;\n\tgetTextValue( state: DBaseState ): DPickerColorGradientData;\n\tnewTextValue(): DPickerColorGradientData;\n}\n\nexport class DButtonColorGradient<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient,\n\tOPTIONS extends DButtonColorGradientOptions<THEME> = DButtonColorGradientOptions<THEME>\n> extends DButton<DPickerColorGradientData, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColorGradient;\n\tprotected _dialog?: DDialogColorGradient;\n\tprotected _dialogOptions?: DDialogColorGradientOptions;\n\tprotected _view?: DPickerColorGradientDataView;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst data = this._textValueComputed;\n\t\tthis._dialogOptions = options && options.dialog;\n\n\t\tif( options == null || options.image == null || options.image.source === undefined ) {\n\t\t\tconst texture = this.theme.getViewBaseTexture();\n\t\t\tif( texture instanceof Texture ) {\n\t\t\t\tconst view = this._view = DPickerColorGradientDataView.from( 1, 10, texture );\n\t\t\t\tview.setRectangle( 0, 0, 0, texture.width, texture.height );\n\t\t\t\tview.setData( 0, data );\n\t\t\t\tview.update();\n\t\t\t\tthis.image = view;\n\t\t\t}\n\t\t}\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.data.fromObject( data );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tdata.fromObject( dialog.data );\n\t\t\t\tconst view = this._view;\n\t\t\t\tif( view != null ) {\n\t\t\t\t\tview.update();\n\t\t\t\t}\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t\tDApplications.update( this );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tget dialog(): DDialogColorGradient {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogColorGradient( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DButtonColorGradient.DIALOG == null ) {\n\t\t\t\t\tDButtonColorGradient.DIALOG = new DDialogColorGradient();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColorGradient.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DPickerColorGradientData {\n\t\treturn this._textValueComputed;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColor, DPickerColorOptions } from \"./d-picker-color\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\n\nexport interface DDialogColorOptions<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerColorOptions;\n}\n\nexport interface DThemeDialogColor extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColor<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor,\n\tOPTIONS extends DDialogColorOptions<THEME> = DDialogColorOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerColor;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerColor( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\n\t\tthis.on( \"ok\", (): void => {\n\t\t\tconst recent = picker.recent;\n\t\t\tif( ! recent.contains( picker.new ) ) {\n\t\t\t\trecent.add( picker.new );\n\t\t\t}\n\t\t});\n\t}\n\n\tget current(): DColorAndAlpha {\n\t\treturn this._picker.current;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this._picker.new;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this._picker.recent;\n\t}\n\n\tget picker(): DPickerColor {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DDialogColor, DDialogColorOptions } from \"./d-dialog-color\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\n\nexport interface DButtonColorOptions<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor\n> extends DButtonOptions<DColorAndAlpha, THEME> {\n\tdialog?: DDialogColorOptions;\n}\n\nexport interface DThemeButtonColor extends DThemeButton {\n\tgetTextFormatter(): ( value: DColorAndAlpha, caller: DButtonColor ) => string;\n\tgetTextValue( state: DBaseState ): DColorAndAlpha;\n\tnewTextValue(): DColorAndAlpha;\n}\n\nexport class DButtonColor<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor,\n\tOPTIONS extends DButtonColorOptions<THEME> = DButtonColorOptions<THEME>\n> extends DButton<DColorAndAlpha, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColor;\n\tprotected _dialog?: DDialogColor;\n\tprotected _dialogOptions!: DDialogColorOptions | undefined;\n\tprotected _value!: DPickerColorAndAlpha;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst colorAndAlpha = this._textValueComputed;\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._value = new DPickerColorAndAlpha( colorAndAlpha, ( color: number ): void => {\n\t\t\tcolorAndAlpha.color = color;\n\t\t\tthis.onColorChange();\n\t\t}, ( alpha: number ): void => {\n\t\t\tcolorAndAlpha.alpha = alpha;\n\t\t\tthis.updateTextForcibly();\n\t\t});\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current.color = colorAndAlpha.color;\n\t\t\tdialog.current.alpha = colorAndAlpha.alpha;\n\t\t\tdialog.new.color = colorAndAlpha.color;\n\t\t\tdialog.new.alpha = colorAndAlpha.alpha;\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dialogNew, dialogCurrent, this );\n\t\t\t\tcolorAndAlpha.color = dialogNew.color;\n\t\t\t\tcolorAndAlpha.alpha = dialogNew.alpha;\n\t\t\t\tthis.onColorChange();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected getImageTintColor( theme: THEME, state: DBaseState ): number | null {\n\t\treturn this._textValueComputed.color;\n\t}\n\n\tprotected onColorChange(): void {\n\t\tconst image = this._image;\n\t\tif( this.isTintAware( image ) ) {\n\t\t\timage.tint = this._textValueComputed.color;\n\t\t\tDApplications.update( this );\n\t\t}\n\t\tthis.updateTextForcibly();\n\t}\n\n\tprotected updateTextForcibly(): void {\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tget dialog(): DDialogColor {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogColor( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DButtonColor.DIALOG == null ) {\n\t\t\t\t\tDButtonColor.DIALOG = new DDialogColor();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColor.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DColorAndAlpha {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonDanger extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonDanger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonBackOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack = DThemePickerDatetimeButtonBack\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonBack extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonBack<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack = DThemePickerDatetimeButtonBack,\n\tOPTIONS extends DPickerDatetimeButtonBackOptions<VALUE, THEME> = DPickerDatetimeButtonBackOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonBack\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate = DThemePickerDatetimeButtonDate\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonDate extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate = DThemePickerDatetimeButtonDate,\n\tOPTIONS extends DPickerDatetimeButtonDateOptions<VALUE, THEME> = DPickerDatetimeButtonDateOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected onToggleStart(): void {\n\t\tif( ! this.isActive() ) {\n\t\t\tthis.setActive( true );\n\t\t}\n\t}\n\n\tprotected onToggleEnd(): void {\n\t\tthis.emit( this.isActive() ? \"active\" : \"inactive\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonNextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext = DThemePickerDatetimeButtonNext\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonNext extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonNext<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext = DThemePickerDatetimeButtonNext,\n\tOPTIONS extends DPickerDatetimeButtonNextOptions<VALUE, THEME> = DPickerDatetimeButtonNextOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonNext\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelOptions<\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel\n> extends DTextOptions<Date, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabel extends DThemeText {\n\n}\n\nexport class DPickerDatetimeLabel<\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel,\n\tOPTIONS extends DPickerDatetimeLabelOptions<THEME> = DPickerDatetimeLabelOptions<THEME>\n> extends DText<Date, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate = DThemePickerDatetimeLabelDate\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabelDate extends DThemeText {\n\n}\n\nexport class DPickerDatetimeLabelDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate = DThemePickerDatetimeLabelDate,\n\tOPTIONS extends DPickerDatetimeLabelDateOptions<VALUE, THEME> = DPickerDatetimeLabelDateOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabelDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DPickerDatetimeSpaceOptions<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeSpace extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeSpace<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace,\n\tOPTIONS extends DPickerDatetimeSpaceOptions<THEME> = DPickerDatetimeSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t\tthis.renderable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputIntegerOptions<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputInteger extends DThemeInputNumber {\n}\n\nexport class DInputInteger<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger,\n\tOPTIONS extends DInputIntegerOptions<THEME> = DInputIntegerOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport type DPickerTimeBoundDate = Date | null;\n\nexport interface DPickerTimeBoundOptions {\n\tdate?: DPickerTimeBoundDate;\n\tinclusive?: boolean;\n}\n\nexport class DPickerTimeBound {\n\tprotected _date: DPickerTimeBoundDate;\n\tprotected _inclusive: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DPickerTimeBoundOptions | undefined, onChange: () => void ) {\n\t\tthis._date = ( options && options.date !== undefined ? options.date : null );\n\t\tthis._inclusive = ( options && options.inclusive !== undefined ? options.inclusive : false );\n\t\tthis._onChange = onChange;\n\t}\n\n\tget date(): DPickerTimeBoundDate {\n\t\treturn this._date;\n\t}\n\n\tset date( date: DPickerTimeBoundDate ) {\n\t\tif( this._date !== date ) {\n\t\t\tthis._date = date;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tget inclusive(): boolean {\n\t\treturn this._inclusive;\n\t}\n\n\tset inclusive( inclusive: boolean ) {\n\t\tif( this._inclusive !== inclusive ) {\n\t\t\tthis._inclusive = inclusive;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DDragMode {\n\tOFF,\n\tON,\n\tTOUCH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundHoursParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundHours {\n\tprotected _parent: DPickerTimeBoundHoursParent;\n\n\tconstructor( parent: DPickerTimeBoundHoursParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateHours = lowerDate.getHours();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( lowerDate.getMinutes() < constant.minute.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateHours + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateHours = upperDate.getHours();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( constant.minute.min < upperDate.getMinutes() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateHours - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundMinutesParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundMinutes {\n\tprotected _parent: DPickerTimeBoundMinutesParent;\n\n\tconstructor( parent: DPickerTimeBoundMinutesParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateMinutes = lowerDate.getMinutes();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateMinutes + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateMinutes = upperDate.getMinutes();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateMinutes - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundSecondsParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundSeconds {\n\tprotected _parent: DPickerTimeBoundSecondsParent;\n\n\tconstructor( parent: DPickerTimeBoundSecondsParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( lowerDate.getMinutes() < date.getMinutes() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn lowerDate.getSeconds() + ( lower.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( date.getMinutes() < upperDate.getMinutes() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn upperDate.getSeconds() - ( upper.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\nimport { DPickerTimeBoundHours } from \"./d-picker-time-bound-hours\";\nimport { DPickerTimeBoundMinutes } from \"./d-picker-time-bound-minutes\";\nimport { DPickerTimeBoundSeconds } from \"./d-picker-time-bound-seconds\";\n\nexport interface DPickerTimeBoundsOptions {\n\tlower?: DPickerTimeBoundOptions;\n\tupper?: DPickerTimeBoundOptions;\n}\n\nexport class DPickerTimeBounds {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\thours: DPickerTimeBoundHours;\n\tminutes: DPickerTimeBoundMinutes;\n\tseconds: DPickerTimeBoundSeconds;\n\tconstant: DPickerTimeBoundConstant;\n\n\tconstructor( options: DPickerTimeBoundsOptions | undefined, onChange: () => void ) {\n\t\tthis.constant = this.newConstant();\n\t\tthis.lower = new DPickerTimeBound( options && options.lower, onChange );\n\t\tthis.upper = new DPickerTimeBound( options && options.upper, onChange );\n\t\tthis.mask = DPickerDatetimeMask.ALL;\n\t\tthis.hours = new DPickerTimeBoundHours( this );\n\t\tthis.minutes = new DPickerTimeBoundMinutes( this );\n\t\tthis.seconds = new DPickerTimeBoundSeconds( this );\n\t}\n\n\tnewConstant(): DPickerTimeBoundConstant {\n\t\treturn {\n\t\t\tsecond: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\tminute: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\thour: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 23\n\t\t\t}\n\t\t};\n\t}\n\n\tadjust( date: Date ): boolean {\n\t\tconst result = this.test( date );\n\t\tif( result < 0 ) {\n\t\t\tconst lower = this.lower;\n\t\t\tconst lowerDate = lower.date;\n\t\t\tif( lowerDate ) {\n\t\t\t\tdate.setTime( lowerDate.getTime() );\n\t\t\t\tif( ! lower.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( lowerDate.getSeconds() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( lowerDate.getMinutes() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( lowerDate.getHours() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( lowerDate.getDate() + 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if( 0 < result ) {\n\t\t\tconst upper = this.upper;\n\t\t\tconst upperDate = upper.date;\n\t\t\tif( upperDate ) {\n\t\t\t\tdate.setTime( upperDate.getTime() );\n\t\t\t\tif( ! upper.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( upperDate.getSeconds() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( upperDate.getMinutes() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( upperDate.getHours() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( upperDate.getDate() - 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tcompare( a: Date, b: Date ): number {\n\t\tconst mask = this.mask;\n\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\tconst ay = a.getFullYear();\n\t\t\tconst by = b.getFullYear();\n\t\t\tif( ay !== by ) {\n\t\t\t\treturn ( ay < by ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst am = a.getMonth();\n\t\t\tconst bm = b.getMonth();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst ad = a.getDate();\n\t\t\tconst bd = b.getDate();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tconst ah = a.getHours();\n\t\t\tconst bh = b.getHours();\n\t\t\tif( ah !== bh ) {\n\t\t\t\treturn ( ah < bh ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tconst am = a.getMinutes();\n\t\t\tconst bm = b.getMinutes();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tconst ad = a.getSeconds();\n\t\t\tconst bd = b.getSeconds();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\ttest( date: Date ): number {\n\t\t// Lower bound\n\t\tconst lower = this.lower;\n\t\tconst lowerDate = lower.date;\n\t\tif( lowerDate != null ) {\n\t\t\tconst result = this.compare( lowerDate, date );\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : -1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : -1 );\n\t\t\t}\n\t\t}\n\n\t\t// Upper bound\n\t\tconst upper = this.upper;\n\t\tconst upperDate = upper.date;\n\t\tif( upperDate != null ) {\n\t\t\tconst result = this.compare( date, upperDate );\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : +1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : +1 );\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcontains( date: Date ): boolean {\n\t\treturn this.test( date ) === 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DInputInteger, DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBoundDate, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBounds, DPickerTimeBoundsOptions } from \"./d-picker-time-bounds\";\nimport { DText } from \"./d-text\";\n\nexport interface DPickerTimeOptions<THEME extends DThemePickerTime = DThemePickerTime> extends DBaseOptions<THEME> {\n\tmargin?: number;\n\thours?: DInputIntegerOptions;\n\tminutes?: DInputIntegerOptions;\n\tseconds?: DInputIntegerOptions;\n\tmask?: DPickerDatetimeMask;\n\tbounds?: DPickerTimeBoundsOptions;\n}\n\nexport interface DThemePickerTime extends DThemeBase {\n\tgetMargin(): number;\n\tgetHoursOptions(): DInputIntegerOptions;\n\tgetMinutesOptions(): DInputIntegerOptions;\n\tgetSecondsOptions(): DInputIntegerOptions;\n\tgetMask(): DPickerDatetimeMask;\n\tgetLowerBound(): DPickerTimeBoundDate;\n\tisLowerBoundInclusive(): boolean;\n\tgetUpperBound(): DPickerTimeBoundDate;\n\tisUpperBoundInclusive(): boolean;\n}\n\nconst toBoundOptions = (\n\toptions: DPickerTimeBoundOptions | undefined,\n\tdate: DPickerTimeBoundDate,\n\tinclusive: boolean\n): DPickerTimeBoundOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tdate: ( options.date !== undefined ? options.date : date ),\n\t\t\tinclusive: ( options.inclusive !== undefined ? options.inclusive : inclusive )\n\t\t};\n\t}\n\treturn {\n\t\tdate,\n\t\tinclusive\n\t};\n};\n\nconst toBoundsOptions = (\n\ttheme: DThemePickerTime,\n\toptions: DPickerTimeBoundsOptions | undefined\n): DPickerTimeBoundsOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tlower: toBoundOptions(\n\t\t\t\toptions.lower,\n\t\t\t\ttheme.getLowerBound(),\n\t\t\t\ttheme.isLowerBoundInclusive()\n\t\t\t),\n\t\t\tupper: toBoundOptions(\n\t\t\t\toptions.upper,\n\t\t\t\ttheme.getUpperBound(),\n\t\t\t\ttheme.isUpperBoundInclusive()\n\t\t\t)\n\t\t};\n\t}\n\treturn {\n\t\tlower: {\n\t\t\tdate: theme.getLowerBound(),\n\t\t\tinclusive: theme.isLowerBoundInclusive()\n\t\t},\n\t\tupper: {\n\t\t\tdate: theme.getUpperBound(),\n\t\t\tinclusive: theme.isUpperBoundInclusive()\n\t\t}\n\t};\n};\n\nexport class DPickerTime<\n\tTHEME extends DThemePickerTime = DThemePickerTime,\n\tOPTIONS extends DPickerTimeOptions<THEME> = DPickerTimeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _dateBounds!: DPickerTimeBounds;\n\tprotected _dateCurrent!: Date;\n\tprotected _dateNew!: Date;\n\tprotected _inputHours!: DInputInteger | null;\n\tprotected _inputMinutes!: DInputInteger | null;\n\tprotected _inputSeconds!: DInputInteger | null;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst theme = this.theme;\n\t\tthis._dateCurrent = new Date();\n\t\tconst dateCurrentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew = new Date( dateCurrentTime );\n\t\tthis._dateBounds = new DPickerTimeBounds(\n\t\t\ttoBoundsOptions( theme, options && options.bounds ),\n\t\t\t(): void => { this.onNewChanged(); }\n\t\t);\n\t\tconst margin = ( options && options.margin != null ?\n\t\t\toptions.margin : theme.getMargin() );\n\t\tnew DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\tmargin,\n\t\t\tchildren: this.newChildren( theme, options, margin )\n\t\t});\n\t}\n\n\tget current(): Date {\n\t\treturn this._dateCurrent;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tif( this._dateCurrent.getTime() !== dateCurrent.getTime() ) {\n\t\t\tthis._dateCurrent = dateCurrent;\n\t\t}\n\t}\n\n\tget new(): Date {\n\t\treturn this._dateNew;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tif( this._dateNew.getTime() !== dateNew.getTime() ) {\n\t\t\tthis._dateNew = dateNew;\n\t\t\tthis.onNewChanged();\n\t\t}\n\t}\n\n\tget bounds(): DPickerTimeBounds {\n\t\treturn this._dateBounds;\n\t}\n\n\thasHours(): boolean {\n\t\treturn this._inputHours != null;\n\t}\n\n\thasMinutes(): boolean {\n\t\treturn this._inputMinutes != null;\n\t}\n\n\thasSeconds(): boolean {\n\t\treturn this._inputSeconds != null;\n\t}\n\n\treset(): void {\n\t\tconst currentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew.setTime( currentTime );\n\t\tthis.onReset();\n\t}\n\n\tprotected onReset(): void {\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected onNewChanged(): void {\n\t\tconst dateNew = this._dateNew;\n\t\tconst dateBounds = this._dateBounds;\n\t\tdateBounds.adjust( this._dateNew );\n\n\t\tconst inputHours = this._inputHours;\n\t\tif( inputHours ) {\n\t\t\tconst hours = dateBounds.hours;\n\t\t\tinputHours.value = dateNew.getHours();\n\t\t\tinputHours.min = hours.min( dateNew );\n\t\t\tinputHours.max = hours.max( dateNew );\n\t\t}\n\n\t\tconst inputMinutes = this._inputMinutes;\n\t\tif( inputMinutes ) {\n\t\t\tconst minutes = dateBounds.minutes;\n\t\t\tinputMinutes.value = dateNew.getMinutes();\n\t\t\tinputMinutes.min = minutes.min( dateNew );\n\t\t\tinputMinutes.max = minutes.max( dateNew );\n\t\t}\n\n\t\tconst inputSeconds = this._inputSeconds;\n\t\tif( inputSeconds ) {\n\t\t\tconst seconds = dateBounds.seconds;\n\t\t\tinputSeconds.value = dateNew.getSeconds();\n\t\t\tinputSeconds.min = seconds.min( dateNew );\n\t\t\tinputSeconds.max = seconds.max( dateNew );\n\t\t}\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tconst mask = ( (options && options.mask != null) ? options.mask : theme.getMask() );\n\t\tthis._dateBounds.mask = mask;\n\t\tthis._inputHours = ( (mask & DPickerDatetimeMask.HOURS) ? this.newInputHours( theme, options ) : null );\n\t\tthis._inputMinutes = ( (mask & DPickerDatetimeMask.MINUTES) ? this.newInputMinutes( theme, options ) : null );\n\t\tthis._inputSeconds = ( (mask & DPickerDatetimeMask.SECONDS) ? this.newInputSeconds( theme, options ) : null );\n\t\treturn [\n\t\t\tthis.newTimeLayout(\n\t\t\t\tthis._inputHours,\n\t\t\t\tthis._inputMinutes,\n\t\t\t\tthis._inputSeconds,\n\t\t\t\tmargin\n\t\t\t)\n\t\t];\n\t}\n\n\tprotected newTimeLayout(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null,\n\t\tmargin: number\n\t): DLayoutHorizontal | null {\n\t\tconst children = this.newTimeLayoutChildren( hours, minutes, seconds );\n\t\tif( 0 < children.length ) {\n\t\t\treturn new DLayoutHorizontal({\n\t\t\t\twidth: this.getTimeLayoutWidth(),\n\t\t\t\theight: this.getTimeLayoutHeight(),\n\t\t\t\tmargin,\n\t\t\t\tchildren\n\t\t\t});\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinateSize {\n\t\treturn \"auto\";\n\t}\n\n\tprotected getTimeLayoutHeight(): DCoordinateSize {\n\t\treturn \"auto\";\n\t}\n\n\tprotected newTimeLayoutChildren(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null\n\t): Array<DisplayObject | null> {\n\t\tconst result = [];\n\t\tif( hours != null ) {\n\t\t\tresult.push( hours );\n\t\t}\n\t\tif( minutes != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newMinuteSeparator() );\n\t\t\t}\n\t\t\tresult.push( minutes );\n\t\t}\n\t\tif( seconds != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newSecondSeparator() );\n\t\t\t}\n\t\t\tresult.push( seconds );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newMinuteSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getMinuteSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinuteSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected newSecondSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getSecondSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetSecondSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.step == null ) {\n\t\t\toptions.step = 1;\n\t\t}\n\t\tif( options.min == null ) {\n\t\t\toptions.min = 0;\n\t\t}\n\t\tif( options.max == null ) {\n\t\t\toptions.max = max;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected newInputHours( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.hours ) || theme.getHoursOptions();\n\t\tconst max = this._dateBounds.constant.hour.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onHoursChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onHoursChanged( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setHours( value );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected newInputMinutes( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.minutes ) || theme.getMinutesOptions();\n\t\tconst max = this._dateBounds.constant.minute.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onMinutesChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onMinutesChanged( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setMinutes( value );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected newInputSeconds( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.seconds ) || theme.getSecondsOptions();\n\t\tconst max = this._dateBounds.constant.second.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onSecondsChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onSecondsChanged( value: number ): void {\n\t\tthis._dateNew.setSeconds( value );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeButtonBack, DPickerDatetimeButtonBackOptions } from \"./d-picker-datetime-button-back\";\nimport { DPickerDatetimeButtonDate } from \"./d-picker-datetime-button-date\";\nimport { DPickerDatetimeButtonNext, DPickerDatetimeButtonNextOptions } from \"./d-picker-datetime-button-next\";\nimport { DPickerDatetimeLabel, DPickerDatetimeLabelOptions } from \"./d-picker-datetime-label\";\nimport { DPickerDatetimeLabelDate } from \"./d-picker-datetime-label-date\";\nimport { DPickerDatetimeSpace } from \"./d-picker-datetime-space\";\nimport { DPickerTime, DPickerTimeOptions, DThemePickerTime } from \"./d-picker-time\";\n\nexport type DPickerDatetimeLabelFormatter = ( date: Date ) => string;\nexport type DPickerDatetimeDateDecorator = ( date: Date, button: DPickerDatetimeButtonDate ) => void;\nexport type DPickerDatetimeDayLabels = [ string, string, string, string, string, string, string ];\n\nexport interface DPickerDatetimeDayOptions {\n\tstart?: number;\n\tlabels?: DPickerDatetimeDayLabels;\n}\n\nexport interface DPickerDatetimeDateOptions {\n\tdecorator?: DPickerDatetimeDateDecorator;\n}\n\nexport interface DPickerDatetimeOptions<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime\n> extends DPickerTimeOptions<THEME> {\n\tback?: DPickerDatetimeButtonBackOptions | null;\n\tnext?: DPickerDatetimeButtonNextOptions | null;\n\tday?: DPickerDatetimeDayOptions;\n\tlabel?: DPickerDatetimeLabelOptions;\n\tdate?: DPickerDatetimeDateOptions;\n}\n\nexport interface DThemePickerDatetime extends DThemePickerTime {\n\tgetDayLabels(): DPickerDatetimeDayLabels;\n\tgetDayStart(): number;\n\tgetLabelFormatter(): DPickerDatetimeLabelFormatter;\n\tgetDateDecorator(): DPickerDatetimeDateDecorator;\n\tgetBackButtonOptions(): DPickerDatetimeButtonBackOptions | null;\n\tgetNextButtonOptions(): DPickerDatetimeButtonNextOptions | null;\n}\n\nexport class DPickerDatetime<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime,\n\tOPTIONS extends DPickerDatetimeOptions<THEME> = DPickerDatetimeOptions<THEME>\n> extends DPickerTime<THEME, OPTIONS> {\n\tprotected _datePage!: Date;\n\tprotected _dateButtons!: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate>;\n\tprotected _dateDecorator!: DPickerDatetimeDateDecorator;\n\tprotected _label!: DPickerDatetimeLabel;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._datePage = new Date( this._dateCurrent.getTime() );\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tthis._dateButtons = this.newDateButtons( theme, options );\n\t\tthis._dateDecorator = ( options && options.date && options.date.decorator ) ||\n\t\t\ttheme.getDateDecorator();\n\t\tthis._label = this.newLabel( theme, options );\n\t\tconst result = super.newChildren( theme, options, margin );\n\t\tresult.unshift(\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"100%\", height: \"auto\",\n\t\t\t\tchildren: [\n\t\t\t\t\tthis.newBackButton( theme, options ),\n\t\t\t\t\tthis._label,\n\t\t\t\t\tthis.newNextButton( theme, options )\n\t\t\t\t]\n\t\t\t}),\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tchildren: this.newDateLabels( theme, options )\n\t\t\t}),\n\t\t\tnew DLayoutVertical({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tcolumn: 7,\n\t\t\t\tchildren: this._dateButtons\n\t\t\t})\n\t\t);\n\t\treturn result;\n\t}\n\n\tget page(): Date {\n\t\treturn this._datePage;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tif( this._datePage.getTime() !== datePage.getTime() ) {\n\t\t\tthis._datePage = datePage;\n\t\t\tthis.onPageChanged();\n\t\t}\n\t}\n\n\tprotected onReset(): void {\n\t\tthis._datePage.setTime( this._dateCurrent.getTime() );\n\t\tsuper.onReset();\n\t}\n\n\tnext(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() + 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChanged();\n\t}\n\n\tback(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() - 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChanged();\n\t}\n\n\tonNewChanged(): void {\n\t\tthis._dateBounds.adjust( this._datePage );\n\t\tsuper.onNewChanged();\n\t\tthis.onPageChanged();\n\t}\n\n\tprotected onPageChanged(): void {\n\t\tconst buttons = this._dateButtons;\n\t\tconst bounds = this._dateBounds;\n\t\tconst datePage = this._datePage;\n\t\tconst dateNew = this._dateNew;\n\n\t\tconst tmp = new Date( datePage.getTime() );\n\t\ttmp.setDate( 1 );\n\t\ttmp.setHours( 0, 0, 0, 0 );\n\n\t\t// Spaces\n\t\tconst theme = this.theme;\n\t\tconst spaceCount = ( tmp.getDay() - theme.getDayStart() + 7 ) % 7;\n\t\tfor( let i = 0; i < spaceCount; ++i ) {\n\t\t\tbuttons[ i ].show();\n\t\t}\n\t\tfor( let i = spaceCount; i < 7; ++i ) {\n\t\t\tbuttons[ i ].hide();\n\t\t}\n\n\t\t// Date buttons\n\t\tconst dateDecorator = this._dateDecorator;\n\t\ttmp.setFullYear( tmp.getFullYear(), tmp.getMonth() + 1, 0 );\n\t\tconst dateCount = tmp.getDate();\n\t\tconst dateNewDate = ( dateNew.getFullYear() === tmp.getFullYear() &&\n\t\t\tdateNew.getMonth() === tmp.getMonth() ? dateNew.getDate() : 0 );\n\t\tfor( let i = 0; i < dateCount; ++i ) {\n\t\t\ttmp.setDate( i + 1 );\n\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.setActive( dateNewDate === i + 1 );\n\t\t\tbutton.setDisabled( ! bounds.contains( tmp ) );\n\t\t\tbutton.show();\n\n\t\t\tdateDecorator( tmp, button as DPickerDatetimeButtonDate );\n\t\t}\n\t\tfor( let i = dateCount; i < 31; ++i ) {\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.setActive( false );\n\t\t\tbutton.hide();\n\t\t}\n\n\t\t// Label\n\t\ttmp.setTime( datePage.getTime() );\n\t\tthis._label.text = tmp;\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.weight == null ) {\n\t\t\toptions.weight = 1;\n\t\t}\n\t\treturn super.adjustInputOptions( theme, options, max );\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinateSize {\n\t\treturn \"100%\";\n\t}\n\n\tprotected toLabelOptions( theme: THEME, options?: DPickerDatetimeOptions ): DPickerDatetimeLabelOptions {\n\t\tconst result = (options && options.label) || {};\n\t\tif( result.weight === undefined ) {\n\t\t\tresult.weight = 1;\n\t\t}\n\n\t\tif( result.padding === undefined ) {\n\t\t\tresult.padding = 0;\n\t\t}\n\n\t\tconst labelText = result.text = result.text || {};\n\t\tconst labelTextAlign = labelText.align = labelText.align || {};\n\t\tif( labelTextAlign.horizontal === undefined ) {\n\t\t\tlabelTextAlign.horizontal = \"CENTER\";\n\t\t}\n\n\t\tif( labelText.formatter === undefined ) {\n\t\t\tlabelText.formatter = theme.getLabelFormatter();\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newLabel( theme: THEME, options?: DPickerDatetimeOptions ): DPickerDatetimeLabel {\n\t\treturn new DPickerDatetimeLabel( this.toLabelOptions( theme, options ) );\n\t}\n\n\tprotected newBackButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonBack | null {\n\t\tconst buttonOptions = ( options && options.back !== undefined ?\n\t\t\toptions.back : theme.getBackButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonBack( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.back();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newNextButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonNext | null {\n\t\tconst buttonOptions = ( options && options.next !== undefined ?\n\t\t\toptions.next : theme.getNextButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonNext( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.next();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newDateLabels( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeLabelDate[] {\n\t\tconst dateLabels = theme.getDayLabels();\n\t\tconst dayStart = theme.getDayStart();\n\t\tconst result: DPickerDatetimeLabelDate[] = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tconst label = dateLabels[ (dayStart + i) % 7 ];\n\t\t\tresult.push(\n\t\t\t\tthis.newDateLabel( theme, options, label )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newDateLabel( theme: THEME, options: OPTIONS | undefined, label: string ): DPickerDatetimeLabelDate {\n\t\treturn new DPickerDatetimeLabelDate({\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newDateButtons(\n\t\ttheme: THEME, options: OPTIONS | undefined\n\t): Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> {\n\t\tconst result: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newSpace( theme, options )\n\t\t\t);\n\t\t}\n\t\tfor( let i = 1; i <= 31; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newDateButton( theme, options, i )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newSpace( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeSpace {\n\t\treturn new DPickerDatetimeSpace();\n\t}\n\n\tprotected newDateButton( theme: THEME, options: OPTIONS | undefined, date: number ): DPickerDatetimeButtonDate {\n\t\treturn new DPickerDatetimeButtonDate({\n\t\t\ttext: {\n\t\t\t\tvalue: String( date )\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tactive: (): void => {\n\t\t\t\t\tthis.onDateButtonClicked( date );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onDateButtonClicked( date: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tif( dateNew.getDate() !== date ) {\n\t\t\tconst datePage = this._datePage;\n\t\t\tdateNew.setFullYear( datePage.getFullYear() );\n\t\t\tdateNew.setMonth( datePage.getMonth() );\n\t\t\tdateNew.setDate( date );\n\t\t\tthis.onNewChanged();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetime, DPickerDatetimeOptions, DThemePickerDatetime } from \"./d-picker-datetime\";\n\nexport interface DPickerDateOptions<\n\tTHEME extends DThemePickerDate = DThemePickerDate\n> extends DPickerDatetimeOptions<THEME> {\n\n}\n\nexport interface DThemePickerDate extends DThemePickerDatetime {\n\n}\n\nexport class DPickerDate<\n\tTHEME extends DThemePickerDate = DThemePickerDate,\n\tOPTIONS extends DPickerDateOptions<THEME> = DPickerDateOptions<THEME>\n> extends DPickerDatetime<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDate, DPickerDateOptions } from \"./d-picker-date\";\n\nexport interface DDialogDateOptions<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerDateOptions;\n}\n\nexport interface DThemeDialogDate extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDate<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate,\n\tOPTIONS extends DDialogDateOptions<THEME> = DDialogDateOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerDate;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerDate( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget page(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tthis._picker.page = datePage;\n\t}\n\n\tget picker(): DPickerDate {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDate } from \"./d-dialog-date\";\n\nexport class DDialogDates {\n\tprotected static INSTANCE?: DDialogDate;\n\tstatic getInstance(): DDialogDate {\n\t\tif( DDialogDates.INSTANCE == null ) {\n\t\t\tDDialogDates.INSTANCE = new DDialogDate();\n\t\t}\n\t\treturn DDialogDates.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\n\nexport interface DButtonDateOptions<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDateOptions;\n}\n\nexport interface DThemeButtonDate extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDate ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonDate<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate,\n\tOPTIONS extends DButtonDateOptions<THEME> = DButtonDateOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDate;\n\tprotected _dialogOptions?: DDialogDateOptions;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._dialogOptions = options && options.dialog;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDate( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetime, DPickerDatetimeOptions } from \"./d-picker-datetime\";\n\nexport interface DDialogDatetimeOptions<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerDatetimeOptions;\n}\n\nexport interface DThemeDialogDatetime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDatetime<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime,\n\tOPTIONS extends DDialogDatetimeOptions<THEME> = DDialogDatetimeOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerDatetime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerDatetime( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget page(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tthis._picker.page = datePage;\n\t}\n\n\tget picker(): DPickerDatetime {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDatetime } from \"./d-dialog-datetime\";\n\nexport class DDialogDatetimes {\n\tprotected static INSTANCE?: DDialogDatetime;\n\tstatic getInstance(): DDialogDatetime {\n\t\tif( DDialogDatetimes.INSTANCE == null ) {\n\t\t\tDDialogDatetimes.INSTANCE = new DDialogDatetime();\n\t\t}\n\t\treturn DDialogDatetimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"./util/to-padded\";\n\nexport class DPickerDates {\n\tstatic format( date: Date ): string {\n\t\tconst y = toPadded( String( date.getFullYear() ), 4, \"0\" );\n\t\tconst M = toPadded( String( date.getMonth() + 1 ), 2, \"0\");\n\t\tconst S = toPadded( String( date.getDate() ), 2, \"0\" );\n\t\treturn `${y}/${M}/${S}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DThemePickerTime } from \"./d-picker-time\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { toPadded } from \"./util/to-padded\";\n\nexport class DPickerTimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tlet result = \"\";\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tresult += toPadded( String( date.getHours() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += toPadded( String( date.getMinutes() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += toPadded( String( date.getSeconds() ), 2, \"0\" );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toMask( options?: { mask?: DPickerDatetimeMask } ): DPickerDatetimeMask {\n\t\treturn ( options && options.mask != null ? options.mask :\n\t\t\t(DThemes.getInstance().get( \"DPickerTime\" ) as DThemePickerTime).getMask() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDates } from \"./d-picker-dates\";\nimport { DThemePickerDatetime } from \"./d-picker-datetime\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport class DPickerDatetimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tconst hms = DPickerTimes.format( date, mask );\n\t\tif( 0 < hms.length ) {\n\t\t\treturn `${DPickerDates.format( date )} ${hms}`;\n\t\t} else {\n\t\t\treturn `${DPickerDates.format( date )}`;\n\t\t}\n\t}\n\n\tstatic toMask( options?: { mask?: DPickerDatetimeMask } ): DPickerDatetimeMask {\n\t\treturn ( options && options.mask != null ? options.mask :\n\t\t\t(DThemes.getInstance().get( \"DPickerDatetime\" ) as DThemePickerDatetime).getMask() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\n\nexport interface DButtonDatetimeOptions<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDatetimeOptions;\n}\n\nexport interface DThemeButtonDatetime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDatetime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonDatetime<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime,\n\tOPTIONS extends DButtonDatetimeOptions<THEME> = DButtonDatetimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _dialogOptions?: DDialogDatetimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._datetimeMask = DPickerDatetimes.toMask( options && options.dialog && options.dialog.picker );\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDatetime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { isString } from \"./util/is-string\";\nimport { UtilFileAs, UtilFileOpener } from \"./util/util-file-opener\";\n\nexport import DButtonFileAs = UtilFileAs;\n\nexport interface DButtonFileOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile = DThemeButtonFile\n> extends DButtonOptions<VALUE, THEME> {\n\tas?: (keyof typeof UtilFileAs) | UtilFileAs;\n\tchecker?: () => Promise<unknown> | boolean;\n}\n\nexport interface DThemeButtonFile extends DThemeButton {\n\n}\n\nexport class DButtonFile<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile = DThemeButtonFile,\n\tOPTIONS extends DButtonFileOptions<VALUE, THEME> = DButtonFileOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _checker!: (() => Promise<unknown> | boolean) | undefined;\n\tprotected _opener!: UtilFileOpener;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis._checker = ( options != null && options.checker != null ? options.checker : undefined );\n\t\tconst as: DButtonFileAs = ( options != null && options.as != null ?\n\t\t\t( isString( options.as ) ? DButtonFileAs[ options.as ] : options.as ) :\n\t\t\tDButtonFileAs.TEXT\n\t\t);\n\t\tconst opener = new UtilFileOpener( as, this );\n\t\tthis._opener = opener;\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst result = this.onOpening();\n\t\t\tif( result === true ) {\n\t\t\t\topener.open();\n\t\t\t} else if( result === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tresult.then((): void => {\n\t\t\t\t\topener.open();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonOpening(): boolean | Promise<unknown> {\n\t\tconst checker = this._checker;\n\t\tif( checker != null ) {\n\t\t\treturn checker();\n\t\t}\n\t\treturn true;\n\t}\n\n\topen(): void {\n\t\tthis._opener.open();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonFile\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonBase } from \"./d-button-base\";\n\ntype BUTTON = DButtonBase<any, any, any>;\n\nexport interface DButtonGroupOptions {\n\ton?: { [name: string]: Function };\n}\n\nexport class DButtonGroup extends utils.EventEmitter {\n\tprotected _buttons: BUTTON[];\n\tprotected _active: BUTTON | null;\n\tprotected _stateOn: DBaseState;\n\tprotected _stateOff: DBaseState;\n\tprotected _onActiveBound: ( button: BUTTON ) => void;\n\n\tconstructor( options?: DButtonGroupOptions ) {\n\t\tsuper();\n\n\t\tthis._buttons = [];\n\t\tthis._active = null;\n\t\tthis._stateOn = DBaseState.NONE;\n\t\tthis._stateOff = DBaseState.NONE;\n\t\tthis._onActiveBound = ( button: BUTTON ): void => {\n\t\t\tthis.onActive( button );\n\t\t};\n\n\t\t// Events\n\t\tif( options != null ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tadd( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( index < 0 ) {\n\t\t\tthis._buttons.push( button );\n\t\t\tbutton.setState( this._stateOn, true );\n\t\t\tbutton.setState( this._stateOff, false );\n\t\t\tbutton.on( \"active\", this._onActiveBound );\n\t\t\tif( button.isActive() ) {\n\t\t\t\tthis.onActive( button );\n\t\t\t}\n\t\t}\n\t}\n\n\tget active() {\n\t\treturn this._active;\n\t}\n\n\tprotected onActive( active: BUTTON ): void {\n\t\tif( active.isToggle() ) {\n\t\t\tthis._active = active;\n\t\t\tconst buttons = this._buttons;\n\t\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\t\tconst button = buttons[ i ];\n\t\t\t\tif( button !== active && button.isToggle() && button.isActive() ) {\n\t\t\t\t\tbutton.onClick();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( 0 <= index ) {\n\t\t\tbuttons.splice( index, 1 );\n\t\t\tbutton.off( \"active\", this._onActiveBound );\n\t\t}\n\t}\n\n\tcontains( button: BUTTON ): boolean {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\treturn ( 0 <= index );\n\t}\n\n\tsetHovered( isHovered: boolean ) {\n\t\treturn this.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tsetActive( isActive: boolean ) {\n\t\treturn this.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tsetReadOnly( isReadOnly: boolean ) {\n\t\treturn this.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tsetDisabled( isDisabled: boolean ) {\n\t\treturn this.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tsetDragging( isDragging: boolean ) {\n\t\treturn this.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tisHovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tisActive(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tisReadOnly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tisDisabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tisDragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tisFocused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tisUnfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ) {\n\t\tif( isOn ) {\n\t\t\tthis._stateOn |= state;\n\t\t\tthis._stateOff &= ~state;\n\t\t} else {\n\t\t\tthis._stateOff |= state;\n\t\t\tthis._stateOn &= ~state;\n\t\t}\n\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tconst button = buttons[ i ];\n\t\t\tbutton.setState( state, isOn );\n\t\t}\n\t\treturn this;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tif( buttons[ i ].hasState( state ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tclear(): void {\n\t\tthis._buttons.length = 0;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonRadioOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio = DThemeButtonRadio\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadio extends DThemeButtonBase {\n\n}\n\nexport class DButtonRadio<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio = DThemeButtonRadio,\n\tOPTIONS extends DButtonRadioOptions<VALUE, THEME> = DButtonRadioOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadio\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonRadio, DButtonRadioOptions, DThemeButtonRadio } from \"./d-button-radio\";\n\nexport interface DButtonRadioRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight = DThemeButtonRadioRight\n> extends DButtonRadioOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadioRight extends DThemeButtonRadio {\n\n}\n\nexport class DButtonRadioRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight = DThemeButtonRadioRight,\n\tOPTIONS extends DButtonRadioRightOptions<VALUE, THEME> = DButtonRadioRightOptions<VALUE, THEME>\n> extends DButtonRadio<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadioRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonRedo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst commandController = DControllers.getCommandController();\n\t\tthis.setState( DBaseState.DISABLED, ! commandController.isRedoable() );\n\t\tcommandController.on( \"change\", () => {\n\t\t\tthis.setState( DBaseState.DISABLED, ! commandController.isRedoable() );\n\t\t});\n\n\t\tthis.on( \"active\", () => {\n\t\t\tcommandController.redo();\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonSecondary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonSecondary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerTime, DPickerTimeOptions } from \"./d-picker-time\";\n\nexport interface DDialogTimeOptions<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerTimeOptions;\n}\n\nexport interface DThemeDialogTime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogTime<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime,\n\tOPTIONS extends DDialogTimeOptions<THEME> = DDialogTimeOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerTime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerTime( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget picker(): DPickerTime {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogTime } from \"./d-dialog-time\";\n\nexport class DDialogTimes {\n\tprotected static INSTANCE?: DDialogTime;\n\tstatic getInstance(): DDialogTime {\n\t\tif( DDialogTimes.INSTANCE == null ) {\n\t\t\tDDialogTimes.INSTANCE = new DDialogTime();\n\t\t}\n\t\treturn DDialogTimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DDialogTimes } from \"./d-dialog-times\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\n\nexport interface DButtonTimeOptions<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogTimeOptions;\n}\n\nexport interface DThemeButtonTime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonTime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonTime<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime,\n\tOPTIONS extends DButtonTimeOptions<THEME> = DButtonTimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogTime;\n\tprotected _dialogOptions?: DDialogTimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._datetimeMask = DPickerTimes.toMask( options && options.dialog && options.dialog.picker );\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogTime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogTimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonUndo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst commandController = DControllers.getCommandController();\n\t\tthis.setState( DBaseState.DISABLED, ! commandController.isUndoable() );\n\t\tcommandController.on( \"change\", () => {\n\t\t\tthis.setState( DBaseState.DISABLED, ! commandController.isUndoable() );\n\t\t});\n\n\t\tthis.on( \"active\", () => {\n\t\t\tcommandController.undo();\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseOverflowMask extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tconst x = 0;\n\t\tconst y = 0;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = Math.max( 0, corner.getRadius() - 0.5 );\n\t\tconst cornerMask = corner.getMask();\n\t\tconst tl = ( cornerMask & DCornerMask.TOP_LEFT ? 0 : cornerRadius );\n\t\tconst tr = ( cornerMask & DCornerMask.TOP_RIGHT ? 0 : cornerRadius );\n\t\tconst bl = ( cornerMask & DCornerMask.BOTTOM_LEFT ? 0 : cornerRadius );\n\t\tconst br = ( cornerMask & DCornerMask.BOTTOM_RIGHT ? 0 : cornerRadius );\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.lineStyle( 0, 0, 0, 0, false );\n\t\tif( tl <= 0 && tr <= 0 && bl <= 0 && br <= 0 ) {\n\t\t\tthis.moveTo( x, y );\n\t\t\tthis.lineTo( x + width, y );\n\t\t\tthis.lineTo( x + width, y + height );\n\t\t\tthis.lineTo( x, y + height );\n\t\t\tthis.lineTo( x, y );\n\t\t} else {\n\t\t\tthis.moveTo( x + tl, y );\n\t\t\tif( 0 < tr ) {\n\t\t\t\tthis.arcTo( x + width, y, x + width, y + height, tr );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y );\n\t\t\t}\n\t\t\tif( 0 < br ) {\n\t\t\t\tthis.arcTo( x + width, y + height, x, y + height, br );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y + height );\n\t\t\t}\n\t\t\tif( 0 < bl ) {\n\t\t\t\tthis.arcTo( x, y + height, x, y, bl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y + height );\n\t\t\t}\n\t\t\tif( 0 < tl ) {\n\t\t\t\tthis.arcTo( x, y, x + width, y, tl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y );\n\t\t\t}\n\t\t}\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { DThemeViewDrag, DViewDrag, DViewDragOptions } from \"./d-view-drag\";\nimport { DViewStopper } from \"./d-view-stopper\";\nimport { DViewToTarget } from \"./d-view-to-target\";\nimport { isString } from \"./util/is-string\";\nimport { UtilDrag } from \"./util/util-drag\";\n\nexport class DViewDragImpl implements DViewDrag {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\tprotected _stopper: DViewStopper;\n\tprotected _dragUtil?: UtilDrag;\n\tprotected _bind: boolean;\n\n\tconstructor(\n\t\tparent: DBase,\n\t\ttoTarget: DViewToTarget,\n\t\tstopper: DViewStopper,\n\t\ttheme: DThemeViewDrag,\n\t\toptions: DViewDragOptions | undefined\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\t\tthis._stopper = stopper;\n\n\t\tconst mode = ( options && options.mode != null ?\n\t\t\t( isString( options.mode ) ? DDragMode[ options.mode ] : options.mode ) :\n\t\t\ttheme.getDragMode()\n\t\t);\n\t\tconst modifier = ( options && options.modifier != null ?\n\t\t\t( isString( options.modifier ) ? DMouseModifier[ options.modifier ] : options.modifier ) :\n\t\t\ttheme.getDragModifier()\n\t\t);\n\t\tconst duration = ( options && options.duration != null ?\n\t\t\toptions.duration : {\n\t\t\t\tposition: theme.getDragDurationPosition(),\n\t\t\t\tscale: theme.getDragDurationScale()\n\t\t\t}\n\t\t);\n\t\tconst bind = (mode === DDragMode.TOUCH);\n\t\tthis._bind = bind;\n\t\tif( mode === DDragMode.ON || mode === DDragMode.TOUCH ) {\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: parent,\n\t\t\t\ttouch: bind,\n\t\t\t\tmodifier,\n\t\t\t\tchecker: options && options.checker,\n\t\t\t\teasing: {\n\t\t\t\t\tduration\n\t\t\t\t},\n\t\t\t\tbind,\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tthis._stopper.stop();\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number, x: number, y: number, ds: number ): void => {\n\t\t\t\t\t\tconst target = toTarget( parent );\n\t\t\t\t\t\tif( target != null ) {\n\t\t\t\t\t\t\t// Scale\n\t\t\t\t\t\t\tconst oldScale = target.scale.y;\n\t\t\t\t\t\t\tconst newScale = stopper.toNormalizedScale( oldScale * ds );\n\t\t\t\t\t\t\tconst scaleRatio = newScale / oldScale;\n\n\t\t\t\t\t\t\t// Position\n\t\t\t\t\t\t\tconst cx = x - dx;\n\t\t\t\t\t\t\tconst cy = y - dy;\n\t\t\t\t\t\t\tconst position = target.position;\n\t\t\t\t\t\t\tconst newX = (position.x - cx) * scaleRatio + x;\n\t\t\t\t\t\t\tconst newY = (position.y - cy) * scaleRatio + y;\n\n\t\t\t\t\t\t\t// Update\n\t\t\t\t\t\t\ttarget.scale.set( newScale, newScale );\n\t\t\t\t\t\t\ttarget.position.set( newX, newY );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t}\n\n\tonDown( e: interaction.InteractionEvent ): void {\n\t\tif( ! this._bind ) {\n\t\t\tconst dragUtil = this._dragUtil;\n\t\t\tif( dragUtil ) {\n\t\t\t\tdragUtil.onDown( e );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DChartAxisPosition {\n\tTOP,\n\tBOTTOM,\n\tLEFT,\n\tRIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DChartAxisTickPosition {\n\tINSIDE,\n\tOUTSIDE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DBase } from \"./d-base\";\nimport { DViewStopper } from \"./d-view-stopper\";\nimport { DViewTarget, DViewToTarget } from \"./d-view-to-target\";\nimport { DViewTransform } from \"./d-view-transform\";\n\nexport class DViewTransformImpl implements DViewTransform {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\tprotected _newX: number;\n\tprotected _newY: number;\n\tprotected _newScaleX: number;\n\tprotected _newScaleY: number;\n\tprotected _oldX: number;\n\tprotected _oldY: number;\n\tprotected _oldScaleX: number;\n\tprotected _oldScaleY: number;\n\tprotected _animation: DAnimationBase;\n\tprotected _stopper: DViewStopper;\n\tprotected _duration: number;\n\n\tconstructor( parent: DBase, toTarget: DViewToTarget, stopper: DViewStopper, duration: number ) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\t\tthis._newScaleX = 1;\n\t\tthis._newScaleY = 1;\n\t\tthis._newX =  0;\n\t\tthis._newY = 0;\n\t\tthis._oldScaleX = 1;\n\t\tthis._oldScaleY = 1;\n\t\tthis._oldX = 0;\n\t\tthis._oldY = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( time: number ): void => {\n\t\t\t\tthis.onTime( time );\n\t\t\t},\n\t\t\tduration\n\t\t});\n\t\tthis._stopper = stopper;\n\t\tthis._duration = duration;\n\t}\n\n\tprotected onTime( time: number ): void {\n\t\tconst w0 = 1 - time;\n\t\tconst w1 = time;\n\n\t\tconst scaleX = this._oldScaleX * w0 + this._newScaleX * w1;\n\t\tconst scaleY = this._oldScaleY * w0 + this._newScaleY * w1;\n\t\tconst x = this._oldX * w0 + this._newX * w1;\n\t\tconst y = this._oldY * w0 + this._newY * w1;\n\n\t\tconst canvas = this._toTarget( this._parent );\n\t\tif( canvas != null ) {\n\t\t\tcanvas.scale.set( scaleX, scaleY );\n\t\t\tcanvas.position.set( x, y );\n\t\t}\n\t}\n\n\tstart(\n\t\ttarget: DViewTarget,\n\t\tx: number, Y: number,\n\t\tscaleX: number, scaleY: number,\n\t\tduration?: number, stop?: boolean\n\t): void {\n\t\tif( stop !== false ) {\n\t\t\tthis._stopper.stop();\n\t\t}\n\t\tif( duration == null ) {\n\t\t\tduration = this._duration;\n\t\t}\n\t\tif( duration <= 0 ) {\n\t\t\ttarget.scale.set( scaleX, scaleY );\n\t\t\ttarget.position.set( x, Y );\n\t\t} else {\n\t\t\tconst position = target.position;\n\t\t\tconst scale = target.scale;\n\t\t\tthis._oldX = position.x;\n\t\t\tthis._oldY = position.y;\n\t\t\tthis._oldScaleX = scale.x;\n\t\t\tthis._oldScaleY = scale.y;\n\n\t\t\tthis._newX = x;\n\t\t\tthis._newY = Y;\n\t\t\tthis._newScaleX = scaleX;\n\t\t\tthis._newScaleY = scaleY;\n\n\t\t\tthis._animation.duration = duration;\n\t\t\tthis._animation.start();\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, IPoint, Point, Rectangle } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { DMouseModifiers } from \"./d-mouse-modifiers\";\nimport { DThemeView, DView, DViewChecker, DViewOptions } from \"./d-view\";\nimport { DViewDrag } from \"./d-view-drag\";\nimport { DViewDragImpl } from \"./d-view-drag-impl\";\nimport { DViewTargetPoint, DViewToTarget } from \"./d-view-to-target\";\nimport { DViewTransformImpl } from \"./d-view-transform-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isString } from \"./util/is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport class DViewImpl implements DView {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\n\tprotected _zoomPoint: Point;\n\tprotected _zoomMin: number;\n\tprotected _zoomMax: number;\n\tprotected _zoomKeepRatio: boolean;\n\n\tprotected _isWheelZoomEnabled: boolean;\n\tprotected _wheelZoomSpeed: number;\n\tprotected _wheelZoomModifier: DMouseModifier;\n\tprotected _wheelZoomChecker: DViewChecker;\n\n\tprotected _isDblClickZoomEnabled: boolean;\n\tprotected _dblClickZoomSpeed: number;\n\tprotected _dblClickZoomModifier: DMouseModifier;\n\tprotected _dblClickZoomChecker: DViewChecker;\n\tprotected _dblclickZoomDuration: number;\n\n\tprotected _isWheelTranslationEnabled: boolean;\n\tprotected _wheelTranslationSpeed: number;\n\tprotected _wheelTranslationModifier: DMouseModifier;\n\tprotected _wheelTranslationChecker: DViewChecker;\n\n\tprotected _transform: DViewTransformImpl;\n\tprotected _drag: DViewDragImpl;\n\n\tprotected _workRect: Rectangle;\n\n\tconstructor( parent: DBase, toTarget: DViewToTarget, options: DViewOptions | undefined ) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\n\t\tthis._workRect = new Rectangle();\n\n\t\t// Theme\n\t\tconst theme = this.toTheme( options ) || this.getThemeDefault();\n\n\t\t// Zoom\n\t\tconst zoom = options && options.zoom;\n\t\tthis._zoomPoint = new Point();\n\t\tthis._zoomMin = zoom && zoom.min != null ? zoom.min : theme.getZoomMin();\n\t\tthis._zoomMax = zoom && zoom.max != null ? zoom.max : theme.getZoomMax();\n\t\tthis._zoomKeepRatio = zoom && zoom.keepRatio != null ? zoom.keepRatio : theme.getZoomKeepRatio();\n\n\t\t// Zoom: Wheel\n\t\tconst wheelZoom = zoom && zoom.wheel;\n\t\tthis._isWheelZoomEnabled = ( wheelZoom && wheelZoom.enable != null ?\n\t\t\twheelZoom.enable : theme.isWheelZoomEnabled()\n\t\t);\n\t\tthis._wheelZoomSpeed = ( wheelZoom && wheelZoom.speed != null ?\n\t\t\twheelZoom.speed : theme.getWheelZoomSpeed()\n\t\t);\n\t\tthis._wheelZoomModifier = ( wheelZoom && wheelZoom.modifier != null ?\n\t\t\t( isString( wheelZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelZoom.modifier ] : wheelZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelZoomModifier()\n\t\t);\n\t\tthis._wheelZoomChecker = (wheelZoom && wheelZoom.checker) || DMouseModifiers.match;\n\n\t\t// Zoom: Dbl click\n\t\tconst dblClickZoom = zoom && zoom.dblclick;\n\t\tthis._isDblClickZoomEnabled = ( dblClickZoom && dblClickZoom.enable != null ?\n\t\t\tdblClickZoom.enable : theme.isDblClickZoomEnabled()\n\t\t);\n\t\tthis._dblClickZoomSpeed = ( dblClickZoom && dblClickZoom.amount != null ?\n\t\t\tdblClickZoom.amount : theme.getDblClickZoomSpeed()\n\t\t);\n\t\tthis._dblClickZoomModifier = ( dblClickZoom && dblClickZoom.modifier != null ?\n\t\t\t( isString( dblClickZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ dblClickZoom.modifier ] : dblClickZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getDblClickZoomModifier()\n\t\t);\n\t\tthis._dblClickZoomChecker = ( dblClickZoom && dblClickZoom.checker ) || DMouseModifiers.match;\n\t\tthis._dblclickZoomDuration = ( dblClickZoom && dblClickZoom.duration != null ?\n\t\t\tdblClickZoom.duration : theme.getDblClickZoomDuration()\n\t\t);\n\n\t\t// Translation: Wheel\n\t\tconst wheelTranslation = options && options.translation && options.translation.wheel;\n\t\tthis._isWheelTranslationEnabled = ( wheelTranslation && wheelTranslation.enable != null ?\n\t\t\twheelTranslation.enable : theme.isWheelTranslationEnabled()\n\t\t);\n\t\tthis._wheelTranslationSpeed = ( wheelTranslation && wheelTranslation.speed != null ?\n\t\t\twheelTranslation.speed : theme.getWheelTranslationSpeed()\n\t\t);\n\t\tthis._wheelTranslationModifier = ( wheelTranslation && wheelTranslation.modifier != null ?\n\t\t\t( isString( wheelTranslation.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelTranslation.modifier ] : wheelTranslation.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelTranslationModifier()\n\t\t);\n\t\tthis._wheelTranslationChecker = ( wheelTranslation && wheelTranslation.checker ) || DMouseModifiers.match;\n\n\t\t// Drag\n\t\tthis._drag = new DViewDragImpl( parent, toTarget, this, theme, options && options.drag );\n\n\t\t// Transform\n\t\tthis._transform = new DViewTransformImpl( parent, toTarget, this, this._dblclickZoomDuration );\n\t}\n\n\tget drag(): DViewDrag {\n\t\treturn this._drag;\n\t}\n\n\tstop(): void {\n\t\tthis._drag.stop();\n\t\tthis._transform.stop();\n\t}\n\n\treset( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst target = this._toTarget( parent );\n\t\tif( target ) {\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\n\t\t\tconst newTargetX = (parent.width - targetRect.width) * 0.5 - targetRect.x;\n\t\t\tconst newTargetY = (parent.height - targetRect.height) * 0.5 - targetRect.y;\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, 1, 1, duration, stop );\n\t\t}\n\t}\n\n\tfit( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst target = this._toTarget( parent ) as any;\n\t\tif( target ) {\n\t\t\tconst padding = parent.padding;\n\t\t\tconst width = parent.width;\n\t\t\tconst height = parent.height;\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\n\t\t\tconst targetX = targetRect.x;\n\t\t\tconst targetY = targetRect.y;\n\t\t\tconst targetWidth = targetRect.width;\n\t\t\tconst targetHeight = targetRect.height;\n\t\t\tlet newTargetScaleX = (width - padding.getLeft() - padding.getRight()) / targetWidth;\n\t\t\tlet newTargetScaleY = (height - padding.getTop() - padding.getBottom()) / targetHeight;\n\t\t\tif( this._zoomKeepRatio ) {\n\t\t\t\tconst newTargetScale = this.toNormalizedScale( Math.min( newTargetScaleX, newTargetScaleY ) );\n\t\t\t\tnewTargetScaleX = newTargetScale;\n\t\t\t\tnewTargetScaleY = newTargetScale;\n\t\t\t} else {\n\t\t\t\tnewTargetScaleX = this.toNormalizedScale( newTargetScaleX );\n\t\t\t\tnewTargetScaleY = this.toNormalizedScale( newTargetScaleY );\n\t\t\t}\n\t\t\tconst newTargetWidth = targetWidth * newTargetScaleX;\n\t\t\tconst newTargetHeight = targetHeight * newTargetScaleY;\n\t\t\tconst newTargetX = (width - newTargetWidth) * 0.5 - targetX * newTargetScaleX;\n\t\t\tconst newTargetY = (height - newTargetHeight) * 0.5 - targetY * newTargetScaleY;\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, newTargetScaleX, newTargetScaleY, duration, stop );\n\t\t}\n\t}\n\n\tzoomIn( duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst factor = this._dblClickZoomSpeed;\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\n\t\t}\n\t}\n\n\tzoomOut( duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst factor = 1 / this._dblClickZoomSpeed;\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\n\t\t}\n\t}\n\n\tzoomAt( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\t// Canvas Scale\n\t\t\tconst oldCanvasScaleX = target.scale.x;\n\t\t\tconst oldCanvasScaleY = target.scale.y;\n\t\t\tconst newCanvasScaleX = this.toNormalizedScale( scaleX );\n\t\t\tconst newCanvasScaleY = this.toNormalizedScale( scaleY );\n\t\t\tconst canvasScaleRatioX = newCanvasScaleX / oldCanvasScaleX;\n\t\t\tconst canvasScaleRatioY = newCanvasScaleY / oldCanvasScaleY;\n\n\t\t\t// Canvas Position\n\t\t\tconst newCanvasX = (target.position.x - x) * canvasScaleRatioX + x;\n\t\t\tconst newCanvasY = (target.position.y - y) * canvasScaleRatioY + y;\n\n\t\t\t// Canvas\n\t\t\tthis._transform.start( target, newCanvasX, newCanvasY, newCanvasScaleX, newCanvasScaleY, duration, stop );\n\t\t}\n\t}\n\n\tzoomAtGlobal( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst local = this._zoomPoint;\n\t\tlocal.set( x, y );\n\t\tthis.toLocal( local, local );\n\t\tthis.zoomAt( local.x, local.y, scaleX, scaleY, duration, stop );\n\t}\n\n\tzoom( scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tthis.zoomAt( parent.width * 0.5, parent.height * 0.5, scaleX, scaleY, duration, stop );\n\t}\n\n\tget scale(): DViewTargetPoint {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\treturn target.scale;\n\t\t}\n\t\treturn new Point( 1, 1 );\n\t}\n\n\tset scale( scale: DViewTargetPoint ) {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst newScaleX = this.toNormalizedScale( scale.x );\n\t\t\tconst newScaleY = this.toNormalizedScale( scale.y );\n\t\t\ttarget.scale.set( newScaleX, newScaleY );\n\t\t}\n\t}\n\n\tmoveTo( x: number, y: number, duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis._transform.start( target, x, y, targetScale.x, targetScale.y, duration, stop );\n\t\t}\n\t}\n\n\tget position(): DViewTargetPoint {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\treturn target.position;\n\t\t}\n\t\treturn new Point( 0, 0 );\n\t}\n\n\tset position( position: DViewTargetPoint ) {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\ttarget.position.set( position.x, position.y );\n\t\t}\n\t}\n\n\ttransform(\n\t\tx: number, y: number,\n\t\tscaleX: number, scaleY: number,\n\t\tduration?: number, stop?: boolean\n\t): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tthis._transform.start( target, x, y, scaleX, scaleY, duration, stop );\n\t\t}\n\t}\n\n\ttoLocal( global: IPoint, local: IPoint, skipUpdate?: boolean ): IPoint {\n\t\treturn this._parent.toLocal( global, undefined, local, skipUpdate );\n\t}\n\n\ttoGlobal( local: IPoint, global: IPoint, skipUpdate?: boolean ): IPoint {\n\t\treturn this._parent.toGlobal( local, global, skipUpdate );\n\t}\n\n\ttoNormalizedScale( scale: number ): number {\n\t\treturn Math.min( this._zoomMax, Math.max( this._zoomMin, scale ) );\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tif( this._isWheelZoomEnabled &&\n\t\t\tthis._wheelZoomChecker( e, this._wheelZoomModifier, this._parent ) ) {\n\t\t\tif( deltas.deltaY !== 0 ) {\n\t\t\t\tconst target = this._toTarget( this._parent );\n\t\t\t\tif( target ) {\n\t\t\t\t\tconst speed = deltas.lowest * this._wheelZoomSpeed;\n\t\t\t\t\tconst factor = 1 + deltas.deltaY * speed;\n\t\t\t\t\tconst targetScale = target.scale;\n\t\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, 0 );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( this._isWheelTranslationEnabled &&\n\t\t\tthis._wheelTranslationChecker( e, this._wheelTranslationModifier, this._parent ) ) {\n\t\t\tconst target = this._toTarget( this._parent );\n\t\t\tif( target ) {\n\t\t\t\tthis.stop();\n\t\t\t\tconst speed = deltas.lowest * this._wheelTranslationSpeed;\n\t\t\t\ttarget.position.set(\n\t\t\t\t\ttarget.position.x - deltas.deltaX * speed,\n\t\t\t\t\ttarget.position.y + deltas.deltaY * speed\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonDown( e: interaction.InteractionEvent ): void {\n\t\tthis._drag.onDown( e );\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tif( this._isDblClickZoomEnabled &&\n\t\t\tthis._dblClickZoomChecker( e, this._dblClickZoomModifier, this._parent ) ) {\n\t\t\tconst target = this._toTarget( this._parent );\n\t\t\tif( target ) {\n\t\t\t\tconst global = this._zoomPoint;\n\t\t\t\tUtilPointerEvent.toGlobal( e, interactionManager, global );\n\t\t\t\tconst factor = this._dblClickZoomSpeed;\n\t\t\t\tconst targetScale = target.scale;\n\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, this._dblclickZoomDuration );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprotected toTheme( options?: DViewOptions ): DThemeView | null {\n\t\tif( options && options.theme ) {\n\t\t\tconst theme = options.theme;\n\t\t\tif( isString( theme ) ) {\n\t\t\t\treturn DThemes.getInstance().get( theme );\n\t\t\t} else {\n\t\t\t\treturn theme;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getThemeDefault(): DThemeView {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DView\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DView, DViewOptions } from \"./d-view\";\nimport { DViewImpl } from \"./d-view-impl\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DCanvasContainerOptions<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tview?: DViewOptions;\n\tcanvas?: CANVAS;\n}\n\nexport interface DThemeCanvasContainer extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n}\n\nconst isOverflowMaskEnabled = <\n\tCANVAS extends DBase,\n\tTHEME extends DThemeCanvasContainer\n>( theme: THEME, options?: DCanvasContainerOptions<CANVAS, THEME> ): boolean => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nexport class DCanvasContainer<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tOPTIONS extends DCanvasContainerOptions<CANVAS, THEME> = DCanvasContainerOptions<CANVAS, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _canvas!: CANVAS | null;\n\tprotected _overflowMask!: DBaseOverflowMask | null;\n\tprotected _view!: DViewImpl;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._canvas = null;\n\t\tconst theme = this.theme;\n\t\tthis._view = new DViewImpl( this, () => this._canvas, options && options.view );\n\n\t\t// Canvas\n\t\tthis.canvas = ( options && options.canvas ? options.canvas : null );\n\n\t\t// Overflow mask\n\t\tthis._overflowMask = null;\n\t\tif( isOverflowMaskEnabled( theme, options ) ) {\n\t\t\tthis.mask = this.getOrCreateOverflowMask();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DCanvasContainer\";\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateContentSize( newWidth, newHeight, oldWidth, oldHeight );\n\t}\n\n\tget canvas(): CANVAS | null {\n\t\treturn this._canvas;\n\t}\n\n\tset canvas( canvas: CANVAS | null ) {\n\t\tconst previous = this._canvas;\n\t\tif( previous != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tthis.removeChild( previous );\n\t\t\tthis.emit( \"unset\", previous, this );\n\t\t\tprevious.destroy();\n\t\t}\n\n\t\tthis._canvas = canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.addChild( canvas );\n\t\t\tthis._view.reset( 0 );\n\t\t\tthis.emit( \"set\", canvas, this );\n\t\t} else {\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected getOrCreateOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tprotected updateContentSize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst canvasX = canvas.x + (newWidth - oldWidth) * 0.5;\n\t\t\tconst canvasY = canvas.y + (newHeight - oldHeight) * 0.5;\n\t\t\tcanvas.position.set( canvasX, canvasY );\n\t\t}\n\t}\n\n\tget view(): DView {\n\t\treturn this._view;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst vresult = this._view.onWheel( e, deltas, global );\n\t\tconst sresult = super.onWheel( e, deltas, global );\n\t\treturn vresult || sresult;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst vresult = this._view.onDblClick( e, interactionManager );\n\t\tconst sresult = super.onDblClick( e, interactionManager );\n\t\treturn vresult || sresult;\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tthis._view.onDown( e );\n\t\tsuper.onDown( e );\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\tthis.mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase,  DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DCanvasOptions<THEME extends DThemeCanvas = DThemeCanvas> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeCanvas extends DThemeBase {\n\n}\n\nexport class DCanvas<\n\tTHEME extends DThemeCanvas = DThemeCanvas,\n\tOPTIONS extends DCanvasOptions<THEME> = DCanvasOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DCanvas\";\n\t}\n}\n","import { isNumber } from \"../util/is-number\";\nimport { isString } from \"../util/is-string\";\nimport { EShapePointsStyle } from \"./e-shape-points-style\";\n\nexport type EShapePointsStyleOption = EShapePointsStyle | keyof typeof EShapePointsStyle |\n\tArray<keyof typeof EShapePointsStyle>;\n\nexport class EShapePointsStyles {\n\tstatic from( style: EShapePointsStyleOption ): EShapePointsStyle {\n\t\tif( isString( style ) ) {\n\t\t\treturn EShapePointsStyle[ style ];\n\t\t} else if( isNumber( style ) ) {\n\t\t\treturn style;\n\t\t} else {\n\t\t\tlet result = EShapePointsStyle.NONE;\n\t\t\tfor( let i = 0, imax = style.length; i < imax; ++i ) {\n\t\t\t\tresult |= EShapePointsStyle[ style[ i ] ];\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\n\nexport enum DChartCoordinateDirection {\n\tX,\n\tY\n}\n\nexport interface DChartCoordinate {\n\t/**\n\t * Monotonic increasing ID for change detection.\n\t */\n\treadonly id: number;\n\treadonly transform: DChartCoordinateTransform;\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void;\n\tunbind(): void;\n\n\t/**\n\t * Adjusts the transform so that mapped points fit into the plot area\n\t * if the plot area container's localTransform is an identity matrix.\n\t */\n\tfit(): void;\n\n\t/**\n\t * Transforms the given raw value to the untransformed value.\n\t *\n\t * @param value a raw value\n\t */\n\tmap( value: number ): number;\n\n\t/**\n\t * Transforms the given raw values to untransformed values.\n\t * Numbers whose indices are ifrom + i * stride + offset and less than iend will be transformed.\n\t * Here, i is a non-negative integer.\n\t *\n\t * @param values raw values to be transformed\n\t * @param ifrom an index on raw values at which to begin a transformation\n\t * @param iend an index on raw values before which to end a transformation\n\t * @param stride a stride of indices\n\t * @param offset an offset of indices\n\t */\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void;\n\n\t/**\n\t * Transforms the given untransformed value to the raw value.\n\t *\n\t * @param value an untransformed value\n\t */\n\tunmap( value: number ): number;\n\n\t/**\n\t * Transforms the given untransformed values to raw values.\n\t * Numbers whose indices are ifrom + i * stride + offset and less than iend will be transformed.\n\t * Here, i is a non-negative integer.\n\t *\n\t * @param values untrasformed values to be transformed\n\t * @param ifrom an index on raw values at which to begin a transformation\n\t * @param iend an index on raw values at which to begin a transformation\n\t * @param stride a stride of indices\n\t * @param offset an offset of indices\n\t */\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void;\n\n\t/**\n\t * Returns major / minor tick positions.\n\t *\n\t * @param domainMin minimum domain\n\t * @param domainMax maximum domain\n\t * @param majorCount Expected major tick count\n\t * @param minorCountPerMajor Expected minor tick count per major ticks\n\t * @param minorCount Expected total minor tick count\n\t * @param majorResult `majorResult.length` must be larger than `majorCount * 3`.\n\t * @param minorResult `minorResult.length` must be larger than `minorCount * 3`.\n\t */\n\tticks(\n\t\tdomainMin: number,\n\t\tdomainMax: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDChartAxisBaseOptions, DChartAxisBaseTickContainerOptions,\n\tDChartAxisBaseTickMajorGridlineOptions, DChartAxisBaseTickMajorOptions,\n\tDChartAxisBaseTickMajorTextOptions, DThemeChartAxisBase\n} from \"./d-chart-axis-base-options\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartAxisTickPosition } from \"./d-chart-axis-tick-position\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyleOption, EShapePointsStyles } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeLike } from \"./shape/e-shape-stroke\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeTextAlignLike } from \"./shape/e-shape-text-align\";\nimport { EShapeTextDirection } from \"./shape/e-shape-text-direction\";\nimport { EShapeTextOffsetLike } from \"./shape/e-shape-text-offset\";\nimport { EShapeTextOutlineLike } from \"./shape/e-shape-text-outline\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { isString } from \"./util/is-string\";\nimport { NumberFormatter } from \"./util/number-formatter\";\nimport { NumberFormatters } from \"./util/number-formatters\";\n\nexport interface DChartAxisBaseGridline {\n\tenable: boolean;\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseTickMajor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\ttext?: DChartAxisBaseTickMajorTextOptions;\n\tformatter: NumberFormatter;\n\tshapes?: EShapeBar[];\n\n\tgridline: DChartAxisBaseGridline;\n}\n\nexport interface DChartAxisBaseTickMinor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseBar {\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshape?: EShapeBar;\n}\n\nexport interface DChartAxisBaseTickContainer {\n\tenable: boolean;\n\tmajor: DChartAxisBaseTickMajor;\n\tminor: DChartAxisBaseTickMinor;\n}\n\nexport class DChartAxisBaseOptionParser {\n\tprotected _coordinateIndex: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _label: DeepPartial<EShapeTextLike> | undefined;\n\tprotected _padding: number;\n\tprotected _bar: DChartAxisBaseBar;\n\n\tconstructor( theme: DThemeChartAxisBase, options?: DChartAxisBaseOptions ) {\n\t\tthis._coordinateIndex = ( options && options.coordinate != null ? options.coordinate : 0 );\n\t\tthis._position = this.toPosition( theme, options );\n\t\tthis._tick = this.toTickContainer( theme, options );\n\t\tthis._label = this.toLabel( theme, options );\n\t\tthis._padding = ( options && options.padding != null ? options.padding : theme.getPadding() );\n\t\tthis._bar = this.toBar( theme, options );\n\t}\n\n\tget coordinateIndex(): number {\n\t\treturn this._coordinateIndex;\n\t}\n\n\tget padding(): number {\n\t\treturn this._padding;\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tget bar(): DChartAxisBaseBar {\n\t\treturn this._bar;\n\t}\n\n\tget tick(): DChartAxisBaseTickContainer {\n\t\treturn this._tick;\n\t}\n\n\tget label(): DeepPartial<EShapeTextLike> | undefined {\n\t\treturn this._label;\n\t}\n\n\tprotected toPosition(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisPosition {\n\t\tconst position = options && options.position;\n\t\tif( isString( position ) ) {\n\t\t\treturn DChartAxisPosition[ position ];\n\t\t} else if( position != null ) {\n\t\t\treturn position;\n\t\t}\n\t\treturn theme.getPosition();\n\t}\n\n\tprotected toBar(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisBaseBar {\n\t\treturn {\n\t\t\tstyle: options && options.style != null ? options.style : theme.getStyle(),\n\t\t\tstroke: this.toBarStroke( theme, options && options.stroke ),\n\t\t\tshape: undefined\n\t\t};\n\t}\n\n\tprotected toTickContainer(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisBaseTickContainer {\n\t\tconst tick = options && options.tick;\n\t\treturn {\n\t\t\tenable: ( tick && tick.enable != null ? tick.enable : theme.getTickEnable() ),\n\t\t\tmajor: this.toTickMajor( theme, tick ),\n\t\t\tminor: this.toMinorTick( theme, tick )\n\t\t};\n\t}\n\n\tprotected toTickMajor(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMajor {\n\t\tconst major: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( major && major.position != null ? major.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMajorTickPosition() )\n\t\t);\n\t\tconst optionsStyle = options && options.style;\n\t\tconst style = EShapePointsStyles.from( major && major.style != null ? major.style :\n\t\t\t( optionsStyle != null ? optionsStyle : theme.getMajorTickStyle() )\n\t\t);\n\t\tconst optionsStroke = options && options.stroke;\n\t\tconst stroke = this.toTickMajorStroke( theme, major && major.stroke, optionsStroke );\n\t\treturn {\n\t\t\tcount: ( major && major.count != null ? major.count : theme.getMajorTickCount() ),\n\t\t\tsize: ( major && major.size != null ? major.size : theme.getMajorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle,\n\t\t\tstroke,\n\t\t\ttext: this.toMajorTickText( theme, major && major.text ),\n\t\t\tformatter: this.toMajorTickFormatter( theme, major ),\n\t\t\tshapes: undefined,\n\t\t\tgridline: this.toTickMajorGridline( theme, major && major.gridline, optionsStyle, optionsStroke )\n\t\t};\n\t}\n\n\tprotected toTickMajorGridline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions: DChartAxisBaseTickMajorGridlineOptions | undefined,\n\t\toptionsStyle: EShapePointsStyleOption | undefined,\n\t\toptionsStroke: Partial<EShapeStrokeLike> | undefined\n\t): DChartAxisBaseGridline {\n\t\tconst style = EShapePointsStyles.from( options && options.style != null ? options.style :\n\t\t\t( optionsStyle != null ? optionsStyle : theme.getMajorTickGridlineStyle() )\n\t\t);\n\t\treturn {\n\t\t\tenable: options && options.enable != null ? options.enable : theme.getMajorTickGridlineEnable(),\n\t\t\tstyle,\n\t\t\tstroke: this.toTickMajorGridlineStroke( theme, options && options.stroke, optionsStroke ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toTickPosition(\n\t\ttickPosition: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition\n\t): EShapeBarPosition {\n\t\tconst position = this._position;\n\t\tif( tickPosition === DChartAxisTickPosition.OUTSIDE || tickPosition === \"OUTSIDE\" ) {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toMinorTick(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMinor {\n\t\tconst minor: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( minor && minor.position != null ? minor.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMinorTickPosition() )\n\t\t);\n\t\tconst style = EShapePointsStyles.from( minor && minor.style != null ? minor.style :\n\t\t\t( options && options.style != null ? options.style : theme.getMinorTickStyle() )\n\t\t);\n\t\treturn {\n\t\t\tcount: ( minor && minor.count != null ? minor.count : theme.getMinorTickCount() ),\n\t\t\tsize: ( minor && minor.size != null ? minor.size : theme.getMinorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle,\n\t\t\tstroke: this.toTickMinorStroke( theme, minor && minor.stroke, options && options.stroke ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toBarStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeStrokeLike>\n\t): EShapeStrokeLike {\n\t\treturn this.toStroke(\n\t\t\toptions, undefined,\n\t\t\ttheme.getStrokeEnable(),\n\t\t\ttheme.getStrokeColor(),\n\t\t\ttheme.getStrokeAlpha(),\n\t\t\ttheme.getStrokeWidth(),\n\t\t\ttheme.getStrokeAlign(),\n\t\t\ttheme.getStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMajorStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): EShapeStrokeLike {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMajorTickStrokeEnable(),\n\t\t\ttheme.getMajorTickStrokeColor(),\n\t\t\ttheme.getMajorTickStrokeAlpha(),\n\t\t\ttheme.getMajorTickStrokeWidth(),\n\t\t\ttheme.getMajorTickStrokeAlign(),\n\t\t\ttheme.getMajorTickStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMajorGridlineStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): EShapeStrokeLike {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMajorTickGridlineStrokeEnable(),\n\t\t\ttheme.getMajorTickGridlineStrokeColor(),\n\t\t\ttheme.getMajorTickGridlineStrokeAlpha(),\n\t\t\ttheme.getMajorTickGridlineStrokeWidth(),\n\t\t\ttheme.getMajorTickGridlineStrokeAlign(),\n\t\t\ttheme.getMajorTickGridlineStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMinorStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): EShapeStrokeLike {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMinorTickStrokeEnable(),\n\t\t\ttheme.getMinorTickStrokeColor(),\n\t\t\ttheme.getMinorTickStrokeAlpha(),\n\t\t\ttheme.getMinorTickStrokeWidth(),\n\t\t\ttheme.getMinorTickStrokeAlign(),\n\t\t\ttheme.getMinorTickStrokeSide()\n\t\t);\n\t}\n\n\tprotected toStroke(\n\t\toptionsA: Partial<EShapeStrokeLike> | undefined,\n\t\toptionsB: Partial<EShapeStrokeLike> | undefined,\n\t\tenable: boolean,\n\t\tcolor: number,\n\t\talpha: number,\n\t\twidth: number,\n\t\talign: number,\n\t\tside: EShapeStrokeSide\n\t): EShapeStrokeLike {\n\t\tif( optionsA ) {\n\t\t\tif( optionsB ) {\n\t\t\t\treturn {\n\t\t\t\t\tenable: ( optionsA.enable != null ? optionsA.enable :\n\t\t\t\t\t\t( optionsB.enable != null ? optionsB.enable : enable )\n\t\t\t\t\t),\n\t\t\t\t\tcolor: ( optionsA.color != null ? optionsA.color :\n\t\t\t\t\t\t( optionsB.color != null ? optionsB.color : color )\n\t\t\t\t\t),\n\t\t\t\t\talpha: ( optionsA.alpha != null ? optionsA.alpha :\n\t\t\t\t\t\t( optionsB.alpha != null ? optionsB.alpha : alpha )\n\t\t\t\t\t),\n\t\t\t\t\twidth: ( optionsA.width != null ? optionsA.width :\n\t\t\t\t\t\t( optionsB.width != null ? optionsB.width : width )\n\t\t\t\t\t),\n\t\t\t\t\talign: ( optionsA.align != null ? optionsA.align :\n\t\t\t\t\t\t( optionsB.align != null ? optionsB.align : align )\n\t\t\t\t\t),\n\t\t\t\t\tside: ( optionsA.side != null ? optionsA.side :\n\t\t\t\t\t\t( optionsB.side != null ? optionsB.side : side )\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tenable: ( optionsA.enable != null ? optionsA.enable : enable ),\n\t\t\t\t\tcolor: ( optionsA.color != null ? optionsA.color : color ),\n\t\t\t\t\talpha: ( optionsA.alpha != null ? optionsA.alpha : alpha ),\n\t\t\t\t\twidth: ( optionsA.width != null ? optionsA.width : width ),\n\t\t\t\t\talign: ( optionsA.align != null ? optionsA.align : align ),\n\t\t\t\t\tside: ( optionsA.side != null ? optionsA.side : side )\n\t\t\t\t};\n\t\t\t}\n\t\t} else if( optionsB ) {\n\t\t\treturn {\n\t\t\t\tenable: ( optionsB.enable != null ? optionsB.enable : enable ),\n\t\t\t\tcolor: ( optionsB.color != null ? optionsB.color : color ),\n\t\t\t\talpha: ( optionsB.alpha != null ? optionsB.alpha : alpha ),\n\t\t\t\twidth: ( optionsB.width != null ? optionsB.width : width ),\n\t\t\t\talign: ( optionsB.align != null ? optionsB.align : align ),\n\t\t\t\tside: ( optionsB.side != null ? optionsB.side : side )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tenable,\n\t\t\t\tcolor,\n\t\t\t\talpha,\n\t\t\t\twidth,\n\t\t\t\talign,\n\t\t\t\tside\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickFormatter(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickMajorOptions\n\t): NumberFormatter {\n\t\tconst text = options && options.text;\n\t\tif( text ) {\n\t\t\tconst format = text.format;\n\t\t\tif( format != null ) {\n\t\t\t\treturn NumberFormatters.create( format );\n\t\t\t} else {\n\t\t\t\tconst formatter = text.formatter;\n\t\t\t\tif( formatter ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tformat: formatter\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn NumberFormatters.create(\n\t\t\ttheme.getMajorTickTextFormat()\n\t\t);\n\t}\n\n\tprotected toMajorTickText(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickMajorTextOptions\n\t): DChartAxisBaseTickMajorTextOptions | undefined {\n\t\toptions = options || {};\n\t\treturn {\n\t\t\tformat: options.format,\n\t\t\tcolor: options.color,\n\t\t\talpha: options.alpha,\n\t\t\tfamily: options.family,\n\t\t\tsize: options.size,\n\t\t\tweight: options.weight,\n\t\t\talign: this.toMajorTickTextAlign( theme, options.align ),\n\t\t\toffset: this.toMajorTickTextOffset( theme, options.offset ),\n\t\t\tstyle: options.style,\n\t\t\toutline: this.toMajorTickTextOutline( theme, options.outline ),\n\t\t\tspacing: this.toMajorTickTextSpacing( theme, options.spacing ),\n\t\t\tdirection: this.toTickMajorTextDirection( theme, options.direction ),\n\t\t\tpadding: this.toMajorTickTextPadding( theme, options.padding ),\n\t\t\tclipping: options.clipping\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ? options.horizontal :\n\t\t\t\t\ttheme.getMajorTickTextAlignHorizontal( position )\n\t\t\t\t),\n\t\t\t\tvertical: ( options.vertical != null ? options.vertical :\n\t\t\t\t\ttheme.getMajorTickTextAlignVertical( position )\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getMajorTickTextAlignHorizontal( position ),\n\t\t\tvertical: theme.getMajorTickTextAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getMajorTickTextPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getMajorTickTextPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toTickMajorTextDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getMajorTickTextDirection() );\n\t}\n\n\tprotected toLabel(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DeepPartial<EShapeTextLike> | undefined {\n\t\tconst label = options && options.label;\n\t\tif( label ) {\n\t\t\treturn {\n\t\t\t\tvalue: label.value,\n\t\t\t\tcolor: label.color,\n\t\t\t\talpha: label.alpha,\n\t\t\t\tfamily: label.family,\n\t\t\t\tsize: label.size,\n\t\t\t\tweight: label.weight,\n\t\t\t\talign: this.toLabelAlign( theme, label.align ),\n\t\t\t\toffset: this.toLabelOffset( theme, label.offset ),\n\t\t\t\tstyle: label.style,\n\t\t\t\toutline: this.toLabelOutline( theme, label.outline ),\n\t\t\t\tspacing: this.toLabelSpacing( theme, label.spacing ),\n\t\t\t\tdirection: this.toLabelDirection( theme, label.direction ),\n\t\t\t\tpadding: this.toLabelPadding( theme, label.padding ),\n\t\t\t\tclipping: label.clipping\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ?\n\t\t\t\t\toptions.horizontal : theme.getLabelAlignHorizontal( position )\n\t\t\t\t),\n\t\t\t\tvertical: ( options.vertical != null ?\n\t\t\t\t\toptions.vertical : theme.getLabelAlignVertical( position )\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getLabelAlignHorizontal( position ),\n\t\t\tvertical: theme.getLabelAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toLabelOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getLabelPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getLabelPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toLabelDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getLabelDirection() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { DChartAxis } from \"./d-chart-axis\";\nimport { DChartAxisBaseOptions, DThemeChartAxisBase } from \"./d-chart-axis-base-options\";\nimport {\n\tDChartAxisBaseBar, DChartAxisBaseOptionParser, DChartAxisBaseTickContainer\n} from \"./d-chart-axis-base-options-parser\";\nimport { DChartAxisContainer } from \"./d-chart-axis-container\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartAxisBase implements DChartAxis {\n\tprotected _coordinateIndex: number;\n\tprotected _padding: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _container?: DChartAxisContainer;\n\tprotected _bar: DChartAxisBaseBar;\n\tprotected _index: number;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _majorTicks: Float64Array;\n\tprotected _minorTicks: Float64Array;\n\tprotected _label?: DeepPartial<EShapeTextLike>;\n\tprotected _theme: DThemeChartAxisBase;\n\n\tconstructor( options?: DChartAxisBaseOptions ) {\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._index = 0;\n\n\t\tconst parser = new DChartAxisBaseOptionParser( theme, options );\n\t\tthis._coordinateIndex = parser.coordinateIndex;\n\t\tthis._padding = parser.padding;\n\t\tthis._position = parser.position;\n\t\tconst tick = parser.tick;\n\t\tthis._tick = tick;\n\t\tthis._label = parser.label;\n\t\tthis._bar = parser.bar;\n\t\tthis._majorTicks = new Float64Array( tick.major.count * 3 );\n\t\tthis._minorTicks = new Float64Array( (tick.major.count + 1) * tick.minor.count * 3 );\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tprotected updateBar( container: DChartAxisContainer ): void {\n\t\tconst bar = this._bar;\n\t\tconst barShape = bar.shape;\n\t\tif( barShape ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tbarShape.disallowUploadedUpdate();\n\t\t\tswitch( this._position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth * 0.5, 0 - padding );\n\t\t\t\tbarShape.size.set( plotAreaWidth, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth * 0.5, plotAreaHeight + padding );\n\t\t\t\tbarShape.size.set( plotAreaWidth, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tbarShape.transform.position.set( 0 - padding, plotAreaHeight * 0.5 );\n\t\t\t\tbarShape.size.set( 0, plotAreaHeight );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth + padding, plotAreaHeight * 0.5 );\n\t\t\t\tbarShape.size.set( 0, plotAreaHeight );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbarShape.allowUploadedUpdate();\n\t\t}\n\t}\n\n\tupdateTicksX(\n\t\tdomainMin: number, domainMax: number,\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[], gridlineShapes: EShapeBar[] | undefined,\n\t\tshapePositionY: number,\n\t\ttransform: Matrix, plotAreaHeight: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks(\n\t\t\tdomainMin, domainMax,\n\t\t\tmajorCount, minorCountPerMajor, minorCount,\n\t\t\tmajorTicks, minorTicks\n\t\t);\n\n\t\tconst a = transform.a;\n\t\tconst tx = transform.tx;\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tif( ! isNaN( majorTickPosition ) ) {\n\t\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\t\tconst majotTickPositionX = a * majorTickProjectedPosition + tx;\n\t\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( majotTickPositionX, shapePositionY );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tconst gridlineShape = gridlineShapes[ i ];\n\t\t\t\t\tgridlineShape.disallowUploadedUpdate();\n\t\t\t\t\tgridlineShape.visible = true;\n\t\t\t\t\tgridlineShape.transform.position.set( majotTickPositionX, plotAreaHeight * 0.5 );\n\t\t\t\t\tgridlineShape.size.set( 0, plotAreaHeight );\n\t\t\t\t\tgridlineShape.allowUploadedUpdate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tgridlineShapes[ i ].visible = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! isNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set(\n\t\t\t\t\ta * minorTickProjectedPosition + tx,\n\t\t\t\t\tshapePositionY\n\t\t\t\t);\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTicksY(\n\t\tdomainMin: number, domainMax: number,\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[], gridlineShapes: EShapeBar[] | undefined,\n\t\tshapePositionX: number,\n\t\ttransform: Matrix, plotAreaWidth: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks(\n\t\t\tdomainMin, domainMax,\n\t\t\tmajorCount, minorCountPerMajor, minorCount,\n\t\t\tmajorTicks, minorTicks\n\t\t);\n\n\t\tconst d = transform.d;\n\t\tconst ty = transform.ty;\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tif( ! isNaN( majorTickPosition ) ) {\n\t\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\t\tconst majotTickPositionY = d * majorTickProjectedPosition + ty;\n\t\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( shapePositionX, majotTickPositionY );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tconst gridlineShape = gridlineShapes[ i ];\n\t\t\t\t\tgridlineShape.disallowUploadedUpdate();\n\t\t\t\t\tgridlineShape.visible = true;\n\t\t\t\t\tgridlineShape.transform.position.set( plotAreaWidth * 0.5, majotTickPositionY );\n\t\t\t\t\tgridlineShape.size.set( plotAreaWidth, 0 );\n\t\t\t\t\tgridlineShape.allowUploadedUpdate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tgridlineShapes[ i ].visible = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! isNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set(\n\t\t\t\t\tshapePositionX,\n\t\t\t\t\td * minorTickProjectedPosition + ty\n\t\t\t\t);\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateTicks( container: DChartAxisContainer ): void {\n\t\tconst tick = this._tick;\n\t\tconst majorShapes = tick.major.shapes;\n\t\tconst minorShapes = tick.minor.shapes;\n\t\tif( majorShapes && minorShapes ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst bounds = plotArea.getBoundsInContainer();\n\t\t\tconst transform = plotArea.container.transform.localTransform;\n\t\t\tconst gridlineShapes = tick.major.gridline.shapes;\n\n\t\t\tconst coordinateIndex = this._coordinateIndex;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tlet coordinate: DChartCoordinate | null;\n\t\t\tswitch( this._position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x + bounds.width )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\t0 - padding,\n\t\t\t\t\t\ttransform, plotAreaHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x + bounds.width )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\tplotAreaHeight + padding,\n\t\t\t\t\t\ttransform, plotAreaHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y + bounds.height )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\t0 - padding,\n\t\t\t\t\t\ttransform, plotAreaWidth\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y + bounds.height )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\tplotAreaWidth + padding,\n\t\t\t\t\t\ttransform, plotAreaWidth\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartAxisContainer, index: number ): void {\n\t\tthis._container = container;\n\t\tthis._index = index;\n\t\tconst tickShapeContainer = container.container;\n\n\t\t// Bar\n\t\tconst bar = this._bar;\n\t\tlet barShape = bar.shape;\n\t\tif( ! barShape ) {\n\t\t\tconst position = this._position;\n\t\t\tconst barPosition = ( position === DChartAxisPosition.LEFT || position === DChartAxisPosition.RIGHT ?\n\t\t\t\tEShapeBarPosition.TOP : EShapeBarPosition.LEFT\n\t\t\t);\n\t\t\tbarShape = new EShapeBar(\n\t\t\t\tbarPosition,\n\t\t\t\t-1,\n\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\tbar.style\n\t\t\t);\n\t\t\tbarShape.stroke.copy( bar.stroke );\n\t\t\tbarShape.text.copy( this._label );\n\t\t\tthis._bar.shape = barShape;\n\t\t}\n\t\tbarShape.attach( container.container );\n\n\t\t// Major tick gridline\n\t\tconst tick = this._tick;\n\t\tconst tickMajor = tick.major;\n\t\tconst gridline = tickMajor.gridline;\n\t\tlet gridlineShapes = gridline.shapes;\n\t\tif( ! gridlineShapes && tick.enable && gridline.enable ) {\n\t\t\tgridlineShapes = [];\n\t\t\tgridline.shapes = gridlineShapes;\n\t\t\tconst position = this._position;\n\t\t\tconst gridlinePosition = ( position === DChartAxisPosition.LEFT || position === DChartAxisPosition.RIGHT ?\n\t\t\t\tEShapeBarPosition.LEFT : EShapeBarPosition.TOP\n\t\t\t);\n\t\t\tconst gridlineCount = tickMajor.count;\n\t\t\tconst gridlineStyle = gridline.style;\n\t\t\tfor( let i = 0; i < gridlineCount; ++i ) {\n\t\t\t\tconst gridlineShape = new EShapeBar(\n\t\t\t\t\tgridlinePosition,\n\t\t\t\t\t-1,\n\t\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\t\tgridlineStyle\n\t\t\t\t);\n\t\t\t\tgridlineShape.stroke.copy( gridline.stroke );\n\t\t\t\tgridlineShapes.push( gridlineShape );\n\t\t\t}\n\t\t}\n\t\tif( gridlineShapes ) {\n\t\t\tfor( let i = 0, imax = gridlineShapes.length; i < imax; ++i ) {\n\t\t\t\tgridlineShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\n\t\t// Major ticks\n\t\tlet tickMajorShapes = tickMajor.shapes;\n\t\tif( ! tickMajorShapes && tick.enable ) {\n\t\t\ttickMajorShapes = [];\n\t\t\ttickMajor.shapes = tickMajorShapes;\n\t\t\tconst tickMajorCount = tickMajor.count;\n\t\t\tconst tickMajorSize = tickMajor.size;\n\t\t\tconst tickMajorPosition = tickMajor.position;\n\t\t\tconst tickMajorStyle = tickMajor.style;\n\t\t\tfor( let i = 0; i < tickMajorCount; ++i ) {\n\t\t\t\tconst tickMajorShape = new EShapeBar(\n\t\t\t\t\ttickMajorPosition,\n\t\t\t\t\ttickMajorSize,\n\t\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\t\ttickMajorStyle\n\t\t\t\t);\n\t\t\t\ttickMajorShape.stroke.copy( tickMajor.stroke );\n\t\t\t\ttickMajorShape.text.copy( tickMajor.text );\n\t\t\t\ttickMajorShape.size.set( 0, 0 );\n\t\t\t\ttickMajorShapes.push( tickMajorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinor = tick.minor;\n\t\tlet tickMinorShapes = tickMinor.shapes;\n\t\tif( ! tickMinorShapes && tick.enable ) {\n\t\t\ttickMinorShapes = [];\n\t\t\ttickMinor.shapes = tickMinorShapes;\n\t\t\tconst tickMinorCount = tickMinor.count;\n\t\t\tconst tickMinorSize = tickMinor.size;\n\t\t\tconst tickMinorPosition = tickMinor.position;\n\t\t\tconst tickMinorStyle = tickMinor.style;\n\t\t\tfor( let i = 0, imax = ( tickMajor.count + 1 ) * tickMinorCount; i < imax; ++i ) {\n\t\t\t\tconst tickMinorShape = new EShapeBar(\n\t\t\t\t\ttickMinorPosition,\n\t\t\t\t\ttickMinorSize,\n\t\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\t\ttickMinorStyle\n\t\t\t\t);\n\t\t\t\ttickMinorShape.stroke.copy( tickMinor.stroke );\n\t\t\t\ttickMinorShape.size.set( 0, 0 );\n\t\t\t\ttickMinorShapes.push( tickMinorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\t// Bar\n\t\tconst barShape = this._bar.shape;\n\t\tif( barShape ) {\n\t\t\tbarShape.detach();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t// Major tick gridlines\n\t\tconst tickMajorGridlineShapes = tick.major.gridline.shapes;\n\t\tif( tickMajorGridlineShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorGridlineShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorGridlineShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tupdate(): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tthis.updateBar( container );\n\t\t\tthis.updateTicks( container );\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\t// Bar\n\t\tconst barShape = this._bar.shape;\n\t\tif( barShape ) {\n\t\t\tbarShape.destroy();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t// Major tick gridlines\n\t\tconst tickMajorGridlineShapes = tick.major.gridline.shapes;\n\t\tif( tickMajorGridlineShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorGridlineShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorGridlineShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tprotected toTheme( options?: DChartAxisBaseOptions ): DThemeChartAxisBase {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartAxisBase {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartAxisBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxis } from \"./d-chart-axis\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\nimport { isNumber } from \"./util/is-number\";\n\nexport class DChartAxisContainerImpl implements DChartAxisContainer {\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _container: EShapeContainer;\n\tprotected _list: Map<DChartAxisPosition, DChartAxis[]>;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartAxisContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._container = new EShapeContainer();\n\n\t\tthis._list = new Map<DChartAxisPosition, DChartAxis[]>();\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\t\tthis.add( list[ i ] );\n\t\t\t}\n\t\t}\n\t}\n\n\tget container(): EShapeContainer {\n\t\treturn this._container;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tadd( axis: DChartAxis ): void {\n\t\tconst list = this._list;\n\t\tlet axes = list.get( axis.position );\n\t\tif( axes == null ) {\n\t\t\taxes = [];\n\t\t\tlist.set( axis.position, axes );\n\t\t}\n\t\taxes.push( axis );\n\t\taxis.bind( this, axes.length - 1 );\n\t}\n\n\tget( position: DChartAxisPosition, index: number ): DChartAxis | null {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tif( 0 <= index && index < axes.length ) {\n\t\t\t\treturn axes[ index ];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( axis: DChartAxis ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( axis.position );\n\t\tif( axes ) {\n\t\t\treturn axes.indexOf( axis );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tremove( axis: DChartAxis ): DChartAxis | null;\n\tremove( position: DChartAxisPosition, index: number ): DChartAxis | null;\n\tremove( axisOrPosition: DChartAxis | DChartAxisPosition, indexOrUndefined?: number ): DChartAxis | null {\n\t\tconst list = this._list;\n\t\tif( isNumber( axisOrPosition ) ) {\n\t\t\tconst position: DChartAxisPosition = axisOrPosition;\n\t\t\tconst index = indexOrUndefined!;\n\t\t\tconst axes = list.get( position );\n\t\t\tif( axes ) {\n\t\t\t\tif( 0 <= index && index < axes.length ) {\n\t\t\t\t\tconst removed = axes.splice( index, 1 )[ 0 ];\n\t\t\t\t\tremoved.unbind();\n\t\t\t\t\tremoved.destroy();\n\t\t\t\t\treturn removed;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst axis = axisOrPosition;\n\t\t\tconst position: DChartAxisPosition = axis.position;\n\t\t\tconst axes = list.get( position );\n\t\t\tif( axes ) {\n\t\t\t\tconst index = axes.indexOf( axisOrPosition );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\taxes.splice( index, 1 );\n\t\t\t\t\taxis.unbind();\n\t\t\t\t\taxis.destroy();\n\t\t\t\t\treturn axis;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear( position: DChartAxisPosition ): this {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t}\n\t\treturn this;\n\t}\n\n\tsize( position: DChartAxisPosition ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\treturn axes.length;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tupdate(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].update();\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\n\n/**\n * An X axis.\n */\nexport class DChartAxisX extends DChartAxisBase {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisX\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisX } from \"./d-chart-axis-x\";\n\n/**\n * An X axis for datetimes.\n */\nexport class DChartAxisXDatetime extends DChartAxisX {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisXDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\n\n/**\n * An Y axis.\n */\nexport class DChartAxisY extends DChartAxisBase {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisY\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"./util/util-rgb\";\n\nconst DCHART_COLOR_SET_1 = [\n\t0x10b7e3,\n\t0xfe5420,\n\t0xf0c312,\n\t0x1c5d71\n];\n\nconst DCHART_COLOR_SET_2 = [\n\tDCHART_COLOR_SET_1[ 0 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 0 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 1 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 1 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 2 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 2 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 3 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 3 ], 0.4 )\n];\n\nexport const DChartColorSet1 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_1[ index % DCHART_COLOR_SET_1.length ];\n};\n\nexport const DChartColorSet2 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_2[ index % DCHART_COLOR_SET_2.length ];\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { isNumber } from \"./util/is-number\";\n\nexport class DChartCoordinateContainerSubImpl implements DChartCoordinateContainerSub {\n\tprotected _list: DChartCoordinate[];\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _container: DChartCoordinateContainer;\n\n\tconstructor( container: DChartCoordinateContainer, direction: DChartCoordinateDirection ) {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t\tthis._list = [];\n\t}\n\n\tget container(): DChartCoordinateContainer {\n\t\treturn this._container;\n\t}\n\n\tadd( coordinate: DChartCoordinate, index?: number ): this {\n\t\tconst list = this._list;\n\t\tif( index == null ) {\n\t\t\tlist.push( coordinate );\n\t\t} else if( 0 <= index && index < list.length ) {\n\t\t\tlist.splice( index, 0, coordinate );\n\t\t} else {\n\t\t\tlist.push( coordinate );\n\t\t}\n\t\tcoordinate.bind( this, this._direction );\n\t\treturn this;\n\t}\n\n\tget( index: number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( coordinate: DChartCoordinate ): number {\n\t\treturn this._list.indexOf( coordinate );\n\t}\n\n\tremove( coordinate: DChartCoordinate ): DChartCoordinate | null;\n\tremove( index: number ): DChartCoordinate | null;\n\tremove( coordinateOrIndex: DChartCoordinate | number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( isNumber( coordinateOrIndex ) ) {\n\t\t\tconst index = coordinateOrIndex;\n\t\t\tif( 0 <= index && index < list.length ) {\n\t\t\t\tconst removed = list.splice( index, 1 )[ 0 ];\n\t\t\t\tremoved.unbind();\n\t\t\t\treturn removed;\n\t\t\t}\n\t\t} else {\n\t\t\tconst coordinate = coordinateOrIndex;\n\t\t\tconst index = list.indexOf( coordinate );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tlist.splice( index, 1 );\n\t\t\t\tcoordinate.unbind();\n\t\t\t\treturn coordinate;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].unbind();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tdestroy(): this {\n\t\treturn this.clear();\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tfit(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].fit();\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DChart } from \"./d-chart\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartAxisContainerImpl } from \"./d-chart-axis-container-impl\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerImpl } from \"./d-chart-coordinate-container-impl\";\nimport { DChartPlotAreaContainer } from \"./d-chart-plot-area-container\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { DChartSeriesContainerImpl } from \"./d-chart-series-container-impl\";\nimport { DView, DViewOptions } from \"./d-view\";\nimport { DViewImpl } from \"./d-view-impl\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport enum DChartPlotAreaFitTarget {\n\tNONE\t= 0,\n\tDOMAIN\t= 1,\n\tRANGE\t= 2,\n\tBOTH\t= DOMAIN | RANGE\n}\n\nexport interface DChartPlotAreaOptions<\n\tTHEME extends DThemeChartPlotArea = DThemeChartPlotArea\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tcoordinate?: DChartCoordinateContainerOptions;\n\tseries?: DChartSeriesContainerOptions;\n\taxis?: DChartAxisContainerOptions;\n\tview?: DViewOptions;\n}\n\nexport interface DThemeChartPlotArea extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n}\n\nexport class DChartPlotArea<\n\tTHEME extends DThemeChartPlotArea = DThemeChartPlotArea,\n\tOPTIONS extends DChartPlotAreaOptions<THEME> = DChartPlotAreaOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _chart: DChart;\n\tprotected _container!: DChartPlotAreaContainer;\n\tprotected _series!: DChartSeriesContainerImpl;\n\tprotected _coordinate!: DChartCoordinateContainer;\n\tprotected _axis!: DChartAxisContainerImpl;\n\tprotected _view!: DViewImpl;\n\tprotected _isViewDirty!: boolean;\n\tprotected _isBoundsInContainerDirty!: boolean;\n\tprotected _boundsInContainer!: Rectangle;\n\tprotected _overflowMask!: DBaseOverflowMask | null;\n\tprotected _workPoint!: Point;\n\n\tconstructor( chart: DChart, options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._chart = chart;\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst container = new DChartPlotAreaContainer( (): void => {\n\t\t\tthis._isViewDirty = true;\n\t\t\tthis._isBoundsInContainerDirty = true;\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tthis._container = container;\n\t\tthis._coordinate = new DChartCoordinateContainerImpl( this, options && options.coordinate );\n\t\tconst series = new DChartSeriesContainerImpl( this, options && options.series );\n\t\tthis._series = series;\n\t\tconst axis = new DChartAxisContainerImpl( this, options && options.axis );\n\t\tthis._axis = axis;\n\t\tthis._isViewDirty = true;\n\t\tthis._isBoundsInContainerDirty = true;\n\t\tthis._boundsInContainer = new Rectangle();\n\t\tthis._workPoint = new Point();\n\n\t\tthis.addChild( container );\n\t\tthis.addChild( axis.container );\n\n\t\tthis._view = new DViewImpl( this, () => container, options && options.view );\n\n\t\tconst selection = series.selection;\n\t\tif( selection ) {\n\t\t\tselection.bind( series );\n\t\t}\n\n\t\t// Overflow mask\n\t\tthis._overflowMask = null;\n\t\tif( options && options.mask != null ? options.mask :\n\t\t\tthis.theme.isOverflowMaskEnabled() ) {\n\t\t\tthis._container.mask = this.getOrCreateOverflowMask();\n\t\t}\n\t}\n\n\tprotected getOrCreateOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tget coordinate(): DChartCoordinateContainer {\n\t\treturn this._coordinate;\n\t}\n\n\tget chart(): DChart {\n\t\treturn this._chart;\n\t}\n\n\tget series(): DChartSeriesContainer {\n\t\treturn this._series;\n\t}\n\n\tget container(): DChartPlotAreaContainer {\n\t\treturn this._container;\n\t}\n\n\tget axis(): DChartAxisContainer {\n\t\treturn this._axis;\n\t}\n\n\tget view(): DView {\n\t\treturn this._view;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst vresult = this._view.onWheel( e, deltas, global );\n\t\tconst sresult = super.onWheel( e, deltas, global );\n\t\treturn vresult || sresult;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst vresult = this._view.onDblClick( e, interactionManager );\n\t\tconst sresult = super.onDblClick( e, interactionManager );\n\t\treturn vresult || sresult;\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tthis._view.onDown( e );\n\t\tsuper.onDown( e );\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( this._isViewDirty ) {\n\t\t\tthis._isViewDirty = false;\n\n\t\t\tthis._axis.update();\n\n\t\t\tconst selection = this._series.selection;\n\t\t\tif( selection ) {\n\t\t\t\tselection.update();\n\t\t\t}\n\t\t}\n\t\tsuper.render( renderer );\n\t}\n\n\tdestroy(): void {\n\t\tthis._container.destroy();\n\t\tthis._series.destroy();\n\t\tthis._axis.destroy();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartPlotArea\";\n\t}\n\n\tgetBoundsInContainer(): Rectangle {\n\t\tconst result = this._boundsInContainer;\n\t\tif( this._isBoundsInContainerDirty ) {\n\t\t\tthis._isBoundsInContainerDirty = false;\n\n\t\t\tconst container = this.container;\n\t\t\tcontainer.updateTransform();\n\t\t\tconst transform = container.transform.localTransform;\n\n\t\t\tconst work = this._workPoint;\n\n\t\t\twork.set( 0, 0 );\n\t\t\ttransform.applyInverse( work, work );\n\t\t\tresult.x = work.x;\n\t\t\tresult.y = work.y;\n\n\t\t\twork.set( this.width, this.height );\n\t\t\ttransform.applyInverse( work, work );\n\t\t\tresult.width = work.x - result.x;\n\t\t\tresult.height = work.y - result.y;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateContainerSubImpl } from \"./d-chart-coordinate-container-sub-impl\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { isArray } from \"./util/is-array\";\n\nexport class DChartCoordinateContainerImpl implements DChartCoordinateContainer {\n\tprotected _x: DChartCoordinateContainerSub;\n\tprotected _y: DChartCoordinateContainerSub;\n\tprotected _plotArea: DChartPlotArea;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartCoordinateContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tconst x = this._x = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.X );\n\t\tconst y = this._y = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.Y );\n\t\tif( options ) {\n\t\t\tconst cxs = options.x;\n\t\t\tif( cxs ) {\n\t\t\t\tif( isArray( cxs ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cxs.length; i < imax; ++i ) {\n\t\t\t\t\t\tx.add( cxs[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tx.add( cxs );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst cys = options.y;\n\t\t\tif( cys ) {\n\t\t\t\tif( isArray( cys ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cys.length; i < imax; ++i ) {\n\t\t\t\t\t\ty.add( cys[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ty.add( cys );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget x(): DChartCoordinateContainerSub {\n\t\treturn this._x;\n\t}\n\n\tget y(): DChartCoordinateContainerSub {\n\t\treturn this._y;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tfit(): this {\n\t\tthis._x.fit();\n\t\tthis._y.fit();\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\n\nexport interface DThemeChartCoordinateLinearTick {\n\ttoStepScale( scale: number ): number;\n}\n\nexport class DChartCoordinateLinearTick {\n\tprotected _theme: DThemeChartCoordinateLinearTick;\n\n\tconstructor( theme: DThemeChartCoordinateLinearTick ) {\n\t\tthis._theme = theme;\n\t}\n\n\tprotected calcStepMajor( domainMin: number, domainMax: number, count: number ): number {\n\t\tif( 0 < count ) {\n\t\t\tconst span = Math.abs( domainMax - domainMin ) / count;\n\t\t\tconst power = Math.floor( Math.log( span ) / Math.LN10 );\n\t\t\tconst base = Math.pow( 10, power );\n\t\t\treturn this._theme.toStepScale( span / base ) * base;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected calcStepMinor( step: number, minorCount: number ): number {\n\t\tif( 0 <= step ) {\n\t\t\treturn step / ( minorCount + 1 );\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tprotected calcTickMinorPositions(\n\t\tstep: number, count: number, majorPosition: number,\n\t\trangeMin: number, rangeMax: number,\n\t\tiresult: number, result: Float64Array\n\t): void {\n\t\tfor( let i = 0; i < count; i += 1 ) {\n\t\t\tconst minorPosition = majorPosition + (i + 1) * step;\n\t\t\tif( rangeMin <= minorPosition && minorPosition <= rangeMax ) {\n\t\t\t\tresult[ iresult++ ] = minorPosition;\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array,\n\t\tcoordinate: DChartCoordinate\n\t): void {\n\t\tif( majorCount <= 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst transform = coordinate.transform;\n\n\t\tconst domainMin = Math.min( domainFrom, domainTo );\n\t\tconst domainMax = Math.max( domainFrom, domainTo );\n\n\t\tconst majorStep = this.calcStepMajor( domainMin, domainMax, majorCount );\n\t\tif( majorStep <= 0 ) {\n\t\t\tmajorResult[ 0 ] = domainMin;\n\t\t\tmajorResult[ 1 ] = transform.map( coordinate.map( domainMin ) );\n\t\t\tmajorResult[ 2 ] = 0;\n\t\t\tfor( let i = 1; i < majorCount; ++i ) {\n\t\t\t\tconst imajorResult = i * 3;\n\t\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\t\tconst iminorResult = i * 3;\n\t\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Major tick start position\n\t\tconst idomainStart = Math.floor( domainMin / majorStep ) - 1;\n\t\tconst idomainEnd = Math.ceil( domainMax / majorStep ) + 1;\n\n\t\t// Major / minor tick positions\n\t\tconst minorStep = this.calcStepMinor( majorStep, minorCountPerMajor );\n\t\tlet imajor = 0;\n\t\tlet iminor = 0;\n\t\tfor( let i = idomainStart; i <= idomainEnd; ++i ) {\n\t\t\tconst majorPosition = i * majorStep;\n\t\t\tif( imajor < majorCount ) {\n\t\t\t\tif( domainMin <= majorPosition && majorPosition <= domainMax ) {\n\t\t\t\t\tconst majorProjectedPosition = transform.map( coordinate.map( majorPosition ) );\n\t\t\t\t\tconst imajorResult = imajor * 3;\n\t\t\t\t\tmajorResult[ imajorResult + 0 ] = majorPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 1 ] = majorProjectedPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 2 ] = majorStep;\n\t\t\t\t\timajor += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let j = 0; j < minorCountPerMajor; j += 1 ) {\n\t\t\t\tif( iminor < minorCount ) {\n\t\t\t\t\tconst minorPosition = majorPosition + (j + 1) * minorStep;\n\t\t\t\t\tif( domainMin <= minorPosition && minorPosition <= domainMax ) {\n\t\t\t\t\t\tconst minorProjectedPosition = transform.map( coordinate.map( minorPosition ) );\n\t\t\t\t\t\tconst iminorResult = iminor * 3;\n\t\t\t\t\t\tminorResult[ iminorResult + 0 ] = minorPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 1 ] = minorProjectedPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 2 ] = minorStep;\n\t\t\t\t\t\timinor += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( let i = imajor; i < majorCount; ++i ) {\n\t\t\tconst imajorResult = i * 3;\n\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t}\n\t\tfor( let i = iminor; i < minorCount; ++i ) {\n\t\t\tconst iminorResult = i * 3;\n\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t}\n\t}\n}\n","import { DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\n\nexport class DChartCoordinateTransformImpl implements DChartCoordinateTransform {\n\tprotected _theme: DThemeChartCoordinateTransform;\n\tprotected _id: number;\n\tprotected _translate: number;\n\tprotected _scale: number;\n\tprotected _itranslate: number;\n\tprotected _iscale: number;\n\n\tconstructor( theme: DThemeChartCoordinateTransform ) {\n\t\tthis._theme = theme;\n\t\tthis._id = 0;\n\t\tthis._translate = 0;\n\t\tthis._scale = 1;\n\t\tthis._itranslate = 0;\n\t\tthis._iscale = 1;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget translate(): number {\n\t\treturn this._translate;\n\t}\n\n\tset translate( translate: number ) {\n\t\tthis.set( translate );\n\t}\n\n\tget scale(): number {\n\t\treturn this._scale;\n\t}\n\n\tset scale( scale: number ) {\n\t\tthis.set( undefined, scale );\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis.set( 0, direction === DChartCoordinateDirection.X ? +1 : -1 );\n\t}\n\n\tunbind(): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( translate?: number, scale?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( translate != null && this._translate !== translate ) {\n\t\t\tisChanged = true;\n\t\t\tthis._translate = translate;\n\t\t}\n\n\t\tif( scale != null && this._scale !== scale ) {\n\t\t\tisChanged = true;\n\t\t\tthis._scale = scale;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._iscale = ( this._theme.isZero( this._scale ) ? 0 : 1 / this._scale );\n\t\t\tthis._itranslate = - this._translate * this._iscale;\n\t\t}\n\t}\n\n\tmap( value: number ): number {\n\t\treturn this._translate + this._scale * value;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst translate = this._translate;\n\t\tconst scale = this._scale;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = translate + scale * values[ i ];\n\t\t}\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn this._itranslate + this._iscale * value;\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst itranslate = this._itranslate;\n\t\tconst iscale = this._iscale;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = itranslate + iscale * values[ i ];\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartRegionImpl implements DChartRegion {\n\tfrom: number;\n\tto: number;\n\n\tconstructor( from: number, to: number ) {\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tif( from != null ) {\n\t\t\tthis.from = from;\n\t\t}\n\t\tif( to != null ) {\n\t\t\tthis.to = to;\n\t\t}\n\t\treturn this;\n\t}\n\n\tadd( from: number, to: number ): this {\n\t\tif( ! isNaN( from ) ) {\n\t\t\tthis.from = ( isNaN( this.from ) ?\n\t\t\t\tfrom : Math.min( this.from, from )\n\t\t\t);\n\t\t}\n\n\t\tif( ! isNaN( to ) ) {\n\t\t\tthis.to = ( isNaN( this.to ) ?\n\t\t\t\tto : Math.max( this.to, to )\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclear(): this {\n\t\tthis.from = NaN;\n\t\tthis.to = NaN;\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateLinearTick, DThemeChartCoordinateLinearTick } from \"./d-chart-coordinate-linear-tick\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\nimport { DChartCoordinateTransformImpl } from \"./d-chart-coordinate-transform-impl\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport interface DThemeChartCoordinateLinear extends DThemeChartCoordinateTransform, DThemeChartCoordinateLinearTick {\n\n}\n\nexport interface DChartCoordinateLinearOptions {\n\ttheme?: DThemeChartCoordinateLinear;\n}\n\nexport class DChartCoordinateLinear implements DChartCoordinate {\n\tprotected _id: number;\n\tprotected _transform: DChartCoordinateTransform;\n\tprotected _container?: DChartCoordinateContainerSub;\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _theme: DThemeChartCoordinateLinear;\n\tprotected _work: DChartRegionImpl;\n\tprotected _tick: DChartCoordinateLinearTick;\n\n\tconstructor( options?: DChartCoordinateLinearOptions ) {\n\t\tthis._id = 0;\n\t\tthis._direction = DChartCoordinateDirection.X;\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._transform = new DChartCoordinateTransformImpl( theme );\n\t\tthis._tick = new DChartCoordinateLinearTick( theme );\n\t\tthis._work = new DChartRegionImpl( NaN, NaN );\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t\tthis._transform.bind( container, direction );\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t\tthis._transform.unbind();\n\t}\n\n\tfit(): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.container.plotArea;\n\t\t\tconst padding = plotArea.padding;\n\t\t\tconst work = this._work;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\tthis.fit_(\n\t\t\t\t\tpadding.getLeft(), plotArea.width - padding.getRight(),\n\t\t\t\t\tplotArea.series.getDomain( this, work )\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\tthis.fit_(\n\t\t\t\t\tplotArea.height - padding.getBottom(), padding.getTop(),\n\t\t\t\t\tplotArea.series.getRange( this, work )\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected fit_( pixelFrom: number, pixelTo: number, region: DChartRegion ): void {\n\t\tconst regionFrom = region.from;\n\t\tconst regionTo = region.to;\n\t\tif( ! (isNaN( regionFrom ) || isNaN( regionTo )) ) {\n\t\t\t// Scale\n\t\t\tlet newScale = 1;\n\t\t\tconst regionSize = ( regionTo - regionFrom );\n\t\t\tif( ! this._theme.isZero( regionSize ) ) {\n\t\t\t\tconst pixelSize = ( pixelTo - pixelFrom );\n\t\t\t\tnewScale = pixelSize / regionSize;\n\t\t\t} else {\n\t\t\t\tnewScale = ( pixelTo < pixelFrom ? -1 : 1 );\n\t\t\t}\n\n\t\t\t// Translation\n\t\t\tconst newTranslation = pixelFrom - regionFrom * newScale;\n\n\t\t\t// Done\n\t\t\tthis._transform.set( newTranslation, newScale );\n\t\t}\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget transform(): DChartCoordinateTransform {\n\t\treturn this._transform;\n\t}\n\n\tmap( value: number ): number {\n\t\treturn value;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn value;\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tticks(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void {\n\t\tthis._tick.calculate(\n\t\t\tdomainFrom, domainTo,\n\t\t\tmajorCount,\n\t\t\tminorCountPerMajor,\n\t\t\tminorCount,\n\t\t\tmajorResult,\n\t\t\tminorResult,\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected toTheme( options?: DChartCoordinateLinearOptions ): DThemeChartCoordinateLinear {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartCoordinateLinear {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartCoordinateLinear\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\n\nexport interface DThemeChartCoordinateLogTick {\n\ttoStepScale( scale: number ): number;\n}\n\nexport class DChartCoordinateLogTick {\n\tprotected _theme: DThemeChartCoordinateLogTick;\n\n\tconstructor( theme: DThemeChartCoordinateLogTick ) {\n\t\tthis._theme = theme;\n\t}\n\n\tprotected calcStepMajor( domainMin: number, domainMax: number, count: number ): number {\n\t\tif( 0 < count ) {\n\t\t\tconst span = Math.abs( domainMax - domainMin ) / count;\n\t\t\tconst power = Math.floor( Math.log( span ) / Math.LN10 );\n\t\t\tconst base = Math.pow( 10, power );\n\t\t\treturn this._theme.toStepScale( span / base ) * base;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected calcStepMinor( step: number, minorCount: number ): number {\n\t\tif( 0 <= step ) {\n\t\t\treturn step / ( minorCount + 1 );\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tprotected calcTickMinorPositions(\n\t\tstep: number, count: number, majorPosition: number,\n\t\trangeMin: number, rangeMax: number,\n\t\tiresult: number, result: Float64Array\n\t): void {\n\t\tfor( let i = 0; i < count; i += 1 ) {\n\t\t\tconst minorPosition = majorPosition + (i + 1) * step;\n\t\t\tif( rangeMin <= minorPosition && minorPosition <= rangeMax ) {\n\t\t\t\tresult[ iresult++ ] = minorPosition;\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array,\n\t\tcoordinate: DChartCoordinate\n\t): void {\n\t\tif( majorCount <= 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst transform = coordinate.transform;\n\n\t\tconst domainFromMapped = coordinate.map( domainFrom );\n\t\tconst domainToMapped = coordinate.map( domainTo );\n\n\t\tconst domainMinMapped = Math.min( domainFromMapped, domainToMapped );\n\t\tconst domainMaxMapped = Math.max( domainFromMapped, domainToMapped );\n\n\t\tconst majorStepMapped = this.calcStepMajor( domainMinMapped, domainMaxMapped, majorCount );\n\t\tif( majorStepMapped <= 0 ) {\n\t\t\tconst domainMin = Math.min( domainFrom, domainTo );\n\t\t\tmajorResult[ 0 ] = domainMin;\n\t\t\tmajorResult[ 1 ] = transform.map( coordinate.map( domainMin ) );\n\t\t\tmajorResult[ 2 ] = 0;\n\t\t\tfor( let i = 1; i < majorCount; ++i ) {\n\t\t\t\tconst imajorResult = i * 3;\n\t\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\t\tconst iminorResult = i * 3;\n\t\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Major tick start position\n\t\tconst idomainStartMapped = Math.floor( domainMinMapped / majorStepMapped ) - 1;\n\t\tconst idomainEndMapped = Math.ceil( domainMaxMapped / majorStepMapped ) + 1;\n\n\t\t// Major / minor tick positions\n\t\tconst minorStepMapped = this.calcStepMinor( majorStepMapped, minorCountPerMajor );\n\t\tlet imajor = 0;\n\t\tlet iminor = 0;\n\t\tfor( let i = idomainStartMapped; i <= idomainEndMapped; ++i ) {\n\t\t\tconst majorPositionMapped = i * majorStepMapped;\n\t\t\tif( imajor < majorCount ) {\n\t\t\t\tif( domainMinMapped <= majorPositionMapped && majorPositionMapped <= domainMaxMapped ) {\n\t\t\t\t\tconst majorPosition = coordinate.unmap( majorPositionMapped );\n\t\t\t\t\tconst majorProjectedPosition = transform.map( majorPositionMapped );\n\t\t\t\t\tconst majorStep = coordinate.unmap( majorPositionMapped - 1 );\n\t\t\t\t\tconst imajorResult = imajor * 3;\n\t\t\t\t\tmajorResult[ imajorResult + 0 ] = majorPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 1 ] = majorProjectedPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 2 ] = majorStep;\n\t\t\t\t\timajor += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let j = 0; j < minorCountPerMajor; j += 1 ) {\n\t\t\t\tif( iminor < minorCount ) {\n\t\t\t\t\tconst minorPositionMapped = majorPositionMapped + (j + 1) * minorStepMapped;\n\t\t\t\t\tif( domainMinMapped <= minorPositionMapped && minorPositionMapped <= domainMaxMapped ) {\n\t\t\t\t\t\tconst minorPosition = coordinate.unmap( minorPositionMapped );\n\t\t\t\t\t\tconst minorProjectedPosition = transform.map( minorPositionMapped );\n\t\t\t\t\t\tconst minorStep = coordinate.unmap( minorPositionMapped - 1 );\n\t\t\t\t\t\tconst iminorResult = iminor * 3;\n\t\t\t\t\t\tminorResult[ iminorResult + 0 ] = minorPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 1 ] = minorProjectedPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 2 ] = minorStep;\n\t\t\t\t\t\timinor += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( let i = imajor; i < majorCount; ++i ) {\n\t\t\tconst imajorResult = i * 3;\n\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t}\n\t\tfor( let i = iminor; i < minorCount; ++i ) {\n\t\t\tconst iminorResult = i * 3;\n\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateLogTick, DThemeChartCoordinateLogTick } from \"./d-chart-coordinate-log-tick\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\nimport { DChartCoordinateTransformImpl } from \"./d-chart-coordinate-transform-impl\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport interface DThemeChartCoordinateLog extends DThemeChartCoordinateTransform, DThemeChartCoordinateLogTick {\n\n}\n\nexport interface DChartCoordinateLogOptions {\n\ttheme?: DThemeChartCoordinateLog;\n}\n\nexport class DChartCoordinateLog implements DChartCoordinate {\n\tprotected _id: number;\n\tprotected _transform: DChartCoordinateTransform;\n\tprotected _container?: DChartCoordinateContainerSub;\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _theme: DThemeChartCoordinateLog;\n\tprotected _work: DChartRegionImpl;\n\tprotected _tick: DChartCoordinateLogTick;\n\n\tconstructor( options?: DChartCoordinateLogOptions ) {\n\t\tthis._id = 0;\n\t\tthis._direction = DChartCoordinateDirection.X;\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._transform = new DChartCoordinateTransformImpl( theme );\n\t\tthis._tick = new DChartCoordinateLogTick( theme );\n\t\tthis._work = new DChartRegionImpl( NaN, NaN );\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t}\n\n\tfit(): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.container.plotArea;\n\t\t\tconst padding = plotArea.padding;\n\t\t\tconst work = this._work;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\tthis.fit_(\n\t\t\t\t\tpadding.getLeft(), plotArea.width - padding.getRight(),\n\t\t\t\t\tplotArea.series.getDomain( this, work )\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\tthis.fit_(\n\t\t\t\t\tplotArea.height - padding.getBottom(), padding.getTop(),\n\t\t\t\t\tplotArea.series.getRange( this, work )\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected fit_( pixelFrom: number, pixelTo: number, region: DChartRegion ): void {\n\t\tconst regionFrom = region.from;\n\t\tconst regionTo = region.to;\n\t\tif( ! (isNaN( regionFrom ) || isNaN( regionTo )) ) {\n\t\t\t// Scale\n\t\t\tlet newScale = 1;\n\t\t\tconst regionFromMapped = this.map( regionFrom );\n\t\t\tconst regionToMapped = this.map( regionTo );\n\t\t\tconst regionSizeMapped = ( regionToMapped - regionFromMapped );\n\t\t\tif( ! this._theme.isZero( regionSizeMapped ) ) {\n\t\t\t\tconst pixelSize = ( pixelTo - pixelFrom );\n\t\t\t\tnewScale = pixelSize / regionSizeMapped;\n\t\t\t} else {\n\t\t\t\tnewScale = ( pixelTo < pixelFrom ? -1 : 1 );\n\t\t\t}\n\n\t\t\t// Translation\n\t\t\tconst newTranslation = pixelFrom - regionFromMapped * newScale;\n\n\t\t\t// Done\n\t\t\tthis._transform.set( newTranslation, newScale );\n\t\t}\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget transform(): DChartCoordinateTransform {\n\t\treturn this._transform;\n\t}\n\n\tmap( value: number ): number {\n\t\treturn Math.log( Math.max( 0, value ) ) / Math.LN10;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst factor = 1 / Math.LN10;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tconst value = values[ i ];\n\t\t\tvalues[ i ] = Math.log( Math.max( 0, value ) ) * factor;\n\t\t}\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn Math.pow( 10, value );\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = Math.pow( 10, values[ i ] );\n\t\t}\n\t}\n\n\tticks(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void {\n\t\tthis._tick.calculate(\n\t\t\tdomainFrom, domainTo,\n\t\t\tmajorCount,\n\t\t\tminorCountPerMajor,\n\t\t\tminorCount,\n\t\t\tmajorResult,\n\t\t\tminorResult,\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected toTheme( options?: DChartCoordinateLogOptions ): DThemeChartCoordinateLog {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartCoordinateLog {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartCoordinateLog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartLegendItemOptions<THEME extends DThemeChartLegendItem> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartLegendItem extends DThemeBase {\n}\n\nexport class DChartLegendItem<\n\tTHEME extends DThemeChartLegendItem = DThemeChartLegendItem,\n\tOPTIONS extends DChartLegendItemOptions<THEME> = DChartLegendItemOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartLegendItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartLegendOptions<THEME extends DThemeChartLegend> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartLegend extends DThemeBase {\n}\n\nexport class DChartLegend<\n\tTHEME extends DThemeChartLegend = DThemeChartLegend,\n\tOPTIONS extends DChartLegendOptions<THEME> = DChartLegendOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartLegend\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartOverviewOptions<THEME extends DThemeChartOverview> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartOverview extends DThemeBase {\n}\n\nexport class DChartOverview<\n\tTHEME extends DThemeChartOverview = DThemeChartOverview,\n\tOPTIONS extends DChartOverviewOptions<THEME> = DChartOverviewOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartOverview\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Rectangle, Transform } from \"pixi.js\";\nimport { DBasePoint } from \"./d-base-point\";\nimport { DViewTarget } from \"./d-view-to-target\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\n\nexport class DChartPlotAreaContainer extends EShapeContainer implements DViewTarget {\n\tprotected _position: DBasePoint;\n\tprotected _scale: DBasePoint;\n\tprotected _workRect: Rectangle;\n\n\tconstructor( onChange: () => void ) {\n\t\tsuper();\n\t\tconst transform: Transform = this.transform;\n\t\tthis._position = new DBasePoint( transform.position, onChange );\n\t\tthis._scale = new DBasePoint( transform.scale, onChange );\n\t\tthis._workRect = new Rectangle();\n\t}\n\n\tget position(): DBasePoint {\n\t\treturn this._position;\n\t}\n\n\tget scale(): DBasePoint {\n\t\treturn this._scale;\n\t}\n\n\tgetBounds( skipUpdate?: boolean, rect?: Rectangle ): Rectangle {\n\t\t(this as any)._lastBoundsID = -1;\n\t\treturn super.getBounds( skipUpdate, rect );\n\t}\n\n\tcalculateBounds(): void {\n\t\tconst bounds = this._bounds;\n\t\tconst work = this._work;\n\t\tconst rect = this._workRect;\n\t\tconst worldTransform = this.transform.worldTransform;\n\n\t\tlet xmin = 0;\n\t\tlet xmax = 0;\n\t\tlet ymin = 0;\n\t\tlet ymax = 0;\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\tlet isFirst = true;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible ) {\n\t\t\t\t\tchild.getBoundsInternal( work, false, rect );\n\t\t\t\t\tif( isFirst ) {\n\t\t\t\t\t\tisFirst = false;\n\t\t\t\t\t\txmin = rect.x;\n\t\t\t\t\t\tymin = rect.y;\n\t\t\t\t\t\txmax = rect.x + rect.width;\n\t\t\t\t\t\tymax = rect.y + rect.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\txmin = Math.min( xmin, rect.x );\n\t\t\t\t\t\tymin = Math.min( ymin, rect.y );\n\t\t\t\t\t\txmax = Math.max( xmax, rect.x + rect.width );\n\t\t\t\t\t\tymax = Math.max( ymax, rect.y + rect.height );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbounds.clear();\n\n\t\twork.set( xmin, ymin );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\twork.set( xmax, ymax );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartRegionImmutable } from \"./d-chart-region\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer } from \"./d-chart-series-coordinate\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport class DChartSeriesHitResult {\n\tshape: EShape | null;\n\tx: number;\n\ty: number;\n\tp0x: number;\n\tp0y: number;\n\tp1x: number;\n\tp1y: number;\n\tindex: number;\n\tt: number;\n\tdistance: number;\n\n\tconstructor() {\n\t\tthis.shape = null;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.p0x = 0;\n\t\tthis.p0y = 0;\n\t\tthis.p1x = 0;\n\t\tthis.p1y = 0;\n\t\tthis.index = 0;\n\t\tthis.t = 0;\n\t\tthis.distance = 0;\n\t}\n\n\tcopyFrom( other: DChartSeriesHitResult ): this {\n\t\tthis.shape = other.shape;\n\t\tthis.x = other.x;\n\t\tthis.y = other.y;\n\t\tthis.p0x = other.p0x;\n\t\tthis.p0y = other.p0y;\n\t\tthis.p1x = other.p1x;\n\t\tthis.p1y = other.p1y;\n\t\tthis.index = other.index;\n\t\tthis.t = other.t;\n\t\tthis.distance = other.distance;\n\t\treturn this;\n\t}\n}\n\nexport interface DChartSeries {\n\treadonly domain: DChartRegionImmutable;\n\treadonly range: DChartRegionImmutable;\n\treadonly shape: EShape | null;\n\treadonly container: DChartSeriesContainer | null;\n\treadonly coordinate: DChartSeriesCoordinateContainer;\n\treadonly index: number;\n\n\tbind( container: DChartSeriesContainer, index: number ): void;\n\tunbind(): void;\n\n\ttoDirty(): void;\n\n\tupdate(): void;\n\tdestroy(): void;\n\n\thitTest( global: IPoint ): boolean;\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean;\n\n\tsetState( state: DBaseState, isOn: boolean ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isArray } from \"./util/is-array\";\nimport { isFunction } from \"./util/is-function\";\n\nexport type DChartSeriesScalar<T> = ( index: number ) => T;\n\nexport class DChartSeriesScalars {\n\tstatic from<T>(\n\t\tvalue: T | T[] | DChartSeriesScalar<T> | undefined,\n\t\tdef: T | T[] | DChartSeriesScalar<T>\n\t): DChartSeriesScalar<T> {\n\t\tif( isArray( value ) ) {\n\t\t\treturn ( index: number ) => value[ index % value.length ];\n\t\t} else if( isFunction( value ) ) {\n\t\t\treturn value;\n\t\t} else if( value != null ) {\n\t\t\treturn () => value;\n\t\t} else if( isArray( def ) ) {\n\t\t\treturn ( index: number ) => def[ index % def.length ];\n\t\t} else if( isFunction( def ) ) {\n\t\t\treturn def;\n\t\t} else {\n\t\t\treturn () => def;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartColorSet2 } from \"./d-chart-color-set\";\nimport { DChartSeriesFill, DChartSeriesFillOptions } from \"./d-chart-series-fill\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\n\nexport class DChartSeriesFillImpl implements DChartSeriesFill {\n\tenable: DChartSeriesScalar<boolean>;\n\tcolor: DChartSeriesScalar<number>;\n\talpha: DChartSeriesScalar<number>;\n\n\tconstructor( options?: DChartSeriesFillOptions ) {\n\t\tthis.enable = DChartSeriesScalars.from( options && options.enable, true );\n\t\tthis.color = DChartSeriesScalars.from( options && options.color, DChartColorSet2 );\n\t\tthis.alpha = DChartSeriesScalars.from( options && options.alpha, EShapeDefaults.FILL_ALPHA );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartColorSet2 } from \"./d-chart-color-set\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\nimport { DChartSeriesStroke, DChartSeriesStrokeOptions } from \"./d-chart-series-stroke\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyleOption } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\n\nexport class DChartSeriesStrokeImpl implements DChartSeriesStroke {\n\tenable: DChartSeriesScalar<boolean>;\n\tcolor: DChartSeriesScalar<number>;\n\talpha: DChartSeriesScalar<number>;\n\twidth: DChartSeriesScalar<number>;\n\talign: DChartSeriesScalar<number>;\n\tside: DChartSeriesScalar<EShapeStrokeSide>;\n\tstyle: DChartSeriesScalar<EShapePointsStyleOption>;\n\n\tconstructor( options?: DChartSeriesStrokeOptions ) {\n\t\tthis.enable = DChartSeriesScalars.from( options && options.enable, true );\n\t\tthis.color = DChartSeriesScalars.from( options && options.color, DChartColorSet2 );\n\t\tthis.alpha = DChartSeriesScalars.from( options && options.alpha, EShapeDefaults.STROKE_ALPHA );\n\t\tthis.width = DChartSeriesScalars.from( options && options.width, EShapeDefaults.STROKE_WIDTH );\n\t\tthis.align = DChartSeriesScalars.from( options && options.width, EShapeDefaults.STROKE_ALIGN );\n\t\tthis.side = DChartSeriesScalars.from( options && options.side, EShapeStrokeSide.ALL );\n\t\tthis.style = DChartSeriesScalars.from( options && options.style,\n\t\t\tEShapePointsStyle.NON_EXPANDING_WIDTH |\n\t\t\tEShapePointsStyle.NON_SHRINKING_WIDTH |\n\t\t\tEShapePointsStyle.NON_SCALING_DOT_AND_DASH\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSelection } from \"./d-chart-selection\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { DChartSeriesFill } from \"./d-chart-series-fill\";\nimport { DChartSeriesFillImpl } from \"./d-chart-series-fill-impl\";\nimport { DChartSeriesStroke } from \"./d-chart-series-stroke\";\nimport { DChartSeriesStrokeImpl } from \"./d-chart-series-stroke-impl\";\nimport { isNumber } from \"./util/is-number\";\n\nexport class DChartSeriesContainerImpl implements DChartSeriesContainer {\n\tprotected static WORK_CALCHITPOINT: DChartSeriesHitResult = new DChartSeriesHitResult();\n\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _list: DChartSeries[];\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _fill: DChartSeriesFillImpl;\n\tprotected _stroke: DChartSeriesStrokeImpl;\n\tprotected _selection: DChartSelection | null;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartSeriesContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._fill = new DChartSeriesFillImpl( options && options.fill );\n\t\tthis._stroke = new DChartSeriesStrokeImpl( options && options.stroke );\n\t\tthis._selection = (options && options.selection ) || null;\n\n\t\tthis._list = [];\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tconst listLength = list.length;\n\t\t\tif( 0 < listLength ) {\n\t\t\t\tfor( let i = 0; i < listLength; ++i ) {\n\t\t\t\t\tthis.add( list[ i ] );\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tget fill(): DChartSeriesFill {\n\t\treturn this._fill;\n\t}\n\n\tget stroke(): DChartSeriesStroke {\n\t\treturn this._stroke;\n\t}\n\n\tget selection(): DChartSelection | null {\n\t\treturn this._selection;\n\t}\n\n\tupdate(): void {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].update();\n\t\t}\n\t\tconst selection = this._selection;\n\t\tif( selection ) {\n\t\t\tselection.update();\n\t\t}\n\t}\n\n\tadd( series: DChartSeries ): void {\n\t\tconst list = this._list;\n\t\tseries.bind( this, list.length );\n\t\tlist.push( series );\n\t}\n\n\tget( index: number ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( series: DChartSeries ): number {\n\t\treturn this._list.indexOf( series );\n\t}\n\n\tremove( series: DChartSeries ): DChartSeries | null;\n\tremove( index: number ): DChartSeries | null;\n\tremove( seriesOrIndex: DChartSeries | number ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tif( isNumber( seriesOrIndex ) ) {\n\t\t\tconst index = seriesOrIndex;\n\t\t\tif( 0 <= index && index < list.length ) {\n\t\t\t\tconst removed = list.splice( index, 1 )[ 0 ];\n\t\t\t\tremoved.unbind();\n\t\t\t\tremoved.destroy();\n\t\t\t\treturn removed;\n\t\t\t}\n\t\t} else {\n\t\t\tconst series = seriesOrIndex;\n\t\t\tconst index = list.indexOf( series );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tlist.splice( index, 1 );\n\t\t\t\tseries.unbind();\n\t\t\t\tseries.destroy();\n\t\t\t\treturn series;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].destroy();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t\tconst selection = this._selection;\n\t\tif( selection ) {\n\t\t\tselection.unbind();\n\t\t}\n\t}\n\n\tgetDomain( coordinate: DChartCoordinate, result: DChartRegion ): DChartRegion {\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.coordinate.x === coordinate ) {\n\t\t\t\tconst domain = series.domain;\n\t\t\t\tresult.add( domain.from, domain.to );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetRange( coordinate: DChartCoordinate, result: DChartRegion ): DChartRegion {\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.coordinate.y === coordinate ) {\n\t\t\t\tconst range = series.range;\n\t\t\t\tresult.add( range.from, range.to );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget domain(): DChartRegion {\n\t\tconst result = this._domain;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst domain = list[ i ].domain;\n\t\t\tresult.add( domain.from, domain.to );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget range(): DChartRegion {\n\t\tconst result = this._range;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst range = list[ i ].range;\n\t\t\tresult.add( range.from, range.to );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thitTest( global: IPoint ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tfor( let i = list.length - 1; 0 <= i; --i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.hitTest( global ) ) {\n\t\t\t\treturn series;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): DChartSeries | null {\n\t\tlet tmp1 = result;\n\t\tlet tmp2 = DChartSeriesContainerImpl.WORK_CALCHITPOINT;\n\t\tconst list = this._list;\n\t\tlet closest: DChartSeries | null = null;\n\t\ttmp2.distance = +Infinity;\n\t\tfor( let i = list.length - 1; 0 <= i; --i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.calcHitPoint( global, tmp1 ) ) {\n\t\t\t\tif( tmp1.distance < tmp2.distance ) {\n\t\t\t\t\tclosest = series;\n\t\t\t\t\tconst tmp = tmp1;\n\t\t\t\t\ttmp1 = tmp2;\n\t\t\t\t\ttmp2 = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( closest && tmp2 !== result ) {\n\t\t\tresult.copyFrom( tmp2 );\n\t\t}\n\t\treturn closest;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport enum DChartSelectionPoint {\n\tPREVIOUS,\n\tNEXT,\n\tCLOSER,\n\tINTERSECTION\n}\n\nexport type DChartSelectionStyle = ( shape: EShape, series: DChartSeries ) => void;\n\nexport interface DChartSelection extends utils.EventEmitter {\n\tbind( container: DChartSeriesContainer ): void;\n\tunbind(): void;\n\tupdate(): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartRegionImplObservable implements DChartRegion {\n\tprotected _from: number;\n\tprotected _to: number;\n\tprotected _onChange: () => void;\n\n\tconstructor( from: number, to: number, onChange: () => void ) {\n\t\tthis._from = from;\n\t\tthis._to = to;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tthis.set( from, undefined );\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tthis.set( undefined, to );\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( from != null && this._from !== from ) {\n\t\t\tif( ! isNaN( this._from ) || ! isNaN(from) ) {\n\t\t\t\tthis._from = from;\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( to != null && this._to !== to ) {\n\t\t\tif( ! isNaN( this._to ) || ! isNaN(to) ) {\n\t\t\t\tthis._to = to;\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._onChange();\n\t\t}\n\t\treturn this;\n\t}\n\n\tadd( from: number, to: number ): this {\n\t\tlet newFrom: number | undefined;\n\t\tif( ! isNaN( from ) ) {\n\t\t\tnewFrom = ( isNaN( this.from ) ?\n\t\t\t\tfrom : Math.min( this.from, from )\n\t\t\t);\n\t\t}\n\n\t\tlet newTo: number | undefined;\n\t\tif( ! isNaN( to ) ) {\n\t\t\tnewTo = ( isNaN( this.to ) ?\n\t\t\t\tto : Math.max( this.to, to )\n\t\t\t);\n\t\t}\n\n\t\treturn this.set( newFrom, newTo );\n\t}\n\n\tclear(): this {\n\t\treturn this.set( NaN, NaN );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer, DChartSeriesCoordinateOptions } from \"./d-chart-series-coordinate\";\n\ninterface DChartSeriesBaseCoordinateContainerParent {\n\tcontainer: DChartSeriesContainer | null;\n}\n\nexport class DChartSeriesBaseCoordinateContainer implements DChartSeriesCoordinateContainer {\n\tprotected _parent: DChartSeriesBaseCoordinateContainerParent;\n\tprotected _coordinateIndexX: number;\n\tprotected _coordinateIndexY: number;\n\tprotected _coordinateIdUpdatedX: number;\n\tprotected _coordinateIdUpdatedY: number;\n\tprotected _coordinateTransformIdUpdatedX: number;\n\tprotected _coordinateTransformIdUpdatedY: number;\n\n\tconstructor( parent: DChartSeriesBaseCoordinateContainerParent, options?: DChartSeriesCoordinateOptions ) {\n\t\tthis._parent = parent;\n\t\tthis._coordinateIndexX = ( options && options.x != null ? options.x : 0 );\n\t\tthis._coordinateIndexY = ( options && options.y != null ? options.y : 0 );\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t\tthis._coordinateTransformIdUpdatedX = NaN;\n\t\tthis._coordinateTransformIdUpdatedY = NaN;\n\t}\n\n\tget x(): DChartCoordinate | null {\n\t\tconst container = this._parent.container;\n\t\tif( container ) {\n\t\t\treturn container.plotArea.coordinate.x.get(\n\t\t\t\tthis._coordinateIndexX\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tget y(): DChartCoordinate | null {\n\t\tconst container = this._parent.container;\n\t\tif( container ) {\n\t\t\treturn container.plotArea.coordinate.y.get(\n\t\t\t\tthis._coordinateIndexY\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tisDirty( coordinateX: DChartCoordinate, coordinateY: DChartCoordinate ): boolean {\n\t\tconst coordinateIdX = coordinateX.id;\n\t\tconst coordinateIdY = coordinateY.id;\n\t\tconst isCoordinateXChanged = ( coordinateIdX !== this._coordinateIdUpdatedX );\n\t\tconst isCoordinateYChanged = ( coordinateIdY !== this._coordinateIdUpdatedY );\n\t\tthis._coordinateIdUpdatedX = coordinateIdX;\n\t\tthis._coordinateIdUpdatedY = coordinateIdY;\n\n\t\tconst coordinateTransformIdX = coordinateX.transform.id;\n\t\tconst coordinateTransformIdY = coordinateY.transform.id;\n\t\tconst isCoordinateTransformXChanged = ( coordinateTransformIdX !== this._coordinateTransformIdUpdatedX );\n\t\tconst isCoordinateTransformYChanged = ( coordinateTransformIdY !== this._coordinateTransformIdUpdatedY );\n\t\tthis._coordinateTransformIdUpdatedX = coordinateTransformIdX;\n\t\tthis._coordinateTransformIdUpdatedY = coordinateTransformIdY;\n\n\t\treturn ( isCoordinateXChanged || isCoordinateYChanged ||\n\t\t\tisCoordinateTransformXChanged || isCoordinateTransformYChanged );\n\t}\n\n\treset(): void {\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t}\n\n\tdestroy(): void {\n\t\tthis.reset();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseOnOptions } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartRegionImmutable } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBaseCoordinateContainer } from \"./d-chart-series-base-coordinate-container\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer, DChartSeriesCoordinateOptions } from \"./d-chart-series-coordinate\";\nimport { EShape } from \"./shape/e-shape\";\n\n/**\n * {@link DChartSeriesBase} options.\n */\nexport interface DChartSeriesBaseOptions {\n\tcoordinate?: DChartSeriesCoordinateOptions;\n\ton?: DBaseOnOptions;\n}\n\n/**\n * A series represents a polyline.\n */\nexport abstract class DChartSeriesBase extends utils.EventEmitter implements DChartSeries {\n\tprotected _coordinate: DChartSeriesBaseCoordinateContainer;\n\n\tprotected _container?: DChartSeriesContainer;\n\tprotected _index: number;\n\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _regionPointId: number;\n\n\tprotected _state: DBaseState;\n\tprotected _stateLocal: DBaseState;\n\n\tabstract readonly shape: EShape | null;\n\n\tconstructor( options?: DChartSeriesBaseOptions ) {\n\t\tsuper();\n\n\t\tthis._coordinate = new DChartSeriesBaseCoordinateContainer( this, options && options.coordinate );\n\t\tthis._index = 0;\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._regionPointId = NaN;\n\n\t\tthis._state = DBaseState.NONE;\n\t\tthis._stateLocal = DBaseState.NONE;\n\n\t\t// Events\n\t\tif( options ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tthis._container = container;\n\t\tthis._coordinate.reset();\n\t\tthis._index = index;\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t}\n\n\tabstract toDirty(): void;\n\tabstract update(): void;\n\n\tget domain(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._domain;\n\t}\n\n\tget range(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._range;\n\t}\n\n\tget container(): DChartSeriesContainer | null {\n\t\treturn this._container || null;\n\t}\n\n\tget index(): number {\n\t\treturn this._index;\n\t}\n\n\tget coordinate(): DChartSeriesCoordinateContainer {\n\t\treturn this._coordinate;\n\t}\n\n\tprotected abstract updateRegion(): void;\n\n\tdestroy(): void {\n\t\tthis._container = undefined;\n\t\tthis._coordinate.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\treturn false;\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ): void {\n\t\tconst oldStateLocal = this._stateLocal;\n\t\tconst newStateLocal = ( isOn ? (oldStateLocal | state) : (oldStateLocal & ~state) );\n\t\tif( oldStateLocal !== newStateLocal ) {\n\t\t\tthis._stateLocal = newStateLocal;\n\t\t\tthis.updateState();\n\t\t}\n\t}\n\n\tprotected updateState(): void {\n\t\tconst container = this._container;\n\t\tconst chart = container && container.plotArea.chart;\n\t\tconst stateLocal = this._stateLocal;\n\t\tconst newState = ( chart ?\n\t\t\tthis.mergeState( stateLocal, chart.state ) :\n\t\t\tstateLocal\n\t\t);\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn stateLocal | ( stateParent & DBaseState.DISABLED ) |\n\t\t\t( stateParent & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) ? DBaseState.FOCUSED_IN : DBaseState.NONE ) |\n\t\t\t( stateParent & (DBaseState.ACTIVE | DBaseState.ACTIVE_IN) ? DBaseState.ACTIVE_IN : DBaseState.NONE );\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tthis.toDirty();\n\t\tconst container = this._container;\n\t\tconst chart = container && container.plotArea.chart;\n\t\tDApplications.update( chart );\n\t\tthis.emit( \"statechange\", newState, oldState, this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesFillComputed, DChartSeriesFillComputedOptions } from \"./d-chart-series-fill-computed\";\n\nexport class DChartSeriesFillComputedImpl implements DChartSeriesFillComputed {\n\tenable: boolean;\n\tcolor: number;\n\talpha: number;\n\n\tconstructor( enable: boolean, color: number, alpha: number ) {\n\t\tthis.enable = enable;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t}\n\n\tstatic from(\n\t\tcontainer: DChartSeriesContainer, index: number,\n\t\tfill?: DChartSeriesFillComputedOptions\n\t): DChartSeriesFillComputed {\n\t\tconst containerFill = container.fill;\n\t\tif( fill ) {\n\t\t\treturn new DChartSeriesFillComputedImpl(\n\t\t\t\t( fill.enable != null ? fill.enable : containerFill.enable( index ) ),\n\t\t\t\t( fill.color != null ? fill.color : containerFill.color( index ) ),\n\t\t\t\t( fill.alpha != null ? fill.alpha : containerFill.alpha( index ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesFillComputedImpl(\n\t\t\t\tcontainerFill.enable( index ),\n\t\t\t\tcontainerFill.color( index ),\n\t\t\t\tcontainerFill.alpha( index )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyles } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\n\nexport class DChartSeriesStrokeComputedImpl implements DChartSeriesStrokeComputed {\n\tenable: boolean;\n\tcolor: number;\n\talpha: number;\n\twidth: number;\n\talign: number;\n\tside: EShapeStrokeSide;\n\tstyle: EShapePointsStyle;\n\n\tconstructor(\n\t\tenable: boolean, color: number, alpha: number, width: number,\n\t\talign: number, side: EShapeStrokeSide, style: EShapePointsStyle\n\t) {\n\t\tthis.enable = enable;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.width = width;\n\t\tthis.align = align;\n\t\tthis.side = side;\n\t\tthis.style = style;\n\t}\n\n\tstatic from(\n\t\tcontainer: DChartSeriesContainer, index: number,\n\t\tstroke?: DChartSeriesStrokeComputedOptions\n\t): DChartSeriesStrokeComputed {\n\t\tconst containerStroke = container.stroke;\n\t\tif( stroke ) {\n\t\t\treturn new DChartSeriesStrokeComputedImpl(\n\t\t\t\t( stroke.enable != null ? stroke.enable : containerStroke.enable( index ) ),\n\t\t\t\t( stroke.color != null ? stroke.color : containerStroke.color( index ) ),\n\t\t\t\t( stroke.alpha != null ? stroke.alpha : containerStroke.alpha( index ) ),\n\t\t\t\t( stroke.width != null ? stroke.width : containerStroke.width( index ) ),\n\t\t\t\t( stroke.align != null ? stroke.align : containerStroke.align( index ) ),\n\t\t\t\t( stroke.side != null ? stroke.side : containerStroke.side( index ) ),\n\t\t\t\tEShapePointsStyles.from( stroke.style != null ? stroke.style : containerStroke.style( index ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesStrokeComputedImpl(\n\t\t\t\tcontainerStroke.enable( index ),\n\t\t\t\tcontainerStroke.color( index ),\n\t\t\t\tcontainerStroke.alpha( index ),\n\t\t\t\tcontainerStroke.width( index ),\n\t\t\t\tcontainerStroke.align( index ),\n\t\t\t\tcontainerStroke.side( index ),\n\t\t\t\tEShapePointsStyles.from( containerStroke.style( index ) )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesFillComputed, DChartSeriesFillComputedOptions } from \"./d-chart-series-fill-computed\";\nimport { DChartSeriesFillComputedImpl } from \"./d-chart-series-fill-computed-impl\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { DChartSeriesStrokeComputedImpl } from \"./d-chart-series-stroke-computed-impl\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfCircles } from \"./shape/variant/e-shape-line-of-circles\";\nimport { isNumber } from \"./util/is-number\";\nimport { toCeilingIndex } from \"./util/to-ceiling-index\";\n\n/**\n * {@link DChartSeriesLineOfAny} options.\n */\nexport interface DChartSeriesLineOfAnyOptions extends DChartSeriesBaseOptions {\n\tpoints?: Array<number | null>;\n\tfill?: DChartSeriesFillComputedOptions;\n\tstroke?: DChartSeriesStrokeComputedOptions;\n\tsize?: number | { x?: number, y?: number };\n}\n\n/**\n * A series represents a line of anything.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport abstract class DChartSeriesLineOfAny extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\n\tprotected _line: EShapeLineOfAny | null;\n\tprotected _options?: DChartSeriesLineOfAnyOptions;\n\tprotected _points: Array<number | null>;\n\tprotected _pointId: number;\n\tprotected _pointIdUpdated: number;\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\tprotected _fill?: DChartSeriesFillComputed;\n\tprotected _size: { x: number, y: number };\n\n\tconstructor( options?: DChartSeriesLineOfAnyOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._options = options;\n\t\tthis._points = (options && options.points) || [];\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tthis._size = this.toSize( options );\n\t}\n\n\tprotected toSize( options?: DChartSeriesLineOfAnyOptions ): { x: number, y: number } {\n\t\tconst result = { x: 10, y: 10 };\n\t\tconst size = options && options.size;\n\t\tif( isNumber( size ) ) {\n\t\t\tresult.x = result.y = size;\n\t\t} else if( size != null ) {\n\t\t\tif( size.x != null ) {\n\t\t\t\tresult.x = size.x;\n\t\t\t}\n\t\t\tif( size.y != null ) {\n\t\t\t\tresult.y = size.y;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tline = this._line = this.newLineOfAny();\n\n\t\t\tconst options = this._options;\n\n\t\t\tconst fill = DChartSeriesFillComputedImpl.from( container, index, options && options.fill );\n\t\t\tline.fill.copy( fill );\n\t\t\tthis._fill = fill;\n\n\t\t\tconst stroke = DChartSeriesStrokeComputedImpl.from( container, index, options && options.stroke );\n\t\t\tline.stroke.copy( stroke );\n\t\t\tthis._stroke = stroke;\n\n\t\t\tconst size = this._size;\n\t\t\tline.points.size.set( size.x, size.y);\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tprotected abstract newLineOfAny(): EShapeLineOfAny;\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLineOfAny | null {\n\t\treturn this._line;\n\t}\n\n\tget points(): Array<number | null> {\n\t\treturn this._points;\n\t}\n\n\tset points( points: Array<number | null> ) {\n\t\tthis._points = points;\n\t\tthis._pointId += 1;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._pointId += 1;\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst pointId = this._pointId;\n\t\t\t\tconst isPointChanged = ( pointId !== this._pointIdUpdated );\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tif( isPointChanged || isCoordinateChanged ) {\n\t\t\t\t\tthis._pointIdUpdated = pointId;\n\t\t\t\t\tthis.updateLine( line, coordinateX, coordinateY );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLineOfAny,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst valuesLength = values.length;\n\t\tlet ivalues = 0;\n\t\tconst points = this._points;\n\t\tlet xmin = NaN;\n\t\tlet xmax = NaN;\n\t\tlet ymin = NaN;\n\t\tlet ymax = NaN;\n\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\tconst x = points[ i ];\n\t\t\tconst y = points[ i + 1 ];\n\t\t\tif( x != null && y != null ) {\n\t\t\t\tif( ivalues < valuesLength ) {\n\t\t\t\t\tvalues[ ivalues ] = x;\n\t\t\t\t\tvalues[ ivalues + 1 ] = y;\n\t\t\t\t} else {\n\t\t\t\t\tvalues.push( x, y );\n\t\t\t\t}\n\t\t\t\tivalues += 2;\n\t\t\t\tif( xmin !== xmin ) {\n\t\t\t\t\txmin = x;\n\t\t\t\t\txmax = x;\n\t\t\t\t\tymin = y;\n\t\t\t\t\tymax = y;\n\t\t\t\t} else {\n\t\t\t\t\txmin = Math.min( xmin, x );\n\t\t\t\t\txmax = Math.max( xmax, x );\n\t\t\t\t\tymin = Math.min( ymin, y );\n\t\t\t\t\tymax = Math.max( ymax, y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( values.length !== ivalues ) {\n\t\t\tvalues.length = ivalues;\n\t\t}\n\n\t\txcoordinate.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.mapAll( values, 0, ivalues, 2, 1 );\n\t\txcoordinate.transform.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.transform.mapAll( values, 0, ivalues, 2, 1 );\n\n\t\tif( xmin !== xmin ) {\n\t\t\txmin = 0;\n\t\t\txmax = 0;\n\t\t\tymin = 0;\n\t\t\tymax = 0;\n\t\t}\n\n\t\txmin = xcoordinate.transform.map( xcoordinate.map( xmin ) );\n\t\txmax = xcoordinate.transform.map( xcoordinate.map( xmax ) );\n\t\tymin = ycoordinate.transform.map( ycoordinate.map( ymin ) );\n\t\tymax = ycoordinate.transform.map( ycoordinate.map( ymax ) );\n\n\t\tconst sx = Math.abs( xmax - xmin );\n\t\tconst sy = Math.abs( ymax - ymin );\n\t\tconst cx = ( xmin + xmax ) * 0.5;\n\t\tconst cy = ( ymin + ymax ) * 0.5;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tvalues[ i + 0 ] -= cx;\n\t\t\tvalues[ i + 1 ] -= cy;\n\t\t}\n\t\tline.points.set( values );\n\t\tline.size.set( sx, sy );\n\t\tline.transform.position.set( cx, cy );\n\t\tDApplications.update( line );\n\t}\n\n\tprotected updateRegion(): void {\n\t\tconst pointId = this._pointId;\n\t\tif( this._regionPointId !== pointId ) {\n\t\t\tthis._regionPointId = pointId;\n\n\t\t\tconst points = this._points;\n\t\t\tconst domain = this._domain;\n\t\t\tconst range = this._range;\n\t\t\tdomain.clear();\n\t\t\trange.clear();\n\t\t\tif( points != null ) {\n\t\t\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\t\t\tconst xraw = points[ i ];\n\t\t\t\t\tif( xraw != null ) {\n\t\t\t\t\t\tdomain.add( xraw, xraw );\n\t\t\t\t\t}\n\t\t\t\t\tconst yraw = points[ i + 1 ];\n\t\t\t\t\tif( yraw != null ) {\n\t\t\t\t\t\trange.add( yraw, yraw );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\n\t\tthis._points.length = 0;\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLineOfAny.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLineOfAny.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, null, this.calcHitPointTestRange, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPointTestRange(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tthreshold: number,\n\t\tvalues: number[],\n\t\tresult: [ number, number ]\n\t): [ number, number ] {\n\t\tconst to = toCeilingIndex( values, x + ax, 2, 0 );\n\t\tlet from = 0;\n\t\tfor( let i = to - 1, iv = i << 1; 0 <= i; i -= 1, iv -= 2 ) {\n\t\t\tif( values[ iv ] <= x - ax ) {\n\t\t\t\tfrom = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tresult[ 0 ] = from;\n\t\tresult[ 1 ] = from !== to ? to : Math.min( values.length << 1, to + 1 );\n\t\treturn result;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tpx: number, py: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tconst shape = result.shape as EShapeLineOfCircles;\n\t\tif( shape.containsPointAbs( x, y, ax, ay, px, py ) ) {\n\t\t\tconst position = shape.transform.position;\n\t\t\tresult.x = result.p0x = result.p1x = position.x + px;\n\t\t\tresult.y = result.p0y = result.p1y = position.y + py;\n\t\t\tresult.t = threshold;\n\t\t\tresult.index = index;\n\t\t\tconst dx = x - px;\n\t\t\tconst dy = y - py;\n\t\t\tresult.distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfCircles } from \"./shape/variant/e-shape-line-of-circles\";\n\n/**\n * A series represents a line of circles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfCircles extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfCircles();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfRectangleRoundeds } from \"./shape/variant/e-shape-line-of-rectangle-roundeds\";\n\n/**\n * A series represents a line of rounded rectangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfRectangleRoundeds extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfRectangleRoundeds();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfRectangles } from \"./shape/variant/e-shape-line-of-rectangles\";\n\n/**\n * A series represents a line of rectangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfRectangles extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfRectangles();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfTriangleRoundeds } from \"./shape/variant/e-shape-line-of-triangle-roundeds\";\n\n/**\n * A series represents a line of rounded triangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfTriangleRoundeds extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfTriangleRoundeds();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfTriangles } from \"./shape/variant/e-shape-line-of-triangles\";\n\n/**\n * A series represents a line of triangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfTriangles extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfTriangles();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { DChartSeriesStrokeComputedImpl } from \"./d-chart-series-stroke-computed-impl\";\nimport { EShapeLine } from \"./shape/variant/e-shape-line\";\nimport { toCeilingIndex } from \"./util/to-ceiling-index\";\n\n/**\n * {@link DChartSeriesLine} options.\n */\nexport interface DChartSeriesLineOptions extends DChartSeriesBaseOptions {\n\tpoints?: Array<number | null>;\n\tstroke?: DChartSeriesStrokeComputedOptions;\n}\n\n/**\n * A series represents a polyline.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLine extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\tprotected _line: EShapeLine | null;\n\tprotected _lineStrokeOptions?: DChartSeriesStrokeComputedOptions;\n\tprotected _points: Array<number | null>;\n\tprotected _pointId: number;\n\tprotected _pointIdUpdated: number;\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\n\tconstructor( options?: DChartSeriesLineOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._lineStrokeOptions = options && options.stroke;\n\t\tthis._points = (options && options.points) || [];\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tconst stroke = this._stroke = DChartSeriesStrokeComputedImpl.from( container, index, this._lineStrokeOptions );\n\t\t\tline = this._line = new EShapeLine([], [], stroke.width, stroke.style);\n\t\t\tline.stroke.copy( stroke );\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLine | null {\n\t\treturn this._line;\n\t}\n\n\tget points(): Array<number | null> {\n\t\treturn this._points;\n\t}\n\n\tset points( points: Array<number | null> ) {\n\t\tthis._points = points;\n\t\tthis._pointId += 1;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._pointId += 1;\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst pointId = this._pointId;\n\t\t\t\tconst isPointChanged = ( pointId !== this._pointIdUpdated );\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tif( isPointChanged || isCoordinateChanged ) {\n\t\t\t\t\tthis._pointIdUpdated = pointId;\n\t\t\t\t\tthis.updateLine( line, coordinateX, coordinateY );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLine,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst segments = line.points.segments;\n\t\tconst valuesLength = values.length;\n\t\tconst segmentsLength = segments.length;\n\t\tlet ivalues = 0;\n\t\tlet isegments = 0;\n\t\tconst points = this._points;\n\t\tlet xmin = NaN;\n\t\tlet xmax = NaN;\n\t\tlet ymin = NaN;\n\t\tlet ymax = NaN;\n\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\tconst x = points[ i ];\n\t\t\tconst y = points[ i + 1 ];\n\t\t\tif( x != null && y != null ) {\n\t\t\t\tif( ivalues < valuesLength ) {\n\t\t\t\t\tvalues[ ivalues ] = x;\n\t\t\t\t\tvalues[ ivalues + 1 ] = y;\n\t\t\t\t} else {\n\t\t\t\t\tvalues.push( x, y );\n\t\t\t\t}\n\t\t\t\tivalues += 2;\n\t\t\t\tif( xmin !== xmin ) {\n\t\t\t\t\txmin = x;\n\t\t\t\t\txmax = x;\n\t\t\t\t\tymin = y;\n\t\t\t\t\tymax = y;\n\t\t\t\t} else {\n\t\t\t\t\txmin = Math.min( xmin, x );\n\t\t\t\t\txmax = Math.max( xmax, x );\n\t\t\t\t\tymin = Math.min( ymin, y );\n\t\t\t\t\tymax = Math.max( ymax, y );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst segment = (i >> 1) - isegments;\n\t\t\t\tif( isegments < segmentsLength ) {\n\t\t\t\t\tsegments[ isegments ] = segment;\n\t\t\t\t} else {\n\t\t\t\t\tsegments.push( segment );\n\t\t\t\t}\n\t\t\t\tisegments += 1;\n\t\t\t}\n\t\t}\n\t\tif( values.length !== ivalues ) {\n\t\t\tvalues.length = ivalues;\n\t\t}\n\t\tif( segments.length !== isegments ) {\n\t\t\tsegments.length = isegments;\n\t\t}\n\n\t\txcoordinate.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.mapAll( values, 0, ivalues, 2, 1 );\n\t\txcoordinate.transform.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.transform.mapAll( values, 0, ivalues, 2, 1 );\n\n\t\tif( xmin !== xmin ) {\n\t\t\txmin = 0;\n\t\t\txmax = 0;\n\t\t\tymin = 0;\n\t\t\tymax = 0;\n\t\t}\n\n\t\txmin = xcoordinate.transform.map( xcoordinate.map( xmin ) );\n\t\txmax = xcoordinate.transform.map( xcoordinate.map( xmax ) );\n\t\tymin = ycoordinate.transform.map( ycoordinate.map( ymin ) );\n\t\tymax = ycoordinate.transform.map( ycoordinate.map( ymax ) );\n\n\t\tconst sx = Math.abs( xmax - xmin );\n\t\tconst sy = Math.abs( ymax - ymin );\n\t\tconst cx = ( xmin + xmax ) * 0.5;\n\t\tconst cy = ( ymin + ymax ) * 0.5;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tvalues[ i + 0 ] -= cx;\n\t\t\tvalues[ i + 1 ] -= cy;\n\t\t}\n\t\tline.points.set( values, segments );\n\t\tline.size.set( sx, sy );\n\t\tline.transform.position.set( cx, cy );\n\t\tDApplications.update( line );\n\t}\n\n\tprotected updateRegion(): void {\n\t\tconst pointId = this._pointId;\n\t\tif( this._regionPointId !== pointId ) {\n\t\t\tthis._regionPointId = pointId;\n\n\t\t\tconst points = this._points;\n\t\t\tconst domain = this._domain;\n\t\t\tconst range = this._range;\n\t\t\tdomain.clear();\n\t\t\trange.clear();\n\t\t\tif( points != null ) {\n\t\t\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\t\t\tconst xraw = points[ i ];\n\t\t\t\t\tif( xraw != null ) {\n\t\t\t\t\t\tdomain.add( xraw, xraw );\n\t\t\t\t\t}\n\t\t\t\t\tconst yraw = points[ i + 1 ];\n\t\t\t\t\tif( yraw != null ) {\n\t\t\t\t\t\trange.add( yraw, yraw );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\n\t\tthis._points.length = 0;\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLine.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLine.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, this.toThreshold, this.calcHitPointTestRange, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected toThreshold( this: unknown, strokeWidth: number, strokeScale: number ): number {\n\t\treturn +Infinity;\n\t}\n\n\tcalcHitPointTestRange(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tthreshold: number,\n\t\tvalues: number[],\n\t\tresult: [ number, number ]\n\t): [ number, number ] {\n\t\tconst index = toCeilingIndex( values, x, 2, 0 );\n\t\tresult[ 0 ] = Math.max( 0, index - 1 );\n\t\tresult[ 1 ] = index;\n\t\treturn result;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tif( p0x <= x && x < p1x ) {\n\t\t\tconst l = p1x - p0x;\n\t\t\tif( 0.0001 < Math.abs( l ) ) {\n\t\t\t\tconst t = (x - p0x) / l;\n\t\t\t\tconst p2x = x;\n\t\t\t\tconst p2y = p0y + t * (p1y - p0y);\n\t\t\t\tconst distance = Math.abs(p2y - y);\n\t\t\t\tif( distance < threshold ) {\n\t\t\t\t\tconst position = result.shape!.transform.position;\n\t\t\t\t\tconst px = position.x;\n\t\t\t\t\tconst py = position.y;\n\t\t\t\t\tresult.x = px + p2x;\n\t\t\t\t\tresult.y = py + p2y;\n\t\t\t\t\tresult.p0x = px + p0x;\n\t\t\t\t\tresult.p0y = py + p0y;\n\t\t\t\t\tresult.p1x = px + p1x;\n\t\t\t\t\tresult.p1y = py + p1y;\n\t\t\t\t\tresult.t = t;\n\t\t\t\t\tresult.index = index;\n\t\t\t\t\tresult.distance = distance;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","import {\n\tDChartSeriesLinearParameters,\n\tDChartSeriesLinearParametersOptions\n} from \"./d-chart-series-linear-parameters\";\n\nexport class DChartSeriesExpressionParametersImpl implements DChartSeriesLinearParameters {\n\tprotected _id: number;\n\tprotected _idUpdated: number;\n\tprotected _a: number;\n\tprotected _b: number;\n\tprotected _x0: number;\n\tprotected _y0: number;\n\n\tconstructor( a: number, b: number, x0: number, y0: number ) {\n\t\tthis._id = 0;\n\t\tthis._idUpdated = NaN;\n\t\tthis._a = a;\n\t\tthis._b = b;\n\t\tthis._x0 = x0;\n\t\tthis._y0 = y0;\n\t}\n\n\tget a(): number {\n\t\treturn this._a;\n\t}\n\n\tset a( a: number ) {\n\t\tif( this._a !== a ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._a = a;\n\t\t}\n\t}\n\n\tget b(): number {\n\t\treturn this._b;\n\t}\n\n\tset b( b: number ) {\n\t\tif( this._b !== b ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._b = b;\n\t\t}\n\t}\n\n\tget x0(): number {\n\t\treturn this._x0;\n\t}\n\n\tset x0( x0: number ) {\n\t\tif( this._x0 !== x0 ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._x0 = x0;\n\t\t}\n\t}\n\n\tget y0(): number {\n\t\treturn this._y0;\n\t}\n\n\tset y0( y0: number ) {\n\t\tif( this._y0 !== y0 ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._y0 = y0;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n\n\tisDirty(): boolean {\n\t\treturn this._id !== this._idUpdated;\n\t}\n\n\ttoClean(): void {\n\t\tthis._idUpdated = this._id;\n\t}\n\n\tstatic from( options?: DChartSeriesLinearParametersOptions ): DChartSeriesExpressionParametersImpl {\n\t\tif( options ) {\n\t\t\treturn new DChartSeriesExpressionParametersImpl(\n\t\t\t\t( options.a != null ? options.a : 1 ),\n\t\t\t\t( options.b != null ? options.b : 1 ),\n\t\t\t\t( options.x0 != null ? options.x0 : 0 ),\n\t\t\t\t( options.y0 != null ? options.y0 : 0 )\n\t\t\t);\n\t\t}\n\t\treturn new DChartSeriesExpressionParametersImpl(\n\t\t\t1,\n\t\t\t1,\n\t\t\t0,\n\t\t\t0\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesLinearParameters, DChartSeriesLinearParametersOptions } from \"./d-chart-series-linear-parameters\";\nimport { DChartSeriesExpressionParametersImpl } from \"./d-chart-series-linear-parameters-impl\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { DChartSeriesStrokeComputedImpl } from \"./d-chart-series-stroke-computed-impl\";\nimport { EShapeLine } from \"./shape/variant/e-shape-line\";\n\n/**\n * {@link DChartSeriesLinear} options.\n */\nexport interface DChartSeriesLinearOptions extends DChartSeriesLinearParametersOptions, DChartSeriesBaseOptions {\n\tstroke?: DChartSeriesStrokeComputedOptions;\n}\n\n/**\n * A series represents a linear equation `a (x - x0) === b (y - y0)`.\n */\nexport class DChartSeriesLinear extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\tprotected _line: EShapeLine | null;\n\tprotected _lineStrokeOptions?: DChartSeriesStrokeComputedOptions;\n\tprotected _plotAreaSizeXUpdated: number;\n\tprotected _plotAreaSizeYUpdated: number;\n\tprotected _parameters: DChartSeriesExpressionParametersImpl;\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\n\tconstructor( options?: DChartSeriesLinearOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._lineStrokeOptions = options && options.stroke;\n\t\tthis._plotAreaSizeXUpdated = NaN;\n\t\tthis._plotAreaSizeYUpdated = NaN;\n\t\tthis._parameters = DChartSeriesExpressionParametersImpl.from( options );\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tconst stroke = this._stroke = DChartSeriesStrokeComputedImpl.from( container, index, this._lineStrokeOptions );\n\t\t\tline = this._line = new EShapeLine([], [], stroke.width, stroke.style);\n\t\t\tline.stroke.color = stroke.color;\n\t\t\tline.stroke.alpha = stroke.alpha;\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._parameters.toDirty();\n\t\tthis._plotAreaSizeXUpdated = NaN;\n\t\tthis._plotAreaSizeYUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLine | null {\n\t\treturn this._line;\n\t}\n\n\tget parameters(): DChartSeriesLinearParameters {\n\t\treturn this._parameters;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._parameters.toDirty();\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tconst container = this._container;\n\t\tif( line && container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\tconst plotAreaHeight = plotArea.height;\n\n\t\t\t\tconst parameters = this._parameters;\n\t\t\t\tconst isParametersChanged = parameters.isDirty();\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tconst isPlotAreaSizeChagned = ( plotAreaWidth !== this._plotAreaSizeXUpdated ||\n\t\t\t\t\tplotAreaHeight !== this._plotAreaSizeYUpdated );\n\t\t\t\tif( isParametersChanged || isCoordinateChanged || isPlotAreaSizeChagned ) {\n\t\t\t\t\tparameters.toClean();\n\t\t\t\t\tthis._plotAreaSizeXUpdated = plotAreaWidth;\n\t\t\t\t\tthis._plotAreaSizeYUpdated = plotAreaHeight;\n\t\t\t\t\tthis.updateLine( line, coordinateX, coordinateY, plotAreaWidth, plotAreaHeight );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLine,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tplotAreaSizeX: number,\n\t\tplotAreaSizeY: number\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst segments = line.points.segments;\n\n\t\tconst parameters = this._parameters;\n\t\tconst a = parameters.a;\n\t\tconst b = parameters.b;\n\t\tconst x0 = parameters.x0;\n\t\tconst y0 = parameters.y0;\n\t\tconst aabs = Math.abs( a );\n\t\tconst babs = Math.abs( b );\n\n\t\tlet p0x = NaN;\n\t\tlet p0y = NaN;\n\t\tlet p1x = NaN;\n\t\tlet p1y = NaN;\n\n\t\tconst threshold = 0.00001;\n\t\tif( babs <= aabs ) {\n\t\t\tconst xfrom0 = xcoordinate.unmap(\n\t\t\t\txcoordinate.transform.unmap( 0 )\n\t\t\t);\n\t\t\tconst xto0 = xcoordinate.unmap(\n\t\t\t\txcoordinate.transform.unmap( plotAreaSizeX )\n\t\t\t);\n\t\t\tp0x = Math.min( xfrom0, xto0 );\n\t\t\tp1x = Math.max( xfrom0, xto0 );\n\n\t\t\tif( threshold < aabs ) {\n\t\t\t\tconst yfrom = ycoordinate.unmap(\n\t\t\t\t\tycoordinate.transform.unmap( 0 )\n\t\t\t\t);\n\t\t\t\tconst yto = ycoordinate.unmap(\n\t\t\t\t\tycoordinate.transform.unmap( plotAreaSizeY )\n\t\t\t\t);\n\t\t\t\tconst xfrom1 = b * (yfrom - y0) / a + x0;\n\t\t\t\tconst xto1 = b * (yto - y0) / a + x0;\n\t\t\t\tconst p2x = Math.min( xfrom1, xto1 );\n\t\t\t\tconst p3x = Math.max( xfrom1, xto1 );\n\n\t\t\t\tif( p0x < p2x ) {\n\t\t\t\t\tp0x = p2x;\n\t\t\t\t}\n\n\t\t\t\tif( p3x < p1x ) {\n\t\t\t\t\tp1x = p3x;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tp0y = a * (p0x - x0) + b * y0;\n\t\t\tp1y = a * (p1x - x0) + b * y0;\n\t\t} else {\n\t\t\tconst yfrom0 = ycoordinate.unmap(\n\t\t\t\tycoordinate.transform.unmap( 0 )\n\t\t\t);\n\t\t\tconst yto0 = ycoordinate.unmap(\n\t\t\t\tycoordinate.transform.unmap( plotAreaSizeY )\n\t\t\t);\n\t\t\tp0y = Math.min( yfrom0, yto0 );\n\t\t\tp1y = Math.max( yfrom0, yto0 );\n\n\t\t\tif( threshold < babs ) {\n\t\t\t\tconst xfrom = xcoordinate.unmap(\n\t\t\t\t\txcoordinate.transform.unmap( 0 )\n\t\t\t\t);\n\t\t\t\tconst xto = xcoordinate.unmap(\n\t\t\t\t\txcoordinate.transform.unmap( plotAreaSizeX )\n\t\t\t\t);\n\t\t\t\tconst yfrom1 = a * (xfrom - x0) / b + y0;\n\t\t\t\tconst yto1 = a * (xto - x0) / b + y0;\n\t\t\t\tconst p2y = Math.min( yfrom1, yto1 );\n\t\t\t\tconst p3y = Math.max( yfrom1, yto1 );\n\n\t\t\t\tif( p0y < p2y ) {\n\t\t\t\t\tp0y = p2y;\n\t\t\t\t}\n\n\t\t\t\tif( p3y < p1y ) {\n\t\t\t\t\tp1y = p3y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tp0x = b * (p0y - y0) + a * x0;\n\t\t\tp1x = b * (p1y - y0) + a * x0;\n\t\t}\n\n\t\tp0x = xcoordinate.transform.map( xcoordinate.map( p0x ) );\n\t\tp0y = ycoordinate.transform.map( ycoordinate.map( p0y ) );\n\t\tp1x = xcoordinate.transform.map( xcoordinate.map( p1x ) );\n\t\tp1y = ycoordinate.transform.map( ycoordinate.map( p1y ) );\n\n\t\tconst cx = ( p0x + p1x ) * 0.5;\n\t\tconst cy = ( p0y + p1y ) * 0.5;\n\t\tconst sx = Math.abs( p1x - p0x );\n\t\tconst sy = Math.abs( p1y - p0y );\n\n\t\tp0x -= cx;\n\t\tp0y -= cy;\n\t\tp1x -= cx;\n\t\tp1y -= cy;\n\n\t\tif( values.length !== 4 ) {\n\t\t\tvalues.length = 0;\n\t\t\tvalues.push( p0x, p0y, p1x, p1y );\n\t\t} else {\n\t\t\tvalues[ 0 ] = p0x;\n\t\t\tvalues[ 1 ] = p0y;\n\t\t\tvalues[ 2 ] = p1x;\n\t\t\tvalues[ 3 ] = p1y;\n\t\t}\n\t\tif( segments.length !== 0 ) {\n\t\t\tsegments.length = 0;\n\t\t}\n\t\tline.points.set( values, segments );\n\t\tline.size.set( sx, sy );\n\t\tline.transform.position.set( cx, cy );\n\t\tDApplications.update( line );\n\t}\n\n\tprotected updateRegion(): void {\n\t\t// DO NOTHING\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLinear.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLinear.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, this.toThreshold, null, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected toThreshold( this: unknown, strokeWidth: number, strokeScale: number ): number {\n\t\treturn +Infinity;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tif( p0x <= x && x < p1x ) {\n\t\t\tconst l = p1x - p0x;\n\t\t\tif( 0.0001 < Math.abs( l ) ) {\n\t\t\t\tconst t = (x - p0x) / l;\n\t\t\t\tconst p2x = x;\n\t\t\t\tconst p2y = p0y + t * (p1y - p0y);\n\t\t\t\tconst distance = Math.abs(p2y - y);\n\t\t\t\tif( distance < threshold ) {\n\t\t\t\t\tconst position = result.shape!.transform.position;\n\t\t\t\t\tconst px = position.x;\n\t\t\t\t\tconst py = position.y;\n\t\t\t\t\tresult.x = result.p0x = result.p1x = px + p2x;\n\t\t\t\t\tresult.y = result.p0y = result.p1y = py + p2y;\n\t\t\t\t\tresult.t = t;\n\t\t\t\t\tresult.index = index;\n\t\t\t\t\tresult.distance = distance;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tconst isActive = DBaseStates.isActive( newState );\n\t\tconst wasActive = DBaseStates.isActive( oldState );\n\t\tif( isActive !== wasActive ) {\n\t\t\tconst line = this._line;\n\t\t\tconst stroke = this._stroke;\n\t\t\tif( line && stroke ) {\n\t\t\t\tline.stroke.width = stroke.width * ( isActive ? 2 : 1 );\n\t\t\t}\n\t\t}\n\t\tsuper.onStateChange( newState, oldState );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartSelectionStyle } from \"./d-chart-selection\";\nimport {\n\tDChartSelectionShape, DChartSelectionShapeOptions,\n\tDThemeChartSelectionShape\n} from \"./d-chart-selection-shape\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isString } from \"./util/is-string\";\n\nexport abstract class DChartSelectionShapeBase implements DChartSelectionShape {\n\tprotected _isEnabled: boolean;\n\tprotected _shape?: EShape;\n\tprotected _style: DChartSelectionStyle;\n\tprotected _state: DBaseState;\n\tprotected _theme: DThemeChartSelectionShape;\n\n\tconstructor( options?: DChartSelectionShapeOptions ) {\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tconst state = ( options && options.state != null ? options.state : DBaseState.HOVERED );\n\t\tthis._state = state;\n\t\tthis._isEnabled = ( options && options.enable != null ? options.enable : theme.isEnabled( state ) );\n\t\tthis._shape = options && options.shape;\n\t\tthis._style = (options && options.style) || this.setStyle;\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst shape = this._shape = (this._shape || this.newShape( this._theme ));\n\t\t\tshape.attach( container.plotArea.axis.container );\n\t\t\tshape.visible = false;\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.detach();\n\t\t}\n\t}\n\n\tprotected newShape( theme: DThemeChartSelectionShape ): EShape {\n\t\treturn theme.newShape( this._state );\n\t}\n\n\tset( container: DChartSeriesContainer, mappedPosition: IPoint, series: DChartSeries ): void {\n\t\tthis.update( container, mappedPosition );\n\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tthis._style( shape, series );\n\t\t}\n\t}\n\n\tprotected setStyle( this: unknown, shape: EShape, series: DChartSeries ): void {\n\t\tconst seriesShape = series.shape;\n\t\tif( seriesShape ) {\n\t\t\tshape.stroke.color = seriesShape.stroke.color;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.visible = false;\n\t\t}\n\t}\n\n\tabstract update( container: DChartSeriesContainer, mappedPosition: IPoint ): void;\n\n\tprotected toTheme( options?: DChartSelectionShapeOptions ): DThemeChartSelectionShape {\n\t\tconst theme = ( options && options.theme );\n\t\tif( isString( theme ) ) {\n\t\t\treturn this.getTheme( theme );\n\t\t} else if( theme != null ) {\n\t\t\treturn theme;\n\t\t} else {\n\t\t\treturn this.getTheme( this.getType() );\n\t\t}\n\t}\n\n\tprotected getTheme( type: string ): DThemeChartSelectionShape {\n\t\treturn DThemes.getInstance().get( type );\n\t}\n\n\tprotected abstract getType(): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineX extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tconst mappedX = mappedPosition.x;\n\t\t\tconst height = container.plotArea.height;\n\t\t\tshape.transform.position.set( mappedX, height * 0.5 );\n\t\t\tshape.size.set( 0, height );\n\t\t\tshape.visible = this.isVisible( container, mappedX );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedX: number ): boolean {\n\t\treturn ( 0 <= mappedX && mappedX <= container.plotArea.width );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionGridlineX\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineY extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tconst mappedY = mappedPosition.y;\n\t\t\tconst width = container.plotArea.width;\n\t\t\tshape.transform.position.set( width * 0.5, mappedY );\n\t\t\tshape.size.set( width, 0 );\n\t\t\tshape.visible = this.isVisible( container, mappedY );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedY: number ): boolean {\n\t\treturn ( 0 <= mappedY && mappedY <= container.plotArea.height );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionGridlineY\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport {\n\tDChartSelectionGridlineContainer, DChartSelectionGridlineContainerOptions\n} from \"./d-chart-selection-gridline-container\";\nimport { DChartSelectionGridlineX } from \"./d-chart-selection-gridline-x\";\nimport { DChartSelectionGridlineY } from \"./d-chart-selection-gridline-y\";\nimport { DChartSelectionShape } from \"./d-chart-selection-shape\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineContainerImpl implements DChartSelectionGridlineContainer {\n\tprotected _x: DChartSelectionShape;\n\tprotected _y: DChartSelectionShape;\n\n\tconstructor( options?: DChartSelectionGridlineContainerOptions ) {\n\t\tthis._x = new DChartSelectionGridlineX( options && options.x );\n\t\tthis._y = new DChartSelectionGridlineY( options && options.y );\n\t}\n\n\tget x(): DChartSelectionShape {\n\t\treturn this._x;\n\t}\n\n\tget y(): DChartSelectionShape {\n\t\treturn this._y;\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tthis._x.bind( container );\n\t\tthis._y.bind( container );\n\t}\n\n\tunbind(): void {\n\t\tthis._x.unbind();\n\t\tthis._y.unbind();\n\t}\n\n\tset( container: DChartSeriesContainer, mappedPosition: IPoint, series: DChartSeries ): void {\n\t\tthis._x.set( container, mappedPosition, series );\n\t\tthis._y.set( container, mappedPosition, series );\n\t}\n\n\tunset(): void {\n\t\tthis._x.unset();\n\t\tthis._y.unset();\n\t}\n\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tthis._x.update( container, mappedPosition );\n\t\tthis._y.update( container, mappedPosition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionMarker extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.transform.position.copyFrom( mappedPosition );\n\t\t\tshape.visible = this.isVisible( container, mappedPosition );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedPosition: IPoint ): boolean {\n\t\tconst x = mappedPosition.x;\n\t\tconst y = mappedPosition.y;\n\t\tconst plotArea = container.plotArea;\n\t\treturn ( 0 <= x && x <= plotArea.width && 0 <= y && y <= plotArea.height );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionMarker\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSelectionPoint } from \"./d-chart-selection\";\nimport { DChartSelectionGridlineContainer } from \"./d-chart-selection-gridline-container\";\nimport { DChartSelectionGridlineContainerImpl } from \"./d-chart-selection-gridline-container-impl\";\nimport { DChartSelectionMarker } from \"./d-chart-selection-marker\";\nimport { DChartSelectionSub, DChartSelectionSubOptions } from \"./d-chart-selection-sub\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport class DChartSelectionSubImpl extends utils.EventEmitter implements DChartSelectionSub {\n\tprotected _container: DChartSeriesContainer | null;\n\tprotected _isEnabled: boolean;\n\tprotected _series: DChartSeries | null;\n\tprotected _coordinateX: DChartCoordinate | null;\n\tprotected _coordinateY: DChartCoordinate | null;\n\tprotected _position: Point;\n\tprotected _point: DChartSelectionPoint;\n\tprotected _work: Point;\n\tprotected _gridline: DChartSelectionGridlineContainer;\n\tprotected _marker: DChartSelectionMarker;\n\tprotected _state: DBaseState;\n\n\tconstructor( options: DChartSelectionSubOptions ) {\n\t\tsuper();\n\n\t\tthis._container = null;\n\t\tthis._series = null;\n\t\tthis._isEnabled = ( options.enable != null ? options.enable : true );\n\t\tthis._gridline = new DChartSelectionGridlineContainerImpl( options.gridline );\n\t\tthis._marker = new DChartSelectionMarker( options.marker );\n\t\tthis._state = ( options.state != null ? options.state : DBaseState.HOVERED );\n\t\tthis._coordinateX = null;\n\t\tthis._coordinateY = null;\n\t\tthis._position = new Point();\n\t\tthis._point = ( options.point != null ? options.point : DChartSelectionPoint.CLOSER );\n\t\tthis._work = new Point();\n\n\t\t// Events\n\t\tconst on = options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis._container = container;\n\t\t\tthis._gridline.bind( container );\n\t\t\tthis._marker.bind( container );\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\tthis._marker.unbind();\n\t\tthis._gridline.unbind();\n\t\tthis._container = null;\n\t\tthis._coordinateX = null;\n\t\tthis._coordinateY = null;\n\t}\n\n\tget series(): DChartSeries | null {\n\t\treturn this._series;\n\t}\n\n\tget position(): Point {\n\t\treturn this._position;\n\t}\n\n\tget gridline(): DChartSelectionGridlineContainer {\n\t\treturn this._gridline;\n\t}\n\n\tget marker(): DChartSelectionMarker {\n\t\treturn this._marker;\n\t}\n\n\tset( series: DChartSeries, result: DChartSeriesHitResult | DChartSelectionSub ): void {\n\t\tconst container = this._container;\n\t\tconst coordinateX = this._coordinateX = series.coordinate.x;\n\t\tconst coordinateY = this._coordinateY = series.coordinate.y;\n\t\tif( container && coordinateX && coordinateY ) {\n\t\t\tconst transform = container.plotArea.container.localTransform;\n\t\t\tconst position = this._position;\n\t\t\tconst work = this._work;\n\t\t\tif( result instanceof DChartSeriesHitResult ) {\n\t\t\t\tlet x = result.x;\n\t\t\t\tlet y = result.y;\n\t\t\t\tswitch( this._point ) {\n\t\t\t\tcase DChartSelectionPoint.PREVIOUS:\n\t\t\t\t\tx = result.p0x;\n\t\t\t\t\ty = result.p0y;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DChartSelectionPoint.NEXT:\n\t\t\t\t\tx = result.p1x;\n\t\t\t\t\ty = result.p1y;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DChartSelectionPoint.CLOSER:\n\t\t\t\t\tif( Math.abs( result.p0x - result.x ) < Math.abs( result.p1x - result.x ) ) {\n\t\t\t\t\t\tx = result.p0x;\n\t\t\t\t\t\ty = result.p0y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tx = result.p1x;\n\t\t\t\t\t\ty = result.p1y;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\twork.set( x, y );\n\t\t\t\ttransform.apply( work, work );\n\t\t\t\tposition.set(\n\t\t\t\t\tcoordinateX.unmap( coordinateX.transform.unmap( x ) ),\n\t\t\t\t\tcoordinateY.unmap( coordinateY.transform.unmap( y ) )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tposition.copyFrom( result.position );\n\t\t\t\twork.set(\n\t\t\t\t\tcoordinateX.transform.map( coordinateX.map( position.x ) ),\n\t\t\t\t\tcoordinateY.transform.map( coordinateY.map( position.y ) )\n\t\t\t\t);\n\t\t\t\ttransform.apply( work, work );\n\t\t\t}\n\n\t\t\tthis._gridline.set( container, work, series );\n\t\t\tthis._marker.set( container, work, series );\n\n\t\t\tDApplications.update( container.plotArea );\n\t\t}\n\n\t\tconst oldSeries = this._series;\n\t\tif( oldSeries !== series ) {\n\t\t\tconst state = this._state;\n\t\t\tif( oldSeries ) {\n\t\t\t\toldSeries.setState( state, false );\n\t\t\t}\n\n\t\t\tthis._series = series;\n\t\t\tseries.setState( state, true );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tprotected setStyle( this: unknown, shape: EShape, series: DChartSeries ): void {\n\t\tconst seriesShape = series.shape;\n\t\tif( seriesShape ) {\n\t\t\tshape.stroke.color = seriesShape.stroke.color;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tconst series = this._series;\n\t\tif( series ) {\n\t\t\tthis._series = null;\n\t\t\tthis._coordinateX = null;\n\t\t\tthis._coordinateY = null;\n\n\t\t\tseries.setState( this._state, false );\n\n\t\t\tthis._gridline.unset();\n\t\t\tthis._marker.unset();\n\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tconst container = this._container;\n\t\tconst coordinateX = this._coordinateX;\n\t\tconst coordinateY = this._coordinateY;\n\t\tif( container && coordinateX && coordinateY ) {\n\t\t\tconst position = this._position;\n\t\t\tconst work = this._work;\n\t\t\twork.set(\n\t\t\t\tcoordinateX.transform.map( coordinateX.map( position.x ) ),\n\t\t\t\tcoordinateY.transform.map( coordinateY.map( position.y ) )\n\t\t\t);\n\t\t\tcontainer.plotArea.container.localTransform.apply( work, work );\n\n\t\t\tthis._gridline.update( container, work );\n\t\t\tthis._marker.update( container, work );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\n\nexport enum DListSelectionMode {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\nexport interface DListSelectionOnOptions {\n\t[ name: string ]: Function;\n}\n\nexport interface DListSelectionOptions {\n\tmode?: DListSelectionMode;\n\ton?: DListSelectionOnOptions;\n}\n\nexport class DListSelection extends utils.EventEmitter {\n\tprotected _content: Container;\n\tprotected _isDirty: boolean;\n\tprotected _indices: number[];\n\tprotected _mode: DListSelectionMode;\n\n\tconstructor( content: Container, options?: DListSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._isDirty = false;\n\t\tthis._indices = [];\n\t\tthis._mode = ( options && options.mode != null ? options.mode : DListSelectionMode.SINGLE );\n\n\t\t// Events\n\t\tconst on = options && options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate() {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst indices = this._indices;\n\t\t\tindices.length = 0;\n\t\t\tconst content = this._content;\n\t\t\tconst children = content.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tif( child.isActive() ) {\n\t\t\t\t\t\tindices.push( i );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsize() {\n\t\tthis.update();\n\t\treturn this._indices.length;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this.size() <= 0;\n\t}\n\n\tfirst<T>(): T | null {\n\t\treturn this.get( 0 );\n\t}\n\n\tget<T>( index: number ): T | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\tconst content = this._content;\n\t\t\tconst child = content.children[ indices[ index ] ];\n\t\t\tif( child != null ) {\n\t\t\t\treturn child as any;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetIndex( index: number ): number | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\treturn indices[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.length ) {\n\t\t\tconst content = this._content;\n\t\t\tconst children = content.children;\n\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.setActive( false );\n\t\t\t\t}\n\t\t\t}\n\t\t\tindices.length = 0;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tadd<T extends DBase<any, any>>( target: T ) {\n\t\tconst mode = this._mode;\n\t\tconst content = this._content;\n\t\tif( mode === DListSelectionMode.SINGLE ) {\n\t\t\tif( ! target.isActive() ) {\n\t\t\t\tthis.update();\n\n\t\t\t\t// Remove the existing\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst children = content.children;\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\t\tchild.setActive( false );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tindices.length = 0;\n\n\t\t\t\t// Add a new child\n\t\t\t\tindices.push( content.getChildIndex( target ) );\n\t\t\t\ttarget.setActive( true );\n\n\t\t\t\t// Event\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t} else if( mode === DListSelectionMode.MULTIPLE ) {\n\t\t\tif( ! target.isActive() ) {\n\t\t\t\tif( this._isDirty ) {\n\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t} else {\n\t\t\t\t\t// Find an insertion position\n\t\t\t\t\tconst indices = this._indices;\n\t\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if( targetIndex < index ) {\n\t\t\t\t\t\t\tindices.splice( i, 0, targetIndex );\n\t\t\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Push\n\t\t\t\t\tindices.push( targetIndex );\n\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove<T extends DBase<any, any>>( target: T ) {\n\t\tif( ! target.isActive() ) {\n\t\t\tif( this._isDirty ) {\n\t\t\t\ttarget.setActive( false );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else {\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst content = this._content;\n\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\tindices.splice( i, 1 );\n\t\t\t\t\t\ttarget.setActive( false );\n\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, utils } from \"pixi.js\";\nimport { DBaseOnOptions } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartSelection, DChartSelectionPoint } from \"./d-chart-selection\";\nimport { DChartSelectionSub, DChartSelectionSubOptions } from \"./d-chart-selection-sub\";\nimport { DChartSelectionSubImpl } from \"./d-chart-selection-sub-impl\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { isString } from \"./util/is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DChartSelectionSimpleOptions {\n\tselected?: DChartSelectionSubOptions;\n\thovered?: DChartSelectionSubOptions;\n\tpoint?: DChartSelectionPoint | (keyof typeof DChartSelectionPoint);\n\ton?: DBaseOnOptions;\n}\n\nexport class DChartSelectionSimple extends utils.EventEmitter implements DChartSelection {\n\tprotected static WORK_SELECT: DChartSeriesHitResult = new DChartSeriesHitResult();\n\n\tprotected _container: DChartSeriesContainer | null;\n\tprotected _selected: DChartSelectionSub;\n\tprotected _hovered: DChartSelectionSub;\n\n\tprotected _onClickBound!: ( e: interaction.InteractionEvent ) => void;\n\tprotected _onMoveBound!: ( e: interaction.InteractionEvent ) => void;\n\n\tconstructor( options?: DChartSelectionSimpleOptions ) {\n\t\tsuper();\n\n\t\tthis._container = null;\n\t\tconst point = ( options && options.point != null ?\n\t\t\t( isString( options.point ) ? DChartSelectionPoint[ options.point ] : options.point ) :\n\t\t\tDChartSelectionPoint.CLOSER\n\t\t);\n\n\t\tthis._selected = this.newSelected( point, options && options.selected );\n\t\tthis._hovered = this.newHovered( point, options && options.hovered );\n\n\t\t// Events\n\t\tif( options ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._onMoveBound = ( e: interaction.InteractionEvent ): void => {\n\t\t\tthis.onMove( e );\n\t\t};\n\n\t\tthis._onClickBound = ( e: interaction.InteractionEvent ): void => {\n\t\t\tthis.onClick( e );\n\t\t};\n\t}\n\n\tprotected newSelected(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions?: DChartSelectionSubOptions\n\t): DChartSelectionSub {\n\t\treturn new DChartSelectionSubImpl(\n\t\t\tthis.toSubOptions(\n\t\t\t\tpoint,\n\t\t\t\toptions,\n\t\t\t\tDBaseState.ACTIVE\n\t\t\t)\n\t\t);\n\t}\n\n\tprotected newHovered(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions?: DChartSelectionSubOptions\n\t): DChartSelectionSub {\n\t\treturn new DChartSelectionSubImpl(\n\t\t\tthis.toSubOptions(\n\t\t\t\tpoint,\n\t\t\t\toptions,\n\t\t\t\tDBaseState.HOVERED\n\t\t\t)\n\t\t);\n\t}\n\n\tprotected toSubOptions(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions: DChartSelectionSubOptions | undefined,\n\t\tstate: DBaseState\n\t): DChartSelectionSubOptions {\n\t\toptions = options || {};\n\n\t\tif( options.point == null ) {\n\t\t\toptions.point = point;\n\t\t}\n\n\t\tif( options.state == null ) {\n\t\t\toptions.state = state;\n\t\t}\n\n\t\tconst gridline = options.gridline || {};\n\t\tconst gridlineX = gridline.x || {};\n\t\tif( gridlineX.state == null ) {\n\t\t\tgridlineX.state = state;\n\t\t}\n\n\t\tconst gridlineY = gridline.y || {};\n\t\tif( gridlineY.state == null ) {\n\t\t\tgridlineY.state = state;\n\t\t}\n\n\t\tconst marker = options.marker || {};\n\t\tif( marker.state == null ) {\n\t\t\tmarker.state = state;\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tprotected onClick( e: interaction.InteractionEvent ): void {\n\t\tconst container = this._container;\n\t\tif( container && e.target === container.plotArea ) {\n\t\t\tconst hovered = this._hovered;\n\t\t\tconst series = hovered.series;\n\t\t\tconst selected = this._selected;\n\t\t\tif( series ) {\n\t\t\t\tselected.set( series, hovered );\n\t\t\t} else {\n\t\t\t\tselected.unset();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMove( e: interaction.InteractionEvent ): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst hovered = this._hovered;\n\t\t\tif( e.target === container.plotArea ) {\n\t\t\t\tconst result = DChartSelectionSimple.WORK_SELECT;\n\t\t\t\tconst series = container.calcHitPoint( e.data.global, result );\n\t\t\t\tif( series ) {\n\t\t\t\t\thovered.set( series, result );\n\t\t\t\t} else {\n\t\t\t\t\thovered.unset();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thovered.unset();\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tthis._container = container;\n\t\tthis._selected.bind( container );\n\t\tthis._hovered.bind( container );\n\t\tconst plotArea = container.plotArea;\n\t\tplotArea.on( UtilPointerEvent.move, this._onMoveBound );\n\t\tUtilPointerEvent.onClick( plotArea, this._onClickBound );\n\t}\n\n\tunbind(): void {\n\t\tconst container = this._container;\n\t\tthis._container = null;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tplotArea.off( UtilPointerEvent.move, this._onMoveBound );\n\t\t}\n\n\t\tthis._selected.unbind();\n\t\tthis._hovered.unbind();\n\t}\n\n\tget selected(): DChartSelectionSub {\n\t\treturn this._selected;\n\t}\n\n\tget hovered(): DChartSelectionSub {\n\t\treturn this._hovered;\n\t}\n\n\tupdate(): void {\n\t\tthis._selected.update();\n\t\tthis._hovered.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DChartPlotArea, DChartPlotAreaOptions} from \"./d-chart-plot-area\";\n\nexport interface DChartOptions<THEME extends DThemeChart> extends DBaseOptions<THEME> {\n\tplotArea: DChartPlotAreaOptions;\n}\n\nexport interface DThemeChart extends DThemeBase {\n}\n\nexport class DChart<\n\tTHEME extends DThemeChart = DThemeChart,\n\tOPTIONS extends DChartOptions<THEME> = DChartOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _plotArea!: DChartPlotArea;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst plotArea = new DChartPlotArea( this, options && options.plotArea );\n\t\tthis._plotArea = plotArea;\n\t\tthis.addChild( plotArea );\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChart\";\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._plotArea.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport abstract class DCommandCreate implements DCommand {\n\tabstract execute(): Promise<unknown> | boolean;\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandDelete implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().delete();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSaveAs implements DCommand {\n\tprotected _name: string;\n\n\tconstructor( name: string ) {\n\t\tthis._name = name;\n\t}\n\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().saveAs( this._name );\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSave implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().save();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DContentOptions extends DBaseOptions<DThemeContent> {\n\n}\n\nexport interface DThemeContent extends DThemeBase {\n\n}\n\nexport class DContent extends DBase<DThemeContent, DContentOptions> {\n\tprotected init( options?: DContentOptions ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ObservablePoint } from \"pixi.js\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingPointImpl extends ObservablePoint implements DMapTileMappingPoint {\n\tget lon(): number {\n\t\treturn this.x;\n\t}\n\n\tset lon( lon: number ) {\n\t\tthis.x = lon;\n\t}\n\n\tget lat(): number {\n\t\treturn this.y;\n\t}\n\n\tset lat( lat: number ) {\n\t\tthis.y = lat;\n\t}\n\n\ttoObject(): { lon: number, lat: number } {\n\t\treturn {\n\t\t\tlon: this.x,\n\t\t\tlat: this.y\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingPointImpl } from \"./d-diagram-canvas-mapping-point-impl\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingImpl implements DDiagramCanvasTileMapping {\n\tprotected _enable: boolean;\n\tprotected _from: DDiagramCanvasTileMappingPointImpl;\n\tprotected _to: DDiagramCanvasTileMappingPointImpl;\n\tprotected _cb: () => void;\n\n\tconstructor( cb: () => void, mapping?: DDiagramCanvasTileMapping );\n\tconstructor( cb: () => void, enable: boolean, lon0: number, lat0: number, lon1: number, lat1: number );\n\tconstructor(\n\t\tcb: () => void,\n\t\tmappingOrEnable?: DDiagramCanvasTileMapping | boolean,\n\t\tlon0?: number,\n\t\tlat0?: number,\n\t\tlon1?: number,\n\t\tlat1?: number\n\t) {\n\t\tthis._cb = cb;\n\t\tif( mappingOrEnable === true || mappingOrEnable === false ) {\n\t\t\tthis._enable = mappingOrEnable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, lon0, lat0 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, lon1, lat1 );\n\t\t} else if( mappingOrEnable != null ) {\n\t\t\tthis._enable = mappingOrEnable.enable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.from.lon, mappingOrEnable.from.lat );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.to.lon, mappingOrEnable.to.lat );\n\t\t} else {\n\t\t\tthis._enable = false;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, -180, +85.05112877980659 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, +180, -85.05112877980659 );\n\t\t}\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._cb();\n\t\t}\n\t}\n\n\tget from(): DMapTileMappingPoint {\n\t\treturn this._from;\n\t}\n\n\tget to(): DMapTileMappingPoint {\n\t\treturn this._to;\n\t}\n\n\tserialize(): DDiagramCanvasTileMapping {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tfrom: this._from.toObject(),\n\t\t\tto: this._to.toObject()\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingImpl } from \"./d-diagram-canvas-mapping-impl\";\nimport { DMapTilePyramid } from \"./d-map-tile-pyramid\";\n\nexport type DDiagramCanvasTilePyramidFactory = ( canvas: DDiagramCanvasBase<any, any> ) => DMapTilePyramid;\n\nexport interface DDiagramCanvasTileOptions {\n\tfactory?: DDiagramCanvasTilePyramidFactory;\n\tmapping?: DDiagramCanvasTileMapping;\n}\n\nexport class DDiagramCanvasTile {\n\tprotected _canvas: DDiagramCanvasBase<any, any>;\n\tprotected _pyramid?: DMapTilePyramid;\n\tprotected _factory?: DDiagramCanvasTilePyramidFactory;\n\tprotected _mapping: DDiagramCanvasTileMappingImpl;\n\n\tconstructor( canvas: DDiagramCanvasBase<any, any>, options?: DDiagramCanvasTileOptions ) {\n\t\tthis._canvas = canvas;\n\t\tthis._factory = options && options.factory;\n\t\tthis._mapping = new DDiagramCanvasTileMappingImpl((): void => {\n\t\t\tthis.onMappingChange();\n\t\t}, options && options.mapping );\n\t}\n\n\tinit(): void {\n\t\tthis.onMappingChange();\n\t}\n\n\tprotected onMappingChange(): void {\n\t\tconst factory = this._factory;\n\t\tif( factory ) {\n\t\t\tconst mapping = this._mapping;\n\t\t\tif( mapping.enable ) {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tpyramid.mapping = mapping;\n\t\t\t\t} else {\n\t\t\t\t\tthis._pyramid = factory( this._canvas ).fit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tthis._pyramid = undefined;\n\t\t\t\t\tpyramid.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget pyramid(): DMapTilePyramid | undefined {\n\t\treturn this._pyramid;\n\t}\n\n\tget factory(): DDiagramCanvasTilePyramidFactory | undefined {\n\t\treturn this._factory;\n\t}\n\n\tget mapping(): DDiagramCanvasTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tserialize(): { mapping: DDiagramCanvasTileMapping } {\n\t\treturn {\n\t\t\tmapping: this._mapping.serialize()\n\t\t};\n\t}\n\n\tdestroy(): void {\n\t\tconst pyramid = this._pyramid;\n\t\tif( pyramid != null ) {\n\t\t\tthis._pyramid = undefined;\n\t\t\tpyramid.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayer extends EShapeContainer {\n\treference: number;\n\n\tconstructor( name: string ) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.interactive = false;\n\t\tthis.reference = 0;\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tchildren[ i ].destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tserialize(\n\t\tlayer: number, manager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst shape = children[ i ];\n\t\t\tconst item = shape.serialize( manager );\n\t\t\titem[ 16 ] = layer;\n\t\t\titems.push( item );\n\t\t}\n\n\t\treturn [\n\t\t\tthis.name || \"\"\n\t\t];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayerContainer extends Container {\n\tpublic children!: DDiagramLayer[];\n\tprotected _active: DDiagramLayer | null;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._active = null;\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\t}\n\n\tget active(): DDiagramLayer | null {\n\t\treturn this._active;\n\t}\n\n\tset active( layer: DDiagramLayer | null ) {\n\t\tif( this._active !== layer && (layer == null || 0 <= this.children.indexOf( layer )) ) {\n\t\t\tthis._active = layer;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tcreate( name: string, activate?: boolean ): DDiagramLayer {\n\t\tconst result = new DDiagramLayer( name );\n\t\tthis.attach( result, activate );\n\t\treturn result;\n\t}\n\n\t/**\n\t * Adds the specified layer and activates it if the `activate` is true.\n\t *\n\t * @param layer\n\t * @param activate\n\t */\n\tattach( layer: DDiagramLayer, activate?: boolean ): void {\n\t\tthis.addChild( layer );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update( this );\n\t}\n\n\tattachAt( layer: DDiagramLayer, index: number, activate?: boolean ): void {\n\t\tthis.addChildAt( layer, index );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update( this );\n\t}\n\n\t/**\n\t * Removes the specified layer from this container and activates the specified layer.\n\t * This method does not destroy the secified layer.\n\t *\n\t * @param layer\n\t */\n\tdetach( layer: DDiagramLayer, active: DDiagramLayer | null ): void {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tthis._active = active;\n\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\t/**\n\t * Removes the specified layer and activate the next layer.\n\t * This method does not destroy the specified layer.\n\t *\n\t * @param layer\n\t * @param activateNext\n\t */\n\tdelete( layer: DDiagramLayer, activateNext?: boolean ): number {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tif( this._active === layer ) {\n\t\t\t\tif( activateNext === true ) {\n\t\t\t\t\tif( index < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index ];\n\t\t\t\t\t} else if( 0 < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index - 1 ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._active = null;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._active = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn index;\n\t}\n\n\tget( index: number ): DDiagramLayer | null {\n\t\tconst child = this.children[ index ];\n\t\tif( child != null ) {\n\t\t\treturn child;\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\t(child as any).parent = null;\n\t\t\t\tchild.destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis.clear();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.children.length;\n\t}\n\n\tserialize(\n\t\tmanager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer[] {\n\t\tconst result: DDiagramSerializedLayer[] = [];\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tresult.push( child.serialize( i, manager, items ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DCanvas, DCanvasOptions, DThemeCanvas } from \"./d-canvas\";\nimport { DDiagramCanvasTile, DDiagramCanvasTileOptions } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramCanvasBaseOptions<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase\n> extends DCanvasOptions<THEME> {\n\ttile?: DDiagramCanvasTileOptions;\n}\n\nexport interface DThemeDiagramCanvasBase extends DThemeCanvas {\n\n}\n\nexport class DDiagramCanvasBase<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase,\n\tOPTIONS extends DDiagramCanvasBaseOptions<THEME> = DDiagramCanvasBaseOptions<THEME>\n> extends DCanvas<THEME, OPTIONS> {\n\tprotected _layer: DDiagramLayerContainer;\n\tprotected _tile: DDiagramCanvasTile;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst layer = new DDiagramLayerContainer();\n\t\tthis._layer = layer;\n\t\tthis.addChild( layer );\n\n\t\tconst tile = this._tile = new DDiagramCanvasTile( this, options && options.tile );\n\t\ttile.init();\n\t}\n\n\tget tile(): DDiagramCanvasTile {\n\t\treturn this._tile;\n\t}\n\n\tget layer(): DDiagramLayerContainer {\n\t\treturn this._layer;\n\t}\n\n\tinitialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._tile.destroy();\n\t\t\tthis._layer.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst layers = this._layer.children;\n\t\tfor( let i = layers.length - 1; 0 <= i; --i ) {\n\t\t\tconst layer = layers[ i ];\n\t\t\tconst shape = layer.hitTest( global, handler );\n\t\t\tif( shape != null ) {\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramSerialized, DDiagramSerializedItem, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\nimport { ESnapper } from \"./snapper/e-snapper\";\nimport { ESnapperTargetValueType } from \"./snapper/e-snapper-target-value\";\n\nexport interface DDiagramCanvasEditorOptions<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor\n> extends DDiagramCanvasBaseOptions<THEME> {\n\tsnapper: ESnapper;\n}\n\nexport interface DThemeDiagramCanvasEditor extends DThemeDiagramCanvasBase {\n\n}\n\nexport class DDiagramCanvasEditor<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor,\n\tOPTIONS extends DDiagramCanvasEditorOptions<THEME> = DDiagramCanvasEditorOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\tprotected _snapper: ESnapper;\n\tprotected _snapperGraphics: Graphics;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.shadow = this.theme.newShadowWeak();\n\n\t\tconst snapperGraphics = new Graphics();\n\t\tsnapperGraphics.visible = false;\n\t\tthis.addChildAt( snapperGraphics, this.children.length - 1 );\n\t\tthis._snapperGraphics = snapperGraphics;\n\n\t\tconst snapper = options.snapper;\n\t\tsnapper.target.on( \"change\", (): void => {\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tthis._snapper = snapper;\n\t}\n\n\tserialize( id: number | undefined ): DDiagramSerialized {\n\t\tconst manager = new EShapeResourceManagerSerialization();\n\t\tconst items: DDiagramSerializedItem[] = [];\n\t\tconst background = this.background;\n\t\treturn {\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid,\n\t\t\tname: this.name,\n\t\t\twidth: this.width,\n\t\t\theight: this.height,\n\t\t\tbackground: {\n\t\t\t\tcolor: background.getColor( 0 ),\n\t\t\t\talpha: background.getAlpha( 0 )\n\t\t\t},\n\t\t\ttile: this._tile.serialize(),\n\t\t\tresources: manager.serialize(),\n\t\t\tlayers: this._layer.serialize( manager, items ),\n\t\t\titems,\n\t\t\tsnap: this._snapper.serialize()\n\t\t};\n\t}\n\n\tonReflow(): void {\n\t\tsuper.onReflow();\n\n\t\tconst snapperGraphics = this._snapperGraphics;\n\t\tconst target = this._snapper.target;\n\t\tif( target.visible ) {\n\t\t\tconst borderColor = 0x1e87f0;\n\t\t\tconst borderWidth = 1;\n\t\t\tconst borderAlpha = 0.5;\n\t\t\tconst width = this.width + 0.5;\n\t\t\tconst height = this.height + 0.5;\n\t\t\tconst values = target.values;\n\t\t\tsnapperGraphics.clear();\n\t\t\tsnapperGraphics.lineStyle( 0, 0, 0, 0 );\n\t\t\tsnapperGraphics.beginFill( borderColor, borderAlpha );\n\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\tconst value = values[ i ];\n\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\tsnapperGraphics.drawRect( value.position, 0, borderWidth, height );\n\t\t\t\t} else {\n\t\t\t\t\tsnapperGraphics.drawRect( 0, value.position, width, borderWidth );\n\t\t\t\t}\n\t\t\t}\n\t\t\tsnapperGraphics.endFill();\n\t\t\tsnapperGraphics.visible = true;\n\t\t} else {\n\t\t\tsnapperGraphics.visible = false;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasEditor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\n\nexport const DDiagramSerializedVersion: number = 1;\n\nexport interface DDiagramSerializedTagRange {\n\t[ 0 ]: number; // type\n\t[ 1 ]: number; // from\n\t[ 2 ]: number; // to\n}\n\nexport interface DDiagramSerializedTagValue {\n\t[ 0 ]: number; // id (Stored as a resouce)\n\t[ 1 ]: number; // initial value (Stored as a resource)\n\t[ 2 ]: number; // format (Stored as a resouce)\n\t[ 3 ]: number; // Range (Stored as a resource)\n\t[ 4 ]: number; // Capacity\n\t[ 5 ]: number; // Order\n}\n\nexport interface DDiagramSerializedFill {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n}\n\nexport interface DDiagramSerializedStroke {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n\t[ 3 ]: number; // width\n\t[ 4 ]: number; // align\n\t[ 5 ]: number; // side\n}\n\nexport interface DDiagramSerializedTextOutline {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n\t[ 3 ]: number; // width\n}\n\nexport interface DDiagramSerializedText {\n\t[  0 ]: number; // value (Stored as a resouce)\n\t[  1 ]: number; // color\n\t[  2 ]: number; // alpha\n\t[  3 ]: number; // family (Stored as a resouce)\n\t[  4 ]: number; // size\n\t[  5 ]: number; // weight (0: normal, 1: bold)\n\t[  6 ]: number; // align (Stored as a resource)\n\t[  7 ]: number; // margin (Stored as a resource)\n\t[  8 ]: number; // style (0: normal, 1: italic)\n\t[  9 ]: number; // outline (Stored as a resource)\n\t[ 10 ]: number; // spacing (Stored as a resource)\n\t[ 11 ]: number; // direction\n\t[ 12 ]: number; // padding\n\t[ 13 ]: number; // clipping (0: false, 1: true)\n}\n\nexport interface DDiagramSerializedItem {\n\t[  0 ]: number; // type\n\t[  1 ]: number; // id (Stored as resource)\n\t[  2 ]: number; // x\n\t[  3 ]: number; // y\n\t[  4 ]: number; // width\n\t[  5 ]: number; // height\n\t[  6 ]: number; // rotation\n\t[  7 ]: number; // skew\n\t[  8 ]: number; // fill (Stored as a resource)\n\t[  9 ]: number; // stroke (Stored as a resource)\n\t[ 10 ]: number; // cursor (Stored as a resource)\n\t[ 11 ]: number; // text (Stored as a resource)\n\t[ 12 ]: number; // tag (Stored as a resource)\n\t[ 13 ]: number; // radius\n\t[ 14 ]: number; // Corner\n\t[ 15 ]: number; // resource (Stored as a resouce)\n\t[ 16 ]: number; // layer\n\t[ 17 ]: number[]; // actions\n\t[ 18 ]: number; // Image (Stored as a resource)\n\t[ 19 ]: number; // Gradient\n\t[ 20 ]: DDiagramSerializedItem[];\n\t[ 21 ]: number; // pivot x\n\t[ 22 ]: number; // pivot y\n\t[ 23 ]: number; // (interactive ? 1 : 0) | (unfocusable ? 2 : 0)\n\t[ 24 ]: number; // shortcut\n\t[ 25 ]: number; // title\n}\n\nexport interface DDiagramSerializedLayer {\n\t[ 0 ]: string;\n}\n\nexport interface DDiagramSerializedSnapTargetValue {\n\t[ 0 ]: number; // 0: Horizontal, 1: Vertical\n\t[ 1 ]: number; // Position\n}\n\nexport interface DDiagramSerializedSnapTarget {\n\t[ 0 ]: number; // Snap on guide (0: Off, 1: On)\n\t[ 1 ]: number; // Visibility (0: Invisible, 1: Visible)\n\t[ 2 ]: DDiagramSerializedSnapTargetValue[]; // Snap targets\n}\n\nexport interface DDiagramSerializedSnapGrid {\n\t[ 0 ]: number; // Snap on grid (0: Off, 1: On)\n\t[ 1 ]: number; // Grid size\n}\n\nexport interface DDiagramSerializedSnap {\n\t[ 0 ]: number; // Snap (0: Off, 1: On)\n\t[ 1 ]: DDiagramSerializedSnapTarget;\n\t[ 2 ]: DDiagramSerializedSnapGrid;\n}\n\nexport interface DDiagramSerializedBackground {\n\tcolor?: number | null;\n\talpha?: number;\n}\n\nexport interface DDiagramSerializedTile {\n\tmapping?: DDiagramCanvasTileMapping;\n}\n\nexport interface DDiagramSerialized {\n\tversion: number;\n\tid?: number;\n\tname: string;\n\twidth: number;\n\theight: number;\n\tbackground?: DDiagramSerializedBackground;\n\ttile?: DDiagramSerializedTile;\n\tresources: string[];\n\tlayers: DDiagramSerializedLayer[];\n\titems: DDiagramSerializedItem[];\n\tsnap?: DDiagramSerializedSnap;\n}\n\nexport interface DDiagramSerializedSimple {\n\tversion: number;\n\tid: number | undefined;\n\tname: string;\n\tdata: string;\n}\n\nexport interface DDiagramSerializedName {\n\tid: number;\n\tname: string;\n}\n\nexport interface DDiagramSerializedTag {\n\tgid: number;\n\tid: string;\n\tsource: string;\n\tdevice: string;\n\tsensor: string;\n\ttype: string;\n\tinterval: number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasIdMap } from \"./d-diagram-canvas-id-map\";\nimport { DDiagramCanvasTagMap } from \"./d-diagram-canvas-tag-map\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeBase } from \"./shape/variant/e-shape-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DDiagramCanvasOptions<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas\n> extends DDiagramCanvasBaseOptions<THEME> {\n\n}\n\nexport interface DThemeDiagramCanvas extends DThemeDiagramCanvasBase {\n\n}\n\nexport class DDiagramCanvas<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas,\n\tOPTIONS extends DDiagramCanvasOptions<THEME> = DDiagramCanvasOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\ttags: DDiagramCanvasTagMap;\n\tinteractives: EShape[];\n\tactionables: EShape[];\n\tids: DDiagramCanvasIdMap;\n\n\tprotected _workLocal: Point;\n\tprotected _workGlobal: Point;\n\tprotected _lastOverShape: EShape | null;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.tags = {};\n\t\tthis.interactives = [];\n\t\tthis.actionables = [];\n\t\tthis.ids = {};\n\t\tthis._workLocal = new Point();\n\t\tthis._workGlobal = new Point();\n\t\tthis._lastOverShape = null;\n\t}\n\n\tinitialize(): void {\n\t\tconst time = Date.now();\n\t\tconst tags = this.tags;\n\t\tconst interactives = this.interactives;\n\t\tconst actionables = this.actionables;\n\t\tconst ids = this.ids;\n\t\tconst layers = this._layer.children;\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.initializeShapes( layers[ i ].children, tags, interactives, actionables, ids );\n\t\t}\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.updateShapes( layers[ i ].children, time );\n\t\t}\n\n\t\tthis.initializeFocus();\n\t}\n\n\tprotected initializeFocus(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.findFocusable( this, false, true, true );\n\t\t\tif( focusable ) {\n\t\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected initializeShapes(\n\t\tshapes: EShape[], tags: DDiagramCanvasTagMap,\n\t\tinteractives: EShape[], actionables: EShape[],\n\t\tids: DDiagramCanvasIdMap\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\t// Tag mappings\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value ) {\n\t\t\t\t\tconst valueId = value.id;\n\t\t\t\t\tif( 0 < valueId.length ) {\n\t\t\t\t\t\tlet values = tags[ valueId ];\n\t\t\t\t\t\tif( values == null ) {\n\t\t\t\t\t\t\tvalues = [];\n\t\t\t\t\t\t\ttags[ valueId ] = values;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Id mappings\n\t\t\tconst shapeId = shape.id;\n\t\t\tif( 0 < shapeId.length ) {\n\t\t\t\tconst mapping: EShape[] | undefined = ids[ shapeId ];\n\t\t\t\tif( mapping == null ) {\n\t\t\t\t\tids[ shapeId ] = [ shape ];\n\t\t\t\t} else {\n\t\t\t\t\tmapping.push( shape );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Interactives\n\t\t\tconst runtime = shape.runtime;\n\t\t\tif( shape.interactive || (0 < shape.cursor.length) || (runtime && runtime.interactive) ) {\n\t\t\t\tinteractives.push( shape );\n\t\t\t}\n\n\t\t\t// Actionables\n\t\t\tif( runtime && 0 < runtime.actions.length ) {\n\t\t\t\tactionables.push( shape );\n\t\t\t}\n\n\t\t\t// Shortcuts\n\t\t\tconst shortcut = shape.shortcut;\n\t\t\tif( shortcut != null ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcut, ( e: KeyboardEvent ): void => {\n\t\t\t\t\tshape.onShortcut( e );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initializeShapes( children, tags, interactives, actionables, ids );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateShapes( shapes: EShape[], time: number ): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tshapes[ i ].update( time );\n\t\t}\n\t}\n\n\tonShapeMove( e: interaction.InteractionEvent ): boolean {\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tconst interactives = this.interactives;\n\t\tlet found: EShape | null = null;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tfound = interactive;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( found ) {\n\t\t\tif( 0 < found.cursor.length ) {\n\t\t\t\tif( layer && layer.view.style.cursor !== found.cursor ) {\n\t\t\t\t\tlayer.view.style.cursor = found.cursor;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tif( found === lastOverShape ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onPointerMove( lastOverShape, e );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._lastOverShape = found;\n\n\t\t\t\t// Previous\n\t\t\t\tif( lastOverShape ) {\n\t\t\t\t\tconst previousRuntime = lastOverShape.runtime;\n\t\t\t\t\tif( previousRuntime ) {\n\t\t\t\t\t\tpreviousRuntime.onPointerOut( lastOverShape, e );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parents\n\t\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\t\twhile( (lastOverParent instanceof EShapeBase) && lastOverParent !== found ) {\n\t\t\t\t\t\tconst parentRuntime = lastOverShape.runtime;\n\t\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\t\tparentRuntime.onPointerOut( lastOverParent, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Next\n\t\t\t\tconst runtime = found.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onPointerOver( found, e );\n\t\t\t\t}\n\t\t\t\tif( layer ) {\n\t\t\t\t\tlayer.view.title = ( found.title || \"\" );\n\t\t\t\t}\n\n\t\t\t\t// Parents\n\t\t\t\tlet parent = found.parent;\n\t\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = parent.runtime;\n\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\tparentRuntime.onPointerOver( parent, e );\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( layer && layer.view.style.cursor !== \"auto\" ) {\n\t\t\t\tlayer.view.style.cursor = \"auto\";\n\t\t\t}\n\n\t\t\t// Previous\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tthis._lastOverShape = null;\n\t\t\tif( lastOverShape ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onPointerOut( lastOverShape, e );\n\t\t\t\t}\n\n\t\t\t\t// Parents\n\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\twhile( lastOverParent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = lastOverParent.runtime;\n\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\tparentRuntime.onPointerOut( lastOverParent, e );\n\t\t\t\t\t}\n\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = \"\";\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonShapeDown( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\truntime.onPointerDown( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeUp( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\truntime.onPointerUp( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeClick( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tlet target: EShape = interactive;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tconst runtime = target.runtime;\n\t\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\t\truntime.onPointerClick( target, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst parent = target.parent;\n\t\t\t\t\t\tif( parent instanceof EShapeBase ) {\n\t\t\t\t\t\t\ttarget = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = UtilPointerEvent.toGlobal( e, interactionManager, this._workGlobal );\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tlet target: EShape = interactive;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tconst runtime = target.runtime;\n\t\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\t\truntime.onPointerDblClick( target, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst parent = target.parent;\n\t\t\t\t\t\tif( parent instanceof EShapeBase ) {\n\t\t\t\t\t\t\ttarget = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvas\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { DDiagramSerialized, DDiagramSerializedSimple } from \"./d-diagram-serialized\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapeDeserializer } from \"./shape/e-shape-deserializer\";\n\nexport class DDiagrams {\n\tstatic toSerialized( target: DDiagramSerializedSimple | DDiagramSerialized ): DDiagramSerialized {\n\t\tif( \"data\" in target ) {\n\t\t\tconst result: DDiagramSerialized = JSON.parse( target.data );\n\t\t\tresult.id = target.id;\n\t\t\treturn result;\n\t\t}\n\t\treturn target;\n\t}\n\n\tstatic newLayer(\n\t\tserialized: DDiagramSerialized,\n\t\tcontainer: DDiagramLayerContainer\n\t): Promise<EShape[]> {\n\t\t// Layers\n\t\tconst pflayers = serialized.layers;\n\t\tfor( let i = 0, imax = pflayers.length; i < imax; ++i ) {\n\t\t\tcontainer.create( pflayers[ i ][ 0 ] || \"\" );\n\t\t}\n\n\t\t// Activate the first later if it exists\n\t\tif( 0 < container.size() ) {\n\t\t\tcontainer.active = container.children[ 0 ];\n\t\t}\n\n\t\t// Items\n\t\tconst pfresources = serialized.resources;\n\t\tconst pfitems = serialized.items;\n\t\tconst shapePromises = EShapeDeserializer.deserializeAll( pfitems, pfresources );\n\t\tif( shapePromises != null ) {\n\t\t\treturn shapePromises.then(( shapes: EShape[] ): EShape[] => {\n\t\t\t\tconst layers = container.children;\n\t\t\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\t\t\tconst pfitem = pfitems[ i ];\n\t\t\t\t\tconst shape = shapes[ i ];\n\t\t\t\t\tconst layer = layers[ pfitem[ 16 ] ];\n\t\t\t\t\tif( layer != null ) {\n\t\t\t\t\t\tshape.attach( layer );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn shapes;\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\t}\n\n\tstatic applyBackground(\n\t\tserialized: DDiagramSerialized,\n\t\tcanvas: DBase,\n\t\tcanvasContainer: DBase\n\t): void {\n\t\tconst background = serialized.background;\n\t\tconst backgroundColor = ( background && background.color != null ? background.color : 0xffffff );\n\t\tconst backgroundAlpha = ( background && background.alpha != null ? background.alpha : 1.0 );\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\tcanvas.background.color = backgroundColor;\n\t\t\tcanvas.background.alpha = backgroundAlpha;\n\t\t} else {\n\t\t\tcanvasContainer.background.color = backgroundColor;\n\t\t\tconst layer = DApplications.getLayer( canvasContainer );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.renderer.backgroundColor = backgroundColor;\n\t\t\t}\n\t\t\tcanvasContainer.background.alpha = backgroundAlpha;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DCanvasContainer, DCanvasContainerOptions, DThemeCanvasContainer } from \"./d-canvas-container\";\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTilePyramidFactory } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerialized } from \"./d-diagram-serialized\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramBaseOptions<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase\n> extends DCanvasContainerOptions<CANVAS, THEME> {\n\ttile?: DDiagramCanvasTilePyramidFactory;\n}\n\nexport interface DThemeDiagramBase extends DThemeCanvasContainer {\n\n}\n\nexport abstract class DDiagramBase<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase,\n\tOPTIONS extends DDiagramBaseOptions<CANVAS, THEME> = DDiagramBaseOptions<CANVAS, THEME>\n> extends DCanvasContainer<CANVAS, THEME, OPTIONS> {\n\tprotected _serialized: DDiagramSerialized | null;\n\tprotected _tileFactory?: DDiagramCanvasTilePyramidFactory;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._serialized = null;\n\t\tthis._tileFactory = options && options.tile;\n\t}\n\n\tset( serialized: DDiagramSerialized | null ) {\n\t\tconst oldSerialized = this._serialized;\n\t\tif( oldSerialized !== serialized ) {\n\t\t\tif( oldSerialized ) {\n\t\t\t\tthis._serialized = null;\n\t\t\t\tthis.onUnset();\n\t\t\t}\n\n\t\t\tthis._serialized = serialized;\n\t\t\tif( serialized ) {\n\t\t\t\tthis.onSet( serialized );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tconst canvas = this.newCanvas( serialized );\n\t\tDDiagrams.newLayer( serialized, canvas.layer ).then(( shapes: EShape[] ): void => {\n\t\t\tthis.initialize( shapes );\n\t\t\tcanvas.initialize( shapes );\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tDDiagrams.applyBackground( serialized, canvas, this );\n\t\tthis.canvas = canvas;\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected abstract newCanvas( serialized: DDiagramSerialized ): CANVAS;\n\n\tprotected onUnset(): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.canvas = null;\n\t\t}\n\t}\n\n\tget(): DDiagramSerialized | null {\n\t\treturn this._serialized;\n\t}\n\n\tget layer(): DDiagramLayer | null {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn canvas.layer.active;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDiagramBase, DDiagramBaseOptions, DThemeDiagramBase } from \"./d-diagram-base\";\nimport { DDiagramCanvasEditor } from \"./d-diagram-canvas-editor\";\nimport { DDiagramSerialized, DDiagramSerializedSimple, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { ESnapper } from \"./snapper/e-snapper\";\n\nexport interface DDiagramEditorController {\n\tget( id: number ): Promise<DDiagramSerializedSimple | DDiagramSerialized>;\n\tsave( simple: DDiagramSerializedSimple ): Promise<number>;\n\tdelete( id: number ): Promise<void>;\n}\n\nexport interface DDiagramEditorOptions<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor\n> extends DDiagramBaseOptions<DDiagramCanvasEditor, THEME> {\n\tcontroller: DDiagramEditorController;\n}\n\nexport interface DThemeDiagramEditor extends DThemeDiagramBase {\n\n}\n\nexport class DDiagramEditor<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor,\n\tOPTIONS extends DDiagramEditorOptions<THEME> = DDiagramEditorOptions<THEME>\n> extends DDiagramBase<DDiagramCanvasEditor, THEME, OPTIONS> implements DControllerDocument<DDiagramSerialized> {\n\tprotected _isChanged: boolean = false;\n\tprotected _controller: DDiagramEditorController;\n\tsnapper: ESnapper;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._controller = options.controller;\n\t\tthis._isChanged = false;\n\n\t\tconst commands = DControllers.getCommandController();\n\t\tcommands.on( \"dirty\", (): void => {\n\t\t\tif( this._isChanged !== true ) {\n\t\t\t\tthis._isChanged = true;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t});\n\n\t\tthis.snapper = new ESnapper( this );\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvasEditor {\n\t\treturn new DDiagramCanvasEditor({\n\t\t\tname: serialized.name,\n\t\t\twidth: serialized.width,\n\t\t\theight: serialized.height,\n\t\t\tsnapper: this.snapper,\n\t\t\ttile: {\n\t\t\t\tfactory: this._tileFactory,\n\t\t\t\tmapping: serialized.tile && serialized.tile.mapping\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize(): DDiagramSerialized | null {\n\t\tconst canvas = this.canvas;\n\t\tconst serialized = this._serialized;\n\t\tif( canvas != null && serialized != null ) {\n\t\t\treturn canvas.serialize( serialized.id );\n\t\t}\n\t\treturn null;\n\t}\n\n\tsave(): Promise<unknown> | boolean {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\treturn this.controller.save({\n\t\t\t\tversion: serialized.version,\n\t\t\t\tid: serialized.id,\n\t\t\t\tname: serialized.name,\n\t\t\t\tdata: JSON.stringify( serialized )\n\t\t\t})\n\t\t\t.then(( newId: number ): void => {\n\t\t\t\tthis._isChanged = false;\n\t\t\t\tserialized.id = newId;\n\t\t\t\tthis._serialized = serialized;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\tthis.emit( \"success\", \"save\", this );\n\t\t\t}, ( reason: any ): void => {\n\t\t\t\tthis.emit( \"fail\", \"save\", this );\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t}\n\n\tsaveAs( name: string ): Promise<unknown> | boolean {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\tserialized.id = undefined;\n\t\t\tserialized.name = name;\n\t\t\treturn this.controller.save({\n\t\t\t\tversion: serialized.version,\n\t\t\t\tid: serialized.id,\n\t\t\t\tname: serialized.name,\n\t\t\t\tdata: JSON.stringify( serialized )\n\t\t\t})\n\t\t\t.then(( newId: number ): void => {\n\t\t\t\tthis._isChanged = false;\n\t\t\t\tserialized.id = newId;\n\t\t\t\tthis._serialized = serialized;\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas != null ) {\n\t\t\t\t\tcanvas.name = name;\n\t\t\t\t}\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\tthis.emit( \"success\", \"save-as\", this );\n\t\t\t}, ( reason: any ): void => {\n\t\t\t\tthis.emit( \"fail\", \"save-as\", this );\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t}\n\n\tdelete(): Promise<unknown> | boolean {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\tif( serialized.id != null ) {\n\t\t\t\treturn this.controller.delete( serialized.id )\n\t\t\t\t.then((): void => {\n\t\t\t\t\tthis.set( null );\n\t\t\t\t\tthis.emit( \"success\", \"delete\", this );\n\t\t\t\t}, ( reason: any ): void => {\n\t\t\t\t\tthis.emit( \"fail\", \"delete\", this );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.set( null );\n\t\t\t\tthis.emit( \"success\", \"delete\", this );\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcreate( name: string, width: number, height: number ): Promise<unknown> | boolean {\n\t\tthis.set({\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid: undefined,\n\t\t\tname,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tresources: [],\n\t\t\tlayers: [[ \"Default layer\" ]],\n\t\t\titems: [],\n\t\t\tsnap: undefined\n\t\t});\n\t\treturn true;\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tsuper.onSet( serialized );\n\t\tconst snap = serialized.snap;\n\t\tconst snapper = this.snapper;\n\t\tif( snap != null ) {\n\t\t\tsnapper.deserialize( snap );\n\t\t} else {\n\t\t\tsnapper.reset();\n\t\t}\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tprotected onUnset(): void {\n\t\tsuper.onUnset();\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\topen( id: number ): Promise<unknown> | boolean {\n\t\treturn this._controller.get( id ).then(( serialized: DDiagramSerializedSimple | DDiagramSerialized ): void => {\n\t\t\tthis.set( DDiagrams.toSerialized( serialized ) );\n\t\t\tthis.emit( \"success\", \"open\", this );\n\t\t}, ( reason: any ): void => {\n\t\t\tthis.emit( \"fail\", \"open\", this );\n\t\t});\n\t}\n\n\tclose(): void {\n\t\tthis.set( null );\n\t}\n\n\tisChanged(): boolean {\n\t\treturn this._isChanged || this.isNew();\n\t}\n\n\tisNew(): boolean {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.id == null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetName(): string | null {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.name;\n\t\t}\n\t\treturn null;\n\t}\n\n\tget controller(): DDiagramEditorController {\n\t\treturn this._controller;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramEditor\";\n\t}\n}\n","import { utils } from \"pixi.js\";\nimport { DApplicationTarget } from \"./d-application-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasIdMap } from \"./d-diagram-canvas-id-map\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramShapeLayer {\n\tchildren: EShape[];\n}\n\nexport interface DDiagramShapeLayerContainer {\n\tchildren: DDiagramShapeLayer[];\n}\n\nexport interface DDiagramShapeCanvas {\n\tlayer: DDiagramShapeLayerContainer;\n\tids: DDiagramCanvasIdMap;\n\tactionables: EShape[];\n}\n\nexport interface DDiagramShapeDiagram extends DApplicationTarget {\n\tcanvas: DDiagramShapeCanvas | null;\n}\n\nexport class DDiagramShape extends utils.EventEmitter {\n\tprotected _diagram: DDiagramShapeDiagram;\n\tprotected _updateBound: () => void;\n\n\tconstructor( diagram: DDiagramShapeDiagram ) {\n\t\tsuper();\n\t\tthis._diagram = diagram;\n\t\tthis._updateBound = (): void => {\n\t\t\tDApplications.update( diagram );\n\t\t};\n\t}\n\n\tupdate(): void {\n\t\tconst diagram = this._diagram;\n\t\tconst canvas = diagram.canvas;\n\t\tif( canvas ) {\n\t\t\tconst actionables = canvas.actionables;\n\t\t\tif( 0 < actionables.length ) {\n\t\t\t\tlet effect = -1;\n\t\t\t\tconst time = Date.now();\n\t\t\t\tfor( let i = 0, imax = actionables.length; i < imax; ++i ) {\n\t\t\t\t\tconst actionable = actionables[ i ];\n\t\t\t\t\tactionable.update( time );\n\t\t\t\t\tconst runtime = actionable.runtime;\n\t\t\t\t\tif( runtime && time < runtime.effect ) {\n\t\t\t\t\t\tconst runtimeEffect = runtime.effect;\n\t\t\t\t\t\tif( time < runtimeEffect ) {\n\t\t\t\t\t\t\teffect = ( effect < 0 ? runtimeEffect : Math.min( effect, runtimeEffect ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 0 <= effect ) {\n\t\t\t\t\tsetTimeout( this._updateBound, effect - Date.now() );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget( id: string ): EShape | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tconst shapes = ( canvas && canvas.ids[ id ] );\n\t\treturn ( shapes && 0 < shapes.length ? shapes[ 0 ] : null );\n\t}\n\n\tgetAll( id: string ): EShape[] {\n\t\tconst canvas = this._diagram.canvas;\n\t\treturn ( canvas && canvas.ids[ id ] ) || [];\n\t}\n\n\teach( callback: ( shape: EShape ) => (boolean | void), reverse = false ): EShape | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst layers = canvas.layer.children;\n\t\t\tif( ! reverse ) {\n\t\t\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\t\t\tconst layer = layers[ i ];\n\t\t\t\t\tconst children = layer.children;\n\t\t\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\t\t\tconst child = children[ j ];\n\t\t\t\t\t\tif( callback( child ) === false ) {\n\t\t\t\t\t\t\treturn child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = layers.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst layer = layers[ i ];\n\t\t\t\t\tconst children = layer.children;\n\t\t\t\t\tfor( let j = children.length - 1; 0 <= j; --j ) {\n\t\t\t\t\t\tconst child = children[ j ];\n\t\t\t\t\t\tif( callback( child ) === false ) {\n\t\t\t\t\t\t\treturn child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n","import { DDiagramCanvasTagMap } from \"./d-diagram-canvas-tag-map\";\nimport { EShapeTagValueRangeType } from \"./shape/e-shape-tag-value-range\";\n\nexport interface DDiagramTagCanvas {\n\ttags: DDiagramCanvasTagMap;\n}\n\nexport interface DDiagramTagDiagram {\n\tcanvas: DDiagramTagCanvas | null;\n}\n\nexport class DDiagramTag {\n\tprotected _diagram: DDiagramTagDiagram;\n\n\tconstructor( diagram: DDiagramTagDiagram ) {\n\t\tthis._diagram = diagram;\n\t}\n\n\tupdate(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetIds(): string[] {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn Object.keys( canvas.tags );\n\t\t}\n\t\treturn [];\n\t}\n\n\teach( callback: ( tagId: string ) => (boolean | void) ): string | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tags = canvas.tags;\n\t\t\tfor( const id in tags ) {\n\t\t\t\tif( callback( id ) === false ) {\n\t\t\t\t\treturn id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( id: string, value: unknown, time?: number, from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\t\t\t\t\tconst range = tagValue.range;\n\n\t\t\t\t\t// Range\n\t\t\t\t\trange.set( from, to );\n\n\t\t\t\t\t// Time\n\t\t\t\t\tif( time !== undefined ) {\n\t\t\t\t\t\ttagValue.time = time;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Value\n\t\t\t\t\ttagValue.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclear( id: string ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].clear();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetAll( id: string, values: unknown[], times?: number[], from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\t\t\t\t\tconst range = tagValue.range;\n\n\t\t\t\t\t// Range\n\t\t\t\t\trange.set( from, to );\n\n\t\t\t\t\t// Time\n\t\t\t\t\tif( times !== undefined ) {\n\t\t\t\t\t\ttagValue.times = times;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Value\n\t\t\t\t\ttagValue.values = values;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValue( id: string, value: unknown, time?: number ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\n\t\t\t\t\tif( time !== undefined ) {\n\t\t\t\t\t\ttagValue.time = time;\n\t\t\t\t\t}\n\n\t\t\t\t\ttagValue.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValues( id: string, values: unknown[], times?: number[] ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\n\t\t\t\t\tif( times !== undefined ) {\n\t\t\t\t\t\ttagValue.times = times;\n\t\t\t\t\t}\n\n\t\t\t\t\ttagValue.values = values;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTime( id: string, time: number ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].time = time;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTimes( id: string, times: number[] ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].times = times;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetRange( id: string, from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst range = tagValues[ i ].range;\n\t\t\t\t\tif( from !== undefined ) {\n\t\t\t\t\t\tif( from !== null ) {\n\t\t\t\t\t\t\trange.type |= EShapeTagValueRangeType.FROM;\n\t\t\t\t\t\t\trange.from = from;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.type &= ~EShapeTagValueRangeType.FROM;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( to !== undefined ) {\n\t\t\t\t\t\tif( to !== null ) {\n\t\t\t\t\t\t\trange.type |= EShapeTagValueRangeType.TO;\n\t\t\t\t\t\t\trange.to = to;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.type &= ~EShapeTagValueRangeType.TO;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Renderer } from \"pixi.js\";\nimport { DDiagramBase, DDiagramBaseOptions, DThemeDiagramBase } from \"./d-diagram-base\";\nimport { DDiagramCanvas } from \"./d-diagram-canvas\";\nimport { DDiagramSerialized } from \"./d-diagram-serialized\";\nimport { DDiagramShape } from \"./d-diagram-shape\";\nimport { DDiagramTag } from \"./d-diagram-tag\";\nimport { EShapeActionRuntime } from \"./shape/action/e-shape-action-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./shape/action/e-shape-action-runtime-open\";\nimport { EShapeActionValue } from \"./shape/action/e-shape-action-value\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeRuntime } from \"./shape/e-shape-runtime\";\nimport { EShapeRuntimes } from \"./shape/e-shape-runtimes\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DDiagramOptions<\n\tTHEME extends DThemeDiagram = DThemeDiagram\n> extends DDiagramBaseOptions<DDiagramCanvas, THEME> {\n\n}\n\nexport interface DThemeDiagram extends DThemeDiagramBase {\n\n}\n\nexport class DDiagram<\n\tTHEME extends DThemeDiagram = DThemeDiagram,\n\tOPTIONS extends DDiagramOptions<THEME> = DDiagramOptions<THEME>\n> extends DDiagramBase<DDiagramCanvas, THEME, OPTIONS> {\n\ttag: DDiagramTag;\n\tshape: DDiagramShape;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Hover handling\n\t\tthis.on( UtilPointerEvent.move, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeMove( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Pointer down / up handling\n\t\tthis.on( UtilPointerEvent.up, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeUp( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Click handling\n\t\tthis.on( \"click\", ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//\n\t\tthis.tag = new DDiagramTag( this );\n\t\tthis.shape = new DDiagramShape( this );\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\tconst formatterMap: { [format: string]: ( value: unknown ) => unknown } = {};\n\t\tconst initialMap: { [initial: string]: unknown | undefined } = {};\n\t\tconst actionMap: Map<EShapeActionValue, EShapeActionRuntime> = new Map<EShapeActionValue, EShapeActionRuntime>();\n\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tconst runtimeConstructor = EShapeRuntimes[ shape.type ] || EShapeRuntime;\n\t\t\tconst runtime = shape.runtime = new (runtimeConstructor)( shape );\n\n\t\t\t// Tag\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value ) {\n\t\t\t\t\t// Format\n\t\t\t\t\tconst tagFormat = value.format;\n\t\t\t\t\tconst tagInitial = value.initial;\n\t\t\t\t\tif( tagFormat in formatterMap ) {\n\t\t\t\t\t\tvalue.formatter = formatterMap[ tagFormat ];\n\t\t\t\t\t} else if( 0 < tagFormat.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst formatter = Function(\n\t\t\t\t\t\t\t\t\"value\",\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagFormat});` +\n\t\t\t\t\t\t\t\t`} catch( e1 ) {` +\n\t\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t\t`return (${0 < tagInitial.length ? tagInitial : 0});` +\n\t\t\t\t\t\t\t\t\t`} catch( e2 ) {` +\n\t\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t\t`}` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t) as any;\n\t\t\t\t\t\t\tformatterMap[ tagFormat ] = formatter;\n\t\t\t\t\t\t\tvalue.formatter = formatter;\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Initial\n\t\t\t\t\tif( tagInitial in initialMap ) {\n\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ];\n\t\t\t\t\t} else if( 0 < tagInitial.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ] = (Function(\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagInitial});` +\n\t\t\t\t\t\t\t\t`} catch( e ) {` +\n\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t)());\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Initialize runtime actions\n\t\t\tconst values = shape.action.values;\n\t\t\tconst actions = runtime.actions;\n\t\t\tfor( let j = 0, jmax = values.length; j < jmax; ++j ) {\n\t\t\t\tconst value = values[ j ];\n\t\t\t\tlet action: EShapeActionRuntime | undefined | null = actionMap.get( value );\n\t\t\t\tif( action == null ) {\n\t\t\t\t\taction = value.toRuntime( shape );\n\t\t\t\t\tif( action != null ) {\n\t\t\t\t\t\tif( action instanceof EShapeActionRuntimeOpen ) {\n\t\t\t\t\t\t\tif( shape.cursor.length <= 0 ) {\n\t\t\t\t\t\t\t\tshape.cursor = \"pointer\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tactionMap.set( value, action );\n\t\t\t\t\t\tactions.push( action );\n\t\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tactions.push( action );\n\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initialize( children );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvas {\n\t\treturn new DDiagramCanvas({\n\t\t\tname: serialized.name,\n\t\t\twidth: serialized.width,\n\t\t\theight: serialized.height,\n\t\t\tbackground: {\n\t\t\t\tcolor: null\n\t\t\t},\n\t\t\tborder: {\n\t\t\t\tcolor: null\n\t\t\t},\n\t\t\ttile: {\n\t\t\t\tfactory: this._tileFactory,\n\t\t\t\tmapping: serialized.tile && serialized.tile.mapping\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas && canvas.onShapeDown( e ) ) {\n\t\t\treturn;\n\t\t}\n\t\tsuper.onDown( e );\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas && canvas.onShapeDblClick( e, interactionManager ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn super.onDblClick( e, interactionManager );\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.shape.update();\n\t\tsuper.render( renderer );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagram\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DDialogConfirmMessageOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage\n> extends DImageOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeDialogConfirmMessage extends DThemeImage {\n\n}\n\nexport class DDialogConfirmMessage<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<VALUE, THEME> = DDialogConfirmMessageOptions<VALUE, THEME>\n> extends DImage<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DStateAwareOrValue } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DDialogConfirmOptions<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm\n> extends DDialogCommandOptions<THEME> {\n\tmessage?: DStateAwareOrValue<string> | DDialogConfirmMessageOptions | DDialogConfirmMessage;\n}\n\nexport interface DThemeDialogConfirm extends DThemeDialogCommand {\n\tgetMessage(): DStateAwareOrValue<string>;\n}\n\nexport class DDialogConfirm<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmOptions<THEME> = DDialogConfirmOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _message!: DDialogConfirmMessage;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tconst message = this.toMessage( this.theme, options );\n\t\tthis._message = message;\n\t\tlayout.addChild( message );\n\t}\n\n\tprotected toMessage( theme: DThemeDialogConfirm, options?: DDialogConfirmOptions ): DDialogConfirmMessage {\n\t\tif( options && options.message != null ) {\n\t\t\tconst message = options.message;\n\t\t\tif( isString( message ) || isFunction( message ) ) {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptions( message )\n\t\t\t\t);\n\t\t\t} else if( message instanceof DBase ) {\n\t\t\t\treturn message;\n\t\t\t} else {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptionsMerged( message, theme.getMessage() )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn this.newMessage(\n\t\t\tthis.toMessageOptions( theme.getMessage() )\n\t\t);\n\t}\n\n\tprotected toMessageOptionsMerged(\n\t\toptions: DDialogConfirmMessageOptions,\n\t\tmessage: DStateAwareOrValue<string>\n\t): DDialogConfirmMessageOptions {\n\t\tif( options.text == null ) {\n\t\t\toptions.text =　{};\n\t\t}\n\t\tif( options.text.value === undefined ) {\n\t\t\toptions.text.value = message;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toMessageOptions( message: DStateAwareOrValue<string> ): DDialogConfirmMessageOptions {\n\t\treturn {\n\t\t\ttext: {\n\t\t\t\tvalue: message\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogConfirmMessage( options );\n\t}\n\n\tget message(): DDialogConfirmMessage {\n\t\treturn this._message;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirm\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDeleteOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDelete extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDelete<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDeleteOptions<THEME> = DDialogConfirmDeleteOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDelete\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDiscardOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDiscard extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDiscard<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDiscardOptions<THEME> = DDialogConfirmDiscardOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDiscard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DButtonPrimary } from \"./d-button-primary\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DInputTextAndLabel } from \"./d-input-text-and-label\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DDialogInputTextOptions<THEME extends DThemeDialog> extends DDialogOptions<THEME> {\n\tok?: string;\n\tcancel?: string;\n\tlabel?: string;\n}\n\nexport interface DThemeDialogInputText extends DThemeDialog {\n\tgetOk(): string;\n\tgetCancel(): string;\n\tgetLabel(): string;\n\tgetLabelWidth(): number;\n}\n\nexport class DDialogInputText<\n\tTHEME extends DThemeDialogInputText = DThemeDialogInputText,\n\tOPTIONS extends DDialogInputTextOptions<THEME> = DDialogInputTextOptions<THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _input: DInputTextAndLabel;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst theme = this.theme;\n\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"padding\", height: \"auto\"\n\t\t});\n\n\t\t// Input\n\t\tthis._input = new DInputTextAndLabel({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ton: {\n\t\t\t\t\tenter: () => {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: ( options != null && options.label != null ?\n\t\t\t\t\t\toptions.label : theme.getLabel()\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t},\n\t\t\tspace: {\n\t\t\t\twidth: theme.getLabelWidth()\n\t\t\t}\n\t\t});\n\n\t\t// Buttons\n\t\tnew DLayoutHorizontal({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\tpadding: {\n\t\t\t\ttop: this.padding.getBottom()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tnew DLayoutSpace({\n\t\t\t\t\tweight: 1\n\t\t\t\t}),\n\t\t\t\tnew DButtonPrimary({\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ( options != null && options.ok != null ?\n\t\t\t\t\t\t\toptions.ok : theme.getOk()\n\t\t\t\t\t\t)\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: () => {\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew DButton({\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ( options != null && options.cancel != null ?\n\t\t\t\t\t\t\toptions.cancel : theme.getCancel()\n\t\t\t\t\t\t)\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: () => {\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew DLayoutSpace({\n\t\t\t\t\tweight: 1\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tget input() {\n\t\treturn this._input.input;\n\t}\n\n\tprotected onOk() {\n\t\tthis.emit( \"ok\", this._input.input.value, this );\n\t}\n\n\tprotected onCancel() {\n\t\tthis.emit( \"cancel\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogMessageOptions<THEME extends DThemeDialogMessage> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogMessage extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogMessage<\n\tTHEME extends DThemeDialogMessage = DThemeDialogMessage,\n\tOPTIONS extends DDialogMessageOptions<THEME> = DDialogMessageOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDialogConfirmMessage, DDialogConfirmMessageOptions, DThemeDialogConfirmMessage\n} from \"./d-dialog-confirm-message\";\n\nexport class DDialogProcessingMessage<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<VALUE, THEME> = DDialogConfirmMessageOptions<VALUE, THEME>\n> extends DDialogConfirmMessage<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessingMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DDialogProcessingMessage } from \"./d-dialog-processing-message\";\n\nexport interface DDialogProcessingOptions<THEME extends DThemeDialogProcessing> extends DDialogConfirmOptions<THEME> {\n\tinterval?: number;\n}\n\nexport interface DThemeDialogProcessing extends DThemeDialogConfirm {\n\tgetInterval(): number;\n}\n\nexport class DDialogProcessing<\n\tTHEME extends DThemeDialogProcessing = DThemeDialogProcessing,\n\tOPTIONS extends DDialogProcessingOptions<THEME> = DDialogProcessingOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected _isDone: boolean;\n\tprotected _startTime: number;\n\tprotected _interval: number;\n\tprotected _timeoutId?: number;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._isDone = true;\n\t\tthis._startTime =  0;\n\t\tthis._interval = ( options && options.interval != null ? options.interval : this.theme.getInterval() );\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogProcessingMessage( options );\n\t}\n\n\tprotected onOpen() {\n\t\tthis._isDone = false;\n\t\tthis._startTime = Date.now();\n\t\tconst timeoutId = this._timeoutId;\n\t\tif( timeoutId != null ) {\n\t\t\tclearTimeout( timeoutId );\n\t\t}\n\t\tthis._message.setStates( DBaseState.NONE, DBaseState.SUCCEEDED | DBaseState.FAILED );\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.setDisabled( true );\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onDone(): void {\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.setDisabled( false );\n\t\t} else {\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tprotected onResolved( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis._message.text = message;\n\t\t}\n\t\tthis._message.setStates( DBaseState.SUCCEEDED, DBaseState.FAILED );\n\t\tthis.onDone();\n\t}\n\n\tprotected onRejected( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis._message.text = message;\n\t\t}\n\t\tthis._message.setStates( DBaseState.FAILED, DBaseState.SUCCEEDED );\n\t\tthis.onDone();\n\t}\n\n\tresolve( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._interval - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onResolved( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onResolved( message );\n\t\t\t}\n\t\t}\n\t}\n\n\treject( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._interval - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onRejected( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onRejected( message );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tif( this._isDone ) {\n\t\t\tsuper.onCloseOn();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessing\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommandSaveAs } from \"./d-command-save-as\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDialogInputText, DDialogInputTextOptions, DThemeDialogInputText } from \"./d-dialog-input-text\";\n\nexport interface DDialogSaveAsOptions<THEME extends DThemeDialogSaveAs> extends DDialogInputTextOptions<THEME> {\n\n}\n\nexport interface DThemeDialogSaveAs extends DThemeDialogInputText {\n\n}\n\nexport class DDialogSaveAs<\n\tTHEME extends DThemeDialogSaveAs = DThemeDialogSaveAs,\n\tOPTIONS extends DDialogSaveAsOptions<THEME> = DDialogSaveAsOptions<THEME>\n> extends DDialogInputText<THEME, OPTIONS> {\n\tprotected onOpen() {\n\t\tconst name = DControllers.getDocumentController().getName();\n\t\tif( name != null ) {\n\t\t\tthis._input.input.value = name;\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onOk() {\n\t\tsuper.onOk();\n\n\t\tconst name = this._input.input.value;\n\t\tDControllers.getCommandController().push( new DCommandSaveAs( name ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSaveAs\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\n\nexport interface DDialogSelectListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeDialogSelecListItem extends DThemeListItem {\n\n}\n\nexport class DDialogSelectListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem,\n\tOPTIONS extends DDialogSelectListItemOptions<VALUE, THEME> = DDialogSelectListItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectListItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\n\nexport interface DScrollBarOptions extends DBaseOptions<DThemeScrollBar> {\n\tthumb?: DScrollBarThumbOptions;\n}\n\nexport interface DThemeScrollBar extends DThemeBase {\n\n}\n\nexport abstract class DScrollBar extends DBase<DThemeScrollBar, DScrollBarOptions> {\n\tprotected _start!: number;\n\tprotected _end!: number;\n\tprotected _thumb!: DScrollBarThumb;\n\n\tprotected init( options?: DScrollBarOptions ): void {\n\t\tsuper.init( options );\n\n\t\tthis._start = 0;\n\t\tthis._end = 1;\n\t\tconst thumb = this._thumb = this.createThumb( options != null ? options.thumb : undefined );\n\t\tthis.addChild( thumb );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tget thumb(): DScrollBarThumb {\n\t\treturn this._thumb;\n\t}\n\n\tprotected abstract createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb;\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBar\";\n\t}\n\n\tsetRegion( start: number, end: number, size: number ): void {\n\t\tif( size < 1 ) {\n\t\t\tstart = 0;\n\t\t\tend = 1;\n\t\t} else {\n\t\t\tstart = Math.max( 0, Math.min( 1, start / size ) );\n\t\t\tend = Math.max( start, Math.min( 1, end / size ) );\n\t\t}\n\t\tif( this._start !== start || this._end !== end ) {\n\t\t\tthis._start = start;\n\t\t\tthis._end = end;\n\t\t\tthis.onRegionChange();\n\t\t}\n\t}\n\n\tisRegionVisible(): boolean {\n\t\treturn 0 < this._start || this._end < 1;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.onRegionChange();\n\t}\n\n\tonRegionChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetRegionStart(): number {\n\t\treturn this._start;\n\t}\n\n\tgetRegionEnd(): number {\n\t\treturn this._end;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { UtilDrag } from \"./util/util-drag\";\n\nexport interface DScrollBarThumbOptions extends DBaseOptions<DThemeScrollBarThumb> {\n\n}\n\nexport interface DThemeScrollBarThumb extends DThemeBase {\n\tgetMinimumSize(): number;\n}\n\nexport abstract class DScrollBarThumb extends DBase<DThemeScrollBarThumb, DScrollBarThumbOptions> {\n\tprotected _dragUtil!: UtilDrag;\n\n\tprotected init( options?: DScrollBarThumbOptions ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst position = new Point();\n\t\tthis._dragUtil = new UtilDrag({\n\t\t\ttarget: this,\n\t\t\teasing: false,\n\t\t\ton: {\n\t\t\t\tstart: (): void => {\n\t\t\t\t\tposition.copyFrom( this.position );\n\t\t\t\t},\n\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\tthis.onDragMove( position.x, position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinimumSize(): number {\n\t\treturn this.theme.getMinimumSize();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBarThumb\";\n\t}\n\n\tprotected abstract onDragMove( dx: number, dy: number ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\n\nexport class DScrollBarThumbReflowableHorizontal extends Graphics implements DReflowable {\n\tconstructor( base: DScrollBarThumb ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\n\t\tthis.clear();\n\n\t\tconst background = base.background;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst size = 1;\n\t\t\tthis.beginFill( backgroundColor, backgroundAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( 0, height * 0.5 - size, width, size * 2 );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableHorizontal } from \"./d-scroll-bar-thumb-reflowable-horizontal\";\n\nexport class DScrollBarThumbHorizontal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dx, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableHorizontal( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbHorizontal } from \"./d-scroll-bar-thumb-horizontal\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarHorizontal extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst width = this.width;\n\t\t\t\tif( 0 < width ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.x / width - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( x: number ) => {\n\t\t\tconst width = this.width;\n\t\t\tif( 0 < width ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, x / width ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbHorizontal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumSize = Math.min( width * 0.5, thumb.getMinimumSize() );\n\t\tconst space = width - thumbMinimumSize;\n\t\tconst barStart = space * this._start;\n\t\tconst barSize = space * this._end + thumbMinimumSize - barStart;\n\n\t\tthumb.position.set( barStart, 0 );\n\t\tthumb.resize( barSize, height );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DScrollBarThumbReflowableVertical extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\n\t\tthis.clear();\n\n\t\tconst background = base.background;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst size = 1;\n\t\t\tthis.beginFill( backgroundColor, backgroundAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( width * 0.5 - size, 0, size * 2, height );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableVertical } from \"./d-scroll-bar-thumb-reflowable-vertical\";\n\nexport class DScrollBarThumbVertocal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dy, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableVertical( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbVertocal } from \"./d-scroll-bar-thumb-vertical\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarVertical extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst height = this.height;\n\t\t\t\tif( 0 < height ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.y / height - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( y: number ): void => {\n\t\t\tconst height = this.height;\n\t\t\tif( 0 < height ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, y / height ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbVertocal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumSize = Math.min( height * 0.5, thumb.getMinimumSize() );\n\t\tconst space = height - thumbMinimumSize;\n\t\tconst barStart = space * this._start;\n\t\tconst barSize = space * this._end + thumbMinimumSize - barStart;\n\n\t\tthumb.position.set( 0, barStart );\n\t\tthumb.resize( width, barSize );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DContent, DContentOptions } from \"./d-content\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarHorizontal } from \"./d-scroll-bar-horizontal\";\nimport { DScrollBarVertical } from \"./d-scroll-bar-vertical\";\nimport { isString } from \"./util/is-string\";\nimport { UtilDrag } from \"./util/util-drag\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DPaneDragOptions {\n\tmode?: (keyof typeof DDragMode) | DDragMode;\n}\n\nexport interface DPaneBarOptions {\n\tvertical?: DScrollBarOptions;\n\thorizontal?: DScrollBarOptions;\n}\n\nexport interface DPaneOptions<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tcontent?: CONTENT_OPTIONS | DBase;\n\tbar?: DPaneBarOptions;\n\tdrag?: DPaneDragOptions;\n}\n\nexport interface DThemePane extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n\tgetWheelSpeed(): number;\n\tgetDragMode(): DDragMode;\n}\n\n// Option parsers\nconst isOverflowMaskEnabled = <\n\tTHEME extends DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions\n>( theme: THEME, options?: DPaneOptions<THEME, CONTENT_OPTIONS> ): boolean => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nconst toBarOptionsVertical = ( options?: DPaneOptions ): DScrollBarOptions | undefined => {\n\treturn options && options.bar && options.bar.vertical;\n};\n\nconst toBarOptionsHorizontal = ( options?: DPaneOptions ): DScrollBarOptions | undefined => {\n\treturn options && options.bar && options.bar.horizontal;\n};\n\n// Class\nexport class DPane<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DPaneOptions<THEME, CONTENT_OPTIONS> = DPaneOptions<THEME, CONTENT_OPTIONS>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static WORK_ON_FOCUSED = new Point();\n\tprotected _content!: DBase;\n\tprotected _overflowMask!: DBaseOverflowMask | null;\n\tprotected _verticalBar?: DScrollBarVertical;\n\tprotected _horizontalBar?: DScrollBarHorizontal;\n\tprotected _dragUtil?: UtilDrag;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._overflowMask = null;\n\n\t\t// Content\n\t\tconst theme = this.theme;\n\t\tconst content = this._content = this.toContent( options );\n\t\tif( isOverflowMaskEnabled( theme, options ) ) {\n\t\t\tthis.mask = this.getOrCreateOverflowMask();\n\t\t}\n\t\tthis.addChild( content );\n\n\t\t// Scroll bar\n\t\tthis.initScrollBar( content, theme, options );\n\n\t\t// Drag\n\t\tthis.initDrag( content, theme, options );\n\t}\n\n\tprotected initDrag( content: DBase, theme: THEME, options?: OPTIONS ): void {\n\t\tconst dragMode = ( options && options.drag && options.drag.mode != null ?\n\t\t\t( isString( options.drag.mode ) ? DDragMode[ options.drag.mode ] : options.drag.mode ) :\n\t\t\ttheme.getDragMode()\n\t\t);\n\t\t// Edge does not fire the wheel event when scrolling using the 2-fingure scroll gesture on a touchpad.\n\t\t// Instead, it fires touch events. This is why the dragging is enabled regardless of the `UtilPointerEvent.touchable`.\n\t\t// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7134034/\n\t\tif( dragMode === DDragMode.ON || dragMode === DDragMode.TOUCH ) {\n\t\t\tconst position = new Point();\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: this,\n\t\t\t\ttouch: dragMode === DDragMode.TOUCH,\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tposition.copyFrom( content.position );\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\t\tcontent.position.set(\n\t\t\t\t\t\t\tthis.toContentX( content, position.x ),\n\t\t\t\t\t\t\tthis.toContentY( content, position.y )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onRegionMoveX( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.x = - content.width * start;\n\t}\n\n\tprotected onRegionMoveY( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.y = - content.height * start;\n\t}\n\n\tprotected initScrollBar( content: DBase, theme: THEME, options?: OPTIONS ): void {\n\t\t// Vertical bar\n\t\tconst verticalBar = this._verticalBar = new DScrollBarVertical( toBarOptionsVertical( options ) );\n\t\tverticalBar.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveY( content, start );\n\t\t});\n\t\tthis.addChild( verticalBar );\n\n\t\t// Horizontal bar\n\t\tconst horizontalBar = this._horizontalBar = new DScrollBarHorizontal( toBarOptionsHorizontal( options ) );\n\t\thorizontalBar.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveX( content, start );\n\t\t});\n\t\tthis.addChild( horizontalBar );\n\n\t\t//\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tthis.onContentChanged();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tthis.onContentChanged();\n\t\t});\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPane\";\n\t}\n\n\tget content(): DBase {\n\t\treturn this._content;\n\t}\n\n\tprotected toContent( options?: OPTIONS ): DBase {\n\t\tif( options && options.content ) {\n\t\t\tconst content = options.content;\n\t\t\tif( content instanceof DBase ) {\n\t\t\t\treturn content;\n\t\t\t} else {\n\t\t\t\treturn this.newContent( content );\n\t\t\t}\n\t\t}\n\t\treturn this.newContent();\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DContent( options );\n\t}\n\n\tprotected getOrCreateOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst content = this._content;\n\t\tconst x = this.getWheelContentX( content, deltas.deltaX * deltas.lowest );\n\t\tconst y = this.getWheelContentY( content, deltas.deltaY * deltas.lowest );\n\t\tif( content.x !== x || content.y !== y ) {\n\t\t\tconst dragUtil = this._dragUtil;\n\t\t\tif( dragUtil != null ) {\n\t\t\t\tdragUtil.stop();\n\t\t\t}\n\t\t\tcontent.position.set( x, y );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getWheelContentX( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentX( content, content.x - delta * speed );\n\t\t}\n\t\treturn content.x;\n\t}\n\n\tprotected getWheelContentY( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentY( content, content.y + delta * speed );\n\t\t}\n\t\treturn content.y;\n\t}\n\n\tprotected toContentX( content: DBase, x: number ): number {\n\t\treturn Math.min( 0, Math.max( this.width - content.width, x ) );\n\t}\n\n\tprotected toContentY( content: DBase, y: number ): number {\n\t\treturn Math.min( 0, Math.max( this.height - content.height, y ) );\n\t}\n\n\tprotected isRefitable( target: any ): target is DBase<any, any> {\n\t\treturn super.isRefitable( target ) && ! ( target instanceof DScrollBar );\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected onContentChanged(): void {\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected updateScrollBar(): void {\n\t\tconst verticalBar = this._verticalBar;\n\t\tconst horizontalBar = this._horizontalBar;\n\t\tif( verticalBar != null && horizontalBar != null ) {\n\t\t\tthis.updateScrollBarRegions( verticalBar, horizontalBar );\n\t\t\tthis.updateScrollBarVisibilities( verticalBar, horizontalBar );\n\t\t\tthis.updateScrollBarPositions( verticalBar, horizontalBar );\n\t\t}\n\t}\n\n\tprotected getScrollBarOffsetHorizontalStart( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetHorizontalEnd( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetVerticalStart( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetVerticalEnd( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected updateScrollBarPositions( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\n\t\tconst verticalBarWidth = verticalBar.width;\n\t\tconst verticalBarOffsetStart = this.getScrollBarOffsetVerticalStart( verticalBarWidth );\n\t\tconst verticalBarOffsetEnd = this.getScrollBarOffsetVerticalEnd( verticalBarWidth );\n\t\tverticalBar.position.set( width - verticalBarWidth, verticalBarOffsetStart );\n\t\tverticalBar.height = height - verticalBarOffsetStart - verticalBarOffsetEnd;\n\n\t\tconst horizontalBarHeight = horizontalBar.height;\n\t\tconst horizontalBarOffsetStart = this.getScrollBarOffsetHorizontalStart( horizontalBarHeight );\n\t\tconst horizontalBarOffsetEnd = this.getScrollBarOffsetHorizontalEnd( horizontalBarHeight );\n\t\thorizontalBar.position.set( horizontalBarOffsetStart, height - horizontalBarHeight );\n\t\thorizontalBar.width = width - horizontalBarOffsetStart - horizontalBarOffsetEnd;\n\t}\n\n\tprotected updateScrollBarRegions( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst content = this._content;\n\t\tconst x = -content.x;\n\t\tconst y = -content.y;\n\t\thorizontalBar.setRegion( x, x + this.width, content.width );\n\t\tverticalBar.setRegion( y, y + this.height, content.height );\n\t}\n\n\tprotected updateScrollBarVisibilities( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst isChangedHorizontal = this.updateScrollBarVisibility( horizontalBar );\n\t\tconst isChangedVertical = this.updateScrollBarVisibility( verticalBar );\n\t\tif( isChangedHorizontal || isChangedVertical ) {\n\t\t\t// Update the overflow mask\n\t\t\tconst overflowMask = this._overflowMask;\n\t\t\tif( overflowMask != null ) {\n\t\t\t\tif( horizontalBar.visible || verticalBar.visible ) {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask !== overflowMask ) {\n\t\t\t\t\t\tcontent.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask ) {\n\t\t\t\t\t\tcontent.mask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Rerender\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected updateScrollBarVisibility( bar: DScrollBar ): boolean {\n\t\tconst isRegionVisible = bar.isRegionVisible();\n\t\tif( bar.visible !== isRegionVisible ) {\n\t\t\tbar.visible = isRegionVisible;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onChildFocused( focused: DBase ): void {\n\t\tconst work = DPane.WORK_ON_FOCUSED;\n\t\tconst content = this.content;\n\t\tconst contentX = content.x;\n\t\tconst contentY = content.y;\n\t\tconst contentWidth = content.width;\n\t\tconst contentHeight = content.height;\n\n\t\twork.set( 0, 0 );\n\t\tfocused.toGlobal( work, work, false );\n\t\tcontent.toLocal( work, undefined, work, false );\n\t\tconst x0 = contentX + Math.min( contentWidth, Math.max( 0, work.x ) );\n\t\tconst y0 = contentY + Math.min( contentHeight, Math.max( 0, work.y ) );\n\n\t\twork.set( focused.width, focused.height );\n\t\tfocused.toGlobal( work, work, true );\n\t\tcontent.toLocal( work, undefined, work, true );\n\t\tconst x1 = contentX + Math.min( contentWidth, Math.max( 0, work.x ) );\n\t\tconst y1 = contentY + Math.min( contentHeight, Math.max( 0, work.y ) );\n\n\t\tconst width = this.width;\n\t\tlet newX: number | null = null;\n\t\tif( x0 < 0 ) {\n\t\t\tif( x1 <= width ) {\n\t\t\t\tnewX = contentX - Math.max( x0, x1 - width );\n\t\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, newX ) );\n\t\t\t}\n\t\t} else {\n\t\t\tif( width < x1 ) {\n\t\t\t\tnewX = contentX - Math.min( x0, x1 - width );\n\t\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, newX ) );\n\t\t\t}\n\t\t}\n\n\t\tconst height = this.height;\n\t\tlet newY: number | null = null;\n\t\tif( y0 < 0 ) {\n\t\t\tif( y1 <= height ) {\n\t\t\t\tnewY = contentY - Math.max( y0, y1 - height );\n\t\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, newY ) );\n\t\t\t}\n\t\t} else {\n\t\t\tif( height < y1 ) {\n\t\t\t\tnewY = contentY - Math.min( y0, y1 - height );\n\t\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, newY ) );\n\t\t\t}\n\t\t}\n\n\t\tif( newX != null ) {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontent.position.set( newX, newY );\n\t\t\t} else {\n\t\t\t\tcontent.position.x = newX;\n\t\t\t}\n\t\t} else {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontent.position.y = newY;\n\t\t\t}\n\t\t}\n\n\t\tsuper.onChildFocused( focused );\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\tthis.mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DListSelection, DListSelectionOptions } from \"./d-list-selection\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DListOptions<\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tselection?: DListSelectionOptions | DListSelection;\n}\n\nexport interface DThemeList extends DThemePane {\n\n}\n\nexport class DList<\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DListOptions<THEME, CONTENT_OPTIONS> = DListOptions<THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _selection!: DListSelection;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst selection = options && options.selection;\n\t\tthis._selection = ( selection instanceof DListSelection ?\n\t\t\tselection : this.newSelection( selection )\n\t\t);\n\n\t\tUtilPointerEvent.onClick( this, ( e: InteractionEvent ): void => {\n\t\t\tconst child: DisplayObject | null = this.findItem( e.target );\n\t\t\tif( child instanceof DBase && child.isActionable() ) {\n\t\t\t\tthis.selection.add( child );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newSelection( options?: DListSelectionOptions ): DListSelection {\n\t\treturn new DListSelection( this._content, options );\n\t}\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tget selection(): DListSelection {\n\t\treturn this._selection;\n\t}\n\n\tprotected findItem( target: DisplayObject | null ): DisplayObject | null {\n\t\tconst content = this.content;\n\t\tlet current = target;\n\t\twhile( current != null ) {\n\t\t\tif( current.parent === content ) {\n\t\t\t\treturn current;\n\t\t\t}\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tonRefit(): void {\n\t\tsuper.onRefit();\n\t\tthis.updateChildPosition();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tprotected updateChildPosition(): void {\n\t\tconst content = this.content;\n\t\tconst items = content.children;\n\t\tlet y = 0;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\titem.y = y;\n\t\t\t\ty += item.height;\n\t\t\t}\n\t\t}\n\t\tconst scrollLimit = Math.min( 0, -y + this.height );\n\t\tif( content.y < scrollLimit ) {\n\t\t\tcontent.y = scrollLimit;\n\t\t}\n\t\tcontent.height = y;\n\t}\n\n\tprotected updateChildVisibility(): void {\n\t\tconst content = this.content;\n\t\tconst items = content.children;\n\t\tconst from = -content.y;\n\t\tconst to = from + this.height;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\tconst itemY = item.y;\n\t\t\t\titem.visible = ( from <= itemY + item.height && itemY <= to );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onContentChanged(): void {\n\t\tsuper.onContentChanged();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DList\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DContentOptions } from \"./d-content\";\nimport { DList, DListOptions, DThemeList } from \"./d-list\";\n\nexport interface DDialogSelectListOptions<\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DListOptions<THEME, CONTENT_OPTIONS> {\n\n}\n\nexport interface DThemeDialogSelecList extends DThemeList {\n\n}\n\nexport class DDialogSelectList<\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DDialogSelectListOptions<THEME, CONTENT_OPTIONS> = DDialogSelectListOptions<THEME, CONTENT_OPTIONS>\n> extends DList<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectList\";\n\t}\n}\n","import { utils } from \"pixi.js\";\n\nexport class DDialogSelectSearh<SEARCH_RESULT> extends utils.EventEmitter {\n\tprotected _search: ( word: string ) => Promise<SEARCH_RESULT[]>;\n\tprotected _id: number;\n\tprotected _idCompleted: number;\n\tprotected _result: SEARCH_RESULT[] | null;\n\n\tconstructor( search: ( word: string ) => Promise<SEARCH_RESULT[]> ) {\n\t\tsuper();\n\n\t\tthis._search = search;\n\t\tthis._id = 0;\n\t\tthis._idCompleted = 0;\n\t\tthis._result = null;\n\t}\n\n\tcreate( args: [ string ] ): void {\n\t\tconst id = ++this._id;\n\t\tthis._search( args[ 0 ] ).then(( searchResult: SEARCH_RESULT[] ) => {\n\t\t\tif( this._id === id ) {\n\t\t\t\tthis._idCompleted = id;\n\t\t\t\tthis._result = searchResult;\n\t\t\t\tthis.emit( \"success\", this, searchResult );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}, () => {\n\t\t\tif( this._id === id ) {\n\t\t\t\tthis._idCompleted = id;\n\t\t\t\tthis._result = null;\n\t\t\t\tthis.emit( \"fail\", this );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t});\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tisDone(): boolean {\n\t\treturn this._id === this._idCompleted;\n\t}\n\n\tgetResult(): SEARCH_RESULT[] | null {\n\t\treturn this._result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DNoteOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote = DThemeNote\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeNote extends DThemeText {\n\n}\n\nexport class DNote<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote = DThemeNote,\n\tOPTIONS extends DNoteOptions<VALUE, THEME> = DNoteOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.visible = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DNote\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DDialogSelectList } from \"./d-dialog-select-list\";\nimport { DDialogSelectListItem } from \"./d-dialog-select-list-item\";\nimport { DDialogSelectSearh } from \"./d-dialog-select-search\";\nimport { DInputText } from \"./d-input-text\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DListItem } from \"./d-list-item\";\nimport { DListSelection } from \"./d-list-selection\";\nimport { DNote, DNoteOptions } from \"./d-note\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\nimport { UtilTransition } from \"./util/util-transition\";\n\nexport interface DDialogSelectSearch<SEARCH_RESULT> {\n\tcreate( args: [ string ] ): void;\n\ton( event: \"success\", handler: ( e: unknown, searchResults: SEARCH_RESULT[] ) => void ): void;\n\ton( event: \"change\", handler: () => void ): void;\n\tisDone(): boolean;\n\tgetResult(): SEARCH_RESULT[] | null;\n}\n\nexport type DDialogSelectSearchFunction<SEARCH_RESULT> = ( word: string ) => Promise<SEARCH_RESULT[]>;\n\nexport interface DDialogSelectController<SEARCH_RESULT> {\n\tsearch: DDialogSelectSearch<SEARCH_RESULT> | DDialogSelectSearchFunction<SEARCH_RESULT>;\n}\n\nexport interface DDialogSelectOptions<\n\tSEARCH_RESULT,\n\tTHEME extends DThemeDialogSelect = DThemeDialogSelect\n> extends DDialogOptions<THEME> {\n\tcontroller: DDialogSelectController<SEARCH_RESULT>;\n\tconverter?: {\n\t\ttoLabel?: ( searchResult: SEARCH_RESULT ) => string;\n\t};\n\tnote?: {\n\t\tnoItems?: DNoteOptions;\n\t\tsearching?: DNoteOptions;\n\t};\n}\n\nexport interface DThemeDialogSelect extends DThemeDialog {\n\tgetNoteNoItemsText(): string;\n\tgetNoteSearchingText(): string;\n}\n\n// Helper\nconst defaultConverter = {\n\ttoLabel: ( target: any ): string => {\n\t\tif( isString( target ) ) {\n\t\t\treturn target;\n\t\t} else if( isNumber( target ) ) {\n\t\t\treturn String( target );\n\t\t} else if( \"name\" in target ) {\n\t\t\treturn target.name;\n\t\t} else if( \"label\" in target ) {\n\t\t\treturn target.label;\n\t\t} else if( \"id\" in target ) {\n\t\t\treturn target.id;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t}\n};\n\nconst toToLabel = <SEARCH_RESULT>( options: DDialogSelectOptions<SEARCH_RESULT, any> ) => {\n\treturn ( options.converter != null ? options.converter.toLabel : null ) || defaultConverter.toLabel;\n};\n\nconst toNoteOptions = ( options: DNoteOptions | undefined, parent: DBase, text: string ): DNoteOptions => {\n\tif( options != null ) {\n\t\tif( options.parent == null ) {\n\t\t\toptions.parent = parent;\n\t\t}\n\t\tif( options.text == null ) {\n\t\t\toptions.text = {\n\t\t\t\tvalue: text\n\t\t\t};\n\t\t} else if( options.text.value == null ) {\n\t\t\toptions.text.value = text;\n\t\t}\n\t\treturn options;\n\t}\n\treturn {\n\t\tparent,\n\t\ttext: {\n\t\t\tvalue: text\n\t\t}\n\t};\n};\n\nconst toNoteNoItemsOptions = (\n\ttheme: DThemeDialogSelect, options: DDialogSelectOptions<any>, parent: DBase\n): DNoteOptions => {\n\treturn toNoteOptions(\n\t\toptions.note && options.note.noItems,\n\t\tparent,\n\t\ttheme.getNoteNoItemsText()\n\t);\n};\n\nconst toNoteSearchingOptions = (\n\ttheme: DThemeDialogSelect, options: DDialogSelectOptions<any>, parent: DBase\n): DNoteOptions => {\n\treturn toNoteOptions(\n\t\toptions.note && options.note.searching,\n\t\tparent,\n\t\ttheme.getNoteSearchingText()\n\t);\n};\n\nexport class DDialogSelect<\n\tSEARCH_RESULT,\n\tTHEME extends DThemeDialogSelect = DThemeDialogSelect,\n\tOPTIONS extends DDialogSelectOptions<SEARCH_RESULT, THEME> = DDialogSelectOptions<SEARCH_RESULT, THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _value: SEARCH_RESULT | null;\n\tprotected _input: DInputText;\n\tprotected _list: DDialogSelectList;\n\tprotected _noteNoItems: DNote;\n\tprotected _noteSearching: DNote;\n\tprotected _toLabel: ( target: any ) => string;\n\tprotected _search: DDialogSelectSearch<SEARCH_RESULT>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._value = null;\n\t\tconst theme = this.theme;\n\t\tthis._toLabel = toToLabel( options );\n\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"padding\", height: \"auto\"\n\t\t});\n\n\t\t// Search box\n\t\tthis._input = new DInputText({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\"\n\t\t});\n\n\t\t// List\n\t\tconst list = this._list = new DDialogSelectList({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\",\n\t\t\tselection: {\n\t\t\t\ton: {\n\t\t\t\t\tchange: ( selection: DListSelection ): void => {\n\t\t\t\t\t\tconst item: DListItem<SEARCH_RESULT> | null = selection.first();\n\t\t\t\t\t\tif( item != null ) {\n\t\t\t\t\t\t\tconst value = this._value = item.value;\n\t\t\t\t\t\t\tthis.emit( \"select\", value, this );\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Text No Items\n\t\tconst noteNoItems = new DNote( toNoteNoItemsOptions( theme, options, list ) );\n\t\tthis._noteNoItems = noteNoItems;\n\n\t\t// Text Searching\n\t\tconst noteSearching = new DNote( toNoteSearchingOptions( theme, options, list ) );\n\t\tthis._noteSearching = noteSearching;\n\n\t\t// Controller binding\n\t\tconst controller = options.controller;\n\t\tconst search = ( \"create\" in controller.search ?\n\t\t\tcontroller.search : new DDialogSelectSearh( controller.search )\n\t\t);\n\t\tthis._search = search;\n\t\tthis._input.on( \"input\", ( value: string ): void => {\n\t\t\tsearch.create([ value ]);\n\t\t});\n\n\t\tsearch.on( \"success\", ( e: unknown, searchResults: SEARCH_RESULT[] ): void => {\n\t\t\tthis.onSearched( searchResults );\n\t\t});\n\n\t\t// Visibility\n\t\tconst transition = new UtilTransition();\n\t\tsearch.on( \"change\", (): void => {\n\t\t\tif( search.isDone() ) {\n\t\t\t\tconst result = search.getResult();\n\t\t\t\tif( result != null && 0 < result.length ) {\n\t\t\t\t\ttransition.hide();\n\t\t\t\t} else {\n\t\t\t\t\ttransition.show( noteNoItems );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttransition.show( noteSearching );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onSearched( searchResults: SEARCH_RESULT[] ): void {\n\t\tconst list = this._list;\n\t\tconst toLabel = this._toLabel;\n\t\tconst content = list.content;\n\t\tconst children = content.children;\n\n\t\t// Update the existing children\n\t\tconst childrenLength = children.length;\n\t\tconst searchResultsLength = searchResults.length;\n\t\tconst minLength = Math.min( childrenLength, searchResultsLength );\n\t\tfor( let i = 0, imax = minLength; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst searchResult = searchResults[ i ];\n\t\t\tif( child instanceof DListItem ) {\n\t\t\t\tchild.text = toLabel( searchResult );\n\t\t\t\tchild.value = searchResult;\n\t\t\t} else {\n\t\t\t\tcontent.removeChildAt( i );\n\t\t\t\tchild.destroy();\n\t\t\t\tconst newChild = this.newItem( searchResult, toLabel( searchResult ) );\n\t\t\t\tcontent.addChildAt( newChild, i );\n\t\t\t}\n\t\t}\n\n\t\t// Insert new children\n\t\tfor( let i = minLength, imax = searchResultsLength; i < imax; ++i ) {\n\t\t\tconst searchResult = searchResults[ i ];\n\t\t\tconst newChild = this.newItem( searchResult, toLabel( searchResult ) );\n\t\t\tcontent.addChild( newChild );\n\t\t}\n\n\t\t// Remove unused children\n\t\tfor( let i = childrenLength - 1; minLength <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t}\n\n\tprotected newItem( searchResult: SEARCH_RESULT, label: string ): DDialogSelectListItem<SEARCH_RESULT> {\n\t\treturn new DDialogSelectListItem<SEARCH_RESULT>({\n\t\t\tvalue: searchResult,\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tget value() {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelect\";\n\t}\n\n\tprotected onOpen() {\n\t\tsuper.onOpen();\n\t\tthis._list.selection.clear();\n\t\tthis._search.create([ this._input.value ]);\n\t}\n\n\tprotected onClose() {\n\t\tsuper.onClose();\n\t}\n\n\tdestroy() {\n\t\tthis._input.destroy();\n\t\tthis._noteNoItems.destroy();\n\t\tthis._noteSearching.destroy();\n\t\tthis._list.destroy();\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\n\nexport interface Owner {\n\tfocus(): void;\n}\n\nexport interface Parent {\n\tparent: unknown;\n}\n\nexport interface Closeable extends DisplayObject {\n\tclose(): void;\n}\n\nexport class DMenuContext {\n\tprotected _owner: Owner;\n\tprotected _closeables: Closeable[];\n\n\tconstructor( owner: Owner ) {\n\t\tthis._owner = owner;\n\t\tthis._closeables = [];\n\t}\n\n\tprotected indexOf( target: unknown ): number {\n\t\treturn this._closeables.indexOf( target as any );\n\t}\n\n\tprotected close( index: number ): void {\n\t\tconst closeables = this._closeables;\n\t\tconst imin = Math.max( 0, index );\n\t\tfor( let i = closeables.length - 1; imin <= i; --i ) {\n\t\t\tcloseables[ i ].close();\n\t\t}\n\t}\n\n\tadd( closeable: Closeable ): void {\n\t\tthis._closeables.push( closeable );\n\t}\n\n\ttrim( closeable: Closeable | null ): void {\n\t\tthis.close( this.indexOf( closeable ) + 1 );\n\t}\n\n\tremove( closeable: Closeable ): void {\n\t\tconst index = this.indexOf( closeable );\n\t\tif( 0 <= index ) {\n\t\t\tthis.close( index + 1 );\n\t\t\tthis._closeables.splice( index, 1 );\n\t\t\tif( index === 0 ) {\n\t\t\t\tthis._owner.focus();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Point } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { isString } from \"./util/is-string\";\nimport { UtilAttach } from \"./util/util-attach\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilOverlay } from \"./util/util-overlay\";\n\nexport interface DMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenu = DThemeMenu\n> extends DLayoutVerticalOptions<THEME> {\n\talign?: (keyof typeof DMenuAlign) | DMenuAlign;\n\tfit?: boolean;\n\tsticky?: boolean;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n}\n\nexport interface DThemeMenu extends DThemeLayoutVertical {\n\tgetOffsetX(): number;\n\tgetOffsetY(): number;\n}\n\nexport class DMenu<\n\tVALUE,\n\tTHEME extends DThemeMenu = DThemeMenu,\n\tOPTIONS extends DMenuOptions<VALUE, THEME> = DMenuOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _align!: DMenuAlign;\n\tprotected _fit!: boolean;\n\tprotected _sticky!: boolean;\n\tprotected _sub!: boolean;\n\tprotected _owner!: DBase<any, any> | null;\n\tprotected _context!: DMenuContext | null;\n\tprotected _overlay!: UtilOverlay;\n\tprotected _onPrerenderBound!: () => void;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._onPrerenderBound = (): void => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tif( options != null ) {\n\t\t\tthis._align = ( options.align != null ?\n\t\t\t\t( isString( options.align ) ? DMenuAlign[ options.align ] : options.align ) :\n\t\t\t\tDMenuAlign.BOTTOM\n\t\t\t);\n\t\t\tthis._fit = ( options.fit != null ? options.fit : false );\n\t\t\tthis._sticky = ( options.sticky != null ? options.sticky : false );\n\t\t} else {\n\t\t\tthis._align = DMenuAlign.BOTTOM;\n\t\t\tthis._fit = false;\n\t\t\tthis._sticky = false;\n\t\t}\n\t\tthis._sub = false;\n\t\tthis._owner = null;\n\t\tthis.visible = false;\n\t\tthis._context = null;\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\n\t\t// Event handlers\n\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\tthis.on( \"select\", (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\t// Items\n\t\tif( options && options.items ) {\n\t\t\tDMenus.newItems( this, options.items, this._sticky );\n\t\t}\n\n\t\t// Overlay\n\t\tthis._overlay = new UtilOverlay( options );\n\t}\n\n\tfindItem( value: VALUE ): DMenuItem<VALUE> | null {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItem && child.value === value ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenu\";\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen( owner: DBase<any, any>, closeable?: Closeable | null, context?: DMenuContext | null ): this {\n\t\tif( this.isHidden() ) {\n\t\t\tconst layer = this._overlay.pick( this );\n\t\t\tthis._owner = owner;\n\n\t\t\t// States\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.setState( DBaseState.FOCUSED | DBaseState.HOVERED, false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Position & size\n\t\t\tconst renderer = layer.renderer;\n\t\t\tconst onPrerenderBound = this._onPrerenderBound;\n\t\t\tif( this._sticky ) {\n\t\t\t\trenderer.on( \"prerender\", onPrerenderBound );\n\t\t\t} else {\n\t\t\t\trenderer.once( \"prerender\", onPrerenderBound );\n\t\t\t}\n\t\t\tif( this._fit ) {\n\t\t\t\tconst bounds = owner.getBounds();\n\t\t\t\tif( bounds != null ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Target\n\t\t\tthis._sub = (context != null);\n\t\t\tcontext = context || new DMenuContext( owner );\n\t\t\tif( closeable != null ) {\n\t\t\t\tcontext.trim( closeable );\n\t\t\t}\n\t\t\tcontext.add( this );\n\t\t\tthis._context = context;\n\n\t\t\t// Stage\n\t\t\tlayer.stage.addChild( this );\n\n\t\t\t// Focus\n\t\t\tthis.focus();\n\n\t\t\t// Show\n\t\t\tsuper.show();\n\n\t\t\t// Event\n\t\t\tthis.emit( \"open\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst owner = this._owner;\n\t\tif( owner ) {\n\t\t\tconst bounds = owner.getBounds();\n\t\t\tif( bounds ) {\n\t\t\t\tif( this._fit ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t\tconst layer = this._overlay.picked;\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tUtilAttach.attach(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tbounds,\n\t\t\t\t\t\ttheme.getOffsetX(), theme.getOffsetY(),\n\t\t\t\t\t\tlayer.width, layer.height,\n\t\t\t\t\t\tthis._align\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclose(): this {\n\t\tif( this.isShown() ) {\n\t\t\tconst context = this._context;\n\t\t\tif( context ) {\n\t\t\t\tcontext.remove( this );\n\t\t\t}\n\n\t\t\tconst layer = this._overlay.picked;\n\t\t\tif( layer ) {\n\t\t\t\tlayer.renderer.off( \"prerender\", this._onPrerenderBound );\n\t\t\t}\n\n\t\t\tthis._owner = null;\n\n\t\t\tsuper.hide();\n\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent ) {\n\t\t\t\tparent.removeChild( this );\n\t\t\t}\n\n\t\t\tthis.emit( \"close\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowUpKey( e ) || UtilKeyboardEvent.isArrowDownKey( e ) ) {\n\t\t\tconst layer = this._overlay.picked;\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tconst focused = focusController.getFocused();\n\t\t\t\tif( focused != null ) {\n\t\t\t\t\tconst direction = UtilKeyboardEvent.isArrowDownKey( e );\n\t\t\t\t\tconst next = focusController.findFocusable(\n\t\t\t\t\t\tfocused, false, focused.hasState( DBaseState.FOCUS_ROOT ) || direction, direction\n\t\t\t\t\t);\n\t\t\t\t\tif( next != null ) {\n\t\t\t\t\t\tfocusController.setFocused( next, true, true );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn ! this._sub;\n\t}\n}\n\nDMenus.setMenuCreator( ( options?: DMenuOptions<any> ) => new DMenu<any>( options ) );\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\nimport { DMenu, DMenuOptions, DThemeMenu } from \"./d-menu\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\n/**\n * Dropdown options.\n */\nexport interface DDropdownOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown\n> extends DButtonBaseOptions<string, THEME> {\n\t/**\n\t * Menu options.\n\t */\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\n/**\n * A dropdown theme.\n */\nexport interface DThemeDropdown extends DThemeButtonBase {\n\tgetTextFormatter(): ( value: string, caller: DDropdown ) => string;\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\nexport class DDropdown<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown,\n\tOPTIONS extends DDropdownOptions<VALUE, THEME> = DDropdownOptions<VALUE, THEME>\n> extends DButtonBase<string, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tthis.start();\n\t\t});\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._menu = this.toMenu( this.theme, options );\n\t}\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options && options.menu;\n\t\treturn ( menu instanceof DMenu ? menu :\n\t\t\tnew DMenu<VALUE>( this.toMenuOptions( theme, menu ) )\n\t\t);\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE, DThemeMenu> {\n\t\toptions = options || {};\n\t\tif( options.fit == null ) {\n\t\t\toptions.fit = true;\n\t\t}\n\t\treturn options;\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\treturn this._menu;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDropdown\";\n\t}\n\n\tstart(): void {\n\t\tthis._menu.open( this );\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DListItem, DListItemSelection } from \"./d-list-item\";\nimport { DMenu } from \"./d-menu\";\nimport { isString } from \"./util/is-string\";\n\nexport enum DMenuSidedSelectionMode {\n\tNONE,\n\tSINGLE,\n\tSINGLE_ONCE,\n\tDEFAULT = SINGLE_ONCE\n}\n\nexport interface DMenuSidedSelectionOnOptions {\n\t[ name: string ]: Function;\n}\n\nexport interface DMenuSidedSelectionOptions {\n\tmode?: (keyof typeof DMenuSidedSelectionMode) | DMenuSidedSelectionMode;\n\ton?: DMenuSidedSelectionOnOptions;\n\tfilter?: ( item: DBase | null ) => boolean;\n}\n\nconst defaultFilter = () => true;\n\nexport class DMenuSidedSelection extends utils.EventEmitter implements DListItemSelection {\n\tprotected _content: Container;\n\tprotected _item: DBase | null;\n\tprotected _isDirty: boolean;\n\tprotected _mode: DMenuSidedSelectionMode;\n\tprotected _filter: ( item: DBase | null ) => boolean;\n\n\tconstructor( content: Container, options?: DMenuSidedSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._item = null;\n\t\tthis._isDirty = true;\n\t\tthis._mode = ( options && options.mode != null ?\n\t\t\t(isString( options.mode ) ? DMenuSidedSelectionMode[ options.mode ] : options.mode) :\n\t\t\tDMenuSidedSelectionMode.DEFAULT\n\t\t);\n\t\tthis._filter = ( options && options.filter ) || this.getFilterDefault();\n\n\t\t// Events\n\t\tconst on = options && options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate() {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis.update_( this._content );\n\t\t}\n\t}\n\n\tprotected hasMenu( child: any ): child is { menu: DMenu<any> } {\n\t\treturn child && child.menu instanceof DMenu;\n\t}\n\n\tprotected update_( root: Container ): void {\n\t\tconst children = root.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DListItem ) {\n\t\t\t\tif( child.isActive() ) {\n\t\t\t\t\tthis.set_( child, false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( child instanceof Container ) {\n\t\t\t\tthis.update_( child );\n\t\t\t}\n\n\t\t\tif( this.hasMenu( child ) ) {\n\t\t\t\tthis.update_( child.menu );\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tset( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tget(): DBase | null {\n\t\tthis.update();\n\t\treturn this._item;\n\t}\n\n\tsize(): number {\n\t\treturn ( this._item ? 1 : 0 );\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._item == null;\n\t}\n\n\tremove( item: DBase ): void {\n\t\tthis.update();\n\t\tif( this._item === item ) {\n\t\t\tthis.set_( null, true );\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tthis.set_( null, true );\n\t}\n\n\tprotected getFilterDefault(): ( item: DBase | null ) => boolean {\n\t\treturn defaultFilter;\n\t}\n\n\tprotected set_( item: DBase | null, emit: boolean ): void {\n\t\tconst oldItem = this._item;\n\t\tconst mode = this._mode;\n\t\tif( mode !== DMenuSidedSelectionMode.NONE && this._filter( item ) && oldItem !== item ) {\n\t\t\tthis.setState( oldItem, mode, false );\n\t\t\tthis._item = item;\n\t\t\tthis.setState( item, mode, true );\n\t\t\tif( emit ) {\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setState( item: DBase | null, mode: DMenuSidedSelectionMode, isOn: boolean ): void {\n\t\tif( item ) {\n\t\t\tif( mode === DMenuSidedSelectionMode.SINGLE ) {\n\t\t\t\titem.setState( DBaseState.ACTIVE, isOn );\n\t\t\t} else {\n\t\t\t\titem.setState( DBaseState.ACTIVE | DBaseState.READ_ONLY, isOn );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader = DThemeExpandableHeader\n> extends DImageOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeExpandableHeader extends DThemeImage {\n\n}\n\nexport class DExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader = DThemeExpandableHeader,\n\tOPTIONS extends DExpandableHeaderOptions<VALUE, THEME> = DExpandableHeaderOptions<VALUE, THEME>\n> extends DImage<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.on( UtilPointerEvent.down, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect();\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onSelect() {\n\t\tthis.emit( \"select\", this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( this.isActionable() && this.isFocused() && UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onSelect();\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DExpandableHeader, DExpandableHeaderOptions } from \"./d-expandable-header\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DExpandableOptions<\n\tTHEME extends DThemeExpandable = DThemeExpandable\n> extends DLayoutVerticalOptions<THEME> {\n\theader?: DisplayObject | DExpandableHeaderOptions;\n\tbody: Container;\n}\n\nexport interface DThemeExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DExpandable<\n\tTHEME extends DThemeExpandable = DThemeExpandable,\n\tOPTIONS extends DExpandableOptions<THEME> = DExpandableOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: Container;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.isActive() ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options && options.header ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DExpandableHeaderOptions ): DisplayObject {\n\t\treturn new DExpandableHeader( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options: OPTIONS ): Container {\n\t\treturn options.body;\n\t}\n\n\topen(): void {\n\t\tthis.setActive( true );\n\t}\n\n\tclose(): void {\n\t\tthis.setActive( false );\n\t}\n\n\ttoggle(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( DBaseStates.isActive( newState ) ) {\n\t\t\tif( ! DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\n\nexport interface DInputIntegerAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputIntegerOptions, THEME> {}\n\nexport class DInputIntegerAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputIntegerAndLabelOptions<THEME> = DInputIntegerAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputInteger, DInputIntegerOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputIntegerOptions<DThemeInputInteger> ): DInputInteger {\n\t\treturn new DInputInteger( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate, DMapPoint } from \"./d-map-coordinate\";\n\nexport class DMapCoordinateEPSG3857 implements DMapCoordinate {\n\tprotected static CIRCUMFERENCE_HALF: number = Math.PI * 6378137 /* Approximate earth radius in meter */;\n\tprotected _tileSize: number;\n\n\tconstructor( tileSize: number = 256 ) {\n\t\tthis._tileSize = tileSize;\n\t}\n\n\tgetTileSize(): number {\n\t\treturn this._tileSize;\n\t}\n\n\t/**\n\t * Converts the given (lon, lat) point in WGS84 to (x, y) in EPSG:900913.\n\t * The origin of the converted point (x, y) is at the middle-left corner.\n\t * The `meters` can be the same instance that is passed in as the `lonlat`.\n\t *\n\t * @param lonlat (lon, lat) point\n\t * @param meters (x, y) point in meters converted from the given lonlat.\n\t * @return (x, y) point in meters\n\t * @see https://www.maptiler.com/google-maps-coordinates-tile-bounds-projection/\n\t * @see https://qiita.com/MALORGIS/items/1a9114dd090e5b891bf7\n\t */\n\tlonLatToMeters( lonlat: DMapPoint, meters: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = lonlat.x * C / 180;\n\t\tmeters.y = Math.log( Math.tan( ( 90 + lonlat.y ) * Math.PI / 360 ) ) * C / Math.PI;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * The `lonlat` can be the same instance that is passed in as the `meters`.\n\t *\n\t * @param meters\n\t * @param lonlat\n\t */\n\tmetersToLonLat( meters: DMapPoint, lonlat: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tlonlat.x = meters.x / C * 180;\n\t\tlonlat.y = Math.atan( Math.exp( meters.y * Math.PI / C ) ) * 360 / Math.PI - 90;\n\t\treturn lonlat;\n\t}\n\n\t/**\n\t * Converts pixel coordinates in given zoom level of pyramid to EPSG:900913.\n\t * The origin of the `pixels` is the top-left corner.\n\t * The `meters` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToMeters( pixels: DMapPoint, tz: number, tileSize: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = pixels.x * R - C;\n\t\tmeters.y = C - pixels.y * R;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * Converts EPSG:900913 to pyramid pixel coordinates in given zoom level.\n\t * The origin of the pixels is the top-left corner.\n\t * The `pixels` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToPixels( meters: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tpixels.x = ( meters.x + C ) / R;\n\t\tpixels.y = ( C - meters.y ) / R;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns a tile covering region in given pixel coordinates.\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToTile( pixels: DMapPoint, tileSize: number, tile: DMapPoint ): DMapPoint {\n\t\ttile.x = Math.ceil( pixels.x / tileSize ) - 1;\n\t\ttile.y = Math.ceil( pixels.y / tileSize ) - 1;\n\t\treturn tile;\n\t}\n\n\t/**\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToTile( meters: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tconst Z = 1 << tz;\n\t\ttile.x = Math.ceil( 0.5 * ( meters.x / C + 1 ) * Z ) - 1;\n\t\ttile.y = Math.ceil( 0.5 * ( 1 - meters.y / C ) * Z ) - 1;\n\t\treturn tile;\n\t}\n\n\tlonLatToTile( lonlat: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\treturn this.metersToTile( this.lonLatToMeters( lonlat, tile ), tz, tile );\n\t}\n\n\tlonLatToPixels( lonlat: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\treturn this.metersToPixels( this.lonLatToMeters( lonlat, pixels ), tz, tileSize, pixels );\n\t}\n\n\tpixelsToLonLat( pixels: DMapPoint, tz: number, tileSize: number, lonlat: DMapPoint ): DMapPoint {\n\t\treturn this.metersToLonLat( this.pixelsToMeters( pixels, tz, tileSize, lonlat ), lonlat );\n\t}\n\n\t/**\n\t * The `pixels` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToPixels( tile: DMapPoint, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tpixels.x = tile.x * tileSize;\n\t\tpixels.y = tile.y * tileSize;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns bounds of the given tile in EPSG:900913 coordinates\n\t * The `meters` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToMeters( tile: DMapPoint, tz: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolutionMeter( tz );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = tile.x * R + C;\n\t\tmeters.y = C - tile.y * R;\n\t\treturn meters;\n\t}\n\n\tprotected toResolutionMeter( tz: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( 1 << tz );\n\t}\n\n\tprotected toResolution( tz: number, tileSize: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( tileSize << tz );\n\t}\n\n\ttoTileCount( tz: number ): number {\n\t\treturn (1 << tz);\n\t}\n\n\ttoTileCode( tz: number, tx: number, ty: number ): number {\n\t\treturn (tx << tz) + ty;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinateEPSG3857 } from \"./d-map-coordinate-epsg3857\";\n\nexport class DMapCoordinates {\n\tprotected static _default?: DMapCoordinate;\n\n\tstatic get DEFAULT(): DMapCoordinate {\n\t\tif( this._default == null ) {\n\t\t\tthis._default = new DMapCoordinateEPSG3857();\n\t\t}\n\t\treturn this._default;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, Renderer, resources, Sprite, Texture } from \"pixi.js\";\n\nexport class DMapTile {\n\ttx: number;\n\tty: number;\n\n\tprotected _sprite: Sprite;\n\n\tconstructor(\n\t\tparent: Container,\n\t\ttx: number, ty: number,\n\t\tpx: number, py: number,\n\t\tscale: number\n\t) {\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t\tconst sprite = new Sprite( Texture.EMPTY );\n\t\t(sprite as any).parent = parent;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t\tthis._sprite = sprite;\n\t}\n\n\tload( url: string, onLoaded: () => void ): void {\n\t\tconst texture = Texture.from( url, { resolution: 1 } );\n\t\tthis._sprite.texture = texture;\n\t\tif( texture.valid ) {\n\t\t\tonLoaded();\n\t\t} else {\n\t\t\ttexture.on( \"update\", onLoaded );\n\t\t}\n\t}\n\n\ttransform( px: number, py: number, scale: number ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t}\n\n\tget loaded(): boolean {\n\t\treturn this._sprite.texture.valid;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.updateTransform();\n\t\tsprite.render( renderer );\n\t}\n\n\tdestroy(): void {\n\t\tconst sprite = this._sprite;\n\t\tconst texture = sprite.texture;\n\t\tconst resource = texture.baseTexture.resource;\n\t\tlet image: HTMLImageElement | null = null;\n\t\tif( resource instanceof resources.BaseImageResource ) {\n\t\t\tif( resource.source instanceof HTMLImageElement ) {\n\t\t\t\timage = resource.source;\n\t\t\t}\n\t\t}\n\t\ttexture.destroy( true );\n\t\tsprite.destroy();\n\t\tif( image ) {\n\t\t\timage.src = \"\";\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTile } from \"./d-map-tile\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePlane {\n\tprotected static WORK: Point = new Point();\n\n\tprotected readonly _parent: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _tz: number;\n\tprotected _lon0: number;\n\tprotected _lat0: number;\n\tprotected _lon1: number;\n\tprotected _lat1: number;\n\tprotected readonly _tiles: Map<number, DMapTile>;\n\tprotected _renderer?: Renderer;\n\tprotected readonly _renderTileBound: ( tile: DMapTile ) => void;\n\tprotected _txmin: number;\n\tprotected _txmax: number;\n\tprotected _tymin: number;\n\tprotected _tymax: number;\n\tprotected readonly _deleteTileBound: ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ) => void;\n\tprotected readonly _destroyTileBound: ( tile: DMapTile ) => void;\n\tprotected _tileCount: number;\n\tprotected _tileScale: number;\n\tprotected _tileScaleRelative: number;\n\tprotected _tileSize: number;\n\tprotected _mapping: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _isLoaded: boolean;\n\tprotected readonly _updateLoadingStateForEach: ( tile: DMapTile ) => void;\n\tprotected readonly _onLoaded: () => void;\n\tprotected readonly _onLoadedBound: () => void;\n\tprotected _isOnLoadedCalled: boolean;\n\tprotected _isOnLoadedAllowed: boolean;\n\n\tconstructor(\n\t\tparent: DBase,\n\t\tbuilder: DMapTileUrlBuilder,\n\t\ttz: number,\n\t\tmapping: DMapTileMappingInternal,\n\t\tcoordinate: DMapCoordinate,\n\t\tonLoaded: () => void\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._builder = builder;\n\t\tthis._onLoaded = onLoaded;\n\t\tthis._isOnLoadedCalled = false;\n\t\tthis._isOnLoadedAllowed = true;\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._tz = tz;\n\t\tthis._lon0 = NaN;\n\t\tthis._lat0 = NaN;\n\t\tthis._lon1 = NaN;\n\t\tthis._lat1 = NaN;\n\t\tthis._tiles = new Map<number, DMapTile>();\n\t\tthis._renderTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.renderTile( tile );\n\t\t};\n\t\tthis._txmin = NaN;\n\t\tthis._txmax = NaN;\n\t\tthis._tymin = NaN;\n\t\tthis._tymax = NaN;\n\t\tthis._deleteTileBound = ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void => {\n\t\t\tthis.deleteTile( tile, tileCode, tiles );\n\t\t};\n\t\tthis._destroyTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.destroyTile( tile );\n\t\t};\n\t\tthis._updateLoadingStateForEach = ( tile: DMapTile ): void => {\n\t\t\tif( ! tile.loaded ) {\n\t\t\t\tthis._isLoaded = false;\n\t\t\t}\n\t\t};\n\t\tthis._tileCount = coordinate.toTileCount( tz );\n\t\tthis._tileScaleRelative = 1 / this._tileCount;\n\t\tthis._tileScale = mapping.scale * this._tileScaleRelative;\n\t\tthis._tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._mapping = mapping;\n\t\tthis._coordinate = coordinate;\n\t\tthis._isLoaded = true;\n\t}\n\n\tprotected newTile( tx: number, ty: number, px: number, py: number, scale: number ): DMapTile {\n\t\treturn new DMapTile( this._parent, tx, ty, px, py, scale );\n\t}\n\n\tprotected renderTile( tile: DMapTile ): void {\n\t\ttile.render( this._renderer! );\n\t}\n\n\tget tz(): number {\n\t\treturn this._tz;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis._renderer = renderer;\n\t\tthis._tiles.forEach( this._renderTileBound );\n\t}\n\n\tmove( lon0: number, lat0: number, lon1: number, lat1: number ): void {\n\t\tconst oldLon0 = this._lon0;\n\t\tconst oldLat0 = this._lat0;\n\t\tconst oldLon1 = this._lon1;\n\t\tconst oldLat1 = this._lat1;\n\t\tif( oldLon0 !== lon0 || oldLat0 !== lat0 || oldLon1 !== lon1 || oldLat1 !== lat1 ) {\n\t\t\tthis._lon0 = lon0;\n\t\t\tthis._lat0 = lat0;\n\t\t\tthis._lon1 = lon1;\n\t\t\tthis._lat1 = lat1;\n\n\t\t\tconst tz = this._tz;\n\t\t\tconst coordinate = this._coordinate;\n\n\t\t\tconst work = DMapTilePlane.WORK;\n\t\t\twork.set( lon0, lat0 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx0 = work.x;\n\t\t\tconst ty0 = work.y;\n\n\t\t\twork.set( lon1, lat1 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx1 = work.x;\n\t\t\tconst ty1 = work.y;\n\n\t\t\tconst tileCount = this._tileCount;\n\t\t\tlet txmin = Math.max( 0, tx0 );\n\t\t\tlet txmax = Math.min( tileCount - 1, tx1 );\n\t\t\tlet tymin = Math.max( 0, ty0 );\n\t\t\tlet tymax = Math.min( tileCount - 1, ty1 );\n\t\t\tconst dtxmin = txmin - this._txmin;\n\t\t\tconst dtxmax = txmax - this._txmax;\n\t\t\tconst dtymin = tymin - this._tymin;\n\t\t\tconst dtymax = tymax - this._tymax;\n\n\t\t\tconst isTxMinChanged = dtxmin !== dtxmin || dtxmin < 0 || 1 < dtxmin;\n\t\t\tconst isTxMaxChanged = dtxmax !== dtxmax || 0 < dtxmax || dtxmax < -1;\n\t\t\tconst isTyMinChanged = dtymin !== dtymin || dtymin < 0 || 1 < dtymin;\n\t\t\tconst isTyMaxChanged = dtymax !== dtymax || 0 < dtymax || dtymax < -1;\n\t\t\tif( isTxMinChanged || isTxMaxChanged || isTyMinChanged || isTyMaxChanged ) {\n\t\t\t\tif( isTxMinChanged ) {\n\t\t\t\t\tthis._txmin = txmin;\n\t\t\t\t} else {\n\t\t\t\t\ttxmin = this._txmin;\n\t\t\t\t}\n\t\t\t\tif( isTxMaxChanged ) {\n\t\t\t\t\tthis._txmax = txmax;\n\t\t\t\t} else {\n\t\t\t\t\ttxmax = this._txmax;\n\t\t\t\t}\n\t\t\t\tif( isTyMinChanged ) {\n\t\t\t\t\tthis._tymin = tymin;\n\t\t\t\t} else {\n\t\t\t\t\ttymin = this._tymin;\n\t\t\t\t}\n\t\t\t\tif( isTyMaxChanged ) {\n\t\t\t\t\tthis._tymax = tymax;\n\t\t\t\t} else {\n\t\t\t\t\ttymax = this._tymax;\n\t\t\t\t}\n\n\t\t\t\tconst tiles = this._tiles;\n\t\t\t\ttiles.forEach( this._deleteTileBound );\n\n\t\t\t\tconst ctx = (txmin + txmax) >> 1;\n\t\t\t\tconst cty = (tymin + tymax) >> 1;\n\t\t\t\tconst ltx = Math.max( ctx - txmin, txmax - ctx );\n\t\t\t\tconst lty = Math.max( cty - tymin, tymax - cty );\n\t\t\t\tconst lt = Math.max( ltx, lty );\n\n\t\t\t\tthis.toOffset( work );\n\t\t\t\tconst offsetX = work.x;\n\t\t\t\tconst offsetY = work.y;\n\n\t\t\t\tthis._isOnLoadedCalled = false;\n\t\t\t\tthis._isOnLoadedAllowed = false;\n\t\t\t\tthis.loadTile( tz, ctx, cty, offsetX, offsetY, work );\n\t\t\t\tfor( let it = 1; it <= lt; ++it ) {\n\t\t\t\t\tconst txa = ctx - it;\n\t\t\t\t\tif( txmin <= txa ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txa, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst txb = ctx + it;\n\t\t\t\t\tif( txb <= txmax ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txb, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tya = cty - it;\n\t\t\t\t\tif( tymin <= tya ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tya, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tyb = cty + it;\n\t\t\t\t\tif( tyb <= tymax ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tyb, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._isOnLoadedAllowed = true;\n\t\t\t\tif( this._isOnLoadedCalled ) {\n\t\t\t\t\tthis.onLoaded();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesX(\n\t\ttz: number,\n\t\tctx: number, ltx: number, txmin: number, txmax: number,\n\t\tty: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, ctx, ty, ox, oy, work );\n\t\tfor( let i = 1; i <= ltx; ++i ) {\n\t\t\tconst txa = ctx - i;\n\t\t\tif( txmin <= txa ) {\n\t\t\t\tthis.loadTile( tz, txa, ty, ox, oy, work );\n\t\t\t}\n\t\t\tconst txb = ctx + i;\n\t\t\tif( txb <= txmax ) {\n\t\t\t\tthis.loadTile( tz, txb, ty, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesY(\n\t\ttz: number, tx: number,\n\t\tcty: number, lty: number, tymin: number, tymax: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, tx, cty, ox, oy, work );\n\t\tfor( let i = 1; i <= lty; ++i ) {\n\t\t\tconst tya = cty - i;\n\t\t\tif( tymin <= tya ) {\n\t\t\t\tthis.loadTile( tz, tx, tya, ox, oy, work );\n\t\t\t}\n\t\t\tconst tyb = cty + i;\n\t\t\tif( tyb <= tymax ) {\n\t\t\t\tthis.loadTile( tz, tx, tyb, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTile( tz: number, tx: number, ty: number, ox: number, oy: number, work: Point ): void {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileCode = coordinate.toTileCode( tz, tx, ty );\n\t\tconst tiles = this._tiles;\n\t\tlet tile = tiles.get( tileCode );\n\t\tif( tile == null ) {\n\t\t\tthis.toTilePosition( tx, ty, ox, oy, work );\n\t\t\ttile = this.newTile( tx, ty, work.x, work.y, this._tileScale );\n\t\t\ttiles.set( tileCode, tile );\n\t\t\ttile.load( this._builder( tz, tx, ty ), this._onLoadedBound );\n\t\t\tthis._isLoaded = false;\n\t\t}\n\t}\n\n\tprotected toTilePosition( tx: number, ty: number, ox: number, oy: number, result: Point ): Point {\n\t\tconst tileSize = this._tileSize;\n\t\tconst tileScaleRelative = this._tileScaleRelative;\n\t\tresult.set( tx, ty );\n\t\tthis._coordinate.tileToPixels( result, tileSize, result );\n\t\tresult.set( result.x * tileScaleRelative + ox, result.y * tileScaleRelative + oy );\n\t\treturn result;\n\t}\n\n\tprotected toOffset( result: Point ): Point {\n\t\tconst parent = this._parent;\n\t\tconst mapping = this._mapping;\n\t\tconst tileSize = this._tileSize;\n\t\tresult.set(\n\t\t\t-mapping.x * tileSize + parent.width * 0.5,\n\t\t\t-mapping.y * tileSize + parent.height * 0.5\n\t\t);\n\t\treturn result;\n\t}\n\n\tprotected deleteTile( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void {\n\t\tconst tx = tile.tx;\n\t\tconst ty = tile.ty;\n\t\tif( tx < this._txmin || this._txmax < tx || ty < this._tymin || this._tymax < ty ) {\n\t\t\ttiles.delete( tileCode );\n\t\t\ttile.destroy();\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst tiles = this._tiles;\n\t\ttiles.forEach( this._destroyTileBound );\n\t\ttiles.clear();\n\t}\n\n\tprotected destroyTile( tile: DMapTile ): void {\n\t\ttile.destroy();\n\t}\n\n\tprotected updateLoadingState(): void {\n\t\tthis._isLoaded = true;\n\t\tthis._tiles.forEach( this._updateLoadingStateForEach );\n\t}\n\n\tprotected onLoaded(): void {\n\t\tif( this._isOnLoadedAllowed ) {\n\t\t\tthis._onLoaded();\n\t\t} else {\n\t\t\tthis._isOnLoadedCalled = true;\n\t\t}\n\t}\n\n\tget loaded(): boolean {\n\t\tif( ! this._isLoaded ) {\n\t\t\tthis.updateLoadingState();\n\t\t}\n\t\treturn this._isLoaded;\n\t}\n\n\tget mapping(): DMapTileMappingInternal {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMappingInternal ) {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileScale = mapping.scale * this._tileScaleRelative;\n\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._tileScale = tileScale;\n\t\tthis._tileSize = tileSize;\n\t\tthis._mapping = mapping;\n\n\t\tconst work = DMapTilePlane.WORK;\n\t\tthis.toOffset( work );\n\t\tconst offsetX = work.x;\n\t\tconst offsetY = work.y;\n\n\t\tthis._tiles.forEach(( tile: DMapTile ): void => {\n\t\t\tthis.toTilePosition( tile.tx, tile.ty, offsetX, offsetY, work );\n\t\t\ttile.transform( work.x, work.y, tileScale );\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTileMapping } from \"./d-map-tile-mapping\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTilePlane } from \"./d-map-tile-plane\";\nimport { DMapTilePyramid, DMapTilePyramidOptions } from \"./d-map-tile-pyramid\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePyramidImpl extends utils.EventEmitter implements DMapTilePyramid {\n\tprotected static WORK_LONLAT: Point = new Point();\n\n\tprotected readonly _canvas: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _planes: Array<DMapTilePlane | undefined>;\n\tprotected _z: number;\n\tprotected _tz: number;\n\tprotected _minZ: number;\n\tprotected _maxZ: number;\n\tprotected _mapping: DMapTileMapping;\n\tprotected _mappingInternal: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _onLoadedBound: () => void;\n\tprotected _fitBound: () => void;\n\tprotected _fitBoundTimeout: number | undefined;\n\tprotected _fitThrottledBound: () => void;\n\tprotected _fitThrottle: number;\n\n\tconstructor( options: DMapTilePyramidOptions ) {\n\t\tsuper();\n\t\tconst canvas = this._canvas = options.canvas;\n\t\tthis._builder = options.builder;\n\t\tconst mappingLonLat = this._mapping = options.mapping;\n\t\tconst coordinate = this._coordinate = options.coordinate;\n\t\tthis._mappingInternal = this.toMapping( canvas, mappingLonLat, coordinate );\n\t\tthis._z = NaN;\n\t\tthis._tz = NaN;\n\t\tthis._minZ = options.plane.min;\n\t\tthis._maxZ = options.plane.max;\n\t\tthis._planes = [];\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._fitBound = (): void => {\n\t\t\tthis._fitBoundTimeout = undefined;\n\t\t\tthis.fit();\n\t\t};\n\t\tthis._fitThrottle = options.plane.throttle;\n\t\tconst fitThrottledBound = this._fitThrottledBound = (): void => {\n\t\t\tthis.fitThrottled();\n\t\t};\n\t\tcanvas.on( \"scale\", fitThrottledBound );\n\t\tcanvas.on( \"move\", fitThrottledBound );\n\t\tcanvas.appendRenderable( this, true );\n\t}\n\n\tget coordinate(): DMapCoordinate {\n\t\treturn this._coordinate;\n\t}\n\n\tprotected fitThrottled(): void {\n\t\tif( this._fitBoundTimeout == null ) {\n\t\t\tthis._fitBoundTimeout = window.setTimeout( this._fitBound, this._fitThrottle );\n\t\t}\n\t}\n\n\tprotected toMapping( canvas: DBase, mapping: DMapTileMapping, coordinate: DMapCoordinate ): DMapTileMappingInternal {\n\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\tconst tileSize = coordinate.getTileSize();\n\n\t\twork.set( mapping.from.lon, mapping.from.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x0 = work.x;\n\t\tconst y0 = work.y;\n\n\t\twork.set( mapping.to.lon, mapping.to.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x1 = work.x;\n\t\tconst y1 = work.y;\n\n\t\tconst dx = Math.abs(x1 - x0);\n\t\tconst dy = Math.abs(y1 - y0);\n\t\tconst dmin = 0.0000001;\n\t\tlet scale = 1;\n\t\tif( dmin < dx ) {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = Math.max( canvas.width / dx, canvas.height / dy );\n\t\t\t} else {\n\t\t\t\tscale = canvas.width / dx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = canvas.height / dy;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tscale,\n\t\t\tx: 0.5 * (x1 + x0) / tileSize,\n\t\t\ty: 0.5 * (y1 + y0) / tileSize\n\t\t};\n\t}\n\n\tget mapping(): DMapTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMapping ) {\n\t\tconst oldMapping = this._mappingInternal;\n\t\tconst newMapping = this.toMapping( this._canvas, mapping, this._coordinate );\n\t\tconst threshold = 0.0000001;\n\t\tif(\n\t\t\tthreshold < Math.abs(oldMapping.scale - newMapping.scale) ||\n\t\t\tthreshold < Math.abs(oldMapping.x - newMapping.x) ||\n\t\t\tthreshold < Math.abs(oldMapping.y - newMapping.y)\n\t\t) {\n\t\t\tthis._mappingInternal = newMapping;\n\n\t\t\tconst planes = this._planes;\n\t\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\t\tconst plane = planes[ i ];\n\t\t\t\tif( plane ) {\n\t\t\t\t\tplane.mapping = newMapping;\n\t\t\t\t}\n\t\t\t}\n\t\t\tDApplications.update( this._canvas );\n\n\t\t\tthis._fitThrottledBound();\n\t\t}\n\t}\n\n\tprotected newPlane( tz: number ): DMapTilePlane {\n\t\treturn new DMapTilePlane(\n\t\t\tthis._canvas,\n\t\t\tthis._builder,\n\t\t\ttz,\n\t\t\tthis._mappingInternal,\n\t\t\tthis._coordinate,\n\t\t\tthis._onLoadedBound\n\t\t);\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = planes.length - 1; tz < i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz != null ) {\n\t\t\tplaneTz.render( renderer );\n\t\t}\n\t}\n\n\tprotected toTileZ( tz: number ): number {\n\t\treturn Math.min( this._maxZ, Math.max( this._minZ, Math.floor( tz ) ) );\n\t}\n\n\tupdateTransform(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected toZ( scale: number ): number {\n\t\treturn Math.log( this._mappingInternal.scale * scale ) / Math.log( 2 );\n\t}\n\n\tmove( scale: number, lon0: number, lat0: number, lon1: number, lat1: number ): this {\n\t\tconst planes = this._planes;\n\t\tconst z = this.toZ( scale );\n\t\tif( this._z !== z ) {\n\t\t\tthis._z = z;\n\n\t\t\tconst tz = this.toTileZ( z );\n\t\t\tif( this._tz !== tz ) {\n\t\t\t\tthis._tz = tz;\n\n\t\t\t\tlet newPlane = planes[ tz ];\n\t\t\t\tif( newPlane == null ) {\n\t\t\t\t\tnewPlane = this.newPlane( tz );\n\t\t\t\t\tplanes[ tz ] = newPlane;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst plane = planes[ this._tz ];\n\t\tif( plane != null ) {\n\t\t\tplane.move( lon0, lat0, lon1, lat1 );\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tfit(): this {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst container = canvas.parent;\n\t\t\tif( container != null ) {\n\t\t\t\tconst scale = canvas.scale;\n\t\t\t\tconst scaleX = scale.x;\n\t\t\t\tconst scaleY = scale.y;\n\t\t\t\tconst x = canvas.x;\n\t\t\t\tconst y = canvas.y;\n\t\t\t\tconst coordinate = this._coordinate;\n\t\t\t\tconst mapping = this._mappingInternal;\n\t\t\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\t\t\tconst x0 = mapping.x * tileSize - (x / scaleX + 0.5 * canvas.width);\n\t\t\t\tconst x1 = x0 + container.width / scaleX;\n\t\t\t\tconst y0 = mapping.y * tileSize - (y / scaleY + 0.5 * canvas.height);\n\t\t\t\tconst y1 = y0 + container.height / scaleY;\n\n\t\t\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\t\t\twork.set( x0, y0 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon0 = work.x;\n\t\t\t\tconst lat0 = work.y;\n\n\t\t\t\twork.set( x1, y1 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon1 = work.x;\n\t\t\t\tconst lat1 = work.y;\n\n\t\t\t\tthis.move( scaleX, lon0, lat0, lon1, lat1 );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tprotected destroyPlanesBefore( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected destroyPlanesAfter( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz && planeTz.loaded ) {\n\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\tthis.destroyPlanesAfter( tz, planes );\n\t\t\treturn;\n\t\t}\n\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\t\tthis.destroyPlanesAfter( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = tz - 1; 0 <= i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onLoaded(): void {\n\t\tthis.cleanup();\n\t\tDApplications.update( this._canvas );\n\t}\n\n\tdestroy(): this {\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tconst fitThrottledBound = this._fitThrottledBound;\n\t\tcanvas.off( \"scale\", fitThrottledBound );\n\t\tcanvas.off( \"move\", fitThrottledBound );\n\t\tcanvas.removeRenderable( this, true );\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinates } from \"./d-map-coordinates\";\nimport { DMapTilePyramid, DMapTilePyramidPlaneOptions } from \"./d-map-tile-pyramid\";\nimport { DMapTilePyramidImpl } from \"./d-map-tile-pyramid-impl\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport const DMapTileUrlBuilderKokudo: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\tif( 5 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/pale/${tz}/${tx}/${ty}.png`;\n\t} else if( 2 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/std/${tz}/${tx}/${ty}.png`;\n\t} else {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/${tz}/${tx}/${ty}.png`;\n\t}\n};\n\nexport const DMapTileUrlBuilderOsm: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://${\"abc\"[( tx + ty ) % 3]}.tile.openstreetmap.org/${tz}/${tx}/${ty}.png`;\n};\n\nexport const DMapTileUrlBuilderOsmfj: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://j.tile.openstreetmap.jp/${tz}/${tx}/${ty}.png`;\n};\n\nexport interface DMapTilePyramidsFromOptions {\n\tcanvas: DDiagramCanvasBase<any, any>;\n\tbuilder?: DMapTileUrlBuilder;\n\tcoordinate?: DMapCoordinate;\n\tplane?: Partial<DMapTilePyramidPlaneOptions>;\n}\n\nexport class DMapTilePyramids {\n\tprotected static MIN: number = 0;\n\tprotected static MAX: number = 18;\n\tprotected static THROTTLE: number = 333;\n\n\tprotected static toPlaneOptions( options: DMapTilePyramidsFromOptions ) {\n\t\tconst plane = options.plane;\n\t\tif( plane ) {\n\t\t\treturn {\n\t\t\t\tmin: ( plane.min != null ? plane.min : this.MIN ),\n\t\t\t\tmax: ( plane.max != null ? plane.max : this.MAX ),\n\t\t\t\tthrottle: ( plane.throttle != null ? plane.throttle : this.THROTTLE )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tmin: this.MIN,\n\t\t\t\tmax: this.MAX,\n\t\t\t\tthrottle: this.THROTTLE\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic from( options: DMapTilePyramidsFromOptions ): DMapTilePyramid {\n\t\treturn new DMapTilePyramidImpl({\n\t\t\tcanvas: options.canvas,\n\t\t\tbuilder: options.builder || DMapTileUrlBuilderOsmfj,\n\t\t\tmapping: options.canvas.tile.mapping,\n\t\t\tcoordinate: options.coordinate || DMapCoordinates.DEFAULT,\n\t\t\tplane: this.toPlaneOptions( options )\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\n\nexport interface DMenuBarItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem = DThemeMenuBarItem\n> extends DButtonOptions<VALUE, THEME> {\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuBarItem extends DThemeButton {\n\n}\n\nexport class DMenuBarItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem = DThemeMenuBarItem,\n\tOPTIONS extends DMenuBarItemOptions<VALUE, THEME> = DMenuBarItemOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._menu = this.toMenu( this.theme, options );\n\t\tthis._menu.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void => {\n\t\t\tthis.onSelect( value, item, menu );\n\t\t});\n\t}\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options && options.menu;\n\t\tif( menu instanceof DMenu ) {\n\t\t\treturn menu;\n\t\t} else {\n\t\t\treturn new DMenu( this.toMenuOptions( theme, menu ) );\n\t\t}\n\t}\n\n\tprotected newMenu( theme: THEME, options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn new DMenu<VALUE>( this.toMenuOptions( theme, options ) );\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE> | undefined {\n\t\toptions = options || {};\n\t\tif( options.fit == null ) {\n\t\t\toptions.fit = false;\n\t\t}\n\t\treturn options;\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n\n\tget menu() {\n\t\treturn this._menu;\n\t}\n\n\tprotected onSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tparent.emit( \"select\", value, item, menu );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBarItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, interaction, Point } from \"pixi.js\";\nimport { DMenuBarItem } from \"./d-menu-bar-item\";\nimport { Closeable } from \"./d-menu-context\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DMenuBarBlocker extends Container {\n\tconstructor( target: Closeable & Container ) {\n\t\tsuper();\n\t\tthis.renderable = false;\n\t\tthis.interactive = true;\n\n\t\tthis.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\ttarget.close();\n\t\t\t}\n\t\t});\n\t\tthis.on( UtilPointerEvent.move, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst children = target.children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\tif( child instanceof DMenuBarItem ) {\n\t\t\t\t\t\tchild.setHovered( child.containsPoint( e.data.global ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcontainsPoint( global: Point ): boolean {\n\t\treturn true;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DMenuBarBlocker } from \"./d-menu-bar-blocker\";\nimport { DMenuBarItem, DMenuBarItemOptions, DThemeMenuBarItem } from \"./d-menu-bar-item\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilOverlay } from \"./util/util-overlay\";\n\nexport interface DMenuBarOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar\n> extends DLayoutHorizontalOptions<THEME> {\n\titems?: Array<DMenuBarItemOptions<VALUE, DThemeMenuBarItem> | DisplayObject>;\n}\n\nexport interface DThemeMenuBar extends DThemeLayoutHorizontal {\n\n}\n\nexport class DMenuBar<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar,\n\tOPTIONS extends DMenuBarOptions<VALUE, THEME> = DMenuBarOptions<VALUE, THEME>\n>　extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _context!: DMenuContext | null;\n\tprotected _blocker!: DMenuBarBlocker;\n\tprotected _overlay!: UtilOverlay;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\n\t\tif( options != null && options.items != null ) {\n\t\t\tconst items = options.items;\n\t\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\t\tthis.close();\n\t\t\t});\n\t\t\tconst onItemStateChangeBound = ( newState: DBaseState, oldState: DBaseState, item: DMenuBarItem<VALUE> ): void => {\n\t\t\t\tthis.onItemStateChange( newState, oldState, item );\n\t\t\t};\n\t\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\t\tconst itemOrItemOptions = items[ i ];\n\t\t\t\tconst item = ( itemOrItemOptions instanceof DisplayObject ?\n\t\t\t\t\titemOrItemOptions : new DMenuBarItem<VALUE>( itemOrItemOptions )\n\t\t\t\t);\n\t\t\t\tif( item instanceof DMenuBarItem ) {\n\t\t\t\t\titem.on( \"statechange\", onItemStateChangeBound );\n\t\t\t\t}\n\t\t\t\tthis.addChild( item );\n\t\t\t}\n\t\t}\n\n\t\tthis.on( \"select\", (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\tthis._context = null;\n\t\tthis._blocker = new DMenuBarBlocker( this );\n\t\tthis._overlay = new UtilOverlay( options );\n\t}\n\n\tprotected onItemStateChange( newState: DBaseState, oldState: DBaseState, item: DMenuBarItem<VALUE> ): void {\n\t\tconst context = this._context;\n\t\tif( context == null ) {\n\t\t\tif( ! DBaseStates.isDisabled( newState ) ) {\n\t\t\t\tif( DBaseStates.isPressed( newState ) ) {\n\t\t\t\t\tif( item.menu.isHidden() ) {\n\t\t\t\t\t\titem.setPressed( false );\n\t\t\t\t\t\tthis.open( item );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( ! DBaseStates.isDisabled( newState ) ) {\n\t\t\t\tif( DBaseStates.isHovered( newState ) && ! DBaseStates.isHovered( oldState ) ) {\n\t\t\t\t\tconst menu = item.menu;\n\t\t\t\t\tif( menu.isHidden() ) {\n\t\t\t\t\t\tmenu.open( item, this, context );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen( item: DMenuBarItem<VALUE> ): void {\n\t\tlet context = this._context;\n\t\tif( context == null ) {\n\t\t\tconst layer = this._overlay.pick( this );\n\t\t\tlayer.stage.addChild( this._blocker );\n\t\t\tcontext = this._context = new DMenuContext( this );\n\t\t\tcontext.trim( item );\n\t\t\tcontext.add( this );\n\t\t\titem.menu.open( item, this, context );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tconst context = this._context;\n\t\tif( context != null ) {\n\t\t\tthis._context = null;\n\t\t\tcontext.remove( this );\n\t\t\tconst blocker = this._blocker;\n\t\t\tconst parent = blocker.parent;\n\t\t\tif( parent ) {\n\t\t\t\tparent.removeChild( blocker );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBar\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuSidedContentOptions<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuSidedContent extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuSidedContent<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent,\n\tOPTIONS extends DMenuSidedContentOptions<THEME> = DMenuSidedContentOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DDialogSelect, DDialogSelectOptions } from \"./d-dialog-select\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DTableBodyCellCheckOptions } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColorOptions } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDateOptions } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetimeOptions } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndexOptions } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputIntegerOptions } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputRealOptions } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputTextOptions } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellSelectDialogOptions } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectFetcherOptions } from \"./d-table-body-cell-select-fetcher\";\nimport { DTableBodyCellSelectMenuOptions } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellTextOptions } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTimeOptions } from \"./d-table-body-cell-time\";\nimport { DTableDataComparatorFunction, DTableDataComparatorObject } from \"./d-table-data-sorter\";\nimport { DTableHeaderCellOptions } from \"./d-table-header-cell\";\n\nexport enum DTableColumnType {\n\tINDEX,\n\tTEXT,\n\tINTEGER,\n\tREAL,\n\tCHECK,\n\tCOLOR,\n\tBUTTON,\n\tSELECT,\n\tDATE,\n\tDATETIME,\n\tTIME\n}\n\nexport type DTableGetter<ROW> = ( row: ROW, index: number ) => unknown;\nexport type DTableSetter<ROW> = ( row: ROW, index: number, cell: unknown ) => void;\nexport type DTableFormatter = ( cell: unknown ) => string;\nexport type DTableEditingFormatter = ( cell: unknown ) => string;\nexport type DTableEditingUnformatter = ( cell: string ) => unknown;\nexport type DTableEditingValidator = ( cell: unknown ) => unknown;\nexport type DTableSelectingGetter = ( selected: unknown ) => unknown;\n\nexport type DTableBodyCellOptionsUnion<ROW> = DTableBodyCellTextOptions<ROW> | DTableBodyCellInputTextOptions<ROW> |\n\tDTableBodyCellInputIntegerOptions<ROW> | DTableBodyCellInputRealOptions<ROW> | DTableBodyCellIndexOptions<ROW> |\n\tDTableBodyCellColorOptions<ROW> | DTableBodyCellCheckOptions<ROW> | DTableBodyCellSelectDialogOptions<ROW> |\n\tDTableBodyCellSelectFetcherOptions<ROW> | DTableBodyCellSelectMenuOptions<ROW> | DTableBodyCellDateOptions<ROW> |\n\tDTableBodyCellDatetimeOptions<ROW> | DTableBodyCellTimeOptions<ROW>;\n\nexport type DTableBodyCellOptionsMerged<ROW> = DTableBodyCellTextOptions<ROW> & DTableBodyCellInputTextOptions<ROW> &\n\tDTableBodyCellInputIntegerOptions<ROW> & DTableBodyCellInputRealOptions<ROW> & DTableBodyCellIndexOptions<ROW> &\n\tDTableBodyCellColorOptions<ROW> & DTableBodyCellCheckOptions<ROW> & DTableBodyCellSelectDialogOptions<ROW> &\n\tDTableBodyCellSelectFetcherOptions<ROW> & DTableBodyCellSelectMenuOptions<ROW> & DTableBodyCellDateOptions<ROW> &\n\tDTableBodyCellDatetimeOptions<ROW> & DTableBodyCellTimeOptions<ROW>;\n\nexport interface DTableColumnEditingOptions {\n\tenable?: boolean;\n\tformatter?: DTableEditingFormatter;\n\tunformatter?: DTableEditingUnformatter;\n\tvalidator?: DTableEditingValidator;\n}\n\nexport interface DTableColumnEditing {\n\tenable: boolean;\n\tformatter: DTableEditingFormatter;\n\tunformatter: DTableEditingUnformatter;\n\tvalidator?: DTableEditingValidator;\n}\n\nexport interface DTableColumnSortingOptions<ROW> {\n\tenable?: boolean;\n\tcomparator?: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW>;\n}\n\nexport interface DTableColumnSorting<ROW> {\n\tenable: boolean;\n\tcomparator?: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW>;\n}\n\nexport interface DTableColumnSelectingOptions {\n\tgetter?: DTableSelectingGetter;\n\n\tmenu?: DMenuOptions<unknown> | DMenu<unknown>;\n\tdialog?: DDialogSelectOptions<unknown> | DDialogSelect<unknown>;\n\tfetcher?: () => Promise<unknown>;\n}\n\nexport interface DTableColumnSelecting {\n\tgetter: DTableSelectingGetter;\n\n\tmenu?: DMenu<unknown>;\n\tdialog?: DDialogSelect<unknown>;\n\tfetcher?: () => Promise<unknown>;\n}\n\nexport interface DTableColumnOptions<ROW> {\n\tweight?: number;\n\twidth?: number;\n\n\ttype?: (keyof typeof DTableColumnType) | DTableColumnType;\n\tlabel?: string;\n\tgetter?: DTableGetter<ROW>;\n\tsetter?: DTableSetter<ROW>;\n\tformatter?: DTableFormatter;\n\talign?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n\n\teditable?: boolean;\n\tediting?: DTableColumnEditingOptions;\n\n\tsortable?: boolean;\n\tsorting?: DTableColumnSortingOptions<ROW>;\n\n\theader?: DTableHeaderCellOptions<ROW>;\n\tbody?: DTableBodyCellOptionsUnion<ROW>;\n\n\tselecting?: DTableColumnSelectingOptions;\n\n\tcategory?: string;\n\tfrozen?: boolean;\n}\n\nexport interface DTableColumn<ROW> {\n\tweight: number | undefined;\n\twidth: number | undefined;\n\n\ttype: DTableColumnType;\n\tlabel: string;\n\tgetter: DTableGetter<ROW>;\n\tsetter: DTableSetter<ROW>;\n\tformatter?: DTableFormatter;\n\talign: DAlignHorizontal;\n\n\tediting: DTableColumnEditing;\n\tsorting: DTableColumnSorting<ROW>;\n\n\theader?: DTableHeaderCellOptions<ROW>;\n\tbody?: DTableBodyCellOptionsUnion<ROW>;\n\n\tselecting: DTableColumnSelecting;\n\n\tcategory?: string;\n\tfrozen?: boolean;\n\toffset: number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSidedContent, DMenuSidedContentOptions } from \"./d-menu-sided-content\";\nimport { DMenuSidedSelection, DMenuSidedSelectionOptions } from \"./d-menu-sided-selection\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\n\nexport interface DMenuSidedOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DBaseOptions = DMenuSidedContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n\tselection?: DMenuSidedSelectionOptions | DMenuSidedSelection;\n}\n\nexport interface DThemeMenuSided extends DThemePane {\n\n}\n\nexport class DMenuSided<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DMenuSidedContentOptions = DMenuSidedContentOptions,\n\tOPTIONS extends DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS> = DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _context!: DMenuContext | null;\n\tprotected _selection!: DMenuSidedSelection;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst context = new DMenuContext( this );\n\t\tthis._context = context;\n\t\tcontext.add( this );\n\n\t\tconst items = options && options.items;\n\t\tif( items != null ) {\n\t\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\t\tthis.newItems( items, sticky );\n\t\t}\n\n\t\tconst selection = options && options.selection;\n\t\tthis._selection = ( selection instanceof DMenuSidedSelection ?\n\t\t\tselection : this.newSelection( selection ) );\n\t}\n\n\tprotected newSelection( options?: DMenuSidedSelectionOptions ): DMenuSidedSelection {\n\t\treturn new DMenuSidedSelection( this._content, options );\n\t}\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tprotected newItems( items: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>, sticky: boolean ): void {\n\t\tDMenuSideds.newItems( this.content, items, sticky );\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DMenuSidedContent( options );\n\t}\n\n\tget selection(): DMenuSidedSelection {\n\t\treturn this._selection;\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen(): void {\n\t\t// DO NOTHING\n\t}\n\n\tclose(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSided\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DNotificationOptions<THEME extends DThemeNotification> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeNotification extends DThemeBase {\n\n}\n\nexport class DNotification<\n\tTHEME extends DThemeNotification = DThemeNotification,\n\tOPTIONS extends DNotificationOptions<THEME> = DNotificationOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPaginationOptions<THEME extends DThemePagination> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePagination extends DThemeBase {\n\n}\n\nexport class DPagination<\n\tTHEME extends DThemePagination = DThemePagination,\n\tOPTIONS extends DPaginationOptions<THEME> = DPaginationOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerDatetimeRangeOptions<THEME extends DThemePickerDatetimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeRange extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeRange<\n\tTHEME extends DThemePickerDatetimeRange = DThemePickerDatetimeRange,\n\tOPTIONS extends DPickerDatetimeRangeOptions<THEME> = DPickerDatetimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerTimeRangeOptions<THEME extends DThemePickerTimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerTimeRange extends DThemeBase {\n\n}\n\nexport class DPickerTimeRange<\n\tTHEME extends DThemePickerTimeRange = DThemePickerTimeRange,\n\tOPTIONS extends DPickerTimeRangeOptions<THEME> = DPickerTimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdown, DDropdownOptions, DThemeDropdown } from \"./d-dropdown\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu } from \"./d-menu-item-menu\";\n\n/**\n * DSelect options.\n */\nexport interface DSelectOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect = DThemeSelect\n> extends DDropdownOptions<VALUE, THEME> {\n\t/**\n\t * A default value.\n\t */\n\tvalue?: VALUE;\n}\n\nexport interface DThemeSelect extends DThemeDropdown {\n\n}\n\nexport class DSelect<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect = DThemeSelect,\n\tOPTIONS extends DSelectOptions<VALUE, THEME> = DSelectOptions<VALUE, THEME>\n> extends DDropdown<VALUE, THEME, OPTIONS> {\n\tprotected _value!: VALUE | null;\n\tprotected _onSelectedBound!: ( value: VALUE, child: DMenuItem<VALUE> ) => void;\n\tprotected _onClosedBound!: () => void;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._value = null;\n\n\t\tthis._onSelectedBound = ( value: VALUE, child: DMenuItem<VALUE> ): void => {\n\t\t\tthis.onSelected( value, child, true );\n\t\t};\n\t\tthis._onClosedBound = (): void => {\n\t\t\tthis.onClosed();\n\t\t};\n\n\t\t// Default value\n\t\tif( options != null && options.value !== undefined ) {\n\t\t\tthis.value = options.value;\n\t\t}\n\t}\n\n\tprotected onSelected( newValue: VALUE | null, item: DMenuItem<VALUE> | null, emit: boolean ): void {\n\t\tif( this._value !== newValue ) {\n\t\t\t// Value\n\t\t\tconst oldValue = this._value;\n\t\t\tthis._value = newValue;\n\n\t\t\t// Text\n\t\t\tif( item != null ) {\n\t\t\t\tthis.text = item.text || \"\";\n\t\t\t} else {\n\t\t\t\tconst options = this._options;\n\t\t\t\tthis.text = ( options && options.text && options.text.value ) || this.theme.newTextValue();\n\t\t\t}\n\n\t\t\t// Event\n\t\t\tif( emit ) {\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, item, this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onClosed(): void {\n\t\tconst menu = this._menu;\n\t\tmenu.off( \"select\", this._onSelectedBound );\n\t\tmenu.off( \"close\", this._onClosedBound );\n\t}\n\n\tstart(): void {\n\t\tconst menu = this._menu;\n\t\tmenu.on( \"select\", this._onSelectedBound );\n\t\tmenu.on( \"close\", this._onClosedBound );\n\t\tsuper.start();\n\t}\n\n\tprotected findMenuItem( menu: DMenu<VALUE>, value: VALUE | null ): DMenuItem<VALUE> | null {\n\t\tconst children = this._menu.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItemMenu ) {\n\t\t\t\tconst result = this.findMenuItem( child.menu, value );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else if( child instanceof DMenuItem ) {\n\t\t\t\tif( child.value === value ) {\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns a selected value or null.\n\t */\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\t/**\n\t * Sets to the specified value.\n\t */\n\tset value( value: VALUE | null ) {\n\t\tconst item = this.findMenuItem( this._menu, value );\n\t\tif( item != null ) {\n\t\t\tthis.onSelected( value, item, false );\n\t\t} else {\n\t\t\tthis.onSelected( null, null, false );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSelect\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NineSlicePlane, Texture } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DShadow } from \"./d-shadow\";\n\nexport class DShadowImpl extends NineSlicePlane implements DShadow {\n\tprotected _offsetX: number;\n\tprotected _offsetY: number;\n\n\tconstructor( texture: Texture, width: number, height: number, offsetX: number, offsetY: number ) {\n\t\tsuper( texture, width, height, width, height );\n\n\t\tthis._offsetX = offsetX;\n\t\tthis._offsetY = offsetY;\n\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\n\t\ttexture.on( \"update\", (): void => {\n\t\t\tthis.onTextureUpdate();\n\t\t});\n\t}\n\n\tprotected onTextureUpdate(): void {\n\t\tthis.emit( \"update\", this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tthis.x = -this.leftWidth + this._offsetX;\n\t\tthis.y = -this.topHeight + this._offsetY;\n\t\tthis.width = this.leftWidth + width + this.rightWidth;\n\t\tthis.height = this.topHeight + height + this.bottomHeight;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DSliderRangeOptions<THEME extends DThemeSliderRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeSliderRange extends DThemeBase {\n\n}\n\nexport class DSliderRange<\n\tTHEME extends DThemeSliderRange = DThemeSliderRange,\n\tOPTIONS extends DSliderRangeOptions<THEME> = DSliderRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DSliderOptions<THEME extends DThemeSlider> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeSlider extends DThemeBase {\n\n}\n\nexport class DSlider<\n\tTHEME extends DThemeSlider = DThemeSlider,\n\tOPTIONS extends DSliderOptions<THEME> = DSliderOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellCheckOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck\n> extends DButtonCheckOptions<unknown, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellCheck extends DThemeButtonCheck {\n\n}\n\nexport class DTableBodyCellCheck<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck,\n\tOPTIONS extends DTableBodyCellCheckOptions<ROW, THEME> = DTableBodyCellCheckOptions<ROW, THEME>\n> extends DButtonCheck<unknown, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tthis.emit( \"cellchange\", true, false, this._columnIndex, this._columnData );\n\t\t});\n\n\t\tthis.on( \"inactive\", (): void => {\n\t\t\tthis.emit( \"cellchange\", false, true, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.setActive( !! value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonColor, DButtonColorOptions, DThemeButtonColor } from \"./d-button-color\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DTableBodyCellColorOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor\n> extends DButtonColorOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellColor extends DThemeButtonColor {\n\n}\n\nconst clone = ( value: DColorAndAlpha ): DColorAndAlpha => {\n\treturn {\n\t\tcolor: value.color,\n\t\talpha: value.alpha\n\t};\n};\n\nconst hasColor = ( value: any ): value is { color: unknown } => {\n\treturn ( \"color\" in value );\n};\n\nconst hasAlpha = ( value: any ): value is { alpha: unknown } => {\n\treturn ( \"alpha\" in value );\n};\n\nexport class DTableBodyCellColor<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor,\n\tOPTIONS extends DTableBodyCellColorOptions<ROW, THEME> = DTableBodyCellColorOptions<ROW, THEME>\n> extends DButtonColor<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"select\", ( newValue: DColorAndAlpha, oldValue: DColorAndAlpha ): void => {\n\t\t\tthis.emit( \"cellchange\", clone( newValue ), clone( oldValue ), this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( newValue: unknown ): void {\n\t\tconst value = this._value;\n\t\tif( isNumber( newValue ) ) {\n\t\t\tvalue.color = newValue;\n\t\t\tvalue.alpha = 1;\n\t\t} else if( isString( newValue ) ) {\n\t\t\tconst parsed = Number( newValue );\n\t\t\tif( parsed === parsed ) {\n\t\t\t\tvalue.color = parsed;\n\t\t\t} else {\n\t\t\t\tvalue.color = 0xffffff;\n\t\t\t}\n\t\t\tvalue.alpha = 1;\n\t\t} else if( newValue != null ) {\n\t\t\tif( hasColor( newValue ) ) {\n\t\t\t\tvalue.color = Number( newValue.color );\n\t\t\t} else {\n\t\t\t\tvalue.color = 0xffffff;\n\t\t\t}\n\t\t\tif( hasAlpha( newValue ) ) {\n\t\t\t\tvalue.alpha = Number( newValue.alpha );\n\t\t\t} else {\n\t\t\t\tvalue.alpha = 1;\n\t\t\t}\n\t\t} else {\n\t\t\tvalue.color = 0xffffff;\n\t\t\tvalue.alpha = 1;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellIndexOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellIndex = DThemeTableBodyCellIndex\n> extends DImageBaseOptions<number, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellIndex extends DThemeImageBase {\n\tgetTextFormatter(): ( value: number, caller: DTableBodyCellIndex ) => string;\n\tgetTextValue( state: DBaseState ): number;\n\tnewTextValue(): number;\n}\n\nexport class DTableBodyCellIndex<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellIndex = DThemeTableBodyCellIndex,\n\tOPTIONS extends DTableBodyCellIndexOptions<ROW, THEME> = DTableBodyCellIndexOptions<ROW, THEME>\n> extends DImageBase<number, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown, rowIndex: number): void {\n\t\tthis.text = rowIndex;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellIndex\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputIntegerOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputInteger = DThemeInputInteger\n> extends DInputIntegerOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputInteger extends DThemeInputInteger {\n\n}\n\nexport class DTableBodyCellInputInteger<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputInteger = DThemeTableBodyCellInputInteger,\n\tOPTIONS extends DTableBodyCellInputIntegerOptions<ROW, THEME> = DTableBodyCellInputIntegerOptions<ROW, THEME>\n> extends DInputInteger<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = Number( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputRealOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputReal = DThemeInputReal\n> extends DInputRealOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputReal extends DThemeInputReal {\n\n}\n\nexport class DTableBodyCellInputReal<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputReal = DThemeTableBodyCellInputReal,\n\tOPTIONS extends DTableBodyCellInputRealOptions<ROW, THEME> = DTableBodyCellInputRealOptions<ROW, THEME>\n> extends DInputReal<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = Number( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputTextOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputText = DThemeInputText\n> extends DInputTextOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputText extends DThemeInputText {\n\n}\n\nexport class DTableBodyCellInputText<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputText = DThemeTableBodyCellInputText,\n\tOPTIONS extends DTableBodyCellInputTextOptions<ROW, THEME> = DTableBodyCellInputTextOptions<ROW, THEME>\n> extends DInputText<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = String( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectDialogOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog = DThemeTableBodyCellSelectDialog\n> extends DButtonOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectDialog extends DThemeButton {\n\n}\n\nexport class DTableBodyCellSelectDialog<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog = DThemeTableBodyCellSelectDialog,\n\tOPTIONS extends DTableBodyCellSelectDialogOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectDialogOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst dialog = selecting.dialog;\n\t\tif( dialog != null ) {\n\t\t\tconst getter = selecting.getter;\n\t\t\tconst onSelectBound = ( selected: VALUE | null ): void => {\n\t\t\t\tconst newValue = getter( selected );\n\t\t\t\tconst oldValue = this.text;\n\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\tthis.text = newValue as VALUE;\n\t\t\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onCloseBound = (): void => {\n\t\t\t\tdialog.off( \"select\", onSelectBound );\n\t\t\t\tdialog.off( \"close\", onCloseBound );\n\t\t\t};\n\t\t\tthis.on( \"active\", (): void => {\n\t\t\t\tdialog.on( \"select\", onSelectBound );\n\t\t\t\tdialog.on( \"close\", onCloseBound );\n\t\t\t\tdialog.open();\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tget value(): VALUE {\n\t\treturn this.text as VALUE;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value as VALUE;\n\t\t\tthis._textValueComputed = value as VALUE;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value as VALUE;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectDialog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectFetcherOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectFetcher = DThemeTableBodyCellSelectFetcher\n> extends DButtonOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectFetcher extends DThemeButton {\n\n}\n\nexport class DTableBodyCellSelectFetcher<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectFetcher = DThemeTableBodyCellSelectFetcher,\n\tOPTIONS extends DTableBodyCellSelectFetcherOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectFetcherOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst fetcher = selecting.fetcher;\n\t\tif( fetcher != null ) {\n\t\t\tconst getter = selecting.getter;\n\t\t\tconst onSelectBound = ( selected: unknown ): void => {\n\t\t\t\tconst newValue = getter( selected );\n\t\t\t\tconst oldValue = this.text;\n\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\tthis.text = newValue as VALUE;\n\t\t\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.on( \"active\", (): void => {\n\t\t\t\tfetcher().then( onSelectBound );\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tget value(): VALUE {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value as VALUE;\n\t\t\tthis._textValueComputed = value as VALUE;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value as VALUE;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectFetcher\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DSelect, DSelectOptions, DThemeSelect } from \"./d-select\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectMenuOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu = DThemeTableBodyCellSelectMenu\n> extends DSelectOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectMenu extends DThemeSelect {\n\n}\n\nexport class DTableBodyCellSelectMenu<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu = DThemeTableBodyCellSelectMenu,\n\tOPTIONS extends DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME> = DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME>\n> extends DSelect<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst getter = selecting.getter;\n\t\tthis.on( \"change\", ( newSelected: VALUE | null, oldSelected: VALUE | null ): void => {\n\t\t\tconst newValue = getter( newSelected );\n\t\t\tconst oldValue = getter( oldSelected );\n\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.value = value as VALUE;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellTextOptions<ROW, THEME extends DThemeTableBodyCellText = DThemeTableBodyCellText>\n\textends DImageBaseOptions<unknown, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellText extends DThemeImageBase {\n\tgetTextValue( state: DBaseState ): unknown;\n\tnewTextValue(): unknown;\n}\n\nexport class DTableBodyCellText<\n\tROW,\n\tTHEME extends DThemeTableBodyCellText = DThemeTableBodyCellText,\n\tOPTIONS extends DTableBodyCellTextOptions<ROW, THEME> = DTableBodyCellTextOptions<ROW, THEME>\n> extends DImageBase<unknown, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ): void {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = value;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellDateOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogDateOptions;\n}\n\nexport interface DThemeTableBodyCellDate extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDate ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellDate<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate,\n\tOPTIONS extends DTableBodyCellDateOptions<ROW, THEME> = DTableBodyCellDateOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _dialog?: DDialogDate;\n\tprotected _dialogOptions?: DDialogDateOptions;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDate( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellDatetimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogDatetimeOptions;\n}\n\nexport interface DThemeTableBodyCellDatetime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDatetime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellDatetime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime,\n\tOPTIONS extends DTableBodyCellDatetimeOptions<ROW, THEME> = DTableBodyCellDatetimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected static DIALOG?: DDialogDatetime;\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _dialogOptions?: DDialogDatetimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._datetimeMask = DPickerDatetimes.toMask( options && options.dialog && options.dialog.picker );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDatetime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellTimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogTimeOptions;\n}\n\nexport interface DThemeTableBodyCellTime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellTime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellTime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime,\n\tOPTIONS extends DTableBodyCellTimeOptions<ROW, THEME> = DTableBodyCellTimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected static DIALOG?: DDialogTime;\n\tprotected _dialog?: DDialogTime;\n\tprotected _dialogOptions?: DDialogTimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._datetimeMask = DPickerTimes.toMask( options.dialog && options.dialog.picker );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn super.mergeState( stateLocal, stateParent ) |\n\t\t\t( stateParent & DBaseState.HOVERED ? DBaseState.HOVERED : DBaseState.NONE );\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogTime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DTableBodyCellTime.DIALOG == null ) {\n\t\t\t\t\tDTableBodyCellTime.DIALOG = new DDialogTime();\n\t\t\t\t}\n\t\t\t\tdialog = DTableBodyCellTime.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellTime\";\n\t}\n}\n","import { DBaseState } from \"./d-base-state\";\n\n/**\n * Cell states.\n */\nexport const DTableCellState = {\n\t/**\n\t * Cells of even rows.\n\t */\n\tEVEN: DBaseState.CUSTOM << 0,\n\n\t/**\n\t * Start cells in rows.\n\t */\n\tSTART: DBaseState.CUSTOM << 1,\n\n\t/**\n\t * End cells in rows.\n\t */\n\tEND: DBaseState.CUSTOM << 2,\n\n\t/**\n\t * Cells of frozen columns.\n\t */\n\tFROZEN: DBaseState.CUSTOM << 3,\n\n\t/**\n\t * Cells of a right-most frozen column.\n\t */\n\tFROZEN_END: DBaseState.CUSTOM << 4\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\nexport enum DTableDataSelectionType {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\nexport interface DTableDataSelectionOptions {\n\ttype?: (keyof typeof DTableDataSelectionType) | DTableDataSelectionType;\n}\n\nexport interface DTableDataSelection<ROW> extends utils.EventEmitter {\n\t/**\n\t * Returns a copy of an index array of selected rows.\n\t * The order of indices is an insertion order.\n\t */\n\treadonly indices: number[];\n\n\t/**\n\t * Returns a copy of an array of selected row value.\n\t * The order is an insertion order.\n\t */\n\treadonly rows: ROW[];\n\n\treadonly type: DTableDataSelectionType;\n\n\ttoggle( rowIndex: number ): void;\n\tadd( rowIndex: number ): void;\n\taddTo( rowIndex: number ): void;\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void;\n\taddAll( rowIndices: number[] ): void;\n\tcontains( rowIndex: number ): boolean;\n\tremove( rowIndex: number ): void;\n\tclear(): void;\n\tclearAndAdd( rowIndex: number ): void;\n\tclearAndAddAll( rowIndices: number[] ): void;\n\tshift( rowIndex: number, amount: number ): void;\n\tsize(): number;\n\tisEmpty(): boolean;\n\n\t/**\n\t * Returns an array of the (index, row value) pairs of selected rows.\n\t * The order of pairs is an insertion order.\n\t */\n\ttoArray(): Array<[ number, ROW ]>;\n\n\t/**\n\t * Returns an sorted array of the (index, row value) pairs of selected rows.\n\t */\n\ttoSortedArray(): Array<[ number, ROW ]>;\n\n\ttoObject(): {[index: number]: ROW};\n\n\ttoMap(): Map<number, ROW>;\n}\n","import { DBaseState } from \"./d-base-state\";\n\n/**\n * Row states.\n */\nexport const DTableRowState = {\n\t/**\n\t * Even rows.\n\t */\n\tEVEN: DBaseState.CUSTOM << 0\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Rectangle } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DTableCellState } from \"./d-table-cell-state\";\nimport { DTableRowState } from \"./d-table-row-state\";\n\nexport interface DTableRowOptions<\n\tROW,\n\tCOLUMN,\n\tTHEME extends DThemeTableRow = DThemeTableRow\n> extends DLayoutHorizontalOptions<THEME> {\n\tcolumns?: COLUMN[];\n\tfrozen: number;\n\teven?: boolean;\n}\n\nexport interface DThemeTableRow extends DThemeLayoutHorizontal {\n\n}\n\nexport interface DTableRowColumn {\n\tweight?: number;\n\tfrozen?: boolean;\n\toffset: number;\n}\n\nexport abstract class DTableRow<\n\tROW,\n\tCOLUMN extends DTableRowColumn,\n\tTHEME extends DThemeTableRow = DThemeTableRow,\n\tOPTIONS extends DTableRowOptions<ROW, COLUMN, THEME> = DTableRowOptions<ROW, COLUMN, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _columns!: COLUMN[];\n\tprotected _frozen!: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\t// State\n\t\tconst even = !! options.even;\n\t\tif( even ) {\n\t\t\tthis.setState( DTableRowState.EVEN, true );\n\t\t}\n\n\t\t// Frozen\n\t\tconst frozen = this._frozen = options.frozen;\n\n\t\t// Cells\n\t\tconst columns = this._columns = options.columns || [];\n\t\tconst iend = this.toIndexEnd( columns );\n\t\tfor( let i = columns.length - 1; 0 <= i; --i ) {\n\t\t\tconst cell = this.newCell( columns[ i ], i, columns, options );\n\t\t\tconst cellState = this.toCellState( even, i, iend, frozen );\n\t\t\tif( cellState ) {\n\t\t\t\tcell.setState( cellState, true );\n\t\t\t}\n\t\t\tthis.addChild( cell );\n\t\t}\n\t}\n\n\tprotected toCellState( even: boolean, index: number, iend: number, frozen: number ): DBaseState {\n\t\treturn ( even ? DTableCellState.EVEN : DBaseState.NONE ) |\n\t\t\t( index === 0 ? DTableCellState.START : DBaseState.NONE ) |\n\t\t\t( index === iend ? DTableCellState.END : DBaseState.NONE ) |\n\t\t\t( index < frozen ? DTableCellState.FROZEN : DBaseState.NONE ) |\n\t\t\t( index === frozen - 1 ? DTableCellState.FROZEN_END : DBaseState.NONE );\n\t}\n\n\tprotected toIndexEnd( columns: COLUMN[] ): number {\n\t\tconst imax = columns.length;\n\t\tfor( let i = 0; i < imax; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tif( column.weight !== undefined ) {\n\t\t\t\treturn imax - 1;\n\t\t\t}\n\t\t}\n\t\treturn imax;\n\t}\n\n\tprotected onRefit(): void {\n\t\tsuper.onRefit();\n\t\tthis.resetFrozenCellPosition();\n\t}\n\n\tupdateFrozenCellPosition( x: number ): void {\n\t\tconst columns = this._columns;\n\t\tconst cells = this.children;\n\t\tconst frozen = this._frozen;\n\t\tfor( let i = 0; i < frozen; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tconst cell = cells[ cells.length - 1 - i ];\n\t\t\tcell.position.x = -x + column.offset;\n\t\t}\n\t}\n\n\tprotected resetFrozenCellPosition(): void {\n\t\tconst columns = this._columns;\n\t\tconst cells = this.children;\n\t\tconst frozen = this._frozen;\n\t\tconst x = this.getContentPositionX();\n\t\tfor( let i = 0; i < frozen; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tconst cell = cells[ cells.length - 1 - i ];\n\t\t\tcolumn.offset = cell.position.x;\n\t\t\tcell.position.x = -x + column.offset;\n\t\t}\n\t}\n\n\tprotected abstract getContentPositionX(): number;\n\n\tgetClippingRect( target: DBase, result: Rectangle ): void {\n\t\tsuper.getClippingRect( target, result );\n\n\t\tconst frozen = this._frozen;\n\t\tif( 0 < frozen && target.parent === this ) {\n\t\t\tconst cells = this.children as DBase[];\n\t\t\tconst cellIndex = cells.indexOf( target );\n\t\t\tif( 0 <= cellIndex ) {\n\t\t\t\tconst index = cells.length - 1 - cellIndex;\n\t\t\t\tif( frozen <= index ) {\n\t\t\t\t\tconst previous = cells[ cellIndex + 1 ];\n\t\t\t\t\tconst shiftX = previous.position.x + previous.width;\n\t\t\t\t\tresult.x += shiftX;\n\t\t\t\t\tresult.width -= shiftX;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected abstract newCell(\n\t\tcolumn: COLUMN,\n\t\tcolumnIndex: number,\n\t\tcolumns: COLUMN[],\n\t\toptions: OPTIONS\n\t): DBase;\n\n\tprotected getType(): string {\n\t\treturn \"DTableRow\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableBodyCell } from \"./d-table-body-cell\";\nimport { DTableBodyCellCheck } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColor } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDate } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetime } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndex } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputInteger } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputReal } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputText } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellSelectDialog } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectFetcher } from \"./d-table-body-cell-select-fetcher\";\nimport { DTableBodyCellSelectMenu } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellText } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTime } from \"./d-table-body-cell-time\";\nimport {\n\tDTableBodyCellOptionsMerged, DTableBodyCellOptionsUnion,\n\tDTableColumn, DTableColumnType\n} from \"./d-table-column\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableBodyRowOptions<\n\tROW,\n\tTHEME extends DThemeTableBodyRow = DThemeTableBodyRow\n> extends DTableRowOptions<ROW, DTableColumn<ROW>, THEME> {\n\theight?: number;\n\tcell?: DTableBodyCellOptionsUnion<ROW>;\n}\n\nexport interface DThemeTableBodyRow extends DThemeTableRow {\n\n}\n\nconst isBodyCell = ( target: any ): target is DTableBodyCell => {\n\treturn (target != null && \"set\" in target);\n};\n\ntype OnCellChange = (\n\tnewCellValue: unknown, oldCellValue: unknown,\n\tcolumnIndex: number, column: DTableColumn<unknown>\n) => void;\n\nexport class DTableBodyRow<\n\tROW,\n\tTHEME extends DThemeTableBodyRow = DThemeTableBodyRow,\n\tOPTIONS extends DTableBodyRowOptions<ROW, THEME> = DTableBodyRowOptions<ROW, THEME>\n> extends DTableRow<ROW, DTableColumn<ROW>, THEME, OPTIONS> {\n\tprotected _row: ROW | undefined = undefined;\n\tprotected _onCellChangeBound!: OnCellChange;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._onCellChangeBound = (\n\t\t\tnewCellValue: unknown, oldCellValue: unknown,\n\t\t\tcolumnIndex: number, column: DTableColumn<unknown>\n\t\t): void => {\n\t\t\tconst row = this._row;\n\t\t\tif( row != null ) {\n\t\t\t\tcolumn.setter( row, columnIndex, newCellValue );\n\t\t\t\tthis.emit( \"change\", newCellValue, oldCellValue, columnIndex, this );\n\t\t\t}\n\t\t};\n\t\tsuper.init( options );\n\t}\n\n\tprotected newCell(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\tconst cellOptions = this.toCellOptions( column, columnIndex, options ) as any;\n\t\tif( column.editing.enable ) {\n\t\t\tconst cell = this.newCellEditable( column, columnIndex, cellOptions );\n\t\t\tcell.on( \"cellchange\", this._onCellChangeBound );\n\t\t\treturn cell;\n\t\t} else {\n\t\t\tconst cell = this.newCellUnediable( column, columnIndex, cellOptions );\n\t\t\tcell.setReadOnly( true );\n\t\t\treturn cell;\n\t\t}\n\t}\n\n\tprotected newCellEditable(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellInputText( options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellInputInteger( options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellInputReal( options );\n\t\tcase DTableColumnType.CHECK:\n\t\t\treturn new DTableBodyCellCheck( options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\tconst selecting = column.selecting;\n\t\t\tif( selecting.menu != null ) {\n\t\t\t\treturn new DTableBodyCellSelectMenu( options );\n\t\t\t} else if( selecting.dialog != null ) {\n\t\t\t\treturn new DTableBodyCellSelectDialog( options );\n\t\t\t} else if( selecting.fetcher != null ) {\n\t\t\t\treturn new DTableBodyCellSelectFetcher( options );\n\t\t\t} else {\n\t\t\t\treturn new DTableBodyCellText( options );\n\t\t\t}\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( options );\n\t\t}\n\t}\n\tprotected newCellUnediable(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.CHECK:\n\t\t\treturn new DTableBodyCellCheck( options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\tconst selecting = column.selecting;\n\t\t\tif( selecting.menu != null ) {\n\t\t\t\treturn new DTableBodyCellSelectMenu( options );\n\t\t\t} else if( selecting.dialog != null ) {\n\t\t\t\treturn new DTableBodyCellSelectDialog( options );\n\t\t\t} else if( selecting.fetcher != null ) {\n\t\t\t\treturn new DTableBodyCellSelectFetcher( options );\n\t\t\t} else {\n\t\t\t\treturn new DTableBodyCellText( options );\n\t\t\t}\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( options );\n\t\t}\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: OPTIONS\n\t): DTableBodyCellOptionsUnion<ROW> {\n\t\tlet result = (column.body || options.cell) as DTableBodyCellOptionsMerged<ROW> | undefined;\n\t\tif( result != null ) {\n\t\t\tresult.weight = column.weight;\n\t\t\tresult.width = column.width;\n\t\t\tconst text = result.text = result.text || {};\n\t\t\tconst align = text.align = text.align || {};\n\t\t\talign.horizontal = column.align;\n\t\t\ttext.formatter = column.formatter;\n\t\t\tresult.column = {\n\t\t\t\tindex: columnIndex,\n\t\t\t\tdata: column\n\t\t\t};\n\t\t\tif( column.selecting.menu ) {\n\t\t\t\tresult.menu = column.selecting.menu;\n\t\t\t}\n\t\t} else {\n\t\t\tresult = {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tformatter: column.formatter,\n\t\t\t\t\talign: {\n\t\t\t\t\t\thorizontal: column.align\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcolumn: {\n\t\t\t\t\tindex: columnIndex,\n\t\t\t\t\tdata: column\n\t\t\t\t},\n\t\t\t\tmenu: column.selecting.menu\n\t\t\t};\n\t\t}\n\n\t\tif( column.editing.enable ) {\n\t\t\tconst editing = result!.editing = result!.editing || {};\n\t\t\tediting.formatter = editing.formatter || column.editing.formatter;\n\t\t\tediting.unformatter = editing.unformatter || column.editing.unformatter as any;\n\t\t\tediting.validator = editing.validator || column.editing.validator as any;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyRow\";\n\t}\n\n\tset( row: ROW, rowIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly || this._row !== row ) {\n\t\t\tthis._row = row;\n\n\t\t\tconst cells = this.children;\n\t\t\tconst cellsLength = cells.length;\n\t\t\tconst columns = this._columns;\n\t\t\tconst columnsLength = columns.length;\n\t\t\tfor( let i = 0, imax = Math.min( columnsLength, cellsLength ); i < imax; ++i ) {\n\t\t\t\tconst cell = cells[ i ];\n\t\t\t\tconst columnIndex = columnsLength - i - 1;\n\t\t\t\tconst column = columns[ columnIndex ];\n\t\t\t\tif( isBodyCell( cell ) ) {\n\t\t\t\t\tcell.set( column.getter( row, columnIndex ), rowIndex, columnIndex, forcibly );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"set\", row, rowIndex, this );\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tif( this._row !== undefined ) {\n\t\t\tthis._row = undefined;\n\n\t\t\tconst cells = this.children;\n\t\t\tfor( let i = 0, imax = cells.length; i < imax; ++i ) {\n\t\t\t\tconst cell = cells[ i ];\n\t\t\t\tif( isBodyCell( cell ) ) {\n\t\t\t\t\tcell.unset();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"unset\", this );\n\t\t}\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tconst content = parent.parent;\n\t\t\tif( content ) {\n\t\t\t\treturn content.position.x;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataEachIterator } from \"./d-table-data\";\nimport { DTableDataFilter, DTableDataFilterFunction, DTableDataFilterObject } from \"./d-table-data-filter\";\nimport { isFunction } from \"./util/is-function\";\n\ninterface DTableDataFilterImplParent<ROW> {\n\teach( iterator: DTableDataEachIterator<ROW> ): void;\n\tupdate(): void;\n}\n\nexport class DTableDataFilterImpl<ROW> extends utils.EventEmitter implements DTableDataFilter<ROW> {\n\tprotected _parent: DTableDataFilterImplParent<ROW>;\n\tprotected _filter: DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null;\n\tprotected _filtered: number[] | null;\n\tprotected _isDirty: boolean;\n\n\tconstructor( parent: DTableDataFilterImplParent<ROW> ) {\n\t\tsuper();\n\n\t\tthis._parent = parent;\n\t\tthis._filter = null;\n\t\tthis._filtered = null;\n\t\tthis._isDirty = false;\n\t}\n\n\tapply(): void {\n\t\tthis._isDirty = true;\n\t\tthis._parent.update();\n\t}\n\n\tunapply(): void {\n\t\tif( this._filtered != null ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._filtered = null;\n\t\t\tthis.emit( \"change\", this );\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._filtered != null;\n\t}\n\n\tprotected newFiltered(): number[] | null {\n\t\tconst filter = this._filter;\n\t\tif( filter != null ) {\n\t\t\tconst filtered: number[] = [];\n\t\t\tconst parent = this._parent;\n\t\t\tif( isFunction( filter ) ) {\n\t\t\t\tparent.each(( row: ROW, index: number ): void => {\n\t\t\t\t\tif( filter( row, index ) ) {\n\t\t\t\t\t\tfiltered.push( index );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tparent.each(( row: ROW, index: number ): void => {\n\t\t\t\t\tif( filter.test( row, index ) ) {\n\t\t\t\t\t\tfiltered.push( index );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn filtered;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tget(): DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null {\n\t\treturn this._filter;\n\t}\n\n\tset( filter: DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null ): void {\n\t\tif( this._filter !== filter ) {\n\t\t\tthis._filter = filter;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._filtered = this.newFiltered();\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst filtered = this._filtered;\n\t\tif( filtered != null && 0 < filtered.length ) {\n\t\t\tfiltered.length = 0;\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tget indices(): number[] | null {\n\t\tthis.update();\n\t\treturn this._filtered;\n\t}\n}\n","import { DTableData, DTableDataMapped, DTableDataMappedEachIterator } from \"./d-table-data\";\n\nexport interface DTableDataMappedListParent<ROW> extends DTableData<ROW> {\n\treadonly rows: ROW[];\n}\n\nexport class DTableDataMappedList<ROW> implements DTableDataMapped<ROW> {\n\tprotected _parent: DTableDataMappedListParent<ROW>;\n\n\tconstructor( parent: DTableDataMappedListParent<ROW> ) {\n\t\tthis._parent = parent;\n\t}\n\n\tunmap( index: number ): number {\n\t\tlet result = index;\n\n\t\tconst parent = this._parent;\n\t\tconst indicesSorted = parent.sorter.indices;\n\t\tif( indicesSorted ) {\n\t\t\tresult = indicesSorted[ result ];\n\t\t}\n\n\t\tconst indicesFiltered = parent.filter.indices;\n\t\tif( indicesFiltered ) {\n\t\t\tresult = indicesFiltered[ result ];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsize(): number {\n\t\tconst parent = this._parent;\n\t\tconst indicesFiltered = parent.filter.indices;\n\t\treturn ( indicesFiltered != null ? indicesFiltered.length : parent.size() );\n\t}\n\n\tget( index: number ): ROW | null {\n\t\tconst parent = this._parent;\n\t\treturn parent.get( this.unmap( index ) );\n\t}\n\n\teach( iterator: DTableDataMappedEachIterator<ROW>, ifrom?: number, ito?: number ): void {\n\t\tconst parent = this._parent;\n\t\tconst rows = parent.rows;\n\t\tconst indicesFiltered = parent.filter.indices;\n\t\tconst indicesSorted = parent.sorter.indices;\n\t\tifrom = ( ifrom != null ? Math.max( 0, ifrom ) : 0 );\n\t\tif( indicesFiltered ) {\n\t\t\tconst size = indicesFiltered.length;\n\t\t\tito = ( ito != null ? Math.min( size, ito ) : size );\n\t\t\tif( indicesSorted ) {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesFiltered[ indicesSorted[ i ] ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tif( iterator( row, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesFiltered[ i ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tif( iterator( row, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst size = rows.length;\n\t\t\tito = ( ito != null ? Math.min( size, ito ) : size );\n\t\t\tif( indicesSorted ) {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesSorted[ i ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tif( iterator( row, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst row = rows[ i ];\n\t\t\t\t\tif( iterator( row, i, i ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableData } from \"./d-table-data\";\nimport { DTableDataSelection, DTableDataSelectionOptions, DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { isString } from \"./util/is-string\";\n\nconst COMPARATOR = ( a: [number, unknown], b: [number, unknown] ): number => {\n\treturn a[ 0 ] - b[ 0 ];\n};\n\nexport interface DTableDataSelectionImplParent<ROW> extends DTableData<ROW> {\n\tupdate(): void;\n}\n\nexport class DTableDataSelectionImpl<ROW> extends utils.EventEmitter implements DTableDataSelection<ROW> {\n\tprotected _parent: DTableDataSelectionImplParent<ROW>;\n\tprotected _type: DTableDataSelectionType;\n\tprotected _indices: Set<number>;\n\n\tconstructor( parent: DTableDataSelectionImplParent<ROW>, options?: DTableDataSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._parent = parent;\n\t\tthis._type = this.toType( options );\n\t\tthis._indices = new Set<number>();\n\t}\n\n\tprotected toType( options?: DTableDataSelectionOptions ): DTableDataSelectionType {\n\t\treturn ( options && options.type != null ?\n\t\t\t( isString( options.type ) ? DTableDataSelectionType[ options.type ] : options.type ) :\n\t\t\tDTableDataSelectionType.NONE\n\t\t);\n\t}\n\n\tget type(): DTableDataSelectionType {\n\t\treturn this._type;\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._parent.update();\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoggle( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( indices.has( rowIndex ) ) {\n\t\t\tindices.delete( rowIndex );\n\t\t} else {\n\t\t\tindices.add( rowIndex );\n\t\t}\n\t\tthis.onChange();\n\t}\n\n\tadd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tindices.add( rowIndex );\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected getFirstIndex(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = NaN;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tif( result !== result ) {\n\t\t\t\t\tresult = index;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getLastIndex(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = 0;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tresult = index;\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\taddTo( rowIndex: number ): void {\n\t\tconst lastRowIndex = this.getLastIndex();\n\t\tif( lastRowIndex != null ) {\n\t\t\tthis.addRange( lastRowIndex, false, rowIndex, true );\n\t\t}\n\t}\n\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tif( from < to ) {\n\t\t\tfor( let i = from + (includeFrom ? 0 : 1), imax = to + (includeTo ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = to + (includeTo ? 0 : 1), imax = from + (includeFrom ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\taddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\tindices.add( rowIndices[ i ] );\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tcontains( rowIndex: number ): boolean {\n\t\treturn this._indices.has( rowIndex );\n\t}\n\n\tremove( rowIndex: number ): void {\n\t\tif( this._indices.delete( rowIndex ) ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tindices.clear();\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAdd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( ! indices.has( rowIndex ) || indices.size !== 1 ) {\n\t\t\tindices.clear();\n\t\t\tindices.add( rowIndex );\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size || 0 < rowIndices.length ) {\n\t\t\tindices.clear();\n\t\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\t\tindices.add( rowIndices[ i ] );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tshift( rowIndex: number, amount: number ): void {\n\t\tconst shifted: number[] = [];\n\t\tconst indices = this._indices;\n\t\tindices.forEach(( index: number ): void => {\n\t\t\tif( rowIndex <= index ) {\n\t\t\t\tshifted.push( index );\n\t\t\t}\n\t\t});\n\t\tconst shiftedLength = shifted.length;\n\t\tif( 0 < shiftedLength ) {\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.delete( shifted[ i ] );\n\t\t\t}\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.add( shifted[ i ] + amount );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this._indices.size;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._indices.size === 0;\n\t}\n\n\t/**\n\t * Returns a copy of an index array of selected rows.\n\t * The order of indices is an insertion order.\n\t */\n\tget indices(): number[] {\n\t\tconst result: number[] = [];\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( index );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns a copy of an array of selected row value.\n\t * The order is an insertion order.\n\t */\n\tget rows(): ROW[] {\n\t\tconst result: ROW[] = [];\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( parent.get( index )! );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an array of the (index, row value) pairs of selected rows.\n\t * The order of pairs is an insertion order.\n\t */\n\ttoArray(): Array<[ number, ROW ]> {\n\t\tconst result: Array<[ number, ROW ]> = [];\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push([ index, parent.get( index )! ]);\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an sorted array of the (index, row value) pairs of selected rows.\n\t */\n\ttoSortedArray(): Array<[ number, ROW ]> {\n\t\treturn this.toArray().sort( COMPARATOR );\n\t}\n\n\ttoObject(): {[index: number]: ROW} {\n\t\tconst result: {[index: number]: ROW} = {};\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult[ index ] = parent.get( index )!;\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoMap(): Map<number, ROW> {\n\t\tconst result: Map<number, ROW> = new Map<number, ROW>();\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.set( index, parent.get( index )! );\n\t\t});\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\n/**\n * A row comparator function.\n */\nexport type DTableDataComparatorFunction<ROW> =\n\t( rowA: ROW, rowB: ROW, indexA: number, indexB: number ) => number;\n\n/**\n * A row comparator object.\n */\nexport interface DTableDataComparatorObject<ROW> {\n\tcompare( rowA: ROW, rowB: ROW, indexA: number, indexB: number ): number;\n}\n\n/**\n * A sort order.\n */\nexport enum DTableDataOrder {\n\tASCENDING,\n\tDESCENDING\n}\n\n/**\n * Table data sorter.\n */\nexport interface DTableDataSorter<ROW> extends utils.EventEmitter {\n\t/**\n\t * An indices of sorted rows.\n\t * Must not change this indices directly.\n\t */\n\treadonly indices: number[] | null;\n\n\t/**\n\t * A sort order.\n\t */\n\torder: DTableDataOrder;\n\n\t/**\n\t * Applys a sorting.\n\t */\n\tapply(): void;\n\n\t/**\n\t * Unapplys a sorting.\n\t */\n\tunapply(): void;\n\n\t/**\n\t * Returns true if a sorting is applied.\n\t */\n\tisApplied(): boolean;\n\n\t/**\n\t * Returns a current comparator.\n\t */\n\tget(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null;\n\n\t/**\n\t * Sets to the given comparator.\n\t *\n\t * @param comparator A comparator\n\t */\n\tset( comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataEachIterator } from \"./d-table-data\";\nimport {\n\tDTableDataComparatorFunction, DTableDataComparatorObject,\n\tDTableDataOrder, DTableDataSorter\n} from \"./d-table-data-sorter\";\nimport { isFunction } from \"./util/is-function\";\n\nexport interface DTableDataSorterImplParent<ROW> {\n\teach( iterator: DTableDataEachIterator<ROW>, ifrom?: number, ito?: number ): void;\n\tupdate(): void;\n}\n\nexport class DTableBodySorterImpl<ROW> extends utils.EventEmitter implements DTableDataSorter<ROW> {\n\tprotected _parent: DTableDataSorterImplParent<ROW>;\n\tprotected _comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null;\n\tprotected _sorted: number[] | null;\n\tprotected _isDirty: boolean;\n\tprotected _order: DTableDataOrder;\n\n\tconstructor( parent: DTableDataSorterImplParent<ROW> ) {\n\t\tsuper();\n\n\t\tthis._parent = parent;\n\t\tthis._comparator = null;\n\t\tthis._sorted = null;\n\t\tthis._isDirty = false;\n\t\tthis._order = DTableDataOrder.ASCENDING;\n\t}\n\n\tget order(): DTableDataOrder {\n\t\treturn this._order;\n\t}\n\n\tset order( order: DTableDataOrder ) {\n\t\tthis._order = order;\n\t}\n\n\tapply(): void {\n\t\tthis._isDirty = true;\n\t\tthis._parent.update();\n\t}\n\n\tunapply(): void {\n\t\tif( this._sorted != null ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._sorted = null;\n\t\t\tthis.emit( \"change\", this );\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._sorted != null;\n\t}\n\n\tprotected newSorted(): number[] | null {\n\t\tconst comparator = this._comparator;\n\t\tif( comparator != null ) {\n\t\t\tconst parent = this._parent;\n\t\t\tconst sorted: number[] = [];\n\t\t\tconst rows: ROW[] = [];\n\t\t\tparent.each(( row: ROW, index: number ): void => {\n\t\t\t\tsorted[ index ] = index;\n\t\t\t\trows[ index ] = row;\n\t\t\t});\n\t\t\tsorted.sort( this.toComparator( rows, comparator ) );\n\t\t\treturn sorted;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprotected toComparator(\n\t\trows: ROW[],\n\t\tcomparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW>\n\t): ( indexA: number, indexB: number) => number {\n\t\tconst order = this._order;\n\t\tif( isFunction( comparator ) ) {\n\t\t\tif( order === DTableDataOrder.ASCENDING ) {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator(\n\t\t\t\t\t\trows[ indexA ], rows[ indexB ],\n\t\t\t\t\t\tindexA, indexB\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator(\n\t\t\t\t\t\trows[ indexB ], rows[ indexA ],\n\t\t\t\t\t\tindexB, indexA\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tif( order === DTableDataOrder.ASCENDING ) {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator.compare(\n\t\t\t\t\t\trows[ indexA ], rows[ indexB ],\n\t\t\t\t\t\tindexA, indexB\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator.compare(\n\t\t\t\t\t\trows[ indexB ], rows[ indexA ],\n\t\t\t\t\t\tindexB, indexA\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\tget(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null {\n\t\treturn this._comparator;\n\t}\n\n\tset( comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null ): void {\n\t\tif( this._comparator !== comparator ) {\n\t\t\tthis._comparator = comparator;\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst sorted = this._sorted;\n\t\tif( sorted != null && 0 < sorted.length ) {\n\t\t\tsorted.length = 0;\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tconst sorted = this._sorted;\n\t\tif( sorted != null ) {\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._sorted = this.newSorted();\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget indices(): number[] | null {\n\t\tthis.update();\n\t\treturn this._sorted;\n\t}\n}\n","import { utils } from \"pixi.js\";\nimport { DTableData, DTableDataMapped, DTableDataOptions, DTableDataParent } from \"./d-table-data\";\nimport { DTableDataFilter } from \"./d-table-data-filter\";\nimport { DTableDataFilterImpl } from \"./d-table-data-filter-impl\";\nimport { DTableDataMappedList } from \"./d-table-data-mapped-list\";\nimport { DTableDataSelection } from \"./d-table-data-selection\";\nimport { DTableDataSelectionImpl } from \"./d-table-data-selection-impl\";\nimport { DTableDataSorter } from \"./d-table-data-sorter\";\nimport { DTableBodySorterImpl } from \"./d-table-data-sorter-impl\";\n\nexport class DTableDataList<ROW> extends utils.EventEmitter implements DTableData<ROW> {\n\tprotected _parent: DTableDataParent | null;\n\tprotected _rows: ROW[];\n\tprotected _filter: DTableDataFilterImpl<ROW>;\n\tprotected _sorter: DTableBodySorterImpl<ROW>;\n\tprotected _selection: DTableDataSelectionImpl<ROW>;\n\tprotected _mapped: DTableDataMappedList<ROW>;\n\n\tconstructor( options?: DTableDataOptions<ROW> ) {\n\t\tsuper();\n\n\t\tthis._parent = null;\n\t\tthis._mapped = new DTableDataMappedList<ROW>( this );\n\t\tthis._rows = this.toRows( options && options.rows );\n\t\tthis._selection = new DTableDataSelectionImpl<ROW>( this, options && options.selection );\n\t\tthis._filter = new DTableDataFilterImpl<ROW>( this );\n\t\tthis._sorter = new DTableBodySorterImpl<ROW>( this );\n\t\tif( options ) {\n\t\t\t// Filter\n\t\t\tconst filter = options.filter;\n\t\t\tif( filter ) {\n\t\t\t\tthis._filter.set( filter );\n\t\t\t}\n\n\t\t\t// Comparator\n\t\t\tconst comparator = options.comparator;\n\t\t\tif( comparator ) {\n\t\t\t\tthis._sorter.set( comparator );\n\t\t\t}\n\n\t\t\t// Events\n\t\t\tconst on = options.on;\n\t\t\tif( on ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( parent: DTableDataParent ): void {\n\t\tthis._parent = parent;\n\t}\n\n\tprotected toRows( row?: ROW[] ): ROW[] {\n\t\tconst result: ROW[] = [];\n\t\tif( row != null ) {\n\t\t\tfor( let i = 0, imax = row.length; i < imax; ++i ) {\n\t\t\t\tresult.push( row[ i ] );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tget rows(): ROW[] {\n\t\treturn this._rows;\n\t}\n\n\tupdate(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.update();\n\t\t}\n\t}\n\n\tlock(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.lock();\n\t\t}\n\t}\n\n\tunlock(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.unlock( false );\n\t\t\tparent.update();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this._rows.length;\n\t}\n\n\tclear(): void {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.length ) {\n\t\t\trows.length = 0;\n\t\t\tthis.lock();\n\t\t\tthis._selection.clear();\n\t\t\tthis._sorter.clear();\n\t\t\tthis._filter.clear();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\tclearAndAdd( row: ROW ): void {\n\t\tconst rows = this._rows;\n\t\trows.length = 0;\n\t\trows.push( row );\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._sorter.toDirty();\n\t\tthis._filter.toDirty();\n\t\tthis.unlock();\n\t}\n\n\tclearAndAddAll( newRows: ROW[] ): void {\n\t\tconst rows = this._rows;\n\t\trows.length = 0;\n\t\tfor( let i = 0, imax = newRows.length; i < imax; ++i ) {\n\t\t\trows.push( newRows[ i ] );\n\t\t}\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._sorter.toDirty();\n\t\tthis._filter.toDirty();\n\t\tthis.unlock();\n\t}\n\n\tadd( row: ROW, index?: number ): void {\n\t\tconst rows = this._rows;\n\t\tconst selection = this._selection;\n\t\tconst sorter = this._sorter;\n\t\tconst filter = this._filter;\n\t\tif( index == null ) {\n\t\t\trows.push( row );\n\t\t\tthis.lock();\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t} else if( 0 <= index && index < rows.length ) {\n\t\t\trows.splice( index, 0, row );\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, 1 );\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\taddAll( rows: ROW[], index?: number ): void {\n\t\tconst data = this._rows;\n\t\tconst dataLength = data.length;\n\t\tconst selection = this._selection;\n\t\tconst sorter = this._sorter;\n\t\tconst filter = this._filter;\n\t\tif( index == null ) {\n\t\t\tconst rowsLength = rows.length;\n\t\t\tfor( let i = 0, imax = rowsLength; i < imax; ++i ) {\n\t\t\t\tdata.push( rows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t} else if( 0 <= index && index < dataLength ) {\n\t\t\tconst rowsLength = rows.length;\n\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\tdata.splice( index + i, 0, rows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, rowsLength );\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\tget( index: number ): ROW | null {\n\t\tconst data = this._rows;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\treturn data[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, row: ROW ): ROW | null {\n\t\tconst data = this._rows;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\tconst result = data[ index ];\n\t\t\tdata[ index ] = row;\n\t\t\tthis._sorter.toDirty();\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.update();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): ROW | null {\n\t\tconst data = this._rows;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\tconst result = data.splice( index, 1 )[ 0 ];\n\t\t\tthis.lock();\n\t\t\tthis._selection.remove( index );\n\t\t\tthis._sorter.toDirty();\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.unlock();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\teach( iterator: ( row: ROW, index: number ) => boolean | void, ifrom?: number, ito?: number ): void {\n\t\tconst data = this._rows;\n\t\tifrom = ( ifrom != null ? Math.max( 0, ifrom ) : 0 );\n\t\tito = ( ito != null ? Math.min( data.length, ito ) : data.length );\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst row = data[ i ];\n\t\t\tif( iterator( row, i ) === false ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget selection(): DTableDataSelection<ROW> {\n\t\treturn this._selection;\n\t}\n\n\tget filter(): DTableDataFilter<ROW> {\n\t\treturn this._filter;\n\t}\n\n\tget sorter(): DTableDataSorter<ROW> {\n\t\treturn this._sorter;\n\t}\n\n\tget mapped(): DTableDataMapped<ROW> {\n\t\treturn this._mapped;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Rectangle } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonBase } from \"./d-button-base\";\nimport { DTableBodyRow, DTableBodyRowOptions } from \"./d-table-body-row\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableData, DTableDataOptions } from \"./d-table-data\";\nimport { DTableDataList } from \"./d-table-data-list\";\nimport { DTableDataSelection, DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableBodyOptions<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTableBody = DThemeTableBody\n> extends DBaseOptions<THEME> {\n\tcolumns?: Array<DTableColumn<ROW>>;\n\trow?: DTableBodyRowOptions<ROW>;\n\tdata?: DTableDataOptions<ROW> | DATA;\n\toffset?: number;\n\tfrozen: number;\n}\n\nexport interface DThemeTableBody extends DThemeBase {\n\tgetRowHeight(): number;\n}\n\nconst toRowOptions = <ROW, DATA extends DTableData<ROW>>(\n\ttheme: DThemeTableBody,\n\toptions: DTableBodyOptions<ROW, DATA>,\n\tselectionType: DTableDataSelectionType\n): DTableBodyRowOptions<ROW> => {\n\tconst columns = options.columns || [];\n\tlet result = options.row;\n\tif( result != null ) {\n\t\tif( result.height == null ) {\n\t\t\tresult.height = theme.getRowHeight();\n\t\t}\n\t\tif( result.columns === undefined ) {\n\t\t\tresult.columns = columns;\n\t\t}\n\t\tif( result.interactive == null && selectionType !== DTableDataSelectionType.NONE ) {\n\t\t\tresult.interactive = \"SELF\";\n\t\t}\n\t\tif( result.frozen == null ) {\n\t\t\tresult.frozen = options.frozen;\n\t\t}\n\t} else {\n\t\tresult = {\n\t\t\tcolumns,\n\t\t\theight: theme.getRowHeight(),\n\t\t\tinteractive: ( selectionType !== DTableDataSelectionType.NONE ? \"SELF\" : undefined ),\n\t\t\tfrozen: options.frozen\n\t\t};\n\t}\n\treturn result as DTableBodyRowOptions<ROW>;\n};\n\nconst isDTableData = <ROW>( target?: ROW[] | DTableDataOptions<ROW> | DTableData<ROW> ): target is DTableData<ROW> => {\n\treturn ( target != null && \"mapped\" in target );\n};\n\nexport class DTableBody<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTableBody = DThemeTableBody,\n\tOPTIONS extends DTableBodyOptions<ROW, DATA, THEME> = DTableBodyOptions<ROW, DATA, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static WORK_ON_CLICK = new Point();\n\tprotected _columns!: Array<DTableColumn<ROW>>;\n\tprotected _rowHeight!: number;\n\tprotected _rowIndexMappedStart!: number;\n\tprotected _rowIndexMappedEnd!: number;\n\tprotected _rowOptions!: DTableBodyRowOptions<ROW>;\n\tprotected _updateRowsCount!: number;\n\tprotected _isUpdateRowsCalled!: boolean;\n\tprotected _isUpdateRowsCalledForcibly!: boolean;\n\tprotected _workRows!: Array<DTableBodyRow<ROW>>;\n\n\tprotected _data!: DATA;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t\tthis._data.emit( \"init\", this._data );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis.transform.position.y = options.offset || 0;\n\n\t\tsuper.init( options );\n\n\t\tconst data = ( isDTableData( options.data ) ? options.data :\n\t\t\tnew DTableDataList<ROW>( options.data ) as unknown as DATA );\n\t\tthis._data = data;\n\t\tdata.bind( this );\n\t\tconst theme = this.theme;\n\t\tconst rowOptions = toRowOptions( theme, options, data.selection.type );\n\t\tthis._rowOptions = rowOptions;\n\t\tthis._rowHeight = ( rowOptions.height != null ? rowOptions.height : theme.getRowHeight() );\n\t\tthis._columns = rowOptions.columns || [];\n\t\tthis._rowIndexMappedStart = 0;\n\t\tthis._rowIndexMappedEnd = 0;\n\t\tthis._updateRowsCount = 0;\n\t\tthis._isUpdateRowsCalled = false;\n\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\tthis._workRows = [];\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.update();\n\t}\n\n\tget selection(): DTableDataSelection<ROW> {\n\t\treturn this._data.selection;\n\t}\n\n\tlock(): void {\n\t\tthis._updateRowsCount += 1;\n\t\tif( this._updateRowsCount === 1 ) {\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\tunlock( callIfNeeded: boolean ): void {\n\t\tthis._updateRowsCount -= 1;\n\t\tif( this._updateRowsCount === 0 ) {\n\t\t\tif( callIfNeeded && this._isUpdateRowsCalled ) {\n\t\t\t\tthis.update( this._isUpdateRowsCalledForcibly );\n\t\t\t}\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\t/**\n\t * Updates rows. If the `forcibly` is true, some dirty checkings for\n\t * avoiding unnecessary state changes are skipped.\n\t *\n\t * @param forcibly true to update forcibly\n\t */\n\tupdate( forcibly?: boolean ): void {\n\t\tif( 0 < this._updateRowsCount ) {\n\t\t\tthis._isUpdateRowsCalled = true;\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._isUpdateRowsCalledForcibly = true;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst content = this.parent;\n\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\tconst height = content.parent.height;\n\t\tconst rowHeight = this._rowHeight;\n\n\t\tconst data = this._data;\n\t\tconst dataMappedSize = data.mapped.size();\n\n\t\tconst oldRowIndexMappedStart = this._rowIndexMappedStart;\n\t\tlet oldRowIndexMappedEnd = this._rowIndexMappedEnd;\n\t\tlet oldRowCount = oldRowIndexMappedEnd - oldRowIndexMappedStart;\n\n\t\tconst newHeight = dataMappedSize * rowHeight;\n\t\tthis.height = newHeight;\n\n\t\tconst newContentHeight = Math.max( height, newHeight );\n\t\tconst newContentY = Math.max( height - newContentHeight, content.position.y );\n\t\tcontent.position.y = newContentY;\n\t\tcontent.height = newContentHeight;\n\n\t\tconst newRowIndexMappedLowerBound = Math.floor( (0 - newContentY) / rowHeight );\n\t\tconst newRowIndexMappedUpperBound = Math.floor( (height - newContentY) / rowHeight );\n\t\tconst newRowIndexMappedStart = newRowIndexMappedLowerBound - ( newRowIndexMappedLowerBound % 2 === 0 ? 2 : 1 );\n\t\tlet newRowIndexMappedEnd = newRowIndexMappedUpperBound +\n\t\t\t((newRowIndexMappedUpperBound - newRowIndexMappedStart + 1) % 2 === 0 ? 3 : 2);\n\t\tlet newRowCount = newRowIndexMappedEnd - newRowIndexMappedStart;\n\t\tif( newRowCount < oldRowCount && oldRowCount - 2 <= newRowCount ) {\n\t\t\tnewRowCount = oldRowCount;\n\t\t\tnewRowIndexMappedEnd = newRowIndexMappedStart + newRowCount;\n\t\t}\n\n\t\tif( oldRowCount < newRowCount ) {\n\t\t\tfor( let i = oldRowCount; i < newRowCount; ++i ) {\n\t\t\t\tconst oldRowIndexMapped = oldRowIndexMappedStart + i;\n\t\t\t\tconst newRow = this.newRow( (oldRowIndexMapped % 2) === 0 );\n\t\t\t\tthis.addChild( newRow );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexMappedEnd = oldRowIndexMappedStart + oldRowCount;\n\t\t} else if( newRowCount < oldRowCount ) {\n\t\t\tfor( let i = oldRowCount - 1; newRowCount <= i; --i ) {\n\t\t\t\tthis.removeChild( rows[ i ] );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexMappedEnd = oldRowIndexMappedStart + oldRowCount;\n\t\t}\n\n\t\tthis._rowIndexMappedStart = newRowIndexMappedStart;\n\t\tthis._rowIndexMappedEnd = newRowIndexMappedEnd;\n\n\t\tconst rowIndexMappedStartDelta = newRowIndexMappedStart - oldRowIndexMappedStart;\n\t\tconst rowIndexMappedStartDeltaAbs = Math.abs(rowIndexMappedStartDelta);\n\t\tconst rowsLength = rows.length;\n\t\tif( 0 < rowIndexMappedStartDeltaAbs && rowIndexMappedStartDeltaAbs < rowsLength ) {\n\t\t\tconst work = this._workRows;\n\t\t\tif( 0 < rowIndexMappedStartDelta ) {\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = rowIndexMappedStartDeltaAbs; i < rowsLength; ++i ) {\n\t\t\t\t\trows[ i - rowIndexMappedStartDeltaAbs ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\trows[ rowsLength - rowIndexMappedStartDeltaAbs + i ] = work[ i ];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ rowsLength - rowIndexMappedStartDeltaAbs + i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = rowsLength - rowIndexMappedStartDeltaAbs - 1; 0 <= i; --i ) {\n\t\t\t\t\trows[ i + rowIndexMappedStartDeltaAbs ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\trows[ i ] = work[ i ];\n\t\t\t\t}\n\t\t\t}\n\t\t\twork.length = 0;\n\t\t}\n\n\t\tconst selection = data.selection;\n\t\tdata.mapped.each(( datum: ROW, index: number, unmappedIndex: number ): void | boolean => {\n\t\t\tconst row = rows[ index - newRowIndexMappedStart ];\n\t\t\trow.position.y = index * rowHeight;\n\t\t\tif( selection.contains( unmappedIndex ) ) {\n\t\t\t\trow.setStates( DBaseState.ACTIVE, DBaseState.DISABLED );\n\t\t\t} else {\n\t\t\t\trow.setStates( DBaseState.NONE, DBaseState.ACTIVE | DBaseState.DISABLED );\n\t\t\t}\n\t\t\trow.set( datum, unmappedIndex, forcibly );\n\t\t}, newRowIndexMappedStart, newRowIndexMappedStart + rowsLength );\n\n\t\tfor( let i = 0; newRowIndexMappedStart + i < 0 && i < rowsLength; ++i ) {\n\t\t\tconst row = rows[ i ];\n\t\t\trow.position.y = ( newRowIndexMappedStart + i ) * rowHeight;\n\t\t\trow.setStates( DBaseState.DISABLED, DBaseState.ACTIVE );\n\t\t\trow.unset();\n\t\t}\n\n\t\tfor( let i = rowsLength - 1; dataMappedSize <= newRowIndexMappedStart + i && 0 <= i; --i ) {\n\t\t\tconst row = rows[ i ];\n\t\t\trow.position.y = ( newRowIndexMappedStart + i ) * rowHeight;\n\t\t\trow.setStates( DBaseState.DISABLED, DBaseState.ACTIVE );\n\t\t\trow.unset();\n\t\t}\n\t}\n\n\tprotected resetRow( row: DTableBodyRow<ROW> ): DTableBodyRow<ROW> {\n\t\trow.blur( true );\n\t\tconst cells = row.children;\n\t\tfor( let i = 0, imax = cells.length; i < imax; ++i ) {\n\t\t\tconst cell = cells[ i ];\n\t\t\tif( cell instanceof DBase ) {\n\t\t\t\tcell.setPressed( false );\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tprotected newRow( isEven: boolean ): DTableBodyRow<ROW> {\n\t\tconst options = this._rowOptions;\n\t\toptions.even = isEven;\n\t\tconst result = new DTableBodyRow<ROW>( options );\n\t\tresult.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown, columnIndex: number ): void => {\n\t\t\tconst index = this.getChildIndex( result );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tconst rowIndex = this._rowIndexMappedStart + index;\n\t\t\t\tconst data = this._data;\n\t\t\t\tdata.emit( \"change\", newCellValue, oldCellValue, rowIndex, columnIndex, data );\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tonParentMove( x: number, y: number ): void {\n\t\tsuper.onParentMove( x, y );\n\t\tthis.updateFrozenCellPosition( x );\n\t}\n\n\tprotected updateFrozenCellPosition( x: number ): void {\n\t\tif( 0 < this._rowOptions.frozen ) {\n\t\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\t\trows[ i ].updateFrozenCellPosition( x );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetClippingRect( target: DBase, result: Rectangle ): void {\n\t\tsuper.getClippingRect( target, result );\n\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tconst shiftY = -parent.transform.position.y;\n\t\t\tresult.y += shiftY;\n\t\t\tresult.height -= shiftY;\n\t\t}\n\t}\n\n\tonRowClicked( e: InteractionEvent ): void {\n\t\tif( this.isActionable() ) {\n\t\t\tconst local = DTableBody.WORK_ON_CLICK;\n\t\t\tlocal.copyFrom( e.data.global );\n\t\t\tthis.toLocal( local, undefined, local, false );\n\t\t\tif( 0 <= this.parent.position.y + local.y ) {\n\t\t\t\tconst rowIndexMapped = Math.floor( local.y / this._rowHeight );\n\t\t\t\tconst data = this._data;\n\t\t\t\tif( 0 <= rowIndexMapped && rowIndexMapped < data.mapped.size() ) {\n\t\t\t\t\tconst isSingle = ( data.selection.type === DTableDataSelectionType.SINGLE );\n\t\t\t\t\tconst isNotSingle = ! isSingle;\n\t\t\t\t\tconst originalEvent = e.data.originalEvent;\n\t\t\t\t\tconst ctrlKey = originalEvent.ctrlKey;\n\t\t\t\t\tconst shiftKey = originalEvent.shiftKey;\n\t\t\t\t\tconst rowIndex = data.mapped.unmap( rowIndexMapped );\n\t\t\t\t\tif( isSingle || data.selection.isEmpty() || ! ( isNotSingle && ( ctrlKey || shiftKey ) ) ) {\n\t\t\t\t\t\tdata.selection.clearAndAdd( rowIndex );\n\t\t\t\t\t} else if( ctrlKey ) {\n\t\t\t\t\t\tdata.selection.toggle( rowIndex );\n\t\t\t\t\t} else if( shiftKey ) {\n\t\t\t\t\t\tdata.selection.addTo( rowIndex );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tlet result = false;\n\t\tconst data = this._data;\n\t\tif( this.isActionable() && data.selection.type !== DTableDataSelectionType.NONE ) {\n\t\t\tconst local = UtilPointerEvent.toGlobal( e, interactionManager, DTableBody.WORK_ON_CLICK );\n\t\t\tthis.toLocal( local, undefined, local, false );\n\t\t\tconst x = local.x;\n\t\t\tconst y = local.y;\n\t\t\tif( 0 <= this.parent.position.y + y ) {\n\t\t\t\tconst rowIndexMapped = Math.floor( y / this._rowHeight );\n\t\t\t\tif( 0 <= rowIndexMapped && rowIndexMapped < data.mapped.size() ) {\n\t\t\t\t\tconst index = rowIndexMapped - this._rowIndexMappedStart;\n\t\t\t\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\t\t\t\tif( 0 <= index && index < rows.length ) {\n\t\t\t\t\t\tconst row = rows[ index ];\n\t\t\t\t\t\tconst cells = row.children as DBase[];\n\t\t\t\t\t\tconst cellsLength = cells.length;\n\t\t\t\t\t\tconst columns = this._columns;\n\t\t\t\t\t\tconst columnsLength = columns.length;\n\t\t\t\t\t\tfor( let i = 0, imax = Math.min( cellsLength, columnsLength ); i < imax; ++i ) {\n\t\t\t\t\t\t\tconst column = columns[ columnsLength - i - 1 ];\n\t\t\t\t\t\t\tif( column.editing.enable ) {\n\t\t\t\t\t\t\t\tconst cell = cells[ cellsLength - i - 1 ];\n\t\t\t\t\t\t\t\tconst dx = x - cell.position.x;\n\t\t\t\t\t\t\t\tif( 0 <= dx && dx <= cell.width ) {\n\t\t\t\t\t\t\t\t\tcell.focus();\n\t\t\t\t\t\t\t\t\tif( cell instanceof DButtonBase ) {\n\t\t\t\t\t\t\t\t\t\tcell.onClick();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresult = super.onDblClick( e, interactionManager ) || result;\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBody\";\n\t}\n\n\tget data(): DATA {\n\t\treturn this._data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DTableCategoryCellOptions<\n\tTHEME extends DThemeTableCategoryCell = DThemeTableCategoryCell\n> extends DImageOptions<string | null, THEME> {\n\n}\n\nexport interface DThemeTableCategoryCell extends DThemeImage {\n\tgetTextFormatter(): ( value: string | null, caller: DTableCategoryCell ) => string;\n\tgetTextValue( state: DBaseState ): string | null;\n\tnewTextValue(): DStateAwareOrValueMightBe<string | null>;\n}\n\nexport class DTableCategoryCell<\n\tTHEME extends DThemeTableCategoryCell = DThemeTableCategoryCell,\n\tOPTIONS extends DTableCategoryCellOptions<THEME> = DTableCategoryCellOptions<THEME>\n> extends DImage<string | null, THEME, OPTIONS> {\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableCategoryCell\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableCategoryCell, DTableCategoryCellOptions } from \"./d-table-category-cell\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableCategoryColumn {\n\tlabel?: string;\n\tweight?: number;\n\twidth?: number;\n\toffset: number;\n}\n\nexport interface DTableCategoryOptions<\n\tTHEME extends DThemeTableCategory = DThemeTableCategory\n> extends DTableRowOptions<unknown, DTableCategoryColumn, THEME> {\n\tcell?: DTableCategoryCellOptions;\n}\n\nexport interface DThemeTableCategory extends DThemeTableRow {\n\n}\n\nexport class DTableCategory<\n\tTHEME extends DThemeTableCategory = DThemeTableCategory,\n\tOPTIONS extends DTableCategoryOptions<THEME> = DTableCategoryOptions<THEME>\n> extends DTableRow<unknown, DTableCategoryColumn, THEME, OPTIONS> {\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tonParentMove( x: number, y: number ): void {\n\t\tsuper.onParentMove( x, y );\n\t\tthis.transform.position.y = -y;\n\t\tthis.updateFrozenCellPosition( x );\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst content = this.parent;\n\t\tif( content ) {\n\t\t\treturn content.position.x;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected newCell(\n\t\tcolumn: DTableCategoryColumn,\n\t\tcolumnIndex: number,\n\t\tcolumns: DTableCategoryColumn[],\n\t\toptions: OPTIONS\n\t): DBase {\n\t\treturn new DTableCategoryCell( this.toCellOptions( column, options ) );\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumn: DTableCategoryColumn,\n\t\toptions: OPTIONS\n\t): DTableCategoryCellOptions {\n\t\tconst result = options.cell;\n\t\tif( result ) {\n\t\t\tresult.weight = column.weight;\n\t\t\tresult.width = column.width;\n\t\t\tconst text = result.text = result.text || {};\n\t\t\ttext.value = text.value || column.label;\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableCategory\";\n\t}\n}\n","import { DBaseState } from \"./d-base-state\";\n\n/**\n * Header cell states.\n * Please note that header cell states must not overlap with states defined in DTableCellState.\n */\nexport const DTableHeaderCellState = {\n\t/**\n\t * Header cells of columns sorted in the ascending order.\n\t */\n\tSORTED_ASCENDING: DBaseState.CUSTOM << 5,\n\n\t/**\n\t * Header cells of columns sorted in the descending order.\n\t */\n\tSORTED_DESCENDING: DBaseState.CUSTOM << 6\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DTableColumn } from \"./d-table-column\";\nimport {\n\tDTableDataComparatorFunction, DTableDataComparatorObject,\n\tDTableDataOrder, DTableDataSorter\n} from \"./d-table-data-sorter\";\nimport { DTableHeaderTable } from \"./d-table-header\";\nimport { DTableHeaderCellState } from \"./d-table-header-cell-state\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableHeaderCellHeader<ROW> {\n\treadonly table: DTableHeaderTable<ROW> | null;\n}\n\nexport interface DTableHeaderCellOptions<\n\tROW,\n\tTHEME extends DThemeTableHeaderCell = DThemeTableHeaderCell\n> extends DImageOptions<string | null, THEME> {\n\theader: DTableHeaderCellHeader<ROW>;\n\tcolumn: DTableColumn<ROW>;\n}\n\nexport interface DThemeTableHeaderCell extends DThemeImage {\n\tgetTextFormatter(): ( value: string | null, caller: DTableHeaderCell<unknown> ) => string;\n\tgetTextValue( state: DBaseState ): string | null;\n\tnewTextValue(): DStateAwareOrValueMightBe<string | null>;\n}\n\nexport class DTableHeaderCell<\n\tROW,\n\tTHEME extends DThemeTableHeaderCell = DThemeTableHeaderCell,\n\tOPTIONS extends DTableHeaderCellOptions<ROW, THEME> = DTableHeaderCellOptions<ROW, THEME>\n> extends DImage<string | null, THEME, OPTIONS> {\n\tprotected _sorter?: DTableDataSorter<ROW>;\n\tprotected _onSorterChangeBound?: () => void;\n\tprotected _comparator?: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW>;\n\tprotected _header: DTableHeaderCellHeader<ROW>;\n\tprotected _column: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._header = options.header;\n\t\tthis._column = options.column;\n\t\tthis._comparator = options.column.sorting.comparator;\n\n\t\tconst sorting = options.column.sorting;\n\t\tif( sorting.enable ) {\n\t\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\t\tthis.onClick();\n\t\t\t});\n\t\t}\n\t}\n\n\tget sorter(): DTableDataSorter<ROW> | null {\n\t\tlet sorter = this._sorter || null;\n\t\tif( sorter == null ) {\n\t\t\tconst table = this._header.table;\n\t\t\tif( table ) {\n\t\t\t\tsorter = table.data.sorter;\n\t\t\t\tthis._sorter = sorter;\n\t\t\t\tthis._onSorterChangeBound = this._onSorterChangeBound || (() => {\n\t\t\t\t\tthis.onSorterChange();\n\t\t\t\t});\n\t\t\t\tsorter.on( \"change\", this._onSorterChangeBound );\n\t\t\t}\n\t\t}\n\t\treturn sorter;\n\t}\n\n\tget comparator(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null {\n\t\treturn this._comparator || null;\n\t}\n\n\tonClick(): void {\n\t\tconst comparator = this._comparator;\n\t\tif( comparator ) {\n\t\t\tconst sorter = this.sorter;\n\t\t\tif( sorter ) {\n\t\t\t\tif( sorter.get() === comparator ) {\n\t\t\t\t\tif( sorter.order === DTableDataOrder.ASCENDING ) {\n\t\t\t\t\t\tsorter.order = DTableDataOrder.DESCENDING;\n\t\t\t\t\t\tsorter.apply();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsorter.set( null );\n\t\t\t\t\t\tsorter.apply();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsorter.set( comparator );\n\t\t\t\t\tsorter.order = DTableDataOrder.ASCENDING;\n\t\t\t\t\tsorter.apply();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onSorterChange(): void {\n\t\tconst sorter = this._sorter;\n\t\tconst comparator = this._comparator;\n\t\tif( sorter && comparator ) {\n\t\t\tconst SORTED_ASCENDING = DTableHeaderCellState.SORTED_ASCENDING;\n\t\t\tconst SORTED_DESCENDING = DTableHeaderCellState.SORTED_DESCENDING;\n\t\t\tif( sorter.isApplied() && sorter.get() === comparator ) {\n\t\t\t\tif( sorter.order === DTableDataOrder.ASCENDING ) {\n\t\t\t\t\tthis.setStates( SORTED_ASCENDING, SORTED_DESCENDING );\n\t\t\t\t} else {\n\t\t\t\t\tthis.setStates( SORTED_DESCENDING, SORTED_ASCENDING );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.setState( SORTED_ASCENDING | SORTED_DESCENDING, false );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeaderCell\";\n\t}\n\n\tdestroy(): void {\n\t\tconst sorter = this._sorter;\n\t\tconst onSorterChangeBound = this._onSorterChangeBound;\n\t\tif( sorter && onSorterChangeBound ) {\n\t\t\tsorter.off( \"change\", onSorterChangeBound );\n\t\t}\n\t\tthis._sorter = undefined;\n\t\tthis._onSorterChangeBound = undefined;\n\t\tthis._comparator = undefined;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableData } from \"./d-table-data\";\nimport { DTableHeaderCell, DTableHeaderCellOptions } from \"./d-table-header-cell\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableHeaderTable<ROW> {\n\treadonly data: DTableData<ROW>;\n}\n\nexport interface DTableHeaderOptions<\n\tROW,\n\tTHEME extends DThemeTableHeader = DThemeTableHeader\n> extends DTableRowOptions<ROW, DTableColumn<ROW>, THEME> {\n\ttable?: DTableHeaderTable<ROW>;\n\toffset?: number;\n\tcell?: DTableHeaderCellOptions<ROW>;\n}\n\nexport interface DThemeTableHeader extends DThemeTableRow {\n\n}\n\nexport class DTableHeader<\n\tROW,\n\tTHEME extends DThemeTableHeader = DThemeTableHeader,\n\tOPTIONS extends DTableHeaderOptions<ROW, THEME> = DTableHeaderOptions<ROW, THEME>\n> extends DTableRow<ROW, DTableColumn<ROW>, THEME, OPTIONS> {\n\tprotected _table!: DTableHeaderTable<ROW> | null;\n\tprotected _offset!: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._table = options.table || null;\n\t\tthis._offset = this.transform.position.y = options.offset || 0;\n\t\tthis._frozen = options.frozen;\n\n\t\tsuper.init( options );\n\t}\n\n\tget table(): DTableHeaderTable<ROW> | null {\n\t\treturn this._table;\n\t}\n\n\tonParentMove( x: number, y: number ): void {\n\t\tsuper.onParentMove( x, y );\n\t\tthis.transform.position.y = -y + this._offset;\n\t\tthis.updateFrozenCellPosition( x );\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst content = this.parent;\n\t\tif( content ) {\n\t\t\treturn content.position.x;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected newCell(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\treturn new DTableHeaderCell<ROW>( this.toCellOptions( column, options ) );\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumn: DTableColumn<ROW>,\n\t\toptions: OPTIONS\n\t): DTableHeaderCellOptions<ROW> {\n\t\tconst result = column.header || options.cell;\n\t\tif( result != null ) {\n\t\t\tif( result.weight === undefined ) {\n\t\t\t\tresult.weight = column.weight;\n\t\t\t}\n\t\t\tif( result.width === undefined ) {\n\t\t\t\tresult.width = column.width;\n\t\t\t}\n\t\t\tif( result.text === undefined ) {\n\t\t\t\tresult.text = {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t};\n\t\t\t} else if( result.text.value === undefined ) {\n\t\t\t\tresult.text.value = column.label;\n\t\t\t}\n\t\t\tif( result.header === undefined ) {\n\t\t\t\tresult.header = this;\n\t\t\t}\n\t\t\tif( result.column === undefined ) {\n\t\t\t\tresult.column = column;\n\t\t\t}\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t},\n\t\t\t\theader: this,\n\t\t\t\tcolumn\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DDialogSelectOptions } from \"../ui/d-dialog-select\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DDialogSelect } from \"./d-dialog-select\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { DTableBody, DTableBodyOptions } from \"./d-table-body\";\nimport { DTableCategory, DTableCategoryColumn, DTableCategoryOptions } from \"./d-table-category\";\nimport {\n\tDTableColumn, DTableColumnEditing, DTableColumnOptions,\n\tDTableColumnSelecting, DTableColumnSelectingOptions, DTableColumnSorting, DTableColumnType,\n\tDTableEditingUnformatter, DTableGetter, DTableSelectingGetter, DTableSetter\n} from \"./d-table-column\";\nimport { DTableData, DTableDataOptions } from \"./d-table-data\";\nimport { DTableDataList } from \"./d-table-data-list\";\nimport { DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { DTableDataComparatorFunction } from \"./d-table-data-sorter\";\nimport { DTableHeader, DTableHeaderOptions } from \"./d-table-header\";\nimport { isArray } from \"./util/is-array\";\nimport { isString } from \"./util/is-string\";\nimport { toString } from \"./util/to-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableOptions<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTable = DThemeTable,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tcolumns: Array<DTableColumnOptions<ROW>>;\n\tcategory?: DTableCategoryOptions;\n\theader?: DTableHeaderOptions<ROW>;\n\tbody?: DTableBodyOptions<ROW, DATA>;\n\tdata?: ROW[] | DTableDataOptions<ROW> | DATA;\n}\n\nexport interface DThemeTable extends DThemePane {\n\n}\n\nconst defaultGetter: DTableGetter<any> = ( row: any, index: number ): unknown => {\n\treturn row[ index ];\n};\n\nconst defaultSetter: DTableSetter<any> = ( row: any, index: number, cell: unknown ): void => {\n\trow[ index ] = cell;\n};\n\nconst defaultEditingUnformatter: DTableEditingUnformatter = ( cell: string ): unknown => {\n\treturn cell;\n};\n\nconst toColumnAlign = <ROW>( options: DTableColumnOptions<ROW>, type: DTableColumnType ): DAlignHorizontal => {\n\tif( options.align != null ) {\n\t\tif( isString( options.align ) ) {\n\t\t\treturn DAlignHorizontal[ options.align ];\n\t\t} else {\n\t\t\treturn options.align;\n\t\t}\n\t}\n\tswitch( type ) {\n\tcase DTableColumnType.TEXT:\n\t\treturn DAlignHorizontal.LEFT;\n\tcase DTableColumnType.REAL:\n\tcase DTableColumnType.INTEGER:\n\t\treturn DAlignHorizontal.RIGHT;\n\tcase DTableColumnType.INDEX:\n\tcase DTableColumnType.SELECT:\n\t\treturn DAlignHorizontal.CENTER;\n\tdefault:\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n};\n\nconst toColumnEditing = <ROW>( options: DTableColumnOptions<ROW> ): DTableColumnEditing => {\n\tconst editing = options.editing;\n\tif( editing ) {\n\t\treturn {\n\t\t\tenable: editing.enable === true || options.editable === true,\n\t\t\tformatter: editing.formatter || toString,\n\t\t\tunformatter: editing.unformatter || defaultEditingUnformatter,\n\t\t\tvalidator: editing.validator\n\t\t};\n\t}\n\treturn {\n\t\tenable: options.editable === true,\n\t\tformatter: toString,\n\t\tunformatter: defaultEditingUnformatter\n\t};\n};\n\nconst toComparator = <ROW>( getter: DTableGetter<ROW>, index: number ): DTableDataComparatorFunction<ROW> => {\n\treturn ( rowA: ROW, rowB: ROW ): number => {\n\t\tconst valueA = getter( rowA, index ) as any;\n\t\tconst valueB = getter( rowB, index ) as any;\n\t\treturn ( valueA < valueB ? -1 : ( valueB < valueA ? +1 : 0 ) );\n\t};\n};\n\nconst toColumnSorting = <ROW>(\n\tgetter: DTableGetter<ROW>,\n\tindex: number,\n\toptions: DTableColumnOptions<ROW>\n): DTableColumnSorting<ROW> => {\n\tconst sorting = options.sorting;\n\tif( sorting ) {\n\t\tconst enable = sorting.enable === true || options.sortable === true;\n\t\tif( enable ) {\n\t\t\treturn {\n\t\t\t\tenable,\n\t\t\t\tcomparator: sorting.comparator || toComparator( getter, index )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tenable\n\t\t\t};\n\t\t}\n\t}\n\tif( options.sortable === true ) {\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcomparator: toComparator( getter, index )\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tenable: false\n\t\t};\n\t}\n};\n\nconst toColumnMenu = ( options?: DMenuOptions<unknown> | DMenu<unknown> ): DMenu<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( options instanceof DMenu ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DMenu( options );\n\t}\n};\n\nconst toColumnDialog = (\n\toptions?: DDialogSelectOptions<unknown> | DDialogSelect<unknown>\n): DDialogSelect<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( options instanceof DDialogSelect ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DDialogSelect( options );\n\t}\n};\n\nconst defaultSelectingGetter: DTableSelectingGetter = ( selected: unknown ): unknown => {\n\treturn selected;\n};\n\nconst toColumnSelecting = ( options: DTableColumnSelectingOptions | undefined ): DTableColumnSelecting => {\n\tif( options ) {\n\t\treturn {\n\t\t\tgetter: options.getter || defaultSelectingGetter,\n\t\t\tmenu: toColumnMenu( options.menu ),\n\t\t\tdialog: toColumnDialog( options.dialog ),\n\t\t\tfetcher: options.fetcher\n\t\t};\n\t}\n\treturn {\n\t\tgetter: defaultSelectingGetter\n\t};\n};\n\nconst toColumn = <ROW>( index: number, options: DTableColumnOptions<ROW> ): DTableColumn<ROW> => {\n\tconst weight = ( options.weight != null ? options.weight :\n\t\t( options.width != null ? undefined : +1 )\n\t);\n\tconst width = ( weight != null ? undefined :\n\t\t( options.width != null ? options.width : 100 )\n\t);\n\tconst type = ( options.type != null ?\n\t\t( isString( options.type ) ? DTableColumnType[ options.type ] : options.type ) :\n\t\tDTableColumnType.TEXT\n\t);\n\tconst align = toColumnAlign( options, type );\n\tconst label = options.label || \"\";\n\tconst getter = options.getter || defaultGetter;\n\tconst setter = options.setter || defaultSetter;\n\treturn {\n\t\tweight,\n\t\twidth,\n\t\ttype,\n\t\tlabel,\n\t\tgetter,\n\t\tsetter,\n\t\tformatter: options.formatter,\n\t\talign,\n\n\t\tediting: toColumnEditing( options ),\n\t\tsorting: toColumnSorting( getter, index, options ),\n\n\t\theader: options.header,\n\t\tbody: options.body,\n\n\t\tselecting: toColumnSelecting( options.selecting ),\n\n\t\tcategory: options.category,\n\t\tfrozen: options.frozen,\n\t\toffset: 0.0\n\t};\n};\n\nconst toColumns = <ROW>( options: Array<DTableColumnOptions<ROW>> ): Array<DTableColumn<ROW>> => {\n\tconst result = [];\n\tfor( let i = 0, imax = options.length; i < imax; ++i ) {\n\t\tresult.push( toColumn( i, options[ i ] ) );\n\t}\n\treturn result;\n};\n\nconst toFrozen = <ROW>( columns: Array<DTableColumn<ROW>> ): number => {\n\tfor( let i = columns.length - 1; 0 <= i; --i ) {\n\t\tif( columns[ i ].frozen === true ) {\n\t\t\treturn i + 1;\n\t\t}\n\t}\n\treturn 0;\n};\n\nexport class DTable<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTable = DThemeTable,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DTableOptions<ROW, DATA, THEME, CONTENT_OPTIONS> = DTableOptions<ROW, DATA, THEME, CONTENT_OPTIONS>\n>  extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _category!: DTableCategory | null;\n\tprotected _header!: DTableHeader<ROW>;\n\tprotected _body!: DTableBody<ROW, DATA>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\t// Column\n\t\tconst columns = toColumns( options.columns );\n\n\t\t// Frozen\n\t\tconst frozen = toFrozen( columns );\n\n\t\t// Categories\n\t\tconst category = this.newCategory( options, columns, frozen );\n\t\tthis._category = category;\n\n\t\t// Header\n\t\tconst headerOffset = (category && category.height) || 0;\n\t\tconst header = this.newHeader( options, columns, frozen, headerOffset );\n\t\tthis._header = header;\n\n\t\t// Body\n\t\tconst bodyOffset = headerOffset + header.height;\n\t\tconst body = this.newBody( options, columns, frozen, bodyOffset );\n\t\tthis._body = body;\n\n\t\t// Super\n\t\tsuper.init( options );\n\n\t\t// Content\n\t\tconst content = this._content;\n\t\tcontent.setWidth( this.toContentWidth( options ) );\n\t\tcontent.addChild( body );\n\t\tcontent.addChild( header );\n\t\tif( category ) {\n\t\t\tcontent.addChild( category );\n\t\t}\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tbody.update();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tbody.update();\n\t\t});\n\t\tif( body.data.selection.type !== DTableDataSelectionType.NONE ) {\n\t\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\t\tbody.onRowClicked( e );\n\t\t\t});\n\t\t}\n\t\tbody.update();\n\t}\n\n\tprotected hasCategories( columns: Array<DTableColumn<ROW>> ): boolean {\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tif( columns[ i ].category != null ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected toCategoryColumns( columns: Array<DTableColumn<ROW>>, frozen: number ): DTableCategoryColumn[] {\n\t\tconst result: DTableCategoryColumn[] = [];\n\t\tlet current: DTableCategoryColumn | null = null;\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tif( i !== frozen && current && current.label === column.category ) {\n\t\t\t\tif( current.weight != null && column.weight != null ) {\n\t\t\t\t\tcurrent.weight += column.weight;\n\t\t\t\t} else if( current.width != null && column.width != null ) {\n\t\t\t\t\tcurrent.width += column.width;\n\t\t\t\t} else {\n\t\t\t\t\tcurrent = {\n\t\t\t\t\t\tlabel: column.category,\n\t\t\t\t\t\tweight: column.weight,\n\t\t\t\t\t\twidth: column.width,\n\t\t\t\t\t\toffset: 0.0\n\t\t\t\t\t};\n\t\t\t\t\tresult.push( current );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcurrent = {\n\t\t\t\t\tlabel: column.category,\n\t\t\t\t\tweight: column.weight,\n\t\t\t\t\twidth: column.width,\n\t\t\t\t\toffset: 0.0\n\t\t\t\t};\n\t\t\t\tresult.push( current );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newCategory( options: OPTIONS, columns: Array<DTableColumn<ROW>>, frozen: number ): DTableCategory | null {\n\t\tif( this.hasCategories( columns ) ) {\n\t\t\treturn new DTableCategory( this.toCategoryOptions( options.category, columns, frozen ) );\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected toCategoryOptions(\n\t\toptions: DTableCategoryOptions | undefined,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\tfrozen: number\n\t): DTableCategoryOptions {\n\t\tif( options ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = this.toCategoryColumns( columns, frozen );\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tcolumns: this.toCategoryColumns( columns, frozen ),\n\t\t\tfrozen\n\t\t};\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst result = this._body.onDblClick( e, interactionManager );\n\t\treturn super.onDblClick( e, interactionManager ) || result;\n\t}\n\n\tprotected getScrollBarOffsetVerticalStart( size: number ): number {\n\t\treturn size * 0.5 + this._body.position.y;\n\t}\n\n\tprotected toContentWidth( options: OPTIONS ): DCoordinateSize {\n\t\tlet columnWidthTotal = 0;\n\t\tconst columns = options.columns;\n\t\tif( columns ) {\n\t\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\t\tconst column = columns[ i ];\n\t\t\t\tconst columnWidth = column.width;\n\t\t\t\tif( columnWidth != null ) {\n\t\t\t\t\tcolumnWidthTotal += columnWidth;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( 0 < columnWidthTotal ) {\n\t\t\treturn ( p: number ): number => {\n\t\t\t\treturn Math.max( p, columnWidthTotal );\n\t\t\t};\n\t\t}\n\t\treturn \"100%\";\n\t}\n\n\tprotected newHeader(\n\t\toptions: OPTIONS,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableHeader<ROW> {\n\t\treturn new DTableHeader( this.toHeaderOptions( options.header, columns, frozen, offset ) );\n\t}\n\n\tprotected toHeaderOptions(\n\t\toptions: DTableHeaderOptions<ROW> | undefined,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableHeaderOptions<ROW> {\n\t\tif( options ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = columns;\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\tif( options.offset === undefined ) {\n\t\t\t\toptions.offset = offset;\n\t\t\t}\n\t\t\tif( options.table === undefined ) {\n\t\t\t\toptions.table = this;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tcolumns,\n\t\t\tfrozen,\n\t\t\toffset,\n\t\t\ttable: this\n\t\t};\n\t}\n\n\tprotected newBody(\n\t\toptions: OPTIONS,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableBody<ROW, DATA> {\n\t\treturn new DTableBody<ROW, DATA>(\n\t\t\tthis.toBodyOptions( options.body, columns, frozen, offset, options.data )\n\t\t);\n\t}\n\n\tprotected toBodyOptions(\n\t\toptions: DTableBodyOptions<ROW, DATA> | undefined,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\tfrozen: number,\n\t\toffset: number,\n\t\tdata: ROW[] | DTableDataOptions<ROW> | DATA | undefined\n\t): DTableBodyOptions<ROW, DATA> {\n\t\tif( options != null ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = columns;\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\tif( options.offset === undefined ) {\n\t\t\t\toptions.offset = offset;\n\t\t\t}\n\t\t\tif( options.data === undefined && data !== undefined ) {\n\t\t\t\tif( isArray( data ) ) {\n\t\t\t\t\toptions.data = {\n\t\t\t\t\t\trows: data\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\toptions.data = data;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( options.height === undefined && options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tif( isArray( data ) ) {\n\t\t\treturn {\n\t\t\t\tcolumns,\n\t\t\t\tfrozen,\n\t\t\t\toffset,\n\t\t\t\tdata: {\n\t\t\t\t\trows: data\n\t\t\t\t},\n\t\t\t\tweight: 1\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tcolumns,\n\t\t\t\tfrozen,\n\t\t\t\toffset,\n\t\t\t\tdata,\n\t\t\t\tweight: 1\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTable\";\n\t}\n\n\tget category(): DTableCategory | null {\n\t\treturn this._category;\n\t}\n\n\tget header(): DTableHeader<ROW> {\n\t\treturn this._header;\n\t}\n\n\tget body(): DTableBody<ROW, DATA> {\n\t\treturn this._body;\n\t}\n\n\tget data(): DATA {\n\t\treturn this._body.data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DTreeOptions<THEME extends DThemeTree> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeTree extends DThemeBase {\n\n}\n\nexport class DTree<\n\tTHEME extends DThemeTree = DThemeTree,\n\tOPTIONS extends DTreeOptions<THEME> = DTreeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\n\nexport class ESnapperResultScale {\n\tdistance: number;\n\tscale: Point;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.scale = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\nexport const toSvgTexture = ( svg: string, resolution: number ): Texture => {\n\treturn Texture.from( toSvgUrl( svg ), {\n\t\tresolution\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as ui from \"./wcardinal/ui\";\n\nui.loadAll();\n\nconst global = window as any;\nglobal.wcardinal = global.wcardinal || {};\nglobal.wcardinal.ui = ui;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","DBorderMask","DApplications","instance","INSTANCES","push","instances","length","Error","index","indexOf","target","stage","parent","toStage","layer","application","getLayerBase","getLayerOverlay","update","i","imax","render","isFunction","theme","options","callback","_theme","_callback","background","_color","color","_alpha","alpha","DBaseBackground","state","undefined","result","getBackgroundColor","onChange","getBackgroundAlpha","DCornerMask","isString","toString","call","border","_width","width","_align","align","_mask","mask","DBaseBorder","getBorderColor","getBorderAlpha","getBorderWidth","getBorderAlign","getBorderMask","DBaseInteractive","isNumber","corner","_radius","radius","DBaseCorner","getCornerRadius","getCornerMask","isChanged","DBaseState","outline","_offset","offset","DBaseOutline","getOutlineColor","getOutlineAlpha","getOutlineWidth","getOutlineOffset","getOutlineAlign","getOutlineMask","padding","_left","_top","_right","_bottom","left","top","right","bottom","DBasePadding","getPaddingLeft","getPaddingTop","getPaddingRight","getPaddingBottom","point","cb","scope","_point","DBasePoint","x","y","set","copyFrom","arguments","equals","texture","height","borderSize","cornerMask","_super","Float32Array","Uint16Array","_this","_height","_texture","_borderSize","_cornerMask","_isDirty","_textureId","NaN","_vertexBuffer","getBuffer","_vertices","data","_uvBuffer","_uvs","_indexBuffer","getIndex","_indices","DBaseBackgroundMeshGeometry","_updateID","iv","array","x0","x1","y0","y1","ii","indices","uvs","c","u0","u1","u2","u3","v0","v1","v2","v3","fillVertices","valid","textureId","getTextureId","vertices","Math","min","x2","max","x3","y2","y3","textureUvs","l","r","t","w","h","ctl","TOP_LEFT","ctr","TOP_RIGHT","cbl","BOTTOM_LEFT","cbr","BOTTOM_RIGHT","ia","fillUvsCorner","fillIndices","fillUvs","MeshGeometry","MeshMaterial","DBaseBackgroundMesh","shader","geometry","renderer","_render","Mesh","borderMask","_borderMask","DBaseBorderMeshGeometry","b1","b2","uz","vz","bt","TOP","bb","BOTTOM","bl","LEFT","br","RIGHT","DBaseBorderMesh","base","cornerRadius","getRadius","cornerHeight","getMask","backgroundPlane","_backgroundPlane","getBackgroundTexture","appendRenderable","borderWidth","getWidth","borderPlane","_borderPlane","getBorderTexture","outlineWidth","outlineMask","outlinePlane","_outlinePlane","DBaseOutlineMesh","_lastBackgroundCornerRadius","_lastBorderCornerRadius","_lastBorderWidth","_lastOutlineCornerRadius","_lastOutlineWidth","addReflowable","DBaseReflowable","backgroundColor","getColor","backgroundAlpha","getAlpha","tint","visible","borderColor","borderAlpha","borderAlign","getAlign","borderOffset","outlineColor","outlineAlpha","outlineOffset","getOffset","outlineAlign","outlineOffsetAccumulative","DLayoutClearType","NodeType","DBaseStates","HOVERED","DRAGGING","FOCUSED","FOCUSED_IN","ACTIVE","ACTIVE_IN","DISABLED","PRESSED","READ_ONLY","INVALID","SUCCEEDED","FAILED","destination","destinationState","source","when","setState","on","newSourceState","isNotActive","bind","AutoFlag","TOKEN_MAPPING_OPERATOR","+","-","*","/","(",")",",","TOKEN_MAPPING_LITERAL","%","s","expression","nodes","toToken","toParensesis","toUnary","toArithmetic","node","_node","DScalarExpression","ifrom","ito","istart","nodeType","nodeTypePrev","j","jnode","toComma","splice","operand","iprev","toCommaOf","type","toUnaryNode","operatorA","operatorB","toArithmeticNode","tokens","matched","TOKEN_REGEX","exec","token","tokenTypeOperator","parsedToken","parseFloat","tokenTypeLiteral","self","current","evaluate","args","POSITION_CENTER","POSITION_PADDING","SIZE_MAXIMIZED","SIZE_PADDING","DScalarFunctions","coordinate","scalarExpression_1","calculate","scalar_1","scalarExpression_2","scalar_2","DThemes","DEFAULT_THEME_CLASS","INSTANCE","defaultThemeClass","getDefaultThemeClass","UtilKeyboardEvent","e","key","which","ctrlKey","shiftKey","expressionOrShortcut","event_1","arrowIndex","keyExpression","substring","trim","keys","toLowerCase","split","shortcut","shift","toUpperCase","code","charCodeAt","setShortcutKeyAndWhich","alt","ctrl","event","parts","join","handler","toShortcut","document","body","addEventListener","altKey","isActionable","emit","preventDefault","UtilPointerEvent","interactionManager","touches","changedTouches","touch","mapPositionToPoint","clientX","clientY","touchable","isDowned_1","downX_1","downY_1","interactionManagerBound_1","cleanup_1","off","up_1","onUp_1","up","contains","global","dx","abs","dy","threshold","CLICK_DISTANCE_THRESHOLD","isValidDistance_1","down","global_1","global_2","getLayer","plugins","interaction","once","onClick","onLongClick","isDowned_2","downX_2","downY_2","timeoutId_1","interactionManagerBound_2","cleanupTimeout_1","clearTimeout","cleanup_2","up_2","onUp_2","move_1","onMove_1","isValidDistance_2","move","global_3","originalEvent","window","setTimeout","LONG_CLICK_THRESHOLD","isDowned_3","downX_3","downY_3","clickTime_1","timeStamp","DBLCLICK_INTERVAL_THRESHOLD","item","targetOrChild","DAlignHorizontal","DAlignVertical","DAlignWith","transform","_position","position","onPositionChanged","_scale","scale","onScaleChanged","_skew","skew","onSkewChanged","_options","scalarSet","_scalarSet","_autoFlags","_hasDirty","_isChildrenDirty","_shadow","_name","name","getInstance","get","toTheme","getThemeDefault","_befores","_afters","_reflowables","_clearType","clear","getClearType","_padding","layout","toChildrenDirty","toDirtyAndUpdate","toDirty","_background","_border","_outline","_corner","initReflowable","getX","getY","toWidthAuto","size","getHeight","toHeightAuto","_state","NONE","_stateLocal","interactive","getInteractive","SELF","interactiveChildren","CHILDREN","name_1","_title","title","getTitle","_weight","weight","getWeight","_onShadowUpdateBound","shadow","getShadow","over","onOver","out","onOut","onDown","isDirty","hasDirty","toParentHasDirty","toParentChildrenDirty","updateState","blur","shortcuts","_shortcuts","toShortcuts","onShortcutBound","onShortcut","cursor","getCursor","init","states","addChild","children","child","DBase","renderable","phase","unshift","list","reflowable","reflowables","onChildrenChange","moveChildren","oldWidth","oldHeight","widthResized","heightResized","resized","onResize","parent_1","getParentOfSize","getLeft","parent_2","getTop","newWidth","newHeight","resizeChildren","getType","scalar","parent_3","isWidthAuto","parent_4","isHeightAuto","isHovered","applyTitle","view","toHasDirty","onChildrenDirty","isActive","isPressed","isReadOnly","isDisabled","isDragging","isInvalid","isSucceeded","isFailed","isFocused","getFocusController","setFocused","recursively","focused","getFocused","hasState","UNFOCUSABLE","isOn","oldStateLocal","newStateLocal","statesOn","statesOff","stateLocal","newState","mergeState","oldState","onStateChange","stateParent","onParentStateChange","onFocused","onBlured","onChildFocused","newStateParent","oldStateParent","setTheme","refit","onRefit","hasRefitableWidth","hasRefitableHeight","resize","getRight","getBottom","isRefitable","onReflow","reflow","previous","removeReflowable","removeRenderable","prependRenderable","onParentResize","parentWidth","parentHeight","parentPadding","paddingWidth","paddingHeight","newX","newY","onParentMove","deltas","onDownThis","parent_5","focusController","findFocusableParent","setHovered","worldAlpha","renderBefore","renderAfter","befores","before","updateTransform","afters","after","worldTransform","bounds","_bounds","work","WORK_CONTAINS_POINT","apply","addPoint","_calculateBounds","containsGlobalPoint","containsLocalPoint","applyInverse","destroy","Point","Container","character","DDynamicTextMeasureResultCharacter","count","characters","clipped","DDynamicTextMeasureResult","advance","lineHeight","newLine","_target","UtilCharacterIterator","iend","isLowSurrogate","isVariationSelector","nextBreak","findNextBreak","except","_instance","DDynamicTextMeasure","text","atlas","clippingWidth","RESULT","start","iterator","from","font","hasNext","next","a","dots","pop","end","DDynamicTextGeometry","vertexBuffer","uvBuffer","indexBuffer","measure","requiredTextSize","ceil","requiredVertexSize","requiredIndexSize","writeCharacter","writeCharacterEmpty","offsetX","origin","vo","_id","_idApproved","DDynamicTextStyle","FONT","_fontFamily","fontFamily","getFontFamilly","_fontSize","fontSize","getFontSize","_fontStyle","fontStyle","_fontVariant","fontVariant","_fontWeight","fontWeight","_fontIdId","_fontId","_fontIdApproved","_fill","fill","_fillApproved","_clipping","clipping","_onChange","newFontId","Texture","EMPTY","_style","_isGeometryDirty","_atlas","update_","_text","_textApproved","_atlasRevisionUpdated","_clippingWidthDelta","DDynamicText","style","textApproved","fontId","fontIdApproved","fillApproved","approve","atlases","getDynamicFontAtlases","add","remove","geometryWidth","newScale","geometryHeight","getRevisionUpdate","revisionUpdate","_clippingWidth","newClippingWidth","getClippingWidth","DMenuItemLinkMenuItemId","DBaseOverflowMaskSimple","beginFill","drawRect","endFill","Graphics","DTextBase","_textValue","value","newTextValue","toTextValue","_textValueComputed","computeTextValue","_textColor","_textAlpha","_textStyle","getFontWeight","getFontStyle","getFontVariant","getTextStyleClipping","toTextStyle","_textAlign","vertical","getTextAlignVertical","horizontal","getTextAlignHorizontal","toTextAlign","_textFormatter","formatter","getTextFormatter","toTextFormatter","_textDynamic","dynamic","isTextDynamic","toTextDynamic","_isOverflowMaskEnabled","isOverflowMaskEnabled","_overflowMask","onTextChange","createOrUpdateText","updateTextValue","textValue","getTextValue","formatted","createText","updateTextPosition","getOrCreateOverflowMask","Text","toRounded","CENTER","MIDDLE","round","getTextColor","getTextAlpha","newTextValueComputed","updateTextColor","updateText","overflowMask","DImageBase","_image","_imageAlign","image","with","getImageAlignWith","getImageAlignVertical","getImageAlignHorizontal","toImageAlign","_imageMargin","margin","getImageMarginVertial","getImageMarginHorizontal","toImageMargin","_imageTint","toImageTint","_imageBound","Rectangle","_imageBoundPoint","_imageSource","_imageSourceComputed","_onImageChangeBound","onImageChange","imageSource","getImageSource","updateImageTint","getLocalBounds","localTransform","getImageRect","imageWidth","imageHeight","textAlign","imageAlign","marginHorizontal","imageWaMH","setClippingWidthDelta","marginVertical","imageHaMV","imageTint","getImageTintColor","getImageTintAlpha","isTintAware","newImageSourceComputed","computeImageSource","oldImageSourceComputed","oldImage","Sprite","removeChild","newImage","updateImageSource","TEXT","updateTextAndImagePosition","PADDING","updateImagePositionPadding","BORDER","updateImagePositionBorder","updateImagePositionText","imageSourceComputed","DImage","DListItem","buttonMode","_value","toValue","selection","hasSelection","getSelection","isActivateKey","onSelect","onKeyDown","DMenuItem","getContext","getCloseable","DMenuItemText","initOnClick","initOnOver","initShortcuts","context","_shortcutMargin","getShortcutTextMargin","shortcutTextValue","_shortcutText","shortcutText","updateShortcutText","closeable","DMenuItemCheck","check","setActive","DMenuItemLinkTarget","DMenuItemLinkState","NEW_WINDOW","CUSTOM","UtilAttachAlign","DMenus","creator","CREATORS","CREATOR_DEFAULT","MENU_CREATOR","creators","creatorDefault","sticky","created","newItemOf","items","DisplayObject","newItem","JSON","stringify","newItemsOf","element","range","createRange","selectNodeContents","removeAllRanges","addRange","toClipboardData","clipboardData","stopPropagation","UtilClipboard","clipboard","navigator","writeText","ClipboardEvent","setData","copyUsingWindow","div","createElement","setAttribute","textContent","appendChild","getData","execCommand","removeEventListener","copyUsingDiv","userAgent","span","innerText","attachShadow","mode","copyUsingSpan","utils","EventEmitter","_link","link","_checker","checker","_menuOptions","menu","DMenuItemLink","_menu","getMenuOptions","toMenu","onMenuSelect","newMenu","OPEN_LINK_IN_NEW_WINDOW","open","COPY_LINK_ADDRESS","copy","then","resolved","href","isHidden","inNewWindow","checked","a_1","display","rel","click","location","oe","InteractionEvent","metaKey","button","DLayoutDirection","UtilAttach","offsetY","clippingHeight","adjust","clippingSize","DMenuAlign","DMenuItemMenu","toggle","initHover","onOpen","close","DListItemSeparatorReflowable","middle","lineStyle","moveTo","lineTo","DListItemSeparator","DMenuItemSeparator","DLayoutSpace","DMenuItemSpace","loadMenuItem","addItemCreator","isCompatible","toSubMenuOptions","setItemCreatorDefault","EShapeType","isVisible","DLayout","_margin","themeMargin","getMargin","toMargin","_direction","direction","getDirection","toDirection","_cornerAdjust","getCornerAdjust","toCornerAdjust","_multiplicity","row","column","getMultiplicity","toMultiplicity","_reverse","reverse","getReverse","toReverse","multiplicity","clearType","BEFORE","AFTER","baseSize","VERTICAL","marginNext","paddingTop","paddingBottom","paddingLeft","paddingRight","weightTotal","getWeightTotal","cornerAdjustWork","requiredSize","CORNER_ADJUST_WORK","irow","weightTotalInverse","spaceLeft","getSpaceLeft","k","icolumn1","i1","irow1","icolumn0","i0","findRowIndexPrevious","hasClearTypeAfter","icolumn2","i2","findRowIndexNext","hasClearTypeBefore","ncolumn","countColumn","toCornerMaskColumn","icolumn","irow0","findColumnIndexPrevious","irow2","findColumnIndexNext","nrow","countRow","toCornerMaskRow","hasClearType","n","ALL","DLayoutVertical","DMenuItemExpandableBody","DMenuItemExpandableHeader","DMenuItemExpandables","DMenuItemExpandable","header","toHeader","_header","toBody","_body","newItems","onActivated","onDeactivated","newHeader","newBody","show","hide","DMenuItemExpandableItemCheck","DMenuItemExpandableItemLink","DMenuItemExpandableItemSeparator","DMenuItemExpandableItemSpace","DMenuItemExpandableItemText","loadMenuItemExpandable","DMenuSidedItemCheck","DMenuSidedItemLink","DMenuSidedItemMenu","DMenuSidedItemSeparator","DMenuSidedItemSpace","DMenuSidedItemText","DMenuSideds","loadMenuSidedItem","DMenuSidedItemExpandables","DMenuSidedItemExpandable","DMenuSidedItemExpandableItemCheck","DMenuSidedItemExpandableItemLink","DMenuItemExpandableItemMenu","DMenuSidedItemExpandableItemMenu","DMenuSidedItemExpandableItemSeparator","DMenuSidedItemExpandableItemSpace","DMenuSidedItemExpandableItemText","loadMenuSidedItemExpandable","loadMenuItemAll","EShapeDeserializers","EShapePointsStyle","EShapeUploadeds","EShapeBarPosition","EShapePointsStyleUploadeds","nonExpandingWidth","NON_EXPANDING_WIDTH","nonShrinkingWidth","NON_SHRINKING_WIDTH","nonScalingDotAndDash","NON_SCALING_DOT_AND_DASH","NON_SOLID_MASK","strokeWidth","DOTTED","DOTTED_DENSELY","DOTTED_LOOSELY","DASHED","DASHED_DENSELY","DASHED_LOOSELY","EShapeCopyPart","EShapeRuntimeReset","EShapeRuntimeState","_parent","_values","_segments","_size","_updatedSize","_updatedParentSizeX","_updatedParentSizeY","_updatedPosition","EShapeBarPoints","sizeX","sizeY","parentSize","parentSizeX","parentSizeY","psxh","psyh","computedSize","getComputedSize","values","segments","newValues","newSegments","newStyle","newPosition","newSize","updateUploaded","manager","resourceId","resources","resource","parsed","parse","ax","ay","tester","EShapeAction","sources","destinations","isEquals","indexA","indexB","tmp","serialize","EShapeCorner","EShapeStrokeSide","shape","rotation","actions","toObject","stroke","reset","written","effect","EShapeRuntime","disabled","CLICKED","CHANGED","hovered","DOWN","UP","onPointerDown","onPointerUp","onPointerClick","time","tag","isEffectTimeUp","disallowUploadedUpdate","onUpdate","allowUploadedUpdate","PERSISTENT","executeActions","resetUnwrittenProperties","execute","POSITION_X","POSITION_Y","VISIBILITY","COLOR_FILL","COLOR_STROKE","COLOR_TEXT","COLOR_TEXT_OUTLINE","HEIGHT","WIDTH","ROTATION","CURSOR","internalTransform","Matrix","EShapeTransformImpl","Transform","onTransformChange","updateSkew","_currentLocalID","_localID","_parentID","_worldID","parentTransform","oldLocalId","oldWorldId","newLocalId","newWorldId","copyTo","prepend","toPadded","str","strLength","UtilRgb","trimmed","Number","g","colorA","colorB","ar","ag","ab","bg","w1","w0","amount","blend","EShapeGradients","gradient","points","parseGradient","serialized","serializeGradient","stops","toCode","radian","PI","cos","sin","btoa","id","newTransform","_onTransformChangeLock","_isOnTransformChanged","action","_visible","_uploadedUpdateLock","_isUploadedUpdated","_isUploadedUpdatedRecursively","_boundsTransformId","_boundsInternalTransformId","_boundsLocalTransformId","selected","reference","EShapeBase","onTransformChange_","updateUploadedRecursively","onChildTransformChange","invokeOnTransformChange","uploaded","root","at","detach","IDENTITY","childrenSerialized","src","toGradientId","pivot","shortcutId","titleId","serializeImage","serializeChildren","unfocusable","sx","sy","rect","toLocalRect","WORK_RECT","containsAbs","containsText","containsChildren","textWorld","world","tx","ty","th","tv","childResult","shadowed","containsAbsBBox","skipUpdate","worldId","getWorldId","getBounds_","boundsInternal","_boundsInternal","currentLocalId","getLocalIdCurrent","boundsLocal","_boundsLocal","px","py","getBoundsSize","xmin","ymin","xmax","ymax","getState","runtime","unforcusable","onPointerDblClick","onKeyUp","part","TRANSFORM","sourceTransform","SIZE","STYLE","ACTION","addAll","POINTS","sourcePoints","clone","STATE","EShapeTagValueOrder","EShapeTagValueRangeType","EShapeDefaults","enable","_enable","EShapeFillImpl","stringified","fills","deserialized","side","_side","EShapeStrokeImpl","strokes","EShapeTextWeight","EShapeTextStyle","EShapeTextAlignHorizontal","EShapeTextAlignVertical","EShapeTextDirection","_type","_from","_to","EShapeTagValueRangeImpl","to","FROM","TO","FROM_TO","copy_","ranges","INDEX_COMPARATOR","initial","format","_time","_capacity","_order","ASCENDING","EShapeTagValueImpl","newValue","capacity","order","normalize","newTime","times","_times","parent_6","newTimes","parent_7","parent_8","parent_9","parent_10","sorted","slice","sort","parent_11","parent_12","idSerialized","initialSerialized","formatSerialized","rangeSerialized","tagValues","deserialize","EShapeTagImpl","inherited","RANGE_DUMMY","nvalue","EMPTY_ARRAY","tags","EShapeActionValueBlinkType","_horizontal","_vertical","EShapeTextAlignImpl","aligns","EShapeTextOffsetImpl","margins","EShapeTextOutlineImpl","textOutlines","family","_family","NORMAL","spacing","LEFT_TO_RIGHT","EShapeTextImpl","isChangedDirty","isChangedUploaded","alignSerialized","offsetSerialized","outlineSerialized","spacingSerialized","paddingSerialized","texts","newFill","newStroke","RADIUS","newText","EShapePrimitive","ObservablePoint","onSizeChange","SIZE_X","SIZE_Y","FILL_COLOR","FILL_ALPHA","STROKE_COLOR","STROKE_ALPHA","STROKE_WIDTH","STROKE_ALIGN","STROKE_SIDE","TEXT_VALUE","TEXT_FAMILY","TEXT_SIZE","imageSrc","EShapeLineBase","container","getPixelScale","toThreshold","strokeScale","getStrokeWidthScale","toHitThreshold","calcHitPointAbs","calcHitPointAbsHitTester","p0x","p0y","p1x","p1y","d0x","d0y","d1x","d1y","BAR","EShapeBar","WORK_COLOR","buildColor","voffset","vcount","colors","rgba","premultiplyTintToRgba","buffer","ioffset","icount","antialiasWeight","transformLocalId","vertexOffset","vertexCount","indexOffset","indexCount","colorFill","alphaFill","colorStroke","alphaStroke","strokeAlign","strokeSide","textureTransformId","EShapeUploadedBase","getLocalId","WHITE","textureAny","updateUvs","isEnabled","colorFillBuffer","colorFills","colorStrokeBuffer","colorStrokes","updateColorFill","updateColorStroke","builder","baseTexture","EShapeTextUploadeds","toLength","dx01","dy01","sqrt","tvcount","ticount","textSize","textFamily","textTexture","textTextureTransformId","textColor","textAlpha","textWeight","textStyle","textAlignHorizontal","textAlignVertical","textOffsetHorizontal","textOffsetVertical","textOutlineWidth","textOutlineColor","textOutlineAlpha","textSpacingHorizontal","textSpacingVertical","textDirection","textPaddingHorizontal","textPaddingVertical","textClipping","textVertexCount","textIndexCount","EShapeTextUploaded","getTextCount","workCount","updateColorFillAndStroke","halign","valign","hoffset","hpadding","vpadding","hnx","hny","vnx","vny","OUTSIDE_TOP","OUTSIDE_BOTTOM","OUTSIDE_LEFT","OUTSIDE_RIGHT","defx","defy","li","textAtlas","toTextureTransformId","isCharChanged","isCharSizeChanged","isCharStyleChanged","isCharAlignChanged","isCharOffsetChanged","isCharSpacingChanged","isCharDirectionChanged","isClippingChanged","isTextureChanged","hl","vl","heightChar","lineWidth","textAtlasCharacters","advancePrevious","tx0","ty0","lineWidthMaximum","getTextBBox","TOP_TO_BOTTOM","rotateAlignVerticalRight","rotateAlignHorizontalRight","BOTTOM_TO_TOP","rotateAlignVerticalLeft","rotateAlignHorizontalLeft","dwidth","toTextureUvs","uvx0","uvx1","uvx3","uvy0","uvy1","uvy3","duvx01","duvy01","duvx03","duvy03","lhx","lhy","snx","sny","oyx","oyy","offsetItalic","bx0","by0","bx3","by3","cx0","cy0","cx3","cy3","lineCount","advanceDots","adjustTextAlignment","ivmax","dataOffsetX","dataWidth","dx0","dy0","dx1","dy1","px0","py0","px1","py1","dux0","duy0","dux1","duy1","dvx0","dvy0","dvx1","dvy1","vertexIndex","textCount","nx","ny","moveText","moveTextHalf","moveTextFull","textOutline","stepBuffer","antialiasBuffer","steps","antialiases","updateTextVertex","updateTextColorFill","updateTextColorStroke","updateTextStep","clippingBuffer","clippings","buildUnit","textBaseTexture","pointsId","pointsStyle","EShapeBarUploaded","ic","initText","isSizeChanged","isStrokeWidthChanged","toTransformLocalId","isTransformChanged","isPointsIdChanged","isPointsStyleChanged","updateLineVertexStepAndColorFill","updateColor","updateBarUv","pointCount","pointValues","pointsSize","scaleInvariant","toScaleInvariant","lastIndex","p2x","p2y","ratio","p3x","p3y","toDash","dash0","dash1","toTexture","iuv","EShapeBarUploadeds","tcount","vertexCapacity","indexCapacity","isArray","EShapeActionBases","EShapeActionRuntime","def","defLiteral","Function","parameter1","parameter2","conditionDefault","condition","toExpression","interval","EShapeActionRuntimeBlink","dinterval","elapsed","toOff","toOn","EShapeActionRuntimeConditional","COLOR","EShapeActionRuntimeBlinkBrighten","toBaseFill","brighten","toBaseStroke","toBaseText","toBaseTextOutline","EShapeActionRuntimeBlinkColorFill","EShapeActionRuntimeBlinkColorStroke","EShapeActionRuntimeBlinkDarken","darken","COLOR_FILL_AND_STROKE","EShapeActionRuntimeBlinkOpacity","EShapeActionRuntimeBlinkVisibility","EShapeActionValueType","EShapeActionValueBase","toLabel","subtype","EShapeActionValueSubtyped","EShapeActionValueChangeColorTarget","EShapeActionValues","BLINK","EShapeActionValueBlink","BRIGHTEN","DARKEN","OPACITY","conditionId","toResource","UtilAlpha","alphaA","alphaB","EShapeActionValueChangeColorType","blendDefault","ALPHA","EShapeActionRuntimeChangeColor","baseFill","baseStroke","baseText","baseOutline","EShapeActionRuntimeChangeColorAll","setAll","EShapeActionRuntimeChangeColorFill","EShapeActionRuntimeChangeColorFillAndStroke","sets","EShapeActionRuntimeChangeColorStroke","EShapeActionRuntimeChangeColorText","EShapeActionRuntimeChangeColorTextOutline","EShapeActionValueChangeTextType","CHANGE_COLOR","EShapeActionValueChangeColor","FILL","STROKE","FILL_AND_STROKE","TEXT_OUTLINE","blendId","brightnessDefault","brightness","EShapeActionRuntimeChangeColorBrightness","toColorAdjusted","EShapeActionRuntimeChangeColorBrightnessAll","EShapeActionRuntimeChangeColorBrightnessFill","EShapeActionRuntimeChangeColorBrightnessFillAndStroke","EShapeActionRuntimeChangeColorBrightnessStroke","EShapeActionRuntimeChangeColorBrightnessText","EShapeActionRuntimeChangeColorBrightnessTextOutline","EShapeActionValueChangeColorBrightness","BRIGHTNESS","brightnessId","colorDefault","alphaDefault","EShapeActionRuntimeChangeColorCode","EShapeActionRuntimeChangeColorCodeAll","EShapeActionRuntimeChangeColorCodeFill","EShapeActionRuntimeChangeColorCodeFillAndStroke","EShapeActionRuntimeChangeColorCodeStroke","EShapeActionRuntimeChangeColorCodeText","EShapeActionRuntimeChangeColorCodeTextOutline","EShapeActionValueChangeColorCode","CODE","colorId","alphaId","nameDefault","EShapeActionRuntimeChangeCursor","CHANGE_CURSOR","EShapeActionValueChangeCursor","nameId","FormatNodeA","step","date","getHours","FormatNodea","FormatNodeD","String","getDate","FormatNoded","precision","FormatNodee","toExponential","FormatNodePrecision","FormatNodef","toFixed","FormatNodefsi","toAbs","format_","unitInverse","postfix","FormatNodeg","toPrecision","FormatNodeH","FormatNodeh","FormatNodeM","getMonth","FormatNodem","getMinutes","FormatNodemi","getMilliseconds","FormatNodeP","FormatNodep","FormatNodePadding","FormatNodeParenthesis","FormatNodePlus","FormatNodeRP","FormatNoderp","Y","M","D","H","m","mi","FormatNodesdt","FormatNodeSpace","FormatNodessi","FormatNodeString","FormatNodeY","getFullYear","FormatNodey","FormatNodez","z","getTimezoneOffset","floor","FormatNoderd","FormatNodes","getSeconds","REGEXP","previousIndex","isDateRequired","all","modifier","toModifiedNodeDatetime2","toModifiedNodeDatetime3","toModifiedNodeNumber","Date","NumberFormatterImpl","setTime","NumberFormatters","numberDefault","number","EShapeActionRuntimeChangeTextNumber","textDefault","EShapeActionRuntimeChangeTextText","EShapeActionValueMiscType","CHANGE_TEXT","EShapeActionValueChangeText","NUMBER","valueId","EShapeActionRuntimeEmitEvent","EMIT_EVENT","EShapeActionValueEmitEvent","ASCII_CHARACTERS","reserved","ref","life","DynamicFontAtlasCharacterOrigin","_gl","_shaderProgram","_vertexPositionAttribute","_textureCoordAttribute","_samplerUniform","_sizeUniform","_vb","_uvb","canvas","_canvas","_onLostBound","_onRestoreBound","restore","_onUnloadBound","DynamicSDFFontGenerator","isContextLost","config","antialias","depth","stencil","premultipliedAlpha","gl","clearColor","makeVertexBuffer","makeUvBuffer","makeShaders","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","vertexShader","getShader","fragmentShader","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteShader","useProgram","getAttribLocation","getUniformLocation","getError","deleteProgram","textureCanvas","viewport","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","deleteTexture","vb","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","deleteBuffer","uvb","COLOR_BUFFER_BIT","vertexPositionAttribute","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureCoordAttribute","activeTexture","TEXTURE0","uniform1i","uniform2f","drawArrays","TRIANGLE_STRIP","copyCanvas","copyContext","drawImage","destroyVertexBuffer","destroyUvBuffer","destroyShaders","WebGLLoseContext","getExtension","loseContext","_generator","DynamicSDFFontAtlas","getGenerator","_font","toFontFamily","italic","_characters","_length","addChar","DynamicFontAtlasCharacter","generator","characterSize","toPowerOf2","textBaseline","lineCap","lineJoin","miterLimit","fillStyle","measureText","characterWidth","characterHeight","clearRect","fillText","updateTexture","read","toJson","getAutoFontFamily","GENERATOR","FONT_FAMILY_AUTO","input","_onInputKeyDownBound","onInputKeyDown","_onInputBlurBound","onInputBlur","_updateInputBound","updateInput","_onInputChangeBound","onInputChange","_onInputInputBound","onInputInput","_updateInputBoundRenderer","EShapeActionRuntimeMiscInputData","getRootElement","createInput","getInputType","getInputStyle","readonly","removeAttribute","paddingHorizontal","matrix","getInputStylePosition","getInputStyleMargin","getInputStyleText","getInputStyleBackground","getInputStyleBorder","getInputStylePadding","getInputStyleOutline","isFocusKey","getFocusDirection","focusable","findFocusable","focus","isOkKey","HTMLInputElement","onInput","newShape","oldShape","getInput","initInput","updateInputBound","select","EShapeActionRuntimeMiscInput","data_1","isShown","_","EShapeActionValueOpenType","MISC","EShapeActionValueMisc","INPUT","targetDefault","EShapeActionRuntimeOpenFlow","opener","EShapeActionRuntimeOpen","EShapeActionRuntimeOpenPage","EShapeActionRuntimeOpenPageInplace","EShapeActionValueShowHideType","OPEN","EShapeActionValueOpen","FLOW","PAGE","PAGE_INPLACE","targetId","EShapeActionValueTransformMoveType","EShapeActionValueTransformType","visibility","SHOW","EShapeActionRuntimeShowHide","SHOW_HIDE","EShapeActionValueShowHide","amountDefault","EShapeActionRuntimeTransformMoveAbsoluteX","EShapeActionRuntimeTransformMove","EShapeActionRuntimeTransformMoveAbsoluteY","POSITION","EShapeActionRuntimeTransformMoveForwardOrBackward","writtenPositionX","writtenPositionY","oldPositionX","oldPositionY","EShapeActionRuntimeTransformMoveLeftOrRight","EShapeActionRuntimeTransformMoveRelativeX","EShapeActionRuntimeTransformMoveRelativeY","opetype","EShapeActionValueOpetyped","EShapeActionValueTransformResizeType","MOVE","EShapeActionValueTransformMove","ABSOLUTE_X","ABSOLUTE_Y","FORWARD_OR_BACKWARD","LEFT_OR_RIGHT","RELATIVE_X","RELATIVE_Y","amountId","EShapeSizes","centerMode","isPerfect","hsize","toNormalized","EShapeActionValueTransformRotateType","sizeRelativeDefault","sizeAbsoluteDefault","RELATIVE_SIZE","ABSOLUTE_SIZE","RELATIVE_HEIGHT","ABSOLUTE_HEIGHT","RELATIVE_WIDTH","ABSOLUTE_WIDTH","EShapeActionRuntimeTransformResize","dsx","dsy","originX","originY","EShapeActionRuntimeTransformResizeHeightAbsolute","sizeAbsolute","oldSizeY","adjustPosition","EShapeActionRuntimeTransformResizeHeightRelative","sizeRelative","EShapeActionRuntimeTransformResizeSizeAbsolute","writtenWidth","writtenHeight","oldSizeX","EShapeActionRuntimeTransformResizeSizeRelative","EShapeActionRuntimeTransformResizeWidthAbsolute","EShapeActionRuntimeTransformResizeWidthRelative","RESIZE","EShapeActionValueTransformResize","EShapeActionRuntimeTransformRotate","oldRotation","newRotation","EShapeActionRuntimeTransformRotateAbsolute","EShapeActionRuntimeTransformRotateRelative","ROTATE","EShapeActionValueTransformRotate","ABSOLUTE","RELATIVE","EShapeActionValueDeserializer","toSerialized","COLOR_AND_ALPHA","EShapeImageElements","dataUrl","imageElements","cachedImageElement","HTMLImageElement","Promise","resolve","reject","imageElement","onload","onabort","onerror","Map","extensions","EShapeDeserializer","shapeDeserializer","childrenPromise","childrenOrPromises","childSerialized","childOrPromise","toShape","serializedActions","gradientId","deserializeGradient","imagePromise","imageId","toImageElement","serializeds","EShapeResourceManagerDeserialization","shapes","jmax","EShapeBars","loadShapeBar","buildStep","swx","swy","cx","cy","toStep","dpc0","pc0","pc1","swc","pc","buildCircleClipping","buildCircleIndex","buildCircleVertexAndStep","isStepsDirty","workStep","x4","y4","x7","y7","worldSizeX","worldSizeY","buildCircleUv","EShapeCircleUploaded","updateCircleVertexAndStep","updateCircleUv","isStrokeChanged","EShapeCircleUploadeds","CIRCLE","EShapeCircle","ay2","ax2","wx","wy","wx2","wy2","EShapeCircles","loadShapeCircle","EShapeGroupUploaded","EShapeGroupUploadeds","EShapeGroupFillEditor","EShapeGroupPoints","toPoints","internalTransformParentInverse","EShapeTransforms","editor","EShapeEditor","invert","identity","disallowOnTransformChange","allowOnTransformChange","keepSize","newLocalTransform","append","applyLocal","bx","by","rx","atan2","ry","shapeBase","EShapeGroupSizeLayout","baseX","baseY","pivotX","pivotY","childBase","WORK_TRANSFORM","translate","_layouts","EShapeGroupSizeEditor","ox","oy","calcRect","_workRectForFit","layouts","workPoint","_workPoint","workRect","_workRectForCalcRect","getBoundsLocal","enlarge","onChange_","newLayout","EShapeGroupSizeViewer","EShapeGroupStrokeEditor","EShapeGroupTextAlignEditor","EShapeGroupTextOffsetEditor","EShapeGroupTextOutlineEditor","EShapeGroupTextPaddingEditor","EShapeGroupTextSpacingEditor","EShapeGroupTextEditor","GROUP","newGroupSize","newGroupFill","newGroupStroke","newGroupText","newGroupPoints","EShapeGroup","IS_EDIT_MODE","result_1","fit","_points","EShapeGroups","loadShapeGroup","EShapeGroupSizeShadowed","GROUP_SHADOWED","EShapeGroupShadowed","EShapeGroupShadoweds","loadShapeGroupShadowed","RECTANGLE","EShapeRectangle","TOP_OR_LEFT","BOTTOM_OR_LEFT","TOP_OR_RIGHT","BOTTOM_OR_RIGHT","IMAGE","EShapeImage","EShapeImages","buildRectangleClipping","buildRectangleIndex","buildRectangleVertexAndStep","x10","y10","swt","pt0","swr","pr0","swb","pb0","swl","pl0","pm0","is","buildRectangleUv","x02","y02","EShapeRectangleUploaded","updateVertexAndStep","updateUv","EShapeRectangleUploadeds","loadShapeImage","EShapeLabelUploaded","updateLabelVertex","updateLabelUv","EShapeLabelUploadeds","LABEL","EShapeLabel","EShapeLabels","loadShapeLabel","toIndexOf","pointsClosed","pointId","EShapeLineUploaded","io","isPointChanged","updateLineUv","CLOSED","pointSegments","closed","lprev","lnext","llop","llo","lmax","pprevx","pprevy","pnextx","pnexty","pseg","psegnext","icfprev","loffset","pfirstx","pfirsty","psegfirst","plastx","plasty","pseglast","psecondx","psecondy","psegsecond","nextIndex","pnextxn","pnextyn","loffsetprev","dx32","dy32","closed_1","icf","lengthInverse","EShapeLineUploadeds","minX","maxX","minY","maxY","pointsLength","_valuesBase","_valuesBaseLength","_sizeBase","EShapeLinePoints","ssx","ssy","sizeBase","hasSizeBaseX","hasSizeBaseY","scaleX","scaleY","valuesBase","fitToParentSize","isUpdated","valuesBaseLength","newValuesLength","iupdate","newSegmentsLength","oldStyle","rangeResult","WORK_RANGE","lineOrPoints","LINE","EShapeLine","EShapeLines","loadShapeLine","EShapeLineOfNullsUploaded","EShapeLineOfAnyUploadeds","vcountPerPoint","icountPerPoint","copyClipping","icd","ics","copyIndex","idiv","iid","iis","copyStep","ivd","ivs","iad","ias","copyUvs","iuvd","iuvs","copyVertex","pointsValues","ip","isStatic","toComputed","EShapeLineOfAnyPointsFillImpl","resolution","frame","DynamicAtlasItem","resolutionInverse","DynamicAtlasItemEmpty","DynamicAtlasItemFontAtlas","DynamicAtlasItemImage","DynamicAtlasItemText","DynamicAtlasItemWhite","save","fillRect","_baseTexture","BaseTexture","mipmap","MIPMAP_MODES","OFF","_idToDatum","_sortedData","_predefined","empty","white","DynamicAtlas","maxRowHeight","datum","minHeight","applyFrame","ITEM_COMPARATOR","idToDatum","forcibly","cleanup","canvasWidth","calcCanvasWidth","canvasHeight","updateFrames","renderFrames","setRealSize","applyFrames","predefined","hex2string","metrics","TextMetrics","measureFont","ascent","descent","fontColor","_context","DynamicFontAtlasFont","_unrefCount","_revision","_revisionUpdated","scaleMode","SCALE_MODES","add_","DynamicFontAtlas","getAdvance","targets","remove_","strokeStyle","cleanup_","fontHeight","realWidth","realHeight","updateAll","colorToAltas","forEach","destroyAll","_atlases","_resolution","DynamicFontAtlases","colorToAtlas","DynamicSDFFontAtlases","begin","addAscii","newAtlas","baseAtlas","getBaseTexture","atlasId","isNaN","newInstance","Lazy","toCeilingIndex","toSvgUrl","svg","Image","BaseImageResource","crossOrigin","crossorigin","autoLoad","load","SVGResource","_load","onError","run","extension","INSTALLED","DMouseModifier","_ratio","_frames","_svg","_nextX","_nextY","UtilSvgAtlasBuilder","path","frames","build","built","_built","force","devicePixelRatio","pow","log","LN2","url","scaling","frames_1","UtilClickOutside","toLocal","ds","dt","UtilDragEasingHistory","DAnimationTimings","_startTime","_duration","duration","_durationInverse","_onTime","onTime","_onTimeBaseBound","onTimeBase","_onStart","onStart","_onEnd","onEnd","_timing","timing","ELASTIC","DAnimationBase","stop","now","toTime","isReverse","elapsedTime","onMove","_histories","_historiesSorted","_historyBegin","_historyEnd","_dx","_dy","_ds","_dt","_animation","onEase","LINEAR","_durationPosition","_durationScale","_onMove","UtilDragEasing","histories","HISTORY_CAPACITY","oldHistoryEnd","newHistoryEnd","oldHistoryBegin","unsorted","total","history_1","history_2","history_3","ldt","adt","updateHistoriesSorted","sortedLength","history_4","d0","d1","animation","UtilFileAs","DMouseModifiers","CTRL","ALT","SHIFT","OR","_modifier","defaultChecker","match","toChecker","_interactionManager","_center","_scalingCenter","easing","_easing","onEasingMove","toEasingOptions","_onDownBound","_onMoveBound","_onEndBound","_down","_move","_up","UtilDrag","center","touchesLength","first","centerX","centerY","squareDistance","calcCenterAndScale","setDragging","oldScale","oldTime","EPSILON","scalingCenter","UtilExtractor","skipUpdateTransform","RenderTexture","renderTexture","pixels","Uint8Array","readPixels","ignorePremutipliedAlpha","canvasRenderTarget","CanvasRenderTarget","imageData","getImageData","extract","Extract","arrayPostDivide","putImageData","scaledWidth","scaledHeight","scaledImageData","quality","toDataURL","UtilFileDownloader","filename","contents","blob","Blob","msSaveBlob","downloadUrl","URL","createObjectURL","UtilExtract","toResolution","toSkipUpdateTransform","toRenderer","toPixels","premultiplied","ignore","toIgnorePremultipliedAlpha","toScale","toCanvas","toBase64","base64","EShapeCapability","as","facade","_input","_as","_facade","UtilFileOpener","getOrCreateInput","onCancel","input_1","stopImmediatePropagation","files","file","fileReader","FileReader","onAboart","readAsText","DATA_URL","readAsDataURL","BINARY_STRING","readAsBinaryString","ARRAY_BUTTER","readAsArrayBuffer","UtilHsv","v","UtilName","mapping","_mapping","_layer","_application","last","UtilOverlay","UtilPromise","UtilRgba","_backgroundCache","_backgroundAttribute","_borderCache","_borderAttribute","_onUpdate","UtilTexturePlane","tl","attr","realRadius","realSize","toCornerBr","toCornerTl","toSvg","make","cache","newBackground","maskToTexture","newBorder","UtilTexture","onLoad","_current","_lastUpdate","_updateId","UtilTransition","updateId","lastUpdate","remaining","_names","documentMode","UtilWheelEvent","useCapture","names","name_2","_lineHeight","getLineHeight","_pageHeight","deltaX","deltaY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","delta","_timestamp","_lowest","shouldAdjust","lowest","deltaMode","getPageHeight","_x","_y","_limit","_limitComputed","_limitId","_limitParentLength","EShapeLineOfAnyPointsSizeImpl","limit","updateLimitComputed","limitId","limitParentLength","calcLimit","parentLenght","EShapeLineOfAnyPointsStrokeImpl","_valuesLength","_stroke","EShapeLineOfAnyPoints","valuesLength","getLimit","buildLineOfAnyColor","colorDef","alphaDef","isStaticColor","isStaticAlpha","pointSizeId","pointFillId","pointStrokeId","EShapeLineOfAnyUploaded","pointFill","isPointFillChanged","isFillEnabled","isFillChanged","pointStroke","isPointStrokeChanged","isStrokeEnabled","EShapeLineOfCirclesUploaded","updateLineOfAnyColorFill","updateLineOfAnyColorStroke","pointSize","isPointSizeChanged","isStaticX","isStaticY","pointSizeX","pointSizeY","EShapeLineOfCirclesUploadeds","other","LINE_OF_CIRCLES","_tester","containsPointAbs","_testerBBox","containsPointAbsBBox","EShapeLineOfCircles","EShapeLinesOfCircles","loadShapeLineOfCircles","ESnapperTargetValueType","EShapeCapabilities","mappings","PRIMITIVE","capability","RECTANGLE_ROUNDED_WORLD_SIZE","buildRectangleRoundedIndex","buildRectangleRoundedVertex","worldSize","dxh","dyh","dxhr","dyhr","x11","y11","dxv","dyv","dxvr","dyvr","x5","y5","x6","y6","x9","y9","x8","y8","x12","y12","x20","y20","x15","y15","x13","y13","x14","y14","x17","y17","x16","y16","x18","y18","x19","y19","x22","y22","x21","y21","buildRectangleRoundedClipping","rxc","ryc","buildRectangleRoundedStep","swtc","ptc0","swrc","prc0","swbc","pbc0","swlc","plc0","plr0","ptb0","buildRectangleRoundedUv","ruvx","ruvy","EShapeLineOfRectangleRoundedsUploaded","updateVertexClippingStepAndUv","isCornerChanged","isVertexChanged","EShapeLineOfRectangleRoundedsUploadeds","RECTANGLE_ROUNDED","EShapeRectangleRounded","by1","bx1","containsAbs_","wr","hasLeftSide","hasTopSide","hasBottomSide","hasRightSide","LINE_OF_RECTANGLE_ROUNDEDS","EShapeLineOfRectangleRoundeds","EShapeLinesOfRectangleRoundeds","loadShapeLineOfRectangleRoundeds","BORDER_RADIUS","EShapeLineOfRectanglesUploaded","EShapeLineOfRectanglesUploadeds","LINE_OF_RECTANGLES","EShapeLineOfRectangles","EShapeLinesOfRectangles","loadShapeLineOfRectangles","TRIANGLE_ROUNDED_WORLD_SIZE","buildTriangleRoundedIndex","buildTriangleRoundedVertex","sz","sw","rz","dx14","dy14","dx47r","dy47r","dx71","dy71","xb","yb","buildTriangleRoundedClipping","buildTriangleRoundedStep","wsr","pr1","p0","p1","buildTriangleRoundedUv","EShapeLineOfTriangleRoundedsUploaded","isRadiusChanged","EShapeLineOfTriangleRoundedsUploadeds","TRIANGLE","EShapeTriangle","ay1","aw","TRIANGLE_ROUNDED","EShapeTriangleRounded","r12","r13","xl","yl","ni","nlx","nly","nrx","nry","det","deti","xc","yc","containsCorner_","az","c0","c1","c2","containsCorner","LINE_OF_TRIANGLE_ROUNDEDS","EShapeLineOfTriangleRoundeds","EShapeLinesOfTriangleRoundeds","loadShapeLineOfTriangleRoundeds","TRIANGLE_WORLD_SIZE","buildTriangleClipping","buildTriangleIndex","buildTriangleVertex","buildTriangleStep","buildTriangleUv","EShapeLineOfTrianglesUploaded","updateVertexStepAndUvs","EShapeLineOfTrianglesUploadeds","LINE_OF_TRIANGLES","EShapeLineOfTriangles","EShapeLinesOfTriangles","loadShapeLineOfTriangles","EShapeNullUploaded","EShapeNullUploadeds","NULL","EShapeNull","EShapeNulls","loadShapeNull","EShapeRectangles","loadShapeRectangle","EShapeRectangleRoundedUploaded","EShapeRectangleRoundedUploadeds","EShapeRectangleRoundeds","loadShapeRectangleRounded","EShapeTriangleUploaded","updateVertexStepAndUv","EShapeTriangleUploadeds","EShapeTriangles","loadShapeTriangle","EShapeTriangleRoundedUploaded","EShapeTriangleRoundedUploadeds","EShapeTriangleRoundeds","loadShapeTriangleRounded","loadShapeAll","loadAll","EShapeGroupFillViewer","EShapeGroupStrokeViewer","EShapeGroupTextAlignViewer","EShapeGroupTextOffsetViewer","EShapeGroupTextOutlineViewer","EShapeGroupTextPaddingViewer","EShapeGroupTextSpacingViewer","EShapeGroupTextViewer","units","EShapeBufferUnitBuilder","unit","EShapeBufferUnit","ntriangles","nindices","nvertices","Buffer","isIndicesShort","Uint32Array","EShapeBufferCount","Geometry","addIndex","addAttribute","EShapeBuffer","unitCount","DRAW_MODES","TRIANGLES","unit0","unit1","ioffset0","ioffset1","uniforms","sampler","draw","vindex","iindex","getVertexOffset","getIndexOffset","getVertexCount","getIndexCount","creater","DUMMY_SHAPES","EShapeRendererIteratorDatum","_index","_datum","_data","EShapeRendererIterator","datumIndex","newDatum","_shader","Shader","_iterator","_bufferSize","_bufferSizeMax","getBufferSizeMax","EShapeRenderer","webGLVersion","uint32ElementIndex","fontAtlases","defaultTexture","textureItem","newTextureItem","updateAtlas","updateAtlases","fontAtlas","updateFontAtlas","updateFontAtlases","buffers","getBuffers","getAntialiasWeight","getAtlas","getFontAtlases","getDefaultTexture","repack","updateBuffers","pixelScale","toPixelScale","translationMatrix","toArray","setBlendMode","correctBlendMode","BLEND_MODES","bufferSize","bufferSizeMax","ib","ibmax","increaseBufferSize","jb","getBufferSize","ObjectRenderer","_childrenId","_childrenIdRendered","_fontAtlases","_pixelScale","_pixelScaleId","_work","_buffers","EShapeContainer","childrenId","childrenIdRendered","isChildrenDirty","shapeRenderer","SHAPE_RENDERER","batch","setObjectRenderer","render_","worldID","childLocal","containsBBox","EShapeSearch","toDepth","isParent","shapeParent","findChildById","findChildByType","matcher","findChild","findChildrenByType","findChildren","EShapeDeleter","generateListOfDetachedShapes","COMPARATOR_INDEX","resourceToIndex","EShapeResourceManagerSerialization","EShapeRuntimes","_isEnabled","ESnapperGrid","disable","distance","ESnapperResult","snapped","newDistance","oldDistance","ESnapperModifierAnchor","ESnapperTargetValue","_isVisible","ESnapperTarget","valueA","DCommandFlag","_normals","_lengths","_workScale","_workSnapResultX","_workSnapResultY","_workScaleResult","_workTranslate","_workSnapRectangle","_workSnap","grid","ESnapper","prepare","snap","workTranslate","newDx","newDy","baseRotation","deltaRotation","gridSize","getGridSizeRotation","newRotationDegree","toDegree","newRotationDegreeResidual","toRadian","anchor","normals","lengths","calcNormalizedVector","TOP_CENTER","MIDDLE_LEFT","MIDDLE_RIGHT","BOTTOM_CENTER","normal","mx","setScaleSnappedResult","my","calcScaleSnapped1D","detA","mdx","mdy","pointO","pointX","pointY","calcScaleSnapped2D","calcScaleSnappedX","calcScaleSnappedY","keepRatio","calcScaleSnappedXY","_isStarted","DAnimationEmpty","_shiftX","_shiftY","_onPrerenderBound","onPrerender","_onPostrenderBound","onPostrender","DAnimationFadeIn","_storedTime","removeEventListeners","_storedTarget","addEventListeners","disallowUpdate","allowUpdate","storedTime","unsafe","_storedX","_storedY","_storedAlpha","DApplicationPadding","_root","_overlay","overlay","getBoundingClientRect","bbox","transparent","_pixi","autoStart","DApplicationLayerOptions","updateWidthAndHeight","pixi","isFocusable","isFocusableContainer","isSelectable","DControllerDefaultFocus","_focused","mightBeFocusable","FOCUS_ROOT","includesTarget","includesTargetChildren","findFocusableNext","found","isFocusRoot","findFocusablePrevious","DDialogCloseOn","DCommandClear","UNSTORABLE","CLEAR","DCommandRedo","DCommandUndo","isCommandStorable","command","getFlag","_done","_waiting","_executing","DControllerDefaultCommand","done","waiting","command_1","undo","onSuccess","onFail","redo","isClear","isStorable","isRedoable","isUndoable","DControllerKeyboard","hasOnKeyDown","hasOnKeyUp","DControllers","KEYBOARD","COMMAND","DOCUMENT","getPixiApplicationOptions","stageAny","_isUpdateAllowed","_refitLimit","_reflowLimit","_renderBound","_renderId","rootElement","elementContainer","_elementContainer","isOverlay","thirdChild","insertBefore","oldOnChildrenChange_1","updateVisibility","firstChild","rootElementStyle","getComputedStyle","overflow","viewStyle","hasFocus","onBlurBound","getKeyboardController","getPadding","wheelGlobal","wheelEventUtil","wheelEvent","toGlobal","hitTest","onWheel","onDblClick","DApplicationLayer","requestAnimationFrame","screen","ilimit","_focus","_dynamicFontAtlases","Application","toRootElement","Renderer","__plugins","accessibility","_base","newLayerBase","_isOverlayEnabled","DApplication","querySelector","toLayerBaseOptions","toLayerOverlayOptions","newLayerOverlay","DBoard","DButtonBase","_isToggle","isToggle","_onActiveUpBound","setPressed","_onActiveUpBoundTarget","setActiveHandlers","group","onToggleStart","onToggleEnd","onActivateKeyDown","onActivateKeyUp","DButton","DButtonAmbient","DButtonCheck","DButtonCheckRight","DButtonPrimary","DHtmlElementWhen","DDialog","_focusable","_isOpened","onAnimationEnd","_closeOn","closeOn","CLICK_OUTSIDE","onCloseOn","firstFocusable","pick","onClose","ESC","isCancelKey","DLayoutHorizontal","DDialogCommand","getLayoutX","getLayoutY","getLayoutWidth","getLayoutHeight","onInit","ok","getOk","cancel","getCancel","buttonLayout","_buttonLayout","_buttonCancel","active","_buttonOk","onOk","_promise","_resolve","_reject","DPickerDatetimeMask","DHtmlElement","clipper","clipperCreator","getClipperCreator","_clipper","_clipperCreator","_clipperRect","elementCreator","getElementCreator","_element","_elementCreator","_elementStyle","_elementRect","_isElementShown","_isElementSelected","_onElementFocusedBound","onElementFocused","_before","_beforeCreator","getBeforeCreator","_beforeStyle","_onBeforeFocusedBound","onBeforeFocused","_after","_afterCreator","getAfterCreator","_afterStyle","_onAfterFocusedBound","onAfterFocused","_select","getSelect","_doSelectBound","doSelect","getWhen","_when","ALWAYS","onEndByBlured","isStartable","doStart","updateElement","getClipper","getBefore","getElement","getAfter","elementRect","getElementRect","clipperRect","getClipperRect","setClipperStyle","setElementStyle","setBeforeStyle","setAfterStyle","onElementAttached","scrollTop","scrollLeft","getClippingRect","onElementDetached","containsPoint","mouse","getElementContainer","_clipperStyle","worldVisible","DInput","_editingValidationResult","_editingValidator","editing","validator","getEditingValidator","_description","description","_editingFormatter","getEditingFormatter","_editingUnformatter","unformatter","getEditingUnformatter","validate","setInvalid","editingValidationResult","oldValue","DInputNumber","_step","getStep","_min","getMin","toMin","_max","getMax","toMax","updateInputStep","updateInputMin","updateInputMax","valueAsString","initInputStep","initInputMin","initInputMax","DInputReal","DText","DInputLabel","_label","label","space","DInputAndLabel","DInputRealAndLabel","DInputText","DInputTextAndLabel","colorAndAlpha","onColorChange","onAlphaChange","_colorAndAlpha","_onColorChange","_onAlphaChange","DPickerColorAndAlpha","recents","_recents","DPickerColorRecent","recent","DPickerColor","_currentPicker","_newPicker","_recent","_new","setColorNew","setAlphaNew","setColorCurrent","setAlphaCurrent","_pointerPoint","mainWidth","getMainWidth","mainHeight","getMainHeight","mainBaseSprite","_mainBaseSprite","mainSprite","_mainSprite","getMainTexture","_onMainMoveBound","onMainMove","_onMainUpBound","onMainUp","onMainDown","baseSprite","_baseSprite","getBaseMargin","_onBaseMoveBound","onBaseMove","_onBaseUpBound","onBaseUp","onBaseDown","alphaCheckerboardSprite","_alphaCheckerboardSprite","getAlphaCheckerboardTexture","getBaseHeight","alphaSprite","getAlphaTexture","_onAlphaMoveBound","onAlphaMove","_onAlphaUpBound","onAlphaUp","onAlphaDown","mainPointerSprite","_mainPointerSprite","getMainPointerTexture","getMainPointerColor","getMainPointerAlpha","alphaPointerSprite","_alphaPointerSprite","getAlphaPointerTexture","getAlphaPointerColor","getAlphaPointerAlpha","basePointerSprite","_basePointerSprite","getBasePointerTexture","getBasePointerColor","getBasePointerAlpha","_recentColorSprites","recentColorSprites","recentColorCount","getRecentColorCount","recentColorWidth","getRecentColorWidth","recentColorHeight","getRecentColorHeight","recentColorWidthHalf","recentColorHeightHalf","recentColorMargin","getRecentColorMargin","recentColorY","getAlphaHeight","getRecentMargin","recentCheckerboardTexture","getRecentCheckerboardTexture","RECENT_COLORS","getRecents","onRecentChange","onRecentClick","checkerboardSprite","currentTarget","sprite","recentColorAndAlpha","inputMargin","getInputMargin","inputY","inputWidth","inputAndLabelColor","_inputAndLabelColor","getInputLabelWidth","fromCode","inputAndLabelAlpha","_inputAndLabelAlpha","sampleWidth","getSampleWidth","sampleHeight","getSampleHeight","sampleX","sampleY","sampleCurrentCheckerboardSprite","_sampleCurrentCheckerboardSprite","getSampleCheckerboardTexture","sampleCurrentSprite","_sampleCurrentSprite","sampleNewCheckerboardSprite","_sampleNewCheckerboardSprite","sampleNewSprite","_sampleNewSprite","onMainPick","hw","ux","uy","toMainHex","onColorNew","toMainColor","hsv","fromRgb","toRgb","ns","nv","onBasePick","toBaseHex","onColorBase","toBaseColor","onAlphaPick","onAlphaNew","sprites","_selected","DPickerColorGradientPoint","POINT_SORTER","_onChangeBound","second","_workColor","DPickerColorGradientData","isSelectionChanged","rgb0","hex2rgb","r0","g0","b0","rgb1","r1","g1","rgb","rgb2hex","oldDirection","oldSelected","pointsCopy","pointLike","nPointsPerData","_nPointsPerData","_colors","_lastHitIndex","_parts","uSampler","DPickerColorGradientDataView","setColors","setColorsHex","setColorsWhite","setVertices","setUvs","newIndices","setColorsPoint","local","isEqual","ap","bp","apj","bpj","DPickerColorGradientRecent","DPickerColorGradient","gradientPointsWidth","getGradientPointsWidth","gradientPointsMargin","getGradientPointsMargin","picker","_picker","onAnchorColorChange","onAnchorAlphaChange","_view","setRectangle","getLastHitIndex","onViewDown","_onAnchorDownBound","onAnchorDown","_onAnchorMoveBound","onAnchorMove","_onAnchorUpBound","onAnchorUp","_anchors","inputLabelWidth","inputDirectionMargin","getGradientDirectionMargin","inputDirectionTexture","getGradientDirectionTexture","inputLeft","inputDirection","change","recentColumn","getGradientRecentColumn","recentWidth","getGradientRecentWidth","recentMargin","getGradientRecentMargin","recentWidthAndMargin","RECENT_COLOR_GRADIENT","getGradientRecents","getGradientRecentCount","getCapacity","onRecentUpdate","lastHitIndex","updateAnchors","onAnchorSelect","recentData","fromObject","addAt","toAnchorPosition","onAnchorDragStart","new","anchorTexture","getGradientAnchorTexture","anchorOutlinedTexture","getGradientAnchorOutlinedTexture","anchors","anchorSize","newAnchor","oldAnchor","isDeleteKey","DDialogColorGradient","DButtonColorGradient","_dialogOptions","dialog","getViewBaseTexture","_dialog","DIALOG","DDialogColor","DButtonColor","updateTextForcibly","dialogNew","dialogCurrent","DButtonDanger","DPickerDatetimeButtonBack","DPickerDatetimeButtonDate","DPickerDatetimeButtonNext","DPickerDatetimeLabel","DPickerDatetimeLabelDate","DPickerDatetimeSpace","DInputInteger","DDragMode","_date","_inclusive","inclusive","DPickerTimeBound","DPickerTimeBoundHours","lower","lowerDate","constant","DATE","hour","lowerDateHours","SECONDS","MINUTES","minute","upper","upperDate","upperDateHours","DPickerTimeBoundMinutes","HOURS","lowerDateMinutes","upperDateMinutes","DPickerTimeBoundSeconds","newConstant","hours","minutes","seconds","DPickerTimeBounds","test","getTime","setSeconds","setMinutes","setHours","setDate","am","bm","ad","bd","ah","bh","compare","toBoundOptions","onNewChanged","DPickerTime","_dateCurrent","dateCurrentTime","_dateNew","_dateBounds","getLowerBound","isLowerBoundInclusive","getUpperBound","isUpperBoundInclusive","toBoundsOptions","newChildren","dateCurrent","dateNew","_inputHours","_inputMinutes","_inputSeconds","currentTime","onReset","dateBounds","inputHours","inputMinutes","inputSeconds","newInputHours","newInputMinutes","newInputSeconds","newTimeLayout","newTimeLayoutChildren","getTimeLayoutWidth","getTimeLayoutHeight","newMinuteSeparator","newSecondSeparator","getMinuteSeparator","getSecondSeparator","inputOptions","getHoursOptions","adjustInputOptions","onHoursChanged","getMinutesOptions","onMinutesChanged","getSecondsOptions","onSecondsChanged","DPickerDatetime","_datePage","_dateButtons","newDateButtons","_dateDecorator","decorator","getDateDecorator","newLabel","newBackButton","newNextButton","newDateLabels","datePage","onPageChanged","setFullYear","buttons","spaceCount","getDay","getDayStart","dateDecorator","dateCount","dateNewDate","setDisabled","labelText","labelTextAlign","getLabelFormatter","toLabelOptions","buttonOptions","back","getBackButtonOptions","getNextButtonOptions","dateLabels","getDayLabels","dayStart","newDateLabel","newSpace","newDateButton","onDateButtonClicked","setMonth","DPickerDate","DDialogDate","page","DDialogDates","DButtonDate","DDialogDatetime","DDialogDatetimes","DPickerDates","DPickerTimes","DPickerDatetimes","hms","DButtonDatetime","_datetimeMask","toMask","DButtonFileAs","DButtonFile","_opener","onOpening","_buttons","_active","_stateOn","_stateOff","_onActiveBound","onActive","DButtonGroup","DButtonRadio","DButtonRadioRight","commandController","getCommandController","DButtonSecondary","DDialogTime","DDialogTimes","DButtonTime","DBaseOverflowMask","tr","arcTo","DChartAxisPosition","DChartAxisTickPosition","toTarget","stopper","_toTarget","_stopper","getDragMode","getDragModifier","getDragDurationPosition","getDragDurationScale","TOUCH","_bind","ON","_dragUtil","toNormalizedScale","scaleRatio","DViewDragImpl","dragUtil","_newScaleX","_newScaleY","_newX","_newY","_oldScaleX","_oldScaleY","_oldX","_oldY","DViewTransformImpl","_workRect","zoom","_zoomPoint","_zoomMin","getZoomMin","_zoomMax","getZoomMax","_zoomKeepRatio","getZoomKeepRatio","wheelZoom","wheel","_isWheelZoomEnabled","isWheelZoomEnabled","_wheelZoomSpeed","speed","getWheelZoomSpeed","_wheelZoomModifier","getWheelZoomModifier","_wheelZoomChecker","dblClickZoom","dblclick","_isDblClickZoomEnabled","isDblClickZoomEnabled","_dblClickZoomSpeed","getDblClickZoomSpeed","_dblClickZoomModifier","getDblClickZoomModifier","_dblClickZoomChecker","_dblclickZoomDuration","getDblClickZoomDuration","wheelTranslation","translation","_isWheelTranslationEnabled","isWheelTranslationEnabled","_wheelTranslationSpeed","getWheelTranslationSpeed","_wheelTranslationModifier","getWheelTranslationModifier","_wheelTranslationChecker","_drag","drag","_transform","DViewImpl","targetRect","newTargetX","newTargetY","targetX","targetY","targetWidth","targetHeight","newTargetScaleX","newTargetScaleY","newTargetScale","factor","targetScale","oldCanvasScaleX","oldCanvasScaleY","newCanvasScaleX","newCanvasScaleY","canvasScaleRatioX","canvasScaleRatioY","newCanvasX","newCanvasY","zoomAt","newScaleX","newScaleY","zoomAtGlobal","DCanvasContainer","updateContentSize","canvasX","canvasY","vresult","sresult","DCanvas","DChartCoordinateDirection","EShapePointsStyles","_coordinateIndex","toPosition","_tick","toTickContainer","_bar","toBar","DChartAxisBaseOptionParser","getPosition","getStyle","toBarStroke","tick","getTickEnable","major","toTickMajor","minor","toMinorTick","getMajorTickPosition","optionsStyle","getMajorTickStyle","optionsStroke","toTickMajorStroke","getMajorTickCount","getMajorTickSize","toTickPosition","toMajorTickText","toMajorTickFormatter","gridline","toTickMajorGridline","getMajorTickGridlineStyle","getMajorTickGridlineEnable","toTickMajorGridlineStroke","tickPosition","OUTSIDE","getMinorTickPosition","getMinorTickStyle","getMinorTickCount","getMinorTickSize","toTickMinorStroke","toStroke","getStrokeEnable","getStrokeColor","getStrokeAlpha","getStrokeWidth","getStrokeAlign","getStrokeSide","optionsA","optionsB","getMajorTickStrokeEnable","getMajorTickStrokeColor","getMajorTickStrokeAlpha","getMajorTickStrokeWidth","getMajorTickStrokeAlign","getMajorTickStrokeSide","getMajorTickGridlineStrokeEnable","getMajorTickGridlineStrokeColor","getMajorTickGridlineStrokeAlpha","getMajorTickGridlineStrokeWidth","getMajorTickGridlineStrokeAlign","getMajorTickGridlineStrokeSide","getMinorTickStrokeEnable","getMinorTickStrokeColor","getMinorTickStrokeAlpha","getMinorTickStrokeWidth","getMinorTickStrokeAlign","getMinorTickStrokeSide","getMajorTickTextFormat","toMajorTickTextAlign","toMajorTickTextOffset","toMajorTickTextOutline","toMajorTickTextSpacing","toTickMajorTextDirection","toMajorTickTextPadding","getMajorTickTextAlignHorizontal","getMajorTickTextAlignVertical","getMajorTickTextPaddingHorizontal","getMajorTickTextPaddingVertical","getMajorTickTextDirection","toLabelAlign","toLabelOffset","toLabelOutline","toLabelSpacing","toLabelDirection","toLabelPadding","getLabelAlignHorizontal","getLabelAlignVertical","getLabelPaddingHorizontal","getLabelPaddingVertical","getLabelDirection","parser","coordinateIndex","bar","_majorTicks","Float64Array","_minorTicks","DChartAxisBase","barShape","plotArea","plotAreaWidth","plotAreaHeight","domainMin","domainMax","majorShapes","minorShapes","gridlineShapes","shapePositionY","majorCount","majorFormatter","minorCountPerMajor","minorCount","majorTicks","minorTicks","ticks","majorShape","imajorTick","majorTickPosition","majotTickPositionX","majorTickStep","gridlineShape","minorShape","iminorTick","minorTickPosition","minorTickProjectedPosition","shapePositionX","majotTickPositionY","getBoundsInContainer","domainFrom","unmap","domainTo","updateTicksX","updateTicksY","_container","tickShapeContainer","barPosition","attach","tickMajor","gridlinePosition","gridlineCount","gridlineStyle","tickMajorShapes","tickMajorCount","tickMajorSize","tickMajorPosition","tickMajorStyle","tickMajorShape","tickMinor","tickMinorShapes","tickMinorCount","tickMinorSize","tickMinorPosition","tickMinorStyle","tickMinorShape","tickMajorGridlineShapes","updateBar","updateTicks","_plotArea","_list","DChartAxisContainerImpl","axes","axisOrPosition","indexOrUndefined","removed","unbind","DChartAxisX","DChartAxisXDatetime","DChartAxisY","DCHART_COLOR_SET_1","DCHART_COLOR_SET_2","DChartColorSet2","DChartPlotAreaFitTarget","DChartCoordinateContainerSubImpl","coordinateOrIndex","X","cxs","cys","DChartCoordinateContainerImpl","DChartCoordinateLinearTick","power","LN10","toStepScale","majorPosition","rangeMin","rangeMax","iresult","minorPosition","majorResult","minorResult","majorStep","calcStepMajor","map","imajorResult","iminorResult","idomainStart","idomainEnd","minorStep","calcStepMinor","imajor","iminor","majorProjectedPosition","minorProjectedPosition","_translate","_itranslate","_iscale","DChartCoordinateTransformImpl","isZero","stride","itranslate","iscale","DChartRegionImpl","DChartCoordinateLinear","fit_","series","getDomain","getRange","pixelFrom","pixelTo","region","regionFrom","regionTo","regionSize","newTranslation","DChartCoordinateLogTick","domainFromMapped","domainToMapped","domainMinMapped","domainMaxMapped","majorStepMapped","idomainStartMapped","idomainEndMapped","minorStepMapped","majorPositionMapped","minorPositionMapped","DChartCoordinateLog","regionFromMapped","regionSizeMapped","DChartLegendItem","DChartLegend","DChartOverview","DChartPlotAreaContainer","_lastBoundsID","getBounds","isFirst","getBoundsInternal","DChartSeriesHitResult","DChartSeriesScalars","_domain","_range","DChartSeriesFillImpl","DChartSeriesStrokeImpl","_selection","listLength","DChartSeriesContainerImpl","seriesOrIndex","domain","tmp1","tmp2","WORK_CALCHITPOINT","closest","calcHitPoint","DChartSelectionPoint","chart","_chart","DChartPlotArea","_isViewDirty","_isBoundsInContainerDirty","_coordinate","_series","_axis","_boundsInContainer","DChartRegionImplObservable","newFrom","newTo","_coordinateIndexX","_coordinateIndexY","_coordinateIdUpdatedX","_coordinateIdUpdatedY","_coordinateTransformIdUpdatedX","_coordinateTransformIdUpdatedY","DChartSeriesBaseCoordinateContainer","coordinateX","coordinateY","coordinateIdX","coordinateIdY","isCoordinateXChanged","isCoordinateYChanged","coordinateTransformIdX","coordinateTransformIdY","isCoordinateTransformXChanged","isCoordinateTransformYChanged","_regionPointId","DChartSeriesBase","updateRegion","DChartSeriesFillComputedImpl","containerFill","DChartSeriesStrokeComputedImpl","containerStroke","_line","_pointId","_pointIdUpdated","toSize","DChartSeriesLineOfAny","line","newLineOfAny","isCoordinateChanged","updateLine","xcoordinate","ycoordinate","ivalues","mapAll","xraw","yraw","WORK","calcHitPointTestRange","calcHitPointHitTester","DChartSeriesLineOfCircles","DChartSeriesLineOfRectangleRoundeds","DChartSeriesLineOfRectangles","DChartSeriesLineOfTriangleRoundeds","DChartSeriesLineOfTriangles","_lineStrokeOptions","DChartSeriesLine","segmentsLength","isegments","segment","_idUpdated","_a","_b","_x0","_y0","DChartSeriesExpressionParametersImpl","_plotAreaSizeXUpdated","_plotAreaSizeYUpdated","_parameters","DChartSeriesLinear","parameters","isParametersChanged","isPlotAreaSizeChagned","toClean","plotAreaSizeX","plotAreaSizeY","aabs","babs","xfrom0","xto0","xfrom1","xto1","yfrom0","yto0","yfrom1","yto1","_shape","setStyle","DChartSelectionShapeBase","mappedPosition","seriesShape","getTheme","DChartSelectionGridlineX","mappedX","DChartSelectionGridlineY","mappedY","DChartSelectionGridlineContainerImpl","unset","DChartSelectionMarker","DListSelectionMode","_gridline","_marker","marker","_coordinateX","_coordinateY","CLOSER","DChartSelectionSubImpl","PREVIOUS","NEXT","oldSeries","newSelected","_hovered","newHovered","_onClickBound","DChartSelectionSimple","toSubOptions","gridlineX","gridlineY","WORK_SELECT","DChart","_destroyed","DCommandCreate","DCommandDelete","getDocumentController","delete","DCommandSaveAs","saveAs","DCommandSave","DContent","DDiagramCanvasTileMappingPointImpl","lon","lat","mappingOrEnable","lon0","lat0","lon1","lat1","_cb","DDiagramCanvasTileMappingImpl","_factory","factory","onMappingChange","DDiagramCanvasTile","pyramid","_pyramid","DDiagramLayer","DDiagramLayerContainer","activate","addChildAt","activateNext","_tile","tile","DDiagramCanvasBase","layers","newShadowWeak","snapperGraphics","_snapperGraphics","snapper","_snapper","DDiagramCanvasEditor","version","interactives","actionables","ids","_workLocal","_workGlobal","_lastOverShape","DDiagramCanvas","initializeShapes","updateShapes","initializeFocus","shapeId","this_1","lastOverShape","onPointerMove","previousRuntime","onPointerOut","lastOverParent","parentRuntime","onPointerOver","DDiagrams","pflayers","pfresources","pfitems","shapePromises","deserializeAll","pfitem","canvasContainer","_serialized","_tileFactory","DDiagramBase","oldSerialized","onUnset","onSet","newCanvas","newLayer","initialize","applyBackground","_controller","controller","_isChanged","DDiagramEditor","newId","reason","isNew","diagram","_diagram","_updateBound","DDiagramShape","actionable","runtimeEffect","DDiagramTag","tagValue","onShapeMove","onShapeUp","onShapeClick","DDiagram","formatterMap","initialMap","actionMap","runtimeConstructor","tagFormat","tagInitial","toRuntime","onShapeDown","onShapeDblClick","DDialogConfirmMessage","DDialogConfirm","message","toMessage","_message","newMessage","toMessageOptions","toMessageOptionsMerged","getMessage","DDialogConfirmDelete","DDialogConfirmDiscard","enter","getLabelWidth","getLabel","DDialogInputText","DDialogMessage","DDialogProcessingMessage","_isDone","_interval","getInterval","DDialogProcessing","timeoutId","_timeoutId","setStates","onDone","delay","onResolved","onRejected","DDialogSaveAs","getName","DDialogSelectListItem","content","_content","_mode","SINGLE","DListSelection","getChildIndex","MULTIPLE","targetIndex","DScrollBar","_start","_end","thumb","_thumb","createThumb","onRegionChange","DScrollBarThumb","onDragMove","getMinimumSize","DScrollBarThumbReflowableHorizontal","DScrollBarThumbHorizontal","DScrollBarHorizontal","getLocalPosition","newStart","thumbMinimumSize","barStart","barSize","DScrollBarThumbReflowableVertical","DScrollBarThumbVertocal","DScrollBarVertical","DPane","toContent","initScrollBar","initDrag","dragMode","position_1","toContentX","toContentY","verticalBar","_verticalBar","toBarOptionsVertical","onRegionMoveY","horizontalBar","_horizontalBar","toBarOptionsHorizontal","onRegionMoveX","onContentChanged","updateScrollBar","newContent","getWheelContentX","getWheelContentY","getWheelSpeed","updateScrollBarRegions","updateScrollBarVisibilities","updateScrollBarPositions","verticalBarWidth","verticalBarOffsetStart","getScrollBarOffsetVerticalStart","verticalBarOffsetEnd","getScrollBarOffsetVerticalEnd","horizontalBarHeight","horizontalBarOffsetStart","getScrollBarOffsetHorizontalStart","horizontalBarOffsetEnd","getScrollBarOffsetHorizontalEnd","setRegion","isChangedHorizontal","updateScrollBarVisibility","isChangedVertical","isRegionVisible","WORK_ON_FOCUSED","contentX","contentY","contentWidth","contentHeight","DList","newSelection","findItem","updateChildPosition","updateChildVisibility","scrollLimit","itemY","DDialogSelectList","search","_search","_idCompleted","_result","DDialogSelectSearh","searchResult","DNote","defaultConverter","toNoteOptions","_toLabel","converter","toToLabel","noteNoItems","note","noItems","getNoteNoItemsText","toNoteNoItemsOptions","_noteNoItems","noteSearching","searching","getNoteSearchingText","toNoteSearchingOptions","_noteSearching","searchResults","onSearched","transition","isDone","getResult","DDialogSelect","childrenLength","searchResultsLength","minLength","removeChildAt","newChild","owner","_owner","_closeables","DMenuContext","closeables","imin","DMenu","_fit","_sticky","_sub","onPrerenderBound","picked","getOffsetX","getOffsetY","isArrowUpKey","isArrowDownKey","setMenuCreator","DMenuSidedSelectionMode","DDropdown","toMenuOptions","DExpandableHeader","DExpandable","DInputIntegerAndLabel","tileSize","_tileSize","DMapCoordinateEPSG3857","lonlat","meters","C","CIRCUMFERENCE_HALF","tan","atan","exp","tz","R","Z","metersToTile","lonLatToMeters","metersToPixels","metersToLonLat","pixelsToMeters","toResolutionMeter","DMapCoordinates","_default","_sprite","DMapTile","onLoaded","_builder","_onLoaded","_isOnLoadedCalled","_isOnLoadedAllowed","_onLoadedBound","_tz","_lon0","_lat0","_lon1","_lat1","_tiles","_renderTileBound","renderTile","_txmin","_txmax","_tymin","_tymax","_deleteTileBound","tileCode","tiles","deleteTile","_destroyTileBound","destroyTile","_updateLoadingStateForEach","loaded","_isLoaded","_tileCount","toTileCount","_tileScaleRelative","_tileScale","getTileSize","DMapTilePlane","_renderer","oldLon0","oldLat0","oldLon1","oldLat1","lonLatToTile","tx1","ty1","tileCount","txmin","txmax","tymin","tymax","dtxmin","dtxmax","dtymin","dtymax","isTxMinChanged","isTxMaxChanged","isTyMinChanged","isTyMaxChanged","ctx","cty","ltx","lty","lt","toOffset","loadTile","it","txa","loadTilesY","txb","tya","loadTilesX","tyb","toTileCode","toTilePosition","newTile","tileScaleRelative","tileToPixels","updateLoadingState","tileScale","mappingLonLat","_mappingInternal","toMapping","_z","_minZ","plane","_maxZ","_planes","_fitBound","_fitBoundTimeout","_fitThrottle","throttle","fitThrottledBound","_fitThrottledBound","fitThrottled","DMapTilePyramidImpl","WORK_LONLAT","lonLatToPixels","oldMapping","newMapping","planes","planeTz","toZ","toTileZ","newPlane","pixelsToLonLat","destroyPlanesBefore","destroyPlanesAfter","DMapTileUrlBuilderOsmfj","DMapTilePyramids","MIN","MAX","THROTTLE","DEFAULT","toPlaneOptions","DMenuBarItem","DMenuBarBlocker","DMenuBar","onItemStateChangeBound","onItemStateChange","itemOrItemOptions","_blocker","blocker","DMenuSidedContent","DTableColumnType","defaultFilter","_item","_filter","filter","getFilterDefault","DMenuSidedSelection","set_","hasMenu","oldItem","DMenuSided","DSelect","_onSelectedBound","onSelected","_onClosedBound","onClosed","findMenuItem","_offsetX","_offsetY","onTextureUpdate","DShadowImpl","leftWidth","topHeight","rightWidth","bottomHeight","NineSlicePlane","DTableBodyCellCheck","_columnIndex","_columnData","DTableBodyCellColor","hasColor","hasAlpha","DTableBodyCellIndex","rowIndex","DTableBodyCellInputInteger","newCellValue","oldCellValue","DTableBodyCellInputReal","DTableBodyCellInputText","DTableBodyCellSelectDialog","selecting","getter_1","getter","onSelectBound_1","onCloseBound_1","columnIndex","DTableBodyCellSelectFetcher","fetcher","DTableBodyCellSelectMenu","DTableBodyCellText","DTableBodyCellDate","textValueComputed","DTableBodyCellDatetime","DTableBodyCellTime","DTableDataSelectionType","DTableCellState","EVEN","START","END","FROZEN","FROZEN_END","DTableRowState","DTableRow","even","frozen","_frozen","columns","_columns","toIndexEnd","cell","newCell","cellState","toCellState","resetFrozenCellPosition","cells","getContentPositionX","cellIndex","shiftX","isBodyCell","DTableBodyRow","_onCellChangeBound","_row","setter","cellOptions","toCellOptions","newCellEditable","newCellUnediable","setReadOnly","INDEX","INTEGER","REAL","CHECK","BUTTON","SELECT","DATETIME","TIME","cellsLength","columnsLength","_filtered","DTableDataFilterImpl","filtered_1","each","newFiltered","filtered","DTableDataMappedList","indicesSorted","sorter","indicesFiltered","rows","unmappedIndex","DTableDataOrder","COMPARATOR","toType","Set","DTableDataSelectionImpl","has","oldSize","result_2","lastRowIndex","getLastIndex","includeFrom","includeTo","rowIndices","shifted","_comparator","_sorted","DTableBodySorterImpl","comparator","sorted_1","rows_1","toComparator","newSorted","_mapped","_rows","toRows","_sorter","DTableDataList","lock","unlock","newRows","dataLength","rowsLength","DTableBody","rowOptions","selectionType","getRowHeight","toRowOptions","_rowOptions","_rowHeight","_rowIndexMappedStart","_rowIndexMappedEnd","_updateRowsCount","_isUpdateRowsCalled","_isUpdateRowsCalledForcibly","_workRows","callIfNeeded","rowHeight","dataMappedSize","mapped","oldRowIndexMappedStart","oldRowIndexMappedEnd","oldRowCount","newContentHeight","newContentY","newRowIndexMappedLowerBound","newRowIndexMappedUpperBound","newRowIndexMappedStart","newRowIndexMappedEnd","newRowCount","oldRowIndexMapped","newRow","rowIndexMappedStartDelta","rowIndexMappedStartDeltaAbs","resetRow","isEven","updateFrozenCellPosition","shiftY","WORK_ON_CLICK","rowIndexMapped","isSingle","isNotSingle","isEmpty","clearAndAdd","addTo","DTableCategoryCell","DTableCategory","DTableHeaderCellState","SORTED_ASCENDING","SORTED_DESCENDING","_column","sorting","DTableHeaderCell","table","_onSorterChangeBound","onSorterChange","DESCENDING","isApplied","onSorterChangeBound","DTableHeader","_table","defaultGetter","defaultSetter","defaultEditingUnformatter","toColumnEditing","editable","rowA","rowB","valueB","toColumnSorting","sortable","toColumnMenu","toColumnDialog","defaultSelectingGetter","toColumnSelecting","toColumn","toColumnAlign","category","DTable","toColumns","toFrozen","newCategory","_category","headerOffset","bodyOffset","setWidth","toContentWidth","onRowClicked","hasCategories","toCategoryOptions","toCategoryColumns","columnWidthTotal","columnWidth","toHeaderOptions","toBodyOptions","wcardinal","ui"],"mappings":"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"}